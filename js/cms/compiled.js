(function(B){var O,ay="2.5.1",x=this,T=Math.round,Z,t=0,e=1,aM=2,s=3,ar=4,q=5,Q=6,au={},aG={_isAMomentObject:null,_i:null,_f:null,_l:null,_strict:null,_isUTC:null,_offset:null,_pf:null,_lang:null},ai=(typeof module!=="undefined"&&module.exports&&typeof require!=="undefined"),b=/^\/?Date\((\-?\d+)/i,aV=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,aA=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,al=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,Y=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,f=/\d\d?/,aa=/\d{1,3}/,C=/\d{1,4}/,a2=/[+\-]?\d{1,6}/,aR=/\d+/,G=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,n=/Z|[\+\-]\d\d:?\d\d/gi,j=/T/i,aJ=/[\+\-]?\d+(\.\d{1,3})?/,X=/\d/,o=/\d\d/,aU=/\d{3}/,aI=/\d{4}/,ae=/[+-]?\d{6}/,V=/[+-]?\d+/,aE=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,R="YYYY-MM-DDTHH:mm:ssZ",aT=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],E=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],W=/([\+\-]|\d\d)/gi,aB="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),A={Milliseconds:1,Seconds:1000,Minutes:60000,Hours:3600000,Days:86400000,Months:2592000000,Years:31536000000},c={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},aQ={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},ah={},aL="DDD w W M D d".split(" "),aj="M D H h m s w W".split(" "),aN={M:function(){return this.month()+1},MMM:function(a4){return this.lang().monthsShort(this,a4)},MMMM:function(a4){return this.lang().months(this,a4)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(a4){return this.lang().weekdaysMin(this,a4)},ddd:function(a4){return this.lang().weekdaysShort(this,a4)},dddd:function(a4){return this.lang().weekdays(this,a4)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return H(this.year()%100,2)},YYYY:function(){return H(this.year(),4)},YYYYY:function(){return H(this.year(),5)},YYYYYY:function(){var a5=this.year(),a4=a5>=0?"+":"-";return a4+H(Math.abs(a5),6)},gg:function(){return H(this.weekYear()%100,2)},gggg:function(){return H(this.weekYear(),4)},ggggg:function(){return H(this.weekYear(),5)},GG:function(){return H(this.isoWeekYear()%100,2)},GGGG:function(){return H(this.isoWeekYear(),4)},GGGGG:function(){return H(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),true)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),false)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return J(this.milliseconds()/100)},SS:function(){return H(J(this.milliseconds()/10),2)},SSS:function(){return H(this.milliseconds(),3)},SSSS:function(){return H(this.milliseconds(),3)},Z:function(){var a5=-this.zone(),a4="+";if(a5<0){a5=-a5;a4="-"}return a4+H(J(a5/60),2)+":"+H(J(a5)%60,2)},ZZ:function(){var a5=-this.zone(),a4="+";if(a5<0){a5=-a5;a4="-"}return a4+H(J(a5/60),2)+H(J(a5)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()},Q:function(){return this.quarter()}},S=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];function ac(){return{empty:false,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:false,invalidMonth:null,invalidFormat:false,userInvalidated:false,iso:false}}function L(a5,a4){return function(a6){return H(a5.call(this,a6),a4)}}function g(a4,a5){return function(a6){return this.lang().ordinal(a4.call(this,a6),a5)}}while(aL.length){Z=aL.pop();aN[Z+"o"]=g(aN[Z],Z)}while(aj.length){Z=aj.pop();aN[Z+Z]=L(aN[Z],2)}aN.DDDD=L(aN.DDD,3);function aC(){}function I(a4){aZ(a4);aw(this,a4)}function ab(a7){var ba=l(a7),a9=ba.year||0,a5=ba.month||0,a4=ba.week||0,bd=ba.day||0,bb=ba.hour||0,a8=ba.minute||0,bc=ba.second||0,a6=ba.millisecond||0;this._milliseconds=+a6+bc*1000+a8*60000+bb*3600000;this._days=+bd+a4*7;this._months=+a5+a9*12;this._data={};this._bubble()}function aw(a5,a4){for(var a6 in a4){if(a4.hasOwnProperty(a6)){a5[a6]=a4[a6]}}if(a4.hasOwnProperty("toString")){a5.toString=a4.toString}if(a4.hasOwnProperty("valueOf")){a5.valueOf=a4.valueOf}return a5}function a1(a5){var a4={},a6;for(a6 in a5){if(a5.hasOwnProperty(a6)&&aG.hasOwnProperty(a6)){a4[a6]=a5[a6]}}return a4}function k(a4){if(a4<0){return Math.ceil(a4)}else{return Math.floor(a4)}}function H(a8,a7,a6){var a5=""+Math.abs(a8),a4=a8>=0;while(a5.length<a7){a5="0"+a5}return(a4?(a6?"+":""):"-")+a5}function D(a7,a6,ba,a9){var a5=a6._milliseconds,bc=a6._days,a4=a6._months,a8,bb;if(a5){a7._d.setTime(+a7._d+a5*ba)}if(bc||a4){a8=a7.minute();bb=a7.hour()}if(bc){a7.date(a7.date()+bc*ba)}if(a4){a7.month(a7.month()+a4*ba)}if(a5&&!a9){O.updateOffset(a7)}if(bc||a4){a7.minute(a8);a7.hour(bb)}}function a(a4){return Object.prototype.toString.call(a4)==="[object Array]"}function d(a4){return Object.prototype.toString.call(a4)==="[object Date]"||a4 instanceof Date}function aK(a9,a8,a5){var a4=Math.min(a9.length,a8.length),a6=Math.abs(a9.length-a8.length),ba=0,a7;for(a7=0;a7<a4;a7++){if((a5&&a9[a7]!==a8[a7])||(!a5&&J(a9[a7])!==J(a8[a7]))){ba++}}return ba+a6}function aP(a5){if(a5){var a4=a5.toLowerCase().replace(/(.)s$/,"$1");a5=c[a5]||aQ[a4]||a4}return a5}function l(a6){var a5={},a4,a7;for(a7 in a6){if(a6.hasOwnProperty(a7)){a4=aP(a7);if(a4){a5[a4]=a6[a7]}}}return a5}function ao(a5){var a4,a6;if(a5.indexOf("week")===0){a4=7;a6="day"}else{if(a5.indexOf("month")===0){a4=12;a6="month"}else{return}}O[a5]=function(bb,a8){var ba,a7,bc=O.fn._lang[a5],a9=[];if(typeof bb==="number"){a8=bb;bb=B}a7=function(be){var bd=O().utc().set(a6,be);return bc.call(O.fn._lang,bd,bb||"")};if(a8!=null){return a7(a8)}else{for(ba=0;ba<a4;ba++){a9.push(a7(ba))}return a9}}}function J(a4){var a6=+a4,a5=0;if(a6!==0&&isFinite(a6)){if(a6>=0){a5=Math.floor(a6)}else{a5=Math.ceil(a6)}}return a5}function aX(a4,a5){return new Date(Date.UTC(a4,a5+1,0)).getUTCDate()}function aS(a4){return aF(a4)?366:365}function aF(a4){return(a4%4===0&&a4%100!==0)||a4%400===0}function aZ(a4){var a5;if(a4._a&&a4._pf.overflow===-2){a5=a4._a[e]<0||a4._a[e]>11?e:a4._a[aM]<1||a4._a[aM]>aX(a4._a[t],a4._a[e])?aM:a4._a[s]<0||a4._a[s]>23?s:a4._a[ar]<0||a4._a[ar]>59?ar:a4._a[q]<0||a4._a[q]>59?q:a4._a[Q]<0||a4._a[Q]>999?Q:-1;if(a4._pf._overflowDayOfYear&&(a5<t||a5>aM)){a5=aM}a4._pf.overflow=a5}}function ax(a4){if(a4._isValid==null){a4._isValid=!isNaN(a4._d.getTime())&&a4._pf.overflow<0&&!a4._pf.empty&&!a4._pf.invalidMonth&&!a4._pf.nullInput&&!a4._pf.invalidFormat&&!a4._pf.userInvalidated;if(a4._strict){a4._isValid=a4._isValid&&a4._pf.charsLeftOver===0&&a4._pf.unusedTokens.length===0}}return a4._isValid}function z(a4){return a4?a4.toLowerCase().replace("_","-"):a4}function u(a4,a5){return a5._isUTC?O(a4).zone(a5._offset||0):O(a4).local()}aw(aC.prototype,{set:function(a4){var a6,a5;for(a5 in a4){a6=a4[a5];if(typeof a6==="function"){this[a5]=a6}else{this["_"+a5]=a6}}},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(a4){return this._months[a4.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(a4){return this._monthsShort[a4.month()]},monthsParse:function(a4){var a5,a7,a6;if(!this._monthsParse){this._monthsParse=[]}for(a5=0;a5<12;a5++){if(!this._monthsParse[a5]){a7=O.utc([2000,a5]);a6="^"+this.months(a7,"")+"|^"+this.monthsShort(a7,"");this._monthsParse[a5]=new RegExp(a6.replace(".",""),"i")}if(this._monthsParse[a5].test(a4)){return a5}}},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(a4){return this._weekdays[a4.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(a4){return this._weekdaysShort[a4.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(a4){return this._weekdaysMin[a4.day()]},weekdaysParse:function(a7){var a4,a6,a5;if(!this._weekdaysParse){this._weekdaysParse=[]}for(a4=0;a4<7;a4++){if(!this._weekdaysParse[a4]){a6=O([2000,1]).day(a4);a5="^"+this.weekdays(a6,"")+"|^"+this.weekdaysShort(a6,"")+"|^"+this.weekdaysMin(a6,"");this._weekdaysParse[a4]=new RegExp(a5.replace(".",""),"i")}if(this._weekdaysParse[a4].test(a7)){return a4}}},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(a5){var a4=this._longDateFormat[a5];if(!a4&&this._longDateFormat[a5.toUpperCase()]){a4=this._longDateFormat[a5.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(a6){return a6.slice(1)});this._longDateFormat[a5]=a4}return a4},isPM:function(a4){return((a4+"").toLowerCase().charAt(0)==="p")},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(a4,a5,a6){if(a4>11){return a6?"pm":"PM"}else{return a6?"am":"AM"}},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(a5,a6){var a4=this._calendar[a5];return typeof a4==="function"?a4.apply(a6):a4},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(a7,a6,a5,a8){var a4=this._relativeTime[a5];return(typeof a4==="function")?a4(a7,a6,a5,a8):a4.replace(/%d/i,a7)},pastFuture:function(a6,a4){var a5=this._relativeTime[a6>0?"future":"past"];return typeof a5==="function"?a5(a4):a5.replace(/%s/i,a4)},ordinal:function(a4){return this._ordinal.replace("%d",a4)},_ordinal:"%d",preparse:function(a4){return a4},postformat:function(a4){return a4},week:function(a4){return y(a4,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}});function ag(a5,a4){a4.abbr=a5;if(!au[a5]){au[a5]=new aC()}au[a5].set(a4);return au[a5]}function aW(a4){delete au[a4]}function av(a8){var a7=0,a5,ba,a9,a6,a4=function(bb){if(!au[bb]&&ai){try{require("./lang/"+bb)}catch(bc){}}return au[bb]};if(!a8){return O.fn._lang}if(!a(a8)){ba=a4(a8);if(ba){return ba}a8=[a8]}while(a7<a8.length){a6=z(a8[a7]).split("-");a5=a6.length;a9=z(a8[a7+1]);a9=a9?a9.split("-"):null;while(a5>0){ba=a4(a6.slice(0,a5).join("-"));if(ba){return ba}if(a9&&a9.length>=a5&&aK(a6,a9,true)>=a5-1){break}a5--}a7++}return O.fn._lang}function af(a4){if(a4.match(/\[[\s\S]/)){return a4.replace(/^\[|\]$/g,"")}return a4.replace(/\\/g,"")}function p(a6){var a7=a6.match(al),a4,a5;for(a4=0,a5=a7.length;a4<a5;a4++){if(aN[a7[a4]]){a7[a4]=aN[a7[a4]]}else{a7[a4]=af(a7[a4])}}return function(a9){var a8="";for(a4=0;a4<a5;a4++){a8+=a7[a4] instanceof Function?a7[a4].call(a9,a6):a7[a4]}return a8}}function ak(a4,a5){if(!a4.isValid()){return a4.lang().invalidDate()}a5=a3(a5,a4.lang());if(!ah[a5]){ah[a5]=p(a5)}return ah[a5](a4)}function a3(a6,a7){var a4=5;function a5(a8){return a7.longDateFormat(a8)||a8}Y.lastIndex=0;while(a4>=0&&Y.test(a6)){a6=a6.replace(Y,a5);Y.lastIndex=0;a4-=1}return a6}function an(a7,a6){var a5,a4=a6._strict;switch(a7){case"DDDD":return aU;case"YYYY":case"GGGG":case"gggg":return a4?aI:C;case"Y":case"G":case"g":return V;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return a4?ae:a2;case"S":if(a4){return X}case"SS":if(a4){return o}case"SSS":if(a4){return aU}case"DDD":return aa;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return G;case"a":case"A":return av(a6._l)._meridiemParse;case"X":return aJ;case"Z":case"ZZ":return n;case"T":return j;case"SSSS":return aR;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return a4?o:f;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return f;default:a5=new RegExp(a0(aq(a7.replace("\\","")),"i"));return a5}}function v(a5){a5=a5||"";var a4=(a5.match(n)||[]),a8=a4[a4.length-1]||[],a7=(a8+"").match(W)||["-",0,0],a6=+(a7[1]*60)+J(a7[2]);return a7[0]==="+"?-a6:a6}function ap(a8,a6,a7){var a5,a4=a7._a;switch(a8){case"M":case"MM":if(a6!=null){a4[e]=J(a6)-1}break;case"MMM":case"MMMM":a5=av(a7._l).monthsParse(a6);if(a5!=null){a4[e]=a5}else{a7._pf.invalidMonth=a6}break;case"D":case"DD":if(a6!=null){a4[aM]=J(a6)}break;case"DDD":case"DDDD":if(a6!=null){a7._dayOfYear=J(a6)}break;case"YY":a4[t]=J(a6)+(J(a6)>68?1900:2000);break;case"YYYY":case"YYYYY":case"YYYYYY":a4[t]=J(a6);break;case"a":case"A":a7._isPm=av(a7._l).isPM(a6);break;case"H":case"HH":case"h":case"hh":a4[s]=J(a6);break;case"m":case"mm":a4[ar]=J(a6);break;case"s":case"ss":a4[q]=J(a6);break;case"S":case"SS":case"SSS":case"SSSS":a4[Q]=J(("0."+a6)*1000);break;case"X":a7._d=new Date(parseFloat(a6)*1000);break;case"Z":case"ZZ":a7._useUTC=true;a7._tzm=v(a6);break;case"w":case"ww":case"W":case"WW":case"d":case"dd":case"ddd":case"dddd":case"e":case"E":a8=a8.substr(0,1);case"gg":case"gggg":case"GG":case"GGGG":case"GGGGG":a8=a8.substr(0,2);if(a6){a7._w=a7._w||{};a7._w[a8]=a6}break}}function ad(a8){var ba,a9,bd=[],a6,bc,a5,be,bf,a7,bb,a4;if(a8._d){return}a6=m(a8);if(a8._w&&a8._a[aM]==null&&a8._a[e]==null){a5=function(bh){var bg=parseInt(bh,10);return bh?(bh.length<3?(bg>68?1900+bg:2000+bg):bg):(a8._a[t]==null?O().weekYear():a8._a[t])};be=a8._w;if(be.GG!=null||be.W!=null||be.E!=null){bf=r(a5(be.GG),be.W||1,be.E,4,1)}else{a7=av(a8._l);bb=be.d!=null?aY(be.d,a7):(be.e!=null?parseInt(be.e,10)+a7._week.dow:0);a4=parseInt(be.w,10)||1;if(be.d!=null&&bb<a7._week.dow){a4++}bf=r(a5(be.gg),a4,bb,a7._week.doy,a7._week.dow)}a8._a[t]=bf.year;a8._dayOfYear=bf.dayOfYear}if(a8._dayOfYear){bc=a8._a[t]==null?a6[t]:a8._a[t];if(a8._dayOfYear>aS(bc)){a8._pf._overflowDayOfYear=true}a9=F(bc,0,a8._dayOfYear);a8._a[e]=a9.getUTCMonth();a8._a[aM]=a9.getUTCDate()}for(ba=0;ba<3&&a8._a[ba]==null;++ba){a8._a[ba]=bd[ba]=a6[ba]}for(;ba<7;ba++){a8._a[ba]=bd[ba]=(a8._a[ba]==null)?(ba===2?1:0):a8._a[ba]}bd[s]+=J((a8._tzm||0)/60);bd[ar]+=J((a8._tzm||0)%60);a8._d=(a8._useUTC?F:am).apply(null,bd)}function az(a5){var a4;if(a5._d){return}a4=l(a5._i);a5._a=[a4.year,a4.month,a4.day,a4.hour,a4.minute,a4.second,a4.millisecond];ad(a5)}function m(a5){var a4=new Date();if(a5._useUTC){return[a4.getUTCFullYear(),a4.getUTCMonth(),a4.getUTCDate()]}else{return[a4.getFullYear(),a4.getMonth(),a4.getDate()]}}function N(a7){a7._a=[];a7._pf.empty=true;var a6=av(a7._l),ba=""+a7._i,a9,a5,bd,a8,bc,a4=ba.length,bb=0;bd=a3(a7._f,a6).match(al)||[];for(a9=0;a9<bd.length;a9++){a8=bd[a9];a5=(ba.match(an(a8,a7))||[])[0];if(a5){bc=ba.substr(0,ba.indexOf(a5));if(bc.length>0){a7._pf.unusedInput.push(bc)}ba=ba.slice(ba.indexOf(a5)+a5.length);bb+=a5.length}if(aN[a8]){if(a5){a7._pf.empty=false}else{a7._pf.unusedTokens.push(a8)}ap(a8,a5,a7)}else{if(a7._strict&&!a5){a7._pf.unusedTokens.push(a8)}}}a7._pf.charsLeftOver=a4-bb;if(ba.length>0){a7._pf.unusedInput.push(ba)}if(a7._isPm&&a7._a[s]<12){a7._a[s]+=12}if(a7._isPm===false&&a7._a[s]===12){a7._a[s]=0}ad(a7);aZ(a7)}function aq(a4){return a4.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(a5,a9,a8,a7,a6){return a9||a8||a7||a6})}function a0(a4){return a4.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function aO(a4){var a8,a6,a7,a5,a9;if(a4._f.length===0){a4._pf.invalidFormat=true;a4._d=new Date(NaN);return}for(a5=0;a5<a4._f.length;a5++){a9=0;a8=aw({},a4);a8._pf=ac();a8._f=a4._f[a5];N(a8);if(!ax(a8)){continue}a9+=a8._pf.charsLeftOver;a9+=a8._pf.unusedTokens.length*10;a8._pf.score=a9;if(a7==null||a9<a7){a7=a9;a6=a8}}aw(a4,a6||a8)}function h(a7){var a8,a4,a6=a7._i,a5=aE.exec(a6);if(a5){a7._pf.iso=true;for(a8=0,a4=aT.length;a8<a4;a8++){if(aT[a8][1].exec(a6)){a7._f=aT[a8][0]+(a5[6]||" ");break}}for(a8=0,a4=E.length;a8<a4;a8++){if(E[a8][1].exec(a6)){a7._f+=E[a8][0];break}}if(a6.match(n)){a7._f+="Z"}N(a7)}else{a7._d=new Date(a6)}}function M(a6){var a5=a6._i,a4=b.exec(a5);if(a5===B){a6._d=new Date()}else{if(a4){a6._d=new Date(+a4[1])}else{if(typeof a5==="string"){h(a6)}else{if(a(a5)){a6._a=a5.slice(0);ad(a6)}else{if(d(a5)){a6._d=new Date(+a5)}else{if(typeof(a5)==="object"){az(a6)}else{a6._d=new Date(a5)}}}}}}}function am(bb,a4,a9,a8,ba,a7,a6){var a5=new Date(bb,a4,a9,a8,ba,a7,a6);if(bb<1970){a5.setFullYear(bb)}return a5}function F(a5){var a4=new Date(Date.UTC.apply(null,arguments));if(a5<1970){a4.setUTCFullYear(a5)}return a4}function aY(a4,a5){if(typeof a4==="string"){if(!isNaN(a4)){a4=parseInt(a4,10)}else{a4=a5.weekdaysParse(a4);if(typeof a4!=="number"){return null}}}return a4}function aD(a4,a6,a5,a7,a8){return a8.relativeTime(a6||1,!!a5,a4,a7)}function w(a6,a4,a5){var bb=T(Math.abs(a6)/1000),a7=T(bb/60),ba=T(a7/60),bc=T(ba/24),a8=T(bc/365),a9=bb<45&&["s",bb]||a7===1&&["m"]||a7<45&&["mm",a7]||ba===1&&["h"]||ba<22&&["hh",ba]||bc===1&&["d"]||bc<=25&&["dd",bc]||bc<=45&&["M"]||bc<345&&["MM",T(bc/30)]||a8===1&&["y"]||["yy",a8];a9[2]=a4;a9[3]=a6>0;a9[4]=a5;return aD.apply({},a9)}function y(a8,a6,a9){var a5=a9-a6,a4=a9-a8.day(),a7;if(a4>a5){a4-=7}if(a4<a5-7){a4+=7}a7=O(a8).add("d",a4);return{week:Math.ceil(a7.dayOfYear()/7),year:a7.year()}}function r(a8,a7,a9,bb,a4){var ba=F(a8,0,1).getUTCDay(),a6,a5;a9=a9!=null?a9:a4;a6=a4-ba+(ba>bb?7:0)-(ba<a4?7:0);a5=7*(a7-1)+(a9-a4)+a6+1;return{year:a5>0?a8:a8-1,dayOfYear:a5>0?a5:aS(a8-1)+a5}}function K(a5){var a4=a5._i,a6=a5._f;if(a4===null){return O.invalid({nullInput:true})}if(typeof a4==="string"){a5._i=a4=av().preparse(a4)}if(O.isMoment(a4)){a5=a1(a4);a5._d=new Date(+a4._d)}else{if(a6){if(a(a6)){aO(a5)}else{N(a5)}}else{M(a5)}}return new I(a5)}O=function(a5,a6,a7,a4){var a8;if(typeof(a7)==="boolean"){a4=a7;a7=B}a8={};a8._isAMomentObject=true;a8._i=a5;a8._f=a6;a8._l=a7;a8._strict=a4;a8._isUTC=false;a8._pf=ac();return K(a8)};O.utc=function(a5,a6,a7,a4){var a8;if(typeof(a7)==="boolean"){a4=a7;a7=B}a8={};a8._isAMomentObject=true;a8._useUTC=true;a8._isUTC=true;a8._l=a7;a8._i=a5;a8._f=a6;a8._strict=a4;a8._pf=ac();return K(a8).utc()};O.unix=function(a4){return O(a4*1000)};O.duration=function(a5,a9){var ba=a5,a8=null,a4,a7,a6;if(O.isDuration(a5)){ba={ms:a5._milliseconds,d:a5._days,M:a5._months}}else{if(typeof a5==="number"){ba={};if(a9){ba[a9]=a5}else{ba.milliseconds=a5}}else{if(!!(a8=aV.exec(a5))){a4=(a8[1]==="-")?-1:1;ba={y:0,d:J(a8[aM])*a4,h:J(a8[s])*a4,m:J(a8[ar])*a4,s:J(a8[q])*a4,ms:J(a8[Q])*a4}}else{if(!!(a8=aA.exec(a5))){a4=(a8[1]==="-")?-1:1;a6=function(bc){var bb=bc&&parseFloat(bc.replace(",","."));return(isNaN(bb)?0:bb)*a4};ba={y:a6(a8[2]),M:a6(a8[3]),d:a6(a8[4]),h:a6(a8[5]),m:a6(a8[6]),s:a6(a8[7]),w:a6(a8[8])}}}}}a7=new ab(ba);if(O.isDuration(a5)&&a5.hasOwnProperty("_lang")){a7._lang=a5._lang}return a7};O.version=ay;O.defaultFormat=R;O.updateOffset=function(){};O.lang=function(a5,a4){var a6;if(!a5){return O.fn._lang._abbr}if(a4){ag(z(a5),a4)}else{if(a4===null){aW(a5);a5="en"}else{if(!au[a5]){av(a5)}}}a6=O.duration.fn._lang=O.fn._lang=av(a5);return a6._abbr};O.langData=function(a4){if(a4&&a4._lang&&a4._lang._abbr){a4=a4._lang._abbr}return av(a4)};O.isMoment=function(a4){return a4 instanceof I||(a4!=null&&a4.hasOwnProperty("_isAMomentObject"))};O.isDuration=function(a4){return a4 instanceof ab};for(Z=S.length-1;Z>=0;--Z){ao(S[Z])}O.normalizeUnits=function(a4){return aP(a4)};O.invalid=function(a5){var a4=O.utc(NaN);if(a5!=null){aw(a4._pf,a5)}else{a4._pf.userInvalidated=true}return a4};O.parseZone=function(a4){return O(a4).parseZone()};aw(O.fn=I.prototype,{clone:function(){return O(this)},valueOf:function(){return +this._d+((this._offset||0)*60000)},unix:function(){return Math.floor(+this/1000)},toString:function(){return this.clone().lang("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var a4=O(this).utc();if(0<a4.year()&&a4.year()<=9999){return ak(a4,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}else{return ak(a4,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}},toArray:function(){var a4=this;return[a4.year(),a4.month(),a4.date(),a4.hours(),a4.minutes(),a4.seconds(),a4.milliseconds()]},isValid:function(){return ax(this)},isDSTShifted:function(){if(this._a){return this.isValid()&&aK(this._a,(this._isUTC?O.utc(this._a):O(this._a)).toArray())>0}return false},parsingFlags:function(){return aw({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(){return this.zone(0)},local:function(){this.zone(0);this._isUTC=false;return this},format:function(a5){var a4=ak(this,a5||O.defaultFormat);return this.lang().postformat(a4)},add:function(a4,a6){var a5;if(typeof a4==="string"){a5=O.duration(+a6,a4)}else{a5=O.duration(a4,a6)}D(this,a5,1);return this},subtract:function(a4,a6){var a5;if(typeof a4==="string"){a5=O.duration(+a6,a4)}else{a5=O.duration(a4,a6)}D(this,a5,-1);return this},diff:function(a8,a7,a4){var a9=u(a8,this),a5=(this.zone()-a9.zone())*60000,ba,a6;a7=aP(a7);if(a7==="year"||a7==="month"){ba=(this.daysInMonth()+a9.daysInMonth())*43200000;a6=((this.year()-a9.year())*12)+(this.month()-a9.month());a6+=((this-O(this).startOf("month"))-(a9-O(a9).startOf("month")))/ba;a6-=((this.zone()-O(this).startOf("month").zone())-(a9.zone()-O(a9).startOf("month").zone()))*60000/ba;if(a7==="year"){a6=a6/12}}else{ba=(this-a9);a6=a7==="second"?ba/1000:a7==="minute"?ba/60000:a7==="hour"?ba/3600000:a7==="day"?(ba-a5)/86400000:a7==="week"?(ba-a5)/604800000:ba}return a4?a6:k(a6)},from:function(a5,a4){return O.duration(this.diff(a5)).lang(this.lang()._abbr).humanize(!a4)},fromNow:function(a4){return this.from(O(),a4)},calendar:function(){var a4=u(O(),this).startOf("day"),a6=this.diff(a4,"days",true),a5=a6<-6?"sameElse":a6<-1?"lastWeek":a6<0?"lastDay":a6<1?"sameDay":a6<2?"nextDay":a6<7?"nextWeek":"sameElse";return this.format(this.lang().calendar(a5,this))},isLeapYear:function(){return aF(this.year())},isDST:function(){return(this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone())},day:function(a5){var a4=this._isUTC?this._d.getUTCDay():this._d.getDay();if(a5!=null){a5=aY(a5,this.lang());return this.add({d:a5-a4})}else{return a4}},month:function(a4){var a5=this._isUTC?"UTC":"",a6;if(a4!=null){if(typeof a4==="string"){a4=this.lang().monthsParse(a4);if(typeof a4!=="number"){return this}}a6=this.date();this.date(1);this._d["set"+a5+"Month"](a4);this.date(Math.min(a6,this.daysInMonth()));O.updateOffset(this);return this}else{return this._d["get"+a5+"Month"]()}},startOf:function(a4){a4=aP(a4);switch(a4){case"year":this.month(0);case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}if(a4==="week"){this.weekday(0)}else{if(a4==="isoWeek"){this.isoWeekday(1)}}return this},endOf:function(a4){a4=aP(a4);return this.startOf(a4).add((a4==="isoWeek"?"week":a4),1).subtract("ms",1)},isAfter:function(a5,a4){a4=typeof a4!=="undefined"?a4:"millisecond";return +this.clone().startOf(a4)>+O(a5).startOf(a4)},isBefore:function(a5,a4){a4=typeof a4!=="undefined"?a4:"millisecond";return +this.clone().startOf(a4)<+O(a5).startOf(a4)},isSame:function(a5,a4){a4=a4||"ms";return +this.clone().startOf(a4)===+u(a5,this).startOf(a4)},min:function(a4){a4=O.apply(null,arguments);return a4<this?this:a4},max:function(a4){a4=O.apply(null,arguments);return a4>this?this:a4},zone:function(a4){var a5=this._offset||0;if(a4!=null){if(typeof a4==="string"){a4=v(a4)}if(Math.abs(a4)<16){a4=a4*60}this._offset=a4;this._isUTC=true;if(a5!==a4){D(this,O.duration(a5-a4,"m"),1,true)}}else{return this._isUTC?a5:this._d.getTimezoneOffset()}return this},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){if(this._tzm){this.zone(this._tzm)}else{if(typeof this._i==="string"){this.zone(this._i)}}return this},hasAlignedHourOffset:function(a4){if(!a4){a4=0}else{a4=O(a4).zone()}return(this.zone()-a4)%60===0},daysInMonth:function(){return aX(this.year(),this.month())},dayOfYear:function(a4){var a5=T((O(this).startOf("day")-O(this).startOf("year"))/86400000)+1;return a4==null?a5:this.add("d",(a4-a5))},quarter:function(){return Math.ceil((this.month()+1)/3)},weekYear:function(a4){var a5=y(this,this.lang()._week.dow,this.lang()._week.doy).year;return a4==null?a5:this.add("y",(a4-a5))},isoWeekYear:function(a4){var a5=y(this,1,4).year;return a4==null?a5:this.add("y",(a4-a5))},week:function(a4){var a5=this.lang().week(this);return a4==null?a5:this.add("d",(a4-a5)*7)},isoWeek:function(a4){var a5=y(this,1,4).week;return a4==null?a5:this.add("d",(a4-a5)*7)},weekday:function(a4){var a5=(this.day()+7-this.lang()._week.dow)%7;return a4==null?a5:this.add("d",a4-a5)},isoWeekday:function(a4){return a4==null?this.day()||7:this.day(this.day()%7?a4:a4-7)},get:function(a4){a4=aP(a4);return this[a4]()},set:function(a4,a5){a4=aP(a4);if(typeof this[a4]==="function"){this[a4](a5)}return this},lang:function(a4){if(a4===B){return this._lang}else{this._lang=av(a4);return this}}});function aH(a4,a5){O.fn[a4]=O.fn[a4+"s"]=function(a6){var a7=this._isUTC?"UTC":"";if(a6!=null){this._d["set"+a7+a5](a6);O.updateOffset(this);return this}else{return this._d["get"+a7+a5]()}}}for(Z=0;Z<aB.length;Z++){aH(aB[Z].toLowerCase().replace(/s$/,""),aB[Z])}aH("year","FullYear");O.fn.days=O.fn.day;O.fn.months=O.fn.month;O.fn.weeks=O.fn.week;O.fn.isoWeeks=O.fn.isoWeek;O.fn.toJSON=O.fn.toISOString;aw(O.duration.fn=ab.prototype,{_bubble:function(){var a6=this._milliseconds,bb=this._days,a4=this._months,a9=this._data,ba,a8,a5,a7;a9.milliseconds=a6%1000;ba=k(a6/1000);a9.seconds=ba%60;a8=k(ba/60);a9.minutes=a8%60;a5=k(a8/60);a9.hours=a5%24;bb+=k(a5/24);a9.days=bb%30;a4+=k(bb/30);a9.months=a4%12;a7=k(a4/12);a9.years=a7},weeks:function(){return k(this.days()/7)},valueOf:function(){return this._milliseconds+this._days*86400000+(this._months%12)*2592000000+J(this._months/12)*31536000000},humanize:function(a5){var a6=+this,a4=w(a6,!a5,this.lang());if(a5){a4=this.lang().pastFuture(a6,a4)}return this.lang().postformat(a4)},add:function(a4,a6){var a5=O.duration(a4,a6);this._milliseconds+=a5._milliseconds;this._days+=a5._days;this._months+=a5._months;this._bubble();return this},subtract:function(a4,a6){var a5=O.duration(a4,a6);this._milliseconds-=a5._milliseconds;this._days-=a5._days;this._months-=a5._months;this._bubble();return this},get:function(a4){a4=aP(a4);return this[a4.toLowerCase()+"s"]()},as:function(a4){a4=aP(a4);return this["as"+a4.charAt(0).toUpperCase()+a4.slice(1)+"s"]()},lang:O.fn.lang,toIsoString:function(){var a7=Math.abs(this.years()),a4=Math.abs(this.months()),a9=Math.abs(this.days()),a5=Math.abs(this.hours()),a6=Math.abs(this.minutes()),a8=Math.abs(this.seconds()+this.milliseconds()/1000);if(!this.asSeconds()){return"P0D"}return(this.asSeconds()<0?"-":"")+"P"+(a7?a7+"Y":"")+(a4?a4+"M":"")+(a9?a9+"D":"")+((a5||a6||a8)?"T":"")+(a5?a5+"H":"")+(a6?a6+"M":"")+(a8?a8+"S":"")}});function U(a4){O.duration.fn[a4]=function(){return this._data[a4]}}function at(a4,a5){O.duration.fn["as"+a4]=function(){return +this/a5}}for(Z in A){if(A.hasOwnProperty(Z)){at(Z,A[Z]);U(Z.toLowerCase())}}at("Weeks",604800000);O.duration.fn.asMonths=function(){return(+this-this.years()*31536000000)/2592000000+this.years()*12};O.lang("en",{ordinal:function(a6){var a4=a6%10,a5=(J(a6%100/10)===1)?"th":(a4===1)?"st":(a4===2)?"nd":(a4===3)?"rd":"th";return a6+a5}});function P(a5){var a4=false,a6=O;if(typeof ender!=="undefined"){return}if(a5){x.moment=function(){if(!a4&&console&&console.warn){a4=true;console.warn("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.")}return a6.apply(null,arguments)};aw(x.moment,a6)}else{x.moment=O}}if(ai){module.exports=O;P(true)}else{if(typeof define==="function"&&define.amd){define("moment",function(a5,a4,a6){if(a6.config&&a6.config()&&a6.config().noGlobal!==true){P(a6.config().noGlobal===B)}return O})}else{P()}}}).call(this);(function(a){if(typeof define==="function"&&define.amd){define(["moment"],a)}else{if(typeof exports==="object"){module.exports=a(require("../moment"))}else{a(window.moment)}}}(function(e){function c(j,h){var g=j.split("_");return h%10===1&&h%100!==11?g[0]:(h%10>=2&&h%10<=4&&(h%100<10||h%100>=20)?g[1]:g[2])}function f(j,h,g){var k={mm:"минута_минуты_минут",hh:"час_часа_часов",dd:"день_дня_дней",MM:"месяц_месяца_месяцев",yy:"год_года_лет"};if(g==="m"){return h?"минута":"минуту"}else{return j+" "+c(k[g],+j)}}function d(h,k){var g={nominative:"январь_февраль_март_апрель_май_июнь_июль_август_сентябрь_октябрь_ноябрь_декабрь".split("_"),accusative:"января_февраля_марта_апреля_мая_июня_июля_августа_сентября_октября_ноября_декабря".split("_")},j=(/D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/).test(k)?"accusative":"nominative";return g[j][h.month()]}function b(g,k){var j={nominative:"янв_фев_мар_апр_май_июнь_июль_авг_сен_окт_ноя_дек".split("_"),accusative:"янв_фев_мар_апр_мая_июня_июля_авг_сен_окт_ноя_дек".split("_")},h=(/D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/).test(k)?"accusative":"nominative";return j[h][g.month()]}function a(g,k){var h={nominative:"воскресенье_понедельник_вторник_среда_четверг_пятница_суббота".split("_"),accusative:"воскресенье_понедельник_вторник_среду_четверг_пятницу_субботу".split("_")},j=(/\[ ?[Вв] ?(?:прошлую|следующую)? ?\] ?dddd/).test(k)?"accusative":"nominative";return h[j][g.day()]}return e.lang("ru",{months:d,monthsShort:b,weekdays:a,weekdaysShort:"вс_пн_вт_ср_чт_пт_сб".split("_"),weekdaysMin:"вс_пн_вт_ср_чт_пт_сб".split("_"),monthsParse:[/^янв/i,/^фев/i,/^мар/i,/^апр/i,/^ма[й|я]/i,/^июн/i,/^июл/i,/^авг/i,/^сен/i,/^окт/i,/^ноя/i,/^дек/i],longDateFormat:{LT:"HH:mm",L:"DD.MM.YYYY",LL:"D MMMM YYYY г.",LLL:"D MMMM YYYY г., LT",LLLL:"dddd, D MMMM YYYY г., LT"},calendar:{sameDay:"[Сегодня в] LT",nextDay:"[Завтра в] LT",lastDay:"[Вчера в] LT",nextWeek:function(){return this.day()===2?"[Во] dddd [в] LT":"[В] dddd [в] LT"},lastWeek:function(){switch(this.day()){case 0:return"[В прошлое] dddd [в] LT";case 1:case 2:case 4:return"[В прошлый] dddd [в] LT";case 3:case 5:case 6:return"[В прошлую] dddd [в] LT"}},sameElse:"L"},relativeTime:{future:"через %s",past:"%s назад",s:"несколько секунд",m:f,mm:f,h:"час",hh:f,d:"день",dd:f,M:"месяц",MM:f,y:"год",yy:f},meridiem:function(g,j,h){if(g<4){return"ночи"}else{if(g<12){return"утра"}else{if(g<17){return"дня"}else{return"вечера"}}}},ordinal:function(g,h){switch(h){case"M":case"d":case"DDD":return g+"-й";case"D":return g+"-го";case"w":case"W":return g+"-я";default:return g}},week:{dow:1,doy:7}})}));var uAdmin=(function(){var register=function(){var checkClass=function(parent,parent_str){for(var i in parent.reg){if(parent.reg[parent_str]){return parent.reg[parent_str]}else{return checkClass(parent.reg[i],parent_str)}}return false};var name,value,parent,params=arguments[0];if(params.length){if(typeof params[0]=="object"){if(Object.prototype.toString.call(params[0])=="[object Array]"){return false}for(var i in params[0]){register([i,params[0][i],params[1]||null])}return true}else{if(typeof params[0]=="string"){if(typeof params[1]=="undefined"){return false}name=params[0];value=params[1];parent=params[2]||null}else{return false}}}else{return false}if(!parent){parent=uAdmin}if(typeof parent=="string"){parent=checkClass(uAdmin,parent)}if(typeof parent!="function"){return false}var isclass=false;name=name.split(".");if(name.length>1){isclass=true}name=name.pop();var reg=function(){parent.reg[name]=value;if(isclass){parent.reg[name].isclass=true}};if(!parent.reg){parent.reg=reg}reg();return true};function uAdmin(){if(uAdmin.prototype.instanse==null){uAdmin.prototype.instanse=new uAdmin.prototype.get()}register(arguments);return uAdmin.prototype.instanse}uAdmin.prototype.get=function(){return this};uAdmin.prototype.get.prototype=uAdmin.prototype;uAdmin.prototype.init=function(){uAdmin.load(uAdmin);delete uAdmin.reg;if(uAdmin.csrf){jQuery(document).ajaxSend(function(event,jqXhr,settings){if(settings.data instanceof FormData){settings.data.append("csrf",uAdmin.csrf);return}if(!settings||!settings.type||(typeof settings.data!=="string"&&typeof settings.data!=="undefined")){return true}switch(settings.type){case"POST":if(typeof settings.data=="undefined"){settings.data=""}settings.data+=settings.data.length?"&csrf="+uAdmin.csrf:"csrf="+uAdmin.csrf;break;case"GET":settings.url+=~settings.url.indexOf("?")?"&csrf="+uAdmin.csrf:"?csrf="+uAdmin.csrf;break}})}var images=document.getElementsByTagName("img");for(var i=0;i<images.length;i++){if(images[i].getAttribute("umi:field-name")=="photo"){if(!!images[i].width){images[i].style.maxWidth=images[i].width+"px"}if(!!images[i].height){images[i].style.maxHeight=images[i].height+"px"}}}};if(typeof JSON=="undefined"){JSON={parse:function(str){try{if(str.match(/^{/g)){var val=eval("("+str+")");if(Object.prototype.toString.call(val)=="[object Object]"){return val}}throw new SyntaxError("JSON.parse: unexpected end of data")}catch(e){throw new SyntaxError("JSON.parse: unexpected end of data")}}}}if(!window.pageData){var data=jQuery.ajax({url:location.pathname+".json"+location.search,dataType:"json",async:false});uAdmin("data",JSON.parse(data.responseText))}else{uAdmin("data",window.pageData)}var onLoadEventHandlers={};uAdmin.onLoad=function(loadedItemName,eventHandler){if(typeof eventHandler!="function"){return false}if(loadedItemName in onLoadEventHandlers===false){onLoadEventHandlers[loadedItemName]=[]}onLoadEventHandlers[loadedItemName].push(eventHandler);return eventHandler in onLoadEventHandlers[loadedItemName]};uAdmin.load=function(parent){for(var i in parent.reg){if(parent.reg[i].reg){uAdmin.load(parent.reg[i])}if(parent.reg[i].isclass){var extend=function(usedClass,extendClass){for(var i in extendClass){usedClass.prototype[i]=extendClass[i]}return new usedClass()};if(parent==uAdmin){parent[i]=new parent.reg[i](extend)}else{parent.prototype[i]=new parent.reg[i](extend)}}else{if(parent==uAdmin){parent[i]=parent.reg[i]}else{parent.prototype[i]=parent.reg[i]}}var moduleOnLoadEventHandlers=onLoadEventHandlers[i];if(moduleOnLoadEventHandlers!=undefined&&moduleOnLoadEventHandlers.length>0){for(var j=0;j<moduleOnLoadEventHandlers.length;j++){if(typeof moduleOnLoadEventHandlers[j]=="function"){moduleOnLoadEventHandlers[j]()}}}}};return uAdmin})();jQuery(document).ready(function(){uAdmin().init()});uAdmin(".panel",function(b){function a(){var c=this;jQuery("html").addClass("u-eip");this.panelHolder=this.addPanelHolder();this.quickpanel=this.addQuickpanel();this.showHideBtn=this.addShowHideBtn();this.drawControls();jQuery(document).bind("click",function(f){if(!jQuery(f.target).parents("#u-quickpanel").length){c.changeAct()}});if(!jQuery.cookie("eip-panel-state-first")){this.quickpanel.css({overflow:"hidden",height:"0"});this.showHideBtn.addClass("collapse");this.quickpanel.delay(500).animate({height:"25px"},500,function(){jQuery(this).css("overflow","visible");c.showHideBtn.removeClass("collapse")});this.quickpanel.fadeTo(300,0.3);this.quickpanel.fadeTo(300,1);jQuery.cookie("eip-panel-state","",{path:"/",expires:0});var e=new Date();e.setTime(e.getTime()+(30*24*60*60*1000));jQuery.cookie("eip-panel-state-first","Y",{path:"/",expires:e})}var d="/admin/content/frontendPanel/.json?links";d+="&ts="+Math.round(Math.random()*1000);jQuery.ajax({url:d,dataType:"json",success:this.onLoadData})}a.prototype.drawControls=function(){this.exitButton=this.addExitButton();this.helpButton=this.addHelpButton();this.butterfly=this.addButtrfly();this.eipHolder=this.addEipHolder();this.editMenu=this.addEditMenu();this.lastDoc=this.addLastDoc();this.changelogDd=this.addChangelogDd();this.note=this.addNote();this.metaHolder=this.addMetaHolder()};a.prototype.addPanelHolder=function(){return jQuery('<div id="u-panel-holder" />').appendTo("body")};a.prototype.addQuickpanel=function(){if(!this.panelHolder.length){return null}return jQuery('<div id="u-quickpanel" />').appendTo(this.panelHolder)};a.prototype.addShowHideBtn=function(){if(!this.panelHolder.length){return null}var c=this;return jQuery('<div id="u-show_hide_btn" />').appendTo(this.panelHolder).click(function(){c.swap(this)})};a.prototype.addExitButton=function(){if(!this.quickpanel.length){return null}return jQuery('\n			<div id="exit" title="'+getLabel("js-panel-exit")+'">&#160;</div>\n		').appendTo(this.quickpanel).click(function(){window.location="/users/logout/";return false})};a.prototype.addHelpButton=function(){if(!this.quickpanel.length){return null}return jQuery('\n			<div id="help" title="'+getLabel("js-panel-documentation")+'">&#160;</div>\n		').appendTo(this.quickpanel).click(function(){window.open("http://help.docs.umi-cms.ru");return false})};a.prototype.addButtrfly=function(){if(!this.quickpanel.length){return null}return jQuery('\n			<div id="butterfly">\n				<span class="in_ico_bg">&#160;</span>'+getLabel("js-panel-modules")+'\n				<div class="bg">\n					<ul id="u-mods-cont-left" />\n					<ul id="u-mods-cont-right" />\n					<div class="clear separate" />\n					<ul id="u-mods-utils" />\n					<ul id="u-mods-admin" />\n					<div class="clear" />\n				</div>\n			</div>\n		').appendTo(this.quickpanel)};a.prototype.addEipHolder=function(){if(!this.quickpanel.length){return null}return jQuery("<div />").attr({id:"eip_holder"}).appendTo(this.quickpanel)};a.prototype.addMetaHolder=function(){if(!this.quickpanel.length){return null}return jQuery("<div />").attr({id:"meta_holder"}).appendTo(this.quickpanel)};a.prototype.addEditMenu=function(){if(!this.quickpanel.length){return null}return jQuery('\n			<div id="edit_menu" title="'+getLabel("js-panel-edit-menu")+'">\n				<span class="in_ico_bg">&#160;</span>\n				<div>\n					<ul id="u-docs-edit"/>\n					<span class="clear" />\n				</div>\n			</div>\n		').appendTo(this.quickpanel)};a.prototype.addLastDoc=function(){if(!this.quickpanel.length){return null}var c=this;return jQuery('\n			<div id="last_doc">\n				<span class="in_ico_bg" />\n				'+getLabel("js-panel-last-documents")+'\n				<div>\n					<ul id="u-docs-recent" />\n					<span class="clear" />\n				</div>\n			</div>\n		').appendTo(this.quickpanel).click(function(){c.changeAct(this)})};a.prototype.addChangelogDd=function(){if(!this.quickpanel.length){return null}var c=this;return jQuery('\n			<div id="changelog_dd" style="display:none;">\n				<span class="in_ico_bg">&#160;</span>\n				'+getLabel("js-panel-history-changes")+'\n				<div>\n					<ul id="u-changelog" />\n					<span class="clear" />\n				</div>\n			</div>\n		').appendTo(this.quickpanel).click(function(){c.changeAct(this)})};a.prototype.addNote=function(){if(!this.quickpanel.length){return null}return jQuery('\n			<div id="note">\n				<span class="in_ico_bg">&#160;</span>\n				'+getLabel("js-panel-note")+"\n			</div>\n		").appendTo(this.quickpanel)};a.prototype.addSeoButton=function(){if(!this.quickpanel.length){return null}return jQuery('\n			<div id="seo">				<span class="in_ico_bg">&#160;</span>\n				'+getLabel("module-seo")+"\n			</div>\n		").appendTo(this.quickpanel).click(function(){window.location="/admin/seo/"})};a.prototype.onLoadData=function(e){var l=uAdmin.panel;if(!l){return false}jQuery('<link type="text/css" rel="stylesheet" href="/styles/skins/_eip/css/theme.css" />').appendTo("head");var g,c;for(g in e.documents.recent.page){g=e.documents.recent.page[g];jQuery("ul#u-docs-recent",l.lastDoc).append('<li><a href="'+g.link+'">'+g.name+"</a></li>")}var f=0;for(g in e.documents.editable.page){g=e.documents.editable.page[g];for(c in e.modules.module){c=e.modules.module[c];if(c.name==g.basetype.module){continue}}jQuery("ul#u-docs-edit",l.quickpanel||null).append('<li><a href="'+(uAdmin.lang_prefix?"/"+uAdmin.lang_prefix:"")+g["edit-link"]+'">'+g.name+"</a></li>");f++}if(f&&l.editMenu){l.editMenu.click(function(){l.changeAct(this)})}else{if(l.editMenu){l.editMenu.hide(0)}}f=0;for(c in e.modules.module){c=e.modules.module[c];var d;switch(c.type){case"system":d="ul#u-mods-utils";break;case"util":d="ul#u-mods-admin";break;default:d=(++f%2)?"ul#u-mods-cont-left":"ul#u-mods-cont-right"}jQuery(d,l.butterfly||null).append('<li><a href="'+(uAdmin.lang_prefix?"/"+uAdmin.lang_prefix:"")+"/admin/"+c.name+'/">'+c.label+"</a></li>")}if(f&&l.butterfly){l.butterfly.click(function(){l.changeAct(this)}).addClass("butterfly_hover")}if(typeof e.changelog!="undefined"&&l.changelogDd){for(var j in e.changelog.revision){j=e.changelog.revision[j];var k=j.date.std+(j.author.name?" - "+j.author.name:"")+(j.active=="active"?"&nbsp;&nbsp;&nbsp;&larr;":"");var h=j.link+"?force-redirect="+window.location.pathname;jQuery("#u-changelog",l.changelogDd).append('<li><a href="'+h+'">'+k+"</a></li>")}l.changelogDd.css("display","")}else{if(l.changelogDd){l.changelogDd.css("display","none")}}if(typeof e.tickets!="undefined"&&typeof uAdmin.tickets=="object"){uAdmin.tickets.draw(e)}else{if(l.note){l.note.remove()}}};a.prototype.swap=function(d){var c=jQuery("#u-quickpanel").css("height");if(c=="0px"){return this.expand(d)}else{if(uAdmin.eip.meta.enabled){jQuery("#u-quickpanel #meta").trigger("click")}return this.collapse(d)}};a.prototype.expand=function(d){var c=jQuery("#u-quickpanel");c.css("overflow","visible");c.animate({height:"25px"},700);jQuery(d).removeClass("collapse");jQuery.cookie("eip-panel-state","",{path:"/",expires:0})};a.prototype.collapse=function(e){var d=jQuery("#u-quickpanel");d.css("overflow","hidden");d.animate({height:"0"},700);jQuery(e).addClass("collapse");var c=new Date();c.setTime(c.getTime()+(30*24*60*60*1000));jQuery.cookie("eip-panel-state","collapsed",{path:"/",expires:c})};a.prototype.loadRes=function(c,e,f){var d;switch(c){case"js":case"text/javascript":d=document.createElement("script");d.src=e;d.charset="utf-8";break;case"css":case"text/css":d=document.createElement("link");d.href=e;d.rel="stylesheet";break;default:return}document.body.parentNode.firstChild.appendChild(d);if(typeof f=="function"){jQuery(document).one("ready",f)}};a.prototype.changeAct=function(f){var d=(uAdmin.eip&&uAdmin.eip.enabled)?"[id != 'edit'][id != 'ieditor-switcher']":"",c=jQuery("#save_edit");if(!f){jQuery("#u-quickpanel .act div:first").hide();jQuery("#u-quickpanel .act"+d).removeClass("act")}else{if(jQuery(f).hasClass("act")){jQuery("#u-quickpanel .act div:first").hide();jQuery("#u-quickpanel .act"+d).removeClass("act");if(f.id=="edit"){c.css("display","none")}}else{var e=jQuery("#u-quickpanel .act"),g=false;if(e.length){jQuery("#u-quickpanel .act div:first").hide();jQuery("#u-quickpanel .act"+d).removeClass("act");if(f.id=="edit"&&!d){c.css("display","none")}}if(jQuery.browser.opera){g=jQuery(f).width()}jQuery(f).addClass("act");if(g){jQuery(f).width(g)}jQuery("#u-quickpanel .act div:first").show();if(f.id=="edit"){c.css("display","block")}}}if(jQuery(f).attr("id")!="meta"&&uAdmin.eip&&uAdmin.eip.meta.enabled){jQuery("#u-quickpanel #meta").addClass("act")}};a.prototype.editInAdmin=function(c){if(c=="enable"){jQuery(document).bind("keypress",this.editInAdmin.bindEvents)}if(c=="disable"){jQuery(document).unbind("keypress",this.editInAdmin.bindEvents)}};a.prototype.editInAdmin.bindEvents=function(c){if(c.shiftKey){switch(c.charCode||c.keyCode){case 68:case 100:case 1042:case 1074:jQuery("#u-quickpanel #edit_menu").each(function(d,e){uAdmin.panel.changeAct(e)});break}}};return b(a,this)});uAdmin(".tickets",function(b){function a(){var d=100;this.defaultColor="#FFFFE1";this.colorProperty="ticketsColor";this.buttonSelector="#u-quickpanel #note, #quickpanel #note";var c=function(f){jQuery.jGrowl(f,{header:"UMI.CMS",life:5000})};var e=function(h){var f=this;f.params=h;(function g(){if(h.message){f.createMessage()}f.update()})()};e.prototype.rollbackParams=function(){if(this.params.oldWidth){this.params.width=this.params.oldWidth}if(this.params.oldHeight){this.params.height=this.params.oldHeight}if(this.params.oldX){this.params.x=this.params.oldX}if(this.params.oldY){this.params.y=this.params.oldY}if(this.params.oldMessage){this.params.message.text=this.params.oldMessage}};e.prototype.resetSelection=function(){if(document.selection&&document.selection.empty){document.selection.empty()}else{if(window.getSelection){var f=window.getSelection();if(f&&f.removeAllRanges){f.removeAllRanges()}}}};e.prototype.createMessage=function(){var f=this;f.messageNode=jQuery('<div class="u-ticket-comment"><div /><textarea /><a /></div>').appendTo("body");f.messageNode.css("background-color",f.params.message.color);f.messageNode.draggable({scroll:false,containment:document.body,stop:function(g,h){f.params.oldX=f.params.x;f.params.oldY=f.params.y;f.params.x=h.position.left;f.params.y=h.position.top;f.save()}});if(f.params.message){jQuery("div",f.messageNode).html("<span>"+f.params.message.authorName+" ("+f.params.message.authorLogin+")</span>");jQuery("textarea",f.messageNode).prop("value",f.params.message.text)}f.messageNode.resizable({minWidth:jQuery("div:first-child span",f.messageNode).outerWidth(),minHeight:d,containment:document.body,start:function(){jQuery(f.messageNode).css("cursor","default")},stop:function(g,h){f.params.oldWidth=f.params.width;f.params.oldHeight=f.params.height;f.params.width=h.size.width;f.params.height=h.size.height;f.save();jQuery(f.messageNode).css("cursor","move")}});jQuery("a",f.messageNode).html(getLabel("js-ticket-delete"));jQuery("textarea",f.messageNode).bind("change",function(){f.save()});jQuery("textarea",f.messageNode).bind("focus",function(){f.params.oldMessage=jQuery(this).prop("value")});jQuery("a",f.messageNode).bind("click",function(){f.del()})};e.prototype.del=function(){var f=this;if(f.params.id){var g="/tickets/manage/delete/"+f.params.id+"/";jQuery.ajax({url:g,dataType:"json",type:"get",success:function(j){if(j&&typeof j.error=="string"){c(j.error);return}h(f.node,f.messageNode)}})}else{h(f.node,f.messageNode)}function h(k,j){if(k&&typeof k.remove=="function"){k.remove()}if(j&&typeof j.remove=="function"){j.remove()}}};e.prototype.save=function(){var f=this;var h=f.params.id?"modify":"create";var g="/tickets/manage/"+h+"/"+f.params.id+"/";g+="?ts="+Math.round(Math.random()*1000);jQuery.ajax({type:"POST",url:g,dataType:"json",data:{x:f.params.x,y:f.params.y,width:f.params.width,height:f.params.height,message:jQuery("textarea",f.messageNode).prop("value"),color:f.params.message.color||uAdmin.tickets.defaultColor,referer:window.location.href.split("#")[0]},success:function(j){if(j&&typeof j.error=="string"){c(j.error);f.rollbackParams();f.update();return}f.params.id=j.id}})};e.prototype.update=function(){var f=this;f.params.width=f.params.width||f.messageNode.outerWidth();f.params.height=f.params.height||f.messageNode.outerHeight();if(f.messageNode){jQuery("textarea",f.messageNode).prop("value",f.params.message.text);f.messageNode.css({top:parseInt(f.params.y),left:parseInt(f.params.x),width:f.params.width,height:f.params.height})}};this.ticket=e}a.prototype.initNewTicket=function(){this.changeState(jQuery(this.buttonSelector).get(0));if(!uAdmin.tickets.created){alert(getLabel("js-panel-note-add"));uAdmin.tickets.created=true}if(uAdmin.tickets.isInit){return false}uAdmin.tickets.isInit=true;var d=this;var e=uAdmin.tickets.user.fname;var c=(uAdmin.tickets.user.lname==null)?"":" "+uAdmin.tickets.user.lname;jQuery(document).one("mousedown",function(f){new uAdmin.tickets.ticket({x:f.pageX,y:f.pageY,message:{authorName:e+c,authorLogin:uAdmin.tickets.user.login,color:uAdmin.tickets.user[d.colorProperty],text:getLabel("js-ticket-empty")}});uAdmin.tickets.isInit=false;d.changeState(jQuery(d.buttonSelector).get(0))})};a.prototype.changeState=function(e){var d=jQuery(e);if(typeof uAdmin.panel=="object"){uAdmin.panel.changeAct(e)}else{if(jQuery("#quickpanel").length>0){var c="act";if(d.hasClass(c)){d.removeClass(c)}else{d.addClass(c)}}}};a.prototype.swapVisible=function(){this.disabled?this.enable():this.disable()};a.prototype.disable=function(){var c=this;jQuery("div.u-ticket, div.u-ticket-comment, "+c.buttonSelector).hide();jQuery(document).unbind("keydown",c.bindEvents);jQuery(c.buttonSelector).unbind("click",c.bindEvents);c.disabled=true};a.prototype.enable=function(){var c=this;jQuery("div.u-ticket, div.u-ticket-comment, "+c.buttonSelector).show();jQuery(document).bind("keydown",c.bindEvents);jQuery(c.buttonSelector).bind("click",c.bindEvents);c.disabled=false};a.prototype.bindEvents=function(c){if(c.delegateTarget!==document){c.preventDefault()}if((c.shiftKey&&(c.keyCode==67||c.keyCode==99)&&(c.target.nodeName!="INPUT"&&c.target.nodeName!="TEXTAREA"))||(c.type=="click"&&document.getElementById("note").id=="note")){uAdmin.tickets.initNewTicket()}};a.prototype.draw=function(j){var d=this;uAdmin.tickets.user=j.user;for(var f in j.tickets.ticket){f=j.tickets.ticket[f];var k=f.position,h=f.author;var g=h.fname;var c=(h.lname==null)?"":" "+h.lname;var e=new this.ticket({id:f.id,x:k.x,y:k.y,width:k.width,height:k.height,message:{authorName:g+c,authorLogin:h.login,color:h[d.colorProperty]||d.defaultColor,text:f.message}});e.update()}};a.prototype.disabled=true;a.prototype.isInit=false;return b(a,this)});uAdmin(".eip",function(b){function a(){this.isMac=(navigator.userAgent.indexOf("Mac OS")!=-1);this.drawControls();if(uAdmin.data&&uAdmin.data.pageId){this.metaInit()}else{uAdmin.onLoad("data",function(){uAdmin.eip.metaInit()})}this.bindEditorEvents();if(!uAdmin.tickets&&uAdmin.panel){uAdmin.onLoad("tickets",this.activateByCookie)}else{if(uAdmin.tickets&&!uAdmin.panel){uAdmin.onLoad("panel",this.activateByCookie)}else{uAdmin.onLoad("eip",this.activateByCookie)}}this.init();this.bindGlobalEvents()}a.prototype.init=function(){this.deleteButtonsTimeout=null;this.initEditBoxes()};a.prototype.initEditBoxes=function(){var c=this;jQuery(document).on("mouseover",".u-eip-edit-box",function(){c.editBoxMouseoverHandler(this)});jQuery(document).on("mouseout",".u-eip-edit-box-hover",function(){c.editBoxMouseoutHandler(this)})};a.prototype.editBoxMouseoverHandler=function(d){var c=this,e=jQuery(d).addClass("u-eip-edit-box-hover"),f=c.searchAttr(d);if(e.attr("umi:delete")&&f.id){c.addDeleteButton(d,f)}else{c.dropDeleteButtons()}d.onclick=function(g){d.onclick=function(){return true};if(window.event){return window.event.ctrlKey}else{return g.ctrlKey}}};a.prototype.editBoxMouseoutHandler=function(d){var e=jQuery(d).removeClass("u-eip-edit-box-hover"),c=this;if(e.attr("umi:delete")){c.deleteButtonsTimeout=setTimeout(c.dropDeleteButtons,500)}e.click(function(){return true})};a.prototype.addDeleteButton=function(d,e){var c=this;if(this.deleteButtonsTimeout){clearTimeout(this.deleteButtonsTimeout)}this.dropDeleteButtons();var f=document.createElement("div");jQuery(f).attr("class","eip-del-button");document.body.appendChild(f);c.placeWith(d,f,"right","middle");jQuery(f).bind("mouseover",function(){if(c.deleteButtonsTimeout){clearTimeout(c.deleteButtonsTimeout)}}).bind("mouseout",function(){c.deleteButtonsTimeout=setTimeout(c.dropDeleteButtons,500)}).bind("click",function(){e["delete"]=true;c.queue.add(e);uAdmin.eip.normalizeBoxes()});return f};a.prototype.dropDeleteButtons=function(){jQuery(".eip-del-button").remove()};a.prototype.bindGlobalEvents=function(){this.bindKeyboardShortcut();window.onresize=function(){uAdmin.eip.normalizeBoxes()}};a.prototype.bindKeyboardShortcut=function(){jQuery(document).bind("keydown",function(c){if(c.keyCode==113){uAdmin.eip.swapEditor()}})};a.prototype.activateByCookie=function(){if(jQuery.cookie("eip-editor-state")){uAdmin.eip.swapEditor()}else{uAdmin.tickets.enable();uAdmin.panel.editInAdmin("enable")}};a.prototype.drawControls=function(){this.editorToggleButton=this.addEditorToggleButton();this.editorControlsHolder=this.addEditorControlsHolder();this.saveButton=this.addSaveButton();this.undoButton=this.addUndoButton();this.redoButton=this.addRedoButton()};a.prototype.addEditorControlsHolder=function(){return jQuery('\n			<div id="save_edit"></div>\n		').appendTo(uAdmin.panel.eipHolder)};a.prototype.addSaveButton=function(){var c=this;if(!this.editorControlsHolder){return null}return jQuery('\n			<div id="save" title="'+getLabel("js-panel-save")+" ("+(this.isMac?"Cmd":"Ctrl")+'+S)">&#160;</div>\n		').appendTo(this.editorControlsHolder).click(function(){c.queue.save();return false})};a.prototype.addUndoButton=function(){var c=this;if(!this.editorControlsHolder){return null}return jQuery('\n			<div id="edit_back" title="'+getLabel("js-panel-cancel")+" ("+(this.isMac?"Cmd":"Ctrl")+'+Z)">&#160;</div>\n		').appendTo(this.editorControlsHolder).click(function(){c.queue.back();return false})};a.prototype.addRedoButton=function(){var c=this;if(!this.editorControlsHolder){return null}return jQuery('\n			<div id="edit_next" title="'+getLabel("js-panel-repeat")+" ("+(this.isMac?"Cmd+Shift+Z":"Ctrl+Y")+')">&#160;</div>\n		').appendTo(this.editorControlsHolder).click(function(){c.queue.forward();return false})};a.prototype.addEditorToggleButton=function(){var c=this,d=jQuery('\n				<div id="edit">\n					<span class="in_ico_bg">&#160;</span>\n					<span class="edit-button-label"></span> (F2)				</div>\n			');d.appendTo(uAdmin.panel.eipHolder).click(function(){c.swapEditor();return false});d.setLabelText=function(e){if(e){d.find(".edit-button-label").text(e)}};d.setLabelText(getLabel("js-panel-edit"));return d};a.prototype.metaInit=function(){var c=this;this.meta.element_id=uAdmin.data.pageId;this.meta.old={alt_name:uAdmin.data.page["alt-name"]?uAdmin.data.page["alt-name"]:"",title:uAdmin.data.title?uAdmin.data.title:"",keywords:uAdmin.data.meta.keywords?uAdmin.data.meta.keywords:"",descriptions:uAdmin.data.meta.description?uAdmin.data.meta.description:""};this.meta["new"]={};this.metaToggleButton=this.addMetaToggleButton();this.metaPanel=this.addMetaPanel();this.metaSaveButton=this.getMetaSaveButton();this.metaPanel.find('input[type!="submit"]').bind("blur",function(f){var d=this.name.replace(/^meta_/g,"");c.meta["new"][d]=this.value}).bind("keyup mousedown blur",function(){var d=this.value.length;if(d>255){this.value=this.value.substring(0,255)}else{var e=this.id+"-count";jQuery("#"+e).html(d)}}).trigger("keyup")};a.prototype.addMetaToggleButton=function(){return jQuery('\n			<div id="meta">\n				<span class="in_ico_bg">&#160;</span>\n				'+getLabel("js-panel-meta")+"\n			</div>\n		").appendTo(uAdmin.panel.metaHolder).click(function(){uAdmin.panel.changeAct(this);uAdmin.eip.metaPanel.toggle();uAdmin.eip.meta.enabled=uAdmin.eip.metaPanel.is(":visible");return false})};a.prototype.addMetaPanel=function(){if(!uAdmin.panel.panelHolder){return null}var c=this;return jQuery('\n				<div id="u-quickpanel-meta">\n					<table>\n						<tr>\n							<td width="100px">'+getLabel("js-panel-meta-altname")+': </td>\n							<td>\n								<input type="text" name="alt_name" id="u-quickpanel-metaaltname" value="'+c.meta.old.alt_name+'"/>\n								<div class="meta_count" id="u-quickpanel-metaaltname-count"/>\n							</td>\n						</tr>\n						<tr>\n							<td width="100px">'+getLabel("js-panel-meta-title")+': </td>\n							<td>\n								<input type="text" name="title" id="u-quickpanel-metatitle" value="'+c.meta.old.title+'"/>\n								<div class="meta_count" id="u-quickpanel-metatitle-count"/>\n							</td>\n						</tr>\n						<tr>\n							<td>'+getLabel("js-panel-meta-keywords")+': </td>\n							<td>\n								<input type="text" name="meta_keywords" id="u-quickpanel-metakeywords" value="'+c.meta.old.keywords+'"/>\n								<div class="meta_count" id="u-quickpanel-metakeywords-count"/>\n								<div class="meta_buttons"><a href="/admin/seo/" style="color:white;">'+getLabel("js-panel-meta-analysis")+"</a></div>\n							</td>\n						</tr>\n						<tr>\n							<td>"+getLabel("js-panel-meta-descriptions")+':</td>\n							<td>\n								<input type="text" name="meta_descriptions" id="u-quickpanel-metadescription" value="'+c.meta.old.descriptions+'"/>\n								<div class="meta_count" id="u-quickpanel-metadescription-count"/>\n								<div class="meta_buttons">\n									<input type="submit" id="save_meta_button" value="'+getLabel("js-panel-save")+'">\n								</div>\n							</td>\n						</tr>\n					</table>\n				</div>\n			').appendTo(uAdmin.panel.panelHolder)};a.prototype.getMetaSaveButton=function(){if(!this.metaPanel){return null}var c=this;return this.metaPanel.find("#save_meta_button").click(function(){c.metaSave();return false})};a.prototype.metaSave=function(){var g={},d,c=this,f=0,e=0;for(d in c.meta["new"]){if(c.meta["new"][d]!=c.meta.old[d]){g["field-name"]=((d=="keywords"||d=="descriptions")?"meta_"+d:d);g["element-id"]=c.meta.element_id;g.value=c.meta["new"][d];f++;jQuery.post("/admin/content/editValue/save.json",g,function(h){if(h.error){c.message(h.error);return}e++;if(e==f){c.message(getLabel("js-panel-message-changes-saved"));uAdmin.eip.metaToggleButton.click()}},"json")}delete c.meta["new"][d]}};a.prototype.bindEditorEvents=function(){this.bind("Enable",this.enableEventHandler);this.bind("Disable",this.disableEventHandler);this.bind("Repaint",this.repaintEventHandler);this.bind("Save",this.saveEventHandler)};a.prototype.enableEventHandler=function(c){if(c=="after"){uAdmin.panel.changeAct(uAdmin.eip.editorToggleButton.get(0))}};a.prototype.disableEventHandler=function(c){if(c=="after"){uAdmin.panel.changeAct(uAdmin.eip.editorToggleButton.get(0))}};a.prototype.repaintEventHandler=function(c){};a.prototype.saveEventHandler=function(c){};a.prototype.swapEditor=function(){if(this.enabled){this.disable();this.editorToggleButton.setLabelText(getLabel("js-panel-edit"));jQuery("#on_edit_in_place").html(getLabel("js-on-eip"));uAdmin.tickets.enable();uAdmin.panel.editInAdmin("enable")}else{this.enable();this.editorToggleButton.setLabelText(getLabel("js-panel-view"));jQuery("#on_edit_in_place").html(getLabel("js-off-eip"));uAdmin.tickets.disable();uAdmin.panel.editInAdmin("disable")}this.bindEvents()};a.prototype.enable=function(){var c=this;c.onEnable("before");c.finishLast();c.inspectDocument();c.highlight();c.normalizeBoxes();jQuery(window).on("load",function(){setTimeout(function(){c.normalizeBoxes()},250)});c.enabled=true;if(c.queue.current>=0){c.queue.setSaveStatus(true)}var d=new Date();d.setTime(d.getTime()+(3*24*60*60*1000));jQuery.cookie("eip-editor-state","enabled",{path:"/",expires:d});c.message(getLabel("js-panel-message-edit-on"));jQuery(document).bind("keydown",c.bindHotkeys);c.onEnable("after")};a.prototype.disable=function(){this.onDisable("before");this.finishLast();this.unhighlight();this.enabled=false;jQuery.cookie("eip-editor-state","",{path:"/",expires:0});this.queue.setSaveStatus(false);this.message(getLabel("js-panel-message-edit-off"));if(this.queue.current>=0){jQuery.openPopupLayer({name:"save",width:200,height:200,data:'\n            						<div class="eip_win_head popupHeader">\n            							<div class="eip_win_close popupClose">&#160;</div>\n            								<div class="eip_win_body popupBody">\n            							<div class="popupText">'+getLabel("js-panel-message-save-confirm",self.save.count)+'</div>\n            							<div class="eip_buttons">\n            								<input type="button" class            								="primary ok" id="saveProgressBtn" value="OK" />\n            								<input type="button" id="closeProgressBtn"class            								="primary back" id="" value="Отмена"/>\n            								<div style="clear: both;" />\n            							</div>\n            						</div>\n            					'});jQuery("#saveProgressBtn").click(function(){jQuery.closePopupLayer("save");uAdmin.eip.queue.save()});jQuery("#closeProgressBtn").click(function(){jQuery.closePopupLayer("save")})}jQuery(document).unbind("keydown",this.bindHotkeys);this.onDisable("after")};a.prototype.bind=function(d,g){var c=this,e=(typeof c["on"+d]=="function")?c["on"+d]:function(){};c["on"+d]=function(h,f){e(h,f);g(h,f)}};a.prototype.trigger=function(e,d,c){if(typeof this["on"+e]=="function"){this["on"+e](d,c)}};a.prototype.bindHotkeys=function(d){var c=uAdmin.eip.queue;if(navigator.userAgent.indexOf("Mac OS")!=-1){if(d.metaKey){switch(d.keyCode){case 83:c.save();break;case 90:if(d.shiftKey){c.forward()}else{c.back()}break;default:return true}return false}}else{if(d.ctrlKey){switch(d.keyCode){case 83:c.save();break;case 90:c.back();break;case 89:c.forward();break;default:return true}return false}}return true};a.prototype.finishLast=function(){if(this.previousEditBox){this.previousEditBox.finish(true);this.previousEditBox=null}};a.prototype.normalizeBoxes=function(){var c=this;jQuery(c.listNodes).each(function(h,l){if(!l.boxNode){return}var f=c.nodePositionInfo(l);jQuery(l.boxNode).css({width:f.width,height:f.height,left:f.x,top:f.y});var j=l.addButtonNode;var k="bottom",e="left";if(j){var g;if((g=jQuery(l).attr("umi:button-position"))){var d=g.split(/ /);if(d.length==2){k=d[0];e=d[1]}}c.placeWith(l,j,k,e)}});c.onRepaint("after")};a.prototype.bindEvents=function(){var d=this,c=jQuery(".u-eip-edit-box");jQuery(document).off("click drop dragexit dragover",".u-eip-edit-box");c.unbind("click");c.unbind("drop");c.unbind("dragexit");c.unbind("dragover");var e="click";if(navigator.userAgent.toLowerCase().indexOf("firefox")||navigator.userAgent.toLowerCase().indexOf("chrome")){e=e+" drop";jQuery(document).on("dragexit",".u-eip-edit-box",function(f){f.stopPropagation();f.preventDefault()});jQuery(document).on("dragover",".u-eip-edit-box",function(f){f.stopPropagation();f.preventDefault()})}jQuery(document).on(e,".u-eip-edit-box",function(j){var h=j.target;if(j.ctrlKey||(navigator.userAgent.indexOf("Mac OS")!=-1&&j.metaKey)){if(this.tagName=="A"){location.href=this.href}return true}var g=(typeof h.onclick=="function")?h.onclick:function(){};var k=function(){return false};h.onclick=k;setTimeout(function(){if(h&&g!=k){h.onclick=g}},100);for(var f=0;f<25;f++){if(!h){return false}if(h.tagName!="TABLE"&&jQuery(h).attr("umi:field-name")){break}h=h.parentNode}if(!h){return false}j.stopPropagation();j.stopImmediatePropagation();j.preventDefault();d.edit(h,j&&j.originalEvent&&j.originalEvent.dataTransfer?j.originalEvent.dataTransfer.files:null);j.stopPropagation();j.stopImmediatePropagation();j.preventDefault();return false});window.onbeforeunload=function(){if(uAdmin.eip.queue.current>=0||uAdmin.eip.queue.save.count>0){return getLabel("js-panel-message-save-before-exit")}}};a.prototype.inspectDocument=function(){var c=this;c.editNodes=[];c.listNodes=[];var d=c.getRegions();d.each(function(e,f){if(jQuery(f).css("display")=="none"){return}c.inspectNode(f)})};a.prototype.inspectNode=function(c){if(c.tagName=="TABLE"){return}if(jQuery(c).attr("umi:field-name")){this.editNodes.push(c)}if(jQuery(c).attr("umi:module")){this.listNodes.push(c)}if(jQuery.browser.msie){jQuery(c).parents("a:first").each(function(){var d=this.href;jQuery(this).click(function(f){if(f.ctrlKey){window.location.href=d}});this.removeAttribute("href")})}};a.prototype.getRegions=function(){return jQuery("*[umi\\:field-name], *[umi\\:module]")};a.prototype.isParentOf=function(d,c){if(!c||!d){return false}if(c==d){return true}if(d.parentNode){return this.isParentOf(d.parentNode,c)}return false};a.prototype.highlight=function(d,c){var e=this;if(e.highlighted){e.unhighlight()}e.highlighted=true;jQuery(e.editNodes).each(function(f,g){if(e.isParentOf(g,d)==false){e.highlightNode(g)}});if(!c){jQuery(e.listNodes).each(function(f,g){if(e.isParentOf(g,d)==false){e.highlightListNode(g)}})}e.onRepaint("after");e.markInversedBoxes()};a.prototype.unhighlight=function(){var c=jQuery(".u-eip-edit-box");c.each(function(d,e){e=jQuery(e);var f=e.attr("umi:empty");if(f&&(e.attr("tagName")!="IMG")&&(e.html()==f)){e.html("")}e.attr("title","")});c.removeClass("u-eip-edit-box u-eip-edit-box-hover u-eip-modified u-eip-deleted u-eip-edit-box-inversed");c.unbind("click");c.unbind("mouseover");c.unbind("mouseout");c.unbind("mousedown");c.unbind("mouseup");jQuery(".u-eip-add-box, .u-eip-add-button, .u-eip-del-button").remove();jQuery(".u-eip-sortable").sortable("destroy");jQuery(".u-eip-sortable").removeClass("u-eip-sortable")};a.prototype.highlightNode=function(d){if(!jQuery(d).attr("umi:field-name")){return}var h=this.searchAttr(d);if(!h){return}var f=this.htmlTrim(jQuery(d).attr("umi:empty"));if(f&&this.htmlTrim(jQuery(d).html())==""&&(jQuery(d).attr("tagName")!="IMG")){try{jQuery(d).html(f)}catch(g){}jQuery(d).addClass("u-eip-empty-field")}jQuery(d).addClass("u-eip-edit-box");if(this.queue.search(h)){jQuery(d).addClass("u-eip-modified")}if(d.tagName=="A"||d.parentNode.tagName=="A"||jQuery("a",d).length>0){var c=getLabel("js-panel-link-to-go");if(navigator.userAgent.indexOf("Mac OS")!=-1){c=c.replace(/Ctrl/g,"Cmd")}jQuery(d).attr("title",c);jQuery(d).bind("dblclick",function(){return false})}else{jQuery(d).attr("title","")}this.markInversedBoxes(jQuery(d))};a.prototype.searchAttr=function(d,h,c){if(!d){return false}var f;c=c||20;if(d.tagName=="BODY"||d.tagName=="TABLE"){return false}if(!this.searchAttr.info.node&&jQuery(d).attr("umi:field-name")){this.searchAttr.info.node=d;var g=jQuery(d).attr("umi:field-name");if(!g&&typeof h!="function"){this.message("You should specify umi:field-name attribute");return false}if(!this.searchAttr.info.field_name){this.searchAttr.info.field_name=g}}var e=jQuery(d);if(typeof h!="function"||h(d)){if(e.attr("umi:element-id")){this.searchAttr.info.id=e.attr("umi:element-id");this.searchAttr.info.type="element";f=this.searchAttr.info;this.searchAttr.info={};return f}else{if(e.attr("umi:object-id")){this.searchAttr.info.id=e.attr("umi:object-id");this.searchAttr.info.type="object";f=this.searchAttr.info;this.searchAttr.info={};return f}}}if(d.parentNode){return this.searchAttr(d.parentNode,h,--c)}this.message("You should specify umi:element-id or umi:object attribute");return false};a.prototype.searchAttr.info={};a.prototype.searchRow=function(d,c){if(c){if(d.tagName=="BODY"||d.tagName=="TABLE"){return false}if(jQuery(d.parentNode).attr("umi:region")){return d.parentNode}else{return this.searchRow(d.parentNode,true)}}else{return jQuery("*[umi\\:region]",d).filter(function(){var e='[umi\\:element-id^="new"], [umi\\:object-id^="new"]';return !jQuery(this).find(e).length&&!jQuery(this).is(e)}).get(0)}};a.prototype.searchRowId=function(d){var c=jQuery(d).attr("umi:element-id");return c||(jQuery("*[umi\\:element-id]",d).length?jQuery("*[umi\\:element-id]",d).get(0).attr("umi:element-id"):null)};a.prototype.inlineAddPage=function(p){var n=this,f=n.searchRow(p);if(!f){n.message("Error, umi:region=row is not defined");return false}p=jQuery(p);var q={element:p.attr("umi:element-id"),object:p.attr("umi:object-id")},j=p.attr("umi:type-id");var g=false;jQuery(".u-eip-deleted").each(function(w,x){if(n.searchAttr(x).id==(q.element||q.object)){g=true;return}});if(g){n.message(getLabel("js-panel-message-cant-add"));return false}if(!j&&q.element){if(q.element.match(/^new/g)){var k=n.queue.search({id:q.element});j=k.type_id}else{var v=jQuery.ajax({url:"/admin/content/getTypeAdding/"+q.element+"/.json",async:false,dataType:"json"});v=JSON.parse(v.responseText);j=v.result}}if(!j){n.message("Error, umi:type-id is not defined");return false}var u=(p.attr("umi:method")=="lastlist"||jQuery(p).attr("umi:add-prepend")=="prepend"),d=jQuery(f).clone(),h=(u)?d.prependTo(f.parentNode):d.appendTo(f.parentNode);h.removeClass("blank_item");var m=function(y){var x,w;if(jQuery(y).attr("umi:field-name")){return y}else{if(y.children){for(w=0;w<y.children.length;w++){x=m(y.children[w]);if(x){return x}}}}return false};d=m(h.get(0));if(!d){n.message("Error, umi:field-name is not defined");return false}var s=n.searchAttr(d);s.id="new_"+new Date().getTime();s.type_id=j;s.add=true;s.node=h.get(0);if(q.object){s.parent=q.object;s.type="object"}if(q.element){s.parent=q.element;s.type="element"}delete s.field_name;if(jQuery(f).attr("umi:"+s.type+"-id")==""){jQuery(f).remove();jQuery(h).attr("umi:"+s.type+"-id",s.id);jQuery("*",h).each(function(w,x){if(!x.children.length){x.style.display=""}})}var e=jQuery.ajax({url:"/admin/content/getTypeFields/"+j+"/.json",async:false,dataType:"json"});e=jQuery.parseJSON(e.responseText);var o=[];for(var r in e){if(parseInt(r)==r){o.push(e[r])}}o.push("name");var c=function(w){var y="umi:"+s.type+"-id";if(jQuery(w).attr("tagName")=="TABLE"){return}if(jQuery(w).attr("umi:field-name")){if(jQuery.inArray(jQuery(w).attr("umi:field-name"),o)==-1){return false}var x=jQuery(w).attr("umi:empty");if(jQuery(w).is("img")&&x){jQuery(w).attr("src",x)}else{jQuery(w).html(x?x:"")}jQuery(w).addClass("u-eip-empty-field");n.editNodes[n.editNodes.length]=w}if(jQuery(w).attr(y)){jQuery(w).attr("umi:clone-source-id",jQuery(w).attr(y));jQuery(w).attr(y,s.id)}};var l=jQuery('*[umi\\:region="row"]',h).get(0);jQuery('*[umi\\:region="row"]',h).remove();c(h);h.addClass("u-eip-newitem");var t=jQuery("*",h);t.each(function(w,x){n.inspectNode(x);n.highlightListNode(x);if(jQuery(x).attr("umi:region")){jQuery(x).html(l);jQuery("*",x).each(function(y,z){z=jQuery(z);if(!z.children().length){z.text("");z.css("display","none")}if(z.attr("href")){z.attr("href","")}if(z.attr("umi:"+s.type+"-id")){z.attr("umi:"+s.type+"-id","")}})}c(x)});n.queue.add(s);n.normalizeBoxes();return true};a.prototype.onSuccessAddNewPage=function(c){if(!c||c.forceReload){document.location.reload();return false}var d=jQuery("[umi\\:element-id="+c.parentId+"][umi\\:region=list]");if(!d.length){return false}var e=function(g,f){g.removeClass("current blank_item");if(g.is("[umi\\:url-attribute]")){g.attr(g.attr("umi:url-attribute"),f.url)}else{if(g.is("a")){g.attr("href",f.url)}}if(g.is("[umi\\:element-id]")){g.attr("umi:element-id",f.elementId)}if(g.is("[umi\\:field-name=name]")){g.text(f.title)}g.children().each(function(){e(jQuery(this),f)})};d.each(function(){var f=jQuery(this);var g=f.find("[umi\\:region=row]").first().clone();e(g,c);g.appendTo(f)});jQuery.closePopupLayer(null,{})};a.prototype.htmlTrim=function(c){c=jQuery.trim(c);return c.replace(/<br ?\/?>/g,"").replace(/(<p>)|(<\/p>)/g,"")};a.prototype.markInversedBoxes=function(c){setTimeout(function(){if(!c){c=jQuery(".u-eip-edit-box")}c.each(function(e,g){var d=new RGBColor(jQuery(g).css("color"));var f=d.toHash();var h=(f.red/255+f.green/255+f.blue/224)/3;if(h>=0.9){jQuery(g).addClass("u-eip-edit-box-inversed")}})},500)};a.prototype.highlightListNode=function(f){var d=this;if(!jQuery(f).attr("umi:module")){return false}var e=document.createElement("div");document.body.appendChild(e);f.boxNode=e;var c=d.nodePositionInfo(f);if(!c.x&&!c.y){return false}jQuery(e).attr("class","u-eip-add-box");jQuery(e).css({position:"absolute",width:c.width,height:c.height,left:c.x,top:c.y});if(jQuery(f).attr("umi:add-method")!="none"){this.addAddButton(f,e)}if(jQuery(f).attr("umi:sortable")=="sortable"){this.setNodeSortable(f,e)}return e};a.prototype.addAddButton=function(k,j){var g=document.createElement("a");k.addButtonNode=g;jQuery(g).attr({"class":"u-eip-add-button"}).html(getLabel("js-panel-add"));jQuery(g).hover(function(){jQuery(this).addClass("u-eip-add-button-hover")},function(){jQuery(this).removeClass("u-eip-add-button-hover")});var h="bottom";var d="left";var f;if(f=jQuery(k).attr("umi:button-position")){var c=f.split(/ /);if(c.length==2){h=c[0];d=c[1]}}this.placeWith(k,g,h,d);var e=this;jQuery(g).bind("mouseup",function(){e.onAddButtonMouseup(k)}).bind("mouseover",function(){e.onAddButtonMouseover(j)}).bind("mouseout",function(){e.onAddButtonMouseout(j)});document.body.appendChild(g)};a.prototype.onAddButtonMouseup=function(h){var o=this;var l=jQuery(h).attr("umi:region");var f=o.searchRow(h);var k=jQuery(h).attr("umi:element-id");var g=jQuery(h).attr("umi:module");var d=jQuery(h).attr("umi:method");var j=jQuery(h).attr("umi:add-method");var c=jQuery(h).attr("umi:type-id");if(f&&(l=="list")&&(j!="popup")){o.inlineAddPage(h)}else{if(o.queue.current>=0){o.message(getLabel("js-panel-message-save-first"));return}var e="/admin/content/eip_add_page/choose/"+parseInt(k)+"/"+g+"/"+d+"/",m=uAdmin.csrf?"?csrf="+uAdmin.csrf:"",n=c?"&type-id="+c:"";jQuery.ajax({url:e+".json"+m,dataType:"json",success:function(p){if(p.data.error){uAdmin.eip.message(p.data.error);return}jQuery.openPopupLayer({name:"CreatePage",title:getLabel("js-eip-create-page"),url:e+m+n})},error:function(){uAdmin.eip.message(getLabel("error-require-more-permissions"));return}})}};a.prototype.onAddButtonMouseover=function(c){jQuery(c).addClass("u-eip-add-box-hover")};a.prototype.onAddButtonMouseout=function(c){jQuery(c).removeClass("u-eip-add-box-hover")};a.prototype.setNodeSortable=function(c,f){var l=this;jQuery(c).addClass("u-eip-sortable");var d=null,k=null,j,e,h=false,g=[];jQuery("*").each(function(p,q){if(q.tagName=="TABLE"){return}if(jQuery(q).attr("umi:sortable")!="sortable"){return}var o=false;jQuery(q).parents().each(function(r,n){if(n==c){o=true}});if(o){return}var m=false;jQuery("*",q).each(function(r,n){if(n==c){m=true}});if(m){return}g.push(q)});jQuery(c).sortable({items:'> [umi\\:region="row"]',tolerance:"pointer",cursor:"move",dropOnEmpty:true,revert:true,forcePlaceholderSize:true,placeholder:"u-eip-sortable-placeholder",update:function(p,q){j=q.item[0];if(!jQuery(j).hasClass("u-eip-newitem")&&!(window.cloudController&&window.cloudController.onController)){var o=jQuery.ajax({url:"/admin/content/eip_move_page/"+jQuery(j).attr("umi:element-id")+"/.json?check",async:false,dataType:"json",type:"GET"});var n=jQuery.parseJSON(o.responseText);if(n.error){jQuery(c).sortable("cancel");uAdmin.eip.message(n.error);return false}}var m=j.nextSibling;do{if(!m){break}if(m.nodeType!=1){continue}if(l.searchRowId(m)){break}}while(m=m.nextSibling);d=m;k=j.parentNode;var r=l.searchAttr(j.parentNode,function(t){return jQuery(t).attr("umi:sortable")=="sortable"});var s=parseInt(r?r.id:null);r.node=j;r.move=true;r.moved=l.searchRowId(j);r.next=m;r.old_next=d;r.parent_id=s;r.parent=j.parentNode;r.old_parent=k;delete r.field_name;d=null;k=null;l.normalizeBoxes();l.queue.add(r)}})};a.prototype.nodePositionInfo=function(c){c=jQuery(c);return{width:c.innerWidth(),height:c.innerHeight(),x:c.offset().left,y:c.offset().top}};a.prototype.placeWith=function(c,d,n,h){if(!c||!d){return}var g=this.nodePositionInfo(c);var l=jQuery(d);var m,k;switch(n){case"top":k=g.y-parseInt(l.css("height"));break;case"right":m=g.x+g.width;break;case"left":m=g.x-l.width();break;default:k=g.y+g.height}if(n=="top"||n=="bottom"){switch(h){case"right":m=g.x+g.width-l.width();break;case"middle":case"center":if(g.width-parseInt(l.css("width"))>0){m=g.x+Math.ceil((g.width-l.width())/2)}else{m=g.x}break;default:m=g.x;m+=parseInt(jQuery(c).css("padding-left"))}}else{switch(h){case"top":k=g.y;break;case"bottom":k=g.y+g.height-parseInt(l.css("height"));break;default:if(g.height-parseInt(l.css("height"))>0){k=g.y+Math.ceil((g.height-parseInt(l.css("height")))/2)}else{k=g.y}}}var o=l.width()+m;var f=jQuery(window);if(o>f.width()){m=f.width()-l.width()-30}try{l.css({position:"absolute",left:m+"px",top:k+"px","z-index":560})}catch(j){}};a.prototype.applyStyles=function(f,h,c){var e=["font-size","font-family","font-name","margin-left","margin-right","margin-top","margin-bottom","font-weight"],d;f=jQuery(f);h=jQuery(h);for(d in e){var g=e[d];h.css(g,f.css(g))}if(c!==false){h.width(f.outerWidth());h.height(f.outerHeight())}};a.prototype.message=function(c){jQuery.jGrowl("<p>"+c+"</p>",{header:"UMI.CMS",life:10000})};a.prototype.edit=function(d,c){if(jQuery(d).hasClass("u-eip-deleted")||jQuery(d).parents().hasClass("u-eip-deleted")){this.message(getLabel("js-panel-message-cant-edit"));return false}this.finishLast();jQuery(".eip-del-button").remove();this.previousEditBox=this.editor.get(d,c);if(this.previousEditBox){jQuery(".u-eip-add-button, .u-eip-add-box").css("display","none")}jQuery(d).removeClass("u-eip-edit-box u-eip-edit-box-hover u-eip-modified u-eip-deleted u-eip-empty-field u-eip-edit-box-inversed");if(this.previousEditBox){jQuery(d).addClass("u-eip-editing")}var e=this.htmlTrim(jQuery(d).attr("umi:empty"));if(e&&this.htmlTrim(jQuery(d).html())==e){jQuery(d).html("&nbsp;");jQuery(d).removeClass("u-eip-empty-field")}return true};a.prototype.queue=[];a.prototype.queue.add=function(c){if(this.current==-1){this.setSaveStatus(true)}if(this.current<this.length-1){for(var d=this.length-1;d>this.current;d--){this.pop()}this.current=(this.length)}else{++this.current}this.push(c);this.step();if(c.add){uAdmin.eip.message(getLabel("js-panel-message-add-after-save"));jQuery(c.node).css("display","")}if(c.move){jQuery(c.node.parentNode).addClass("u-eip-modified")}if(c["delete"]){uAdmin.eip.message(getLabel("js-panel-message-delete-after-save"));jQuery(c.node).addClass("u-eip-deleted")}jQuery(c.node).addClass("u-eip-modified");return this.length};a.prototype.queue.get=function(c){if(!parseInt(c)){c=this.current}return this[c]||null};a.prototype.queue._saveStatus=false;a.prototype.queue.setSaveStatus=function(d){var c=uAdmin.eip;if(d){jQuery("#save").addClass("save_me");c.editorToggleButton.setLabelText(getLabel("js-panel-edit-save"))}else{jQuery("#save").removeClass("save_me");c.editorToggleButton.setLabelText(c.enabled?getLabel("js-panel-view"):getLabel("js-panel-edit"))}uAdmin.eip.queue._saveStatus=d};a.prototype.queue.getSaveStatus=function(c){return uAdmin.eip.queue._saveStatus};a.prototype.queue.search=function(c){var d=this.current;while(d>=0){if(this[d].id==c.id&&(this[d].field_name==c.field_name||(this[d].add&&c.add)||(this[d].move&&c.move)||(this[d]["delete"]&&c["delete"])||(this[d].custom&&c.custom))){return this[d]}--d}return false};a.prototype.queue.back=function(c){c=parseInt(c)||1;while(c--){if(this[this.current]){this.cancel()}}uAdmin.eip.normalizeBoxes();this.step()};a.prototype.queue.forward=function(c){c=parseInt(c)||1;while(c--){if(this[this.current+1]){this.apply()}}uAdmin.eip.normalizeBoxes();this.step()};a.prototype.queue.apply=function(){uAdmin.eip.finishLast();++this.current;var c=this.get();if(!c.add&&!c.move&&!c["delete"]&&!c.custom&&!uAdmin.eip.editor.replace(c,c.new_value,c.old_value)){--this.current}else{switch(true){case c.add:uAdmin.eip.message(getLabel("js-panel-message-add-after-save"));jQuery(c.node).css("display","");break;case c["delete"]:uAdmin.eip.message(getLabel("js-panel-message-delete-after-save"));jQuery(c.node).addClass("u-eip-deleted");break;case c.move:if(c.next){jQuery(c.node).insertBefore(c.next)}else{jQuery(c.node).appendTo(c.parent)}jQuery(c.node).addClass("u-eip-modified");jQuery(c.parent).addClass("u-eip-modified");break;case c.custom:if(c.target&&c.target.forward){c.target.forward()}break;default:jQuery(c.node).addClass("u-eip-modified")}}if(this.current==0){this.setSaveStatus(true)}};a.prototype.queue.cancel=function(){uAdmin.eip.finishLast();var d=this.get(),c=false;switch(true){case d.add:--this.current;jQuery(d.node).css("display","none");break;case d["delete"]:--this.current;jQuery(d.node).removeClass("u-eip-deleted");break;case d.move:--this.current;if(d.old_next){jQuery(d.node).insertBefore(d.old_next)}else{jQuery(d.node).appendTo(d.old_parent)}jQuery(d.node).removeClass("u-eip-modified");if(!this.search(d)){jQuery(d.parent).removeClass("u-eip-modified")}break;case d.custom:--this.current;if(d.target&&d.target.back){d.target.back()}break;default:c=uAdmin.eip.editor.replace(d,d.old_value,d.new_value);if(c){--this.current;jQuery(d.node).addClass("u-eip-modified")}}if(d.add||d.move||d["delete"]||d.custom||c){if(!this.search(d)){jQuery(d.node).removeClass("u-eip-modified")}if(this.current==-1){this.setSaveStatus(false);uAdmin.eip.message(getLabel("js-panel-message-changes-revert"))}}};a.prototype.queue.step=function(){if(this.length){jQuery("#u-quickpanel #save_edit #edit_back").attr("class",(this.current==-1)?"":"ac");jQuery("#u-quickpanel #save_edit #edit_next").attr("class",((this.length-this.current)==1)?"":"ac")}};a.prototype.queue.save=function(j){uAdmin.eip.finishLast();if(this.current==-1&&!j){return false}var c=this,g=false,k={},d=jQuery("div.popupText span",c.progress);switch(j){case"add":for(e in c.save.add){g=c.save.add[e];delete c.save.add[e];break}if(g){for(e in c.save.added){if(g.parent==e){g.parent=c.save.added[e]}}var f="/admin/content/eip_quick_add/"+g.parent+".json?type-id="+g.type_id;if(jQuery(g.node).parent().attr("umi:module")!="data"){f+="&force-hierarchy=1"}jQuery.get(f,function(n){if(n.error){uAdmin.eip.message(n.error);return}var o=parseInt(n.data["element-id"]);var s=parseInt(n.data["object-id"]);c.save.added[g.id]=o||s;jQuery(g.node).removeClass("u-eip-newitem u-eip-modified");jQuery(g.node).attr("umi:"+g.type+"-id",o||s);jQuery("*[umi\\:"+g.type+'-id="'+g.id+'"]',g.node).attr("umi:"+g.type+"-id",o||s);var m=jQuery(g.node);var l=o||s;var p=g.parent;var q=m.parents("[umi\\:region=list]").first();var u=q.attr("umi:add-prepend")=="prepend";var t=function(x,w,v){v=!!v;if(x.attr("umi:element-id")){x.attr("umi:element-id",w.attr("umi:element-id")||l)}if(x.attr("umi:object-id")){x.attr("umi:object-id",w.attr("umi:object-id")||l)}if(x.is("img")){x.attr("src",w.attr("src"))}else{if(v&&x.is("a")){x.attr("href",w.attr("href"))}if(x.is("[umi\\:field-name]")){if(w.attr("umi:empty")){x.attr("umi:empty",w.attr("umi:empty"))}if(x.attr("umi:empty")){x.addClass("u-eip-empty-field")}else{x.removeClass("u-eip-empty-field")}x.text(w.text()||w.attr("umi:empty")||"")}}};var r=q.attr("umi:type-id");jQuery("[umi\\:"+g.type+"-id="+p+"][umi\\:region=list]").filter(function(){return jQuery(this).find("[umi\\:"+g.type+"-id="+l+"]").length==0}).filter(function(){var v=false,w=jQuery(this).attr("umi:type-id");if((!w&&!r)||w==r){v=true}return v}).each(function(){var v=jQuery(this),x=v.children("[umi\\:region=row]:first").clone().removeClass("blank_item current"),w=m.find("*").addBack().filter("[umi\\:url-attribute]").first();if(w.length){var z=w.attr("umi:url-attribute"),y=x.find("*").addBack();if(y.filter("[umi\\:url-attribute]").attr(z,w.attr(z)).length==0){y.filter("a").attr("href",w.attr(z))}t(x,m)}else{t(x,m,true)}m.find("[umi\\:field-name]").each(function(){var A=jQuery(this);var B=A.attr("umi:field-name");x.find("[umi\\:field-name="+B+"]").each(function(){t(jQuery(this),A)})});if(u){x.prependTo(v)}else{x.appendTo(v)}v.find("[umi\\:field-name]").each(function(){uAdmin.eip.highlightNode(this)})});g=false;uAdmin.eip.normalizeBoxes();d.text(parseInt(d.text())+1);--c.save.count;c.save("add")},"json")}else{c.save("move")}break;case"move":for(e in c.save.move){g=c.save.move[e];delete c.save.move[e];break}if(g){g.next=(g.next==null?"":uAdmin.eip.searchRowId(g.next));for(e in c.save.added){if(g.parent_id==e){g.parent_id=c.save.added[e]}if(g.moved==e){g.moved=c.save.added[e]}if(g.next==e){g.next=c.save.added[e]}}jQuery.post("/admin/content/eip_move_page/"+g.moved+"/"+g.next+".json",{"parent-id":g.parent_id},function(l){if(l.error){uAdmin.eip.message(l.error);return}jQuery(g.node).removeClass("u-eip-modified");jQuery(g.node).parent().removeClass("u-eip-modified");jQuery("[umi\\:region=list]").filter("[umi\\:element-id="+g.parent_id+"], [umi\\:object-id="+g.parent_id+"]").filter(function(){return this!=g.parent}).each(function(){var n=jQuery(g.node).index(),o=jQuery(this).find("[umi\\:region=row][umi\\:"+g.type+"-id="+g.moved+"]"),m=jQuery(this).children().eq(n);if(o.index()>n){o.insertBefore(m)}else{if(o.index()<n){o.insertAfter(m)}}});uAdmin.eip.normalizeBoxes();if(uAdmin.eip.enabled){uAdmin.eip.highlight(g.moved)}uAdmin.eip.message(getLabel("js-panel-message-page-moved"));--c.save.count;d.text(parseInt(d.text())+1);c.save("move")},"json")}else{c.save("edit")}break;case"edit":for(e in c.save.edit){g=c.save.edit[e];delete c.save.edit[e];break}if(g){for(e in c.save.added){if(g.id==e){g.id=c.save.added[e]}}if(uAdmin.eip.editor.equals(g.new_value,g.old_value)){jQuery(g.node).removeClass("u-eip-modified");g=false;uAdmin.eip.normalizeBoxes();d.text(parseInt(d.text())+1);--c.save.count;c.save("edit")}else{k={};k[g.type+"-id"]=g.id;k.qt=new Date().getTime();k["field-name"]=g.field_name;var h,e;switch(typeof g.new_value){case"object":if(g.new_value.src){h=g.new_value.src}else{h=[];for(e in g.new_value){h.push(e)}}break;case"string":if(jQuery.browser.mozilla&&g.new_value.match(/="\.\.\//g)){g.new_value=g.new_value.replace(/="[\.\.\/]+/g,'="/')}h=g.new_value.replace(/\sumi:[-a-z]+="[^"]*"/g,"");break;default:h=g.new_value}k.value=h;jQuery.post("/admin/content/editValue/save.json",k,function(p){if(p.error){uAdmin.eip.message(p.error);return}var n=p.property["new-link"],q=p.property["old-link"];var m=jQuery(g.node).parents("[umi\\:element-id], [umi\\:object-id]").first(),s=m.is("[umi\\:object-id]")?"object":"element",r=m.attr("umi:"+s+"-id"),l=jQuery("[umi\\:"+s+"-id="+r+"]");if(!l.length){l=jQuery(g.node).parent()}if(q&&n){var o=0;l.each(function(){jQuery(this).find("[umi\\:url-attribute]").each(function(){jQuery(this).attr(jQuery(this).attr("umi:url-attribute"),n).bind("click mousedown mouseup",function(){return true});o++})});if(!o){l.find("a").each(function(t,u){jQuery(this).attr("href",n).bind("click mousedown mouseup",function(){return true})})}}jQuery("[umi\\:"+g.type+"-id='"+g.id+"']").find("[umi\\:field-name="+p.property.name+"]").add("[umi\\:"+g.type+"-id='"+g.id+"'][umi\\:field-name="+p.property.name+"]").not("[umi\\:"+g.type+"-id][umi\\:"+g.type+"-id!='"+g.id+"']").each(function(){var t=jQuery(this);if(t.is("img")){t.attr("src",p.property.value["src"])}else{t.html(g.node.innerHTML)}t.parents(".not_hidden").removeClass("not_hidden")});jQuery(g.node).removeClass("u-eip-modified");g=false;uAdmin.eip.normalizeBoxes();d.text(parseInt(d.text())+1);--c.save.count;c.save("edit")},"json")}}else{c.save("custom")}break;case"custom":for(e in c.save.custom){g=c.save.custom[e];delete c.save.custom[e];break}if(g){if(g.target&&g.target.save&&typeof g.target.save=="function"){g.target.save()}d.text(parseInt(d.text())+1);--c.save.count;c.save("custom")}else{c.save("del")}break;case"del":for(e in c.save.del){g=c.save.del[e];delete c.save.del[e];break}if(g){for(e in c.save.added){if(g.id==e){g.id=c.save.added[e]}}k={};k[g.type+"-id"]=g.id;k.qt=new Date().getTime();jQuery.post("/admin/content/eip_del_page.json",k,function(m){if(m.error){uAdmin.eip.message(m.error)}else{var l=uAdmin.eip.searchRow(g.node,true);if(l&&jQuery(l).attr("umi:region")!="list"){jQuery(l).remove()}else{jQuery(g.node).remove()}jQuery("[umi\\:element-id="+g.id+"], [umi\\:object-id="+g.id+"]").remove();uAdmin.eip.normalizeBoxes();g=false;uAdmin.eip.normalizeBoxes();d.text(parseInt(d.text())+1);--c.save.count;c.save("del")}},"json")}else{c.save.add={};c.save.added={};c.save.move={};c.save.edit={};c.save.del={};c.save.custom={};c.setSaveStatus(false);uAdmin.eip.message(getLabel("js-panel-message-changes-saved"));jQuery("input:button",c.progress).removeClass("hidden");uAdmin.eip.onSave("after")}break;default:uAdmin.eip.onSave("before");while(0<=this.current){if(c[0].add){c.save.add[c[0].id]=c[0];++c.save.count}else{if(this[0].move){if(c.save.move[c[0].moved]){delete c.save.move[c[0].moved];--c.save.count}c.save.move[c[0].moved]=c[0];++c.save.count}else{if(this[0]["delete"]){c.save.del[c[0].id]=c[0];++c.save.count}else{if(this[0]["custom"]){c.save.custom[c[0].id]=c[0];++c.save.count}else{if(c.save.edit[c[0].id+"_"+c[0].field_name]){c.save.edit[c[0].id+"_"+c[0].field_name].new_value=c[0].new_value}else{c.save.edit[c[0].id+"_"+c[0].field_name]=c[0];++c.save.count}}}}}c.shift();--c.current}c.progress=jQuery.openPopupLayer({name:"SaveProgress",width:400,height:200,data:'\n						<div class="eip_win_head popupHeader">\n							<div class="eip_win_close popupClose hidden">&#160;</div>\n							<div class="eip_win_title">'+getLabel("js-cms-eip-edit_in_place-save_processing")+'</div>\n						</div>\n						<div class="eip_win_body popupBody">\n							<div class="popupText">'+getLabel("js-cms-eip-edit_in_place-saved_count_modify",c.save.count)+'</div>\n							<div class="eip_buttons">\n								<input type="button" class="primary ok hidden" value="OK" />\n								<div style="clear: both;" />\n							</div>\n						</div>\n					'}).find("#popupLayer_SaveProgress");jQuery("input:button",c.progress).click(function(){jQuery.closePopupLayer("SaveProgress")});c.save("add")}return false};a.prototype.queue.save.add={};a.prototype.queue.save.added={};a.prototype.queue.save.move={};a.prototype.queue.save.edit={};a.prototype.queue.save.del={};a.prototype.queue.save.custom={};a.prototype.queue.save.count=0;a.prototype.queue.current=-1;a.prototype.enabled=false;a.prototype.previousEditBox=null;a.prototype.editNodes=[];a.prototype.listNodes=[];a.prototype.meta={};return b(a,this)});uAdmin(".ieditor",function(s){var t={backend_request_url:"/udata://content/ieditor/",backend_request_method:"POST",image_data_url:"/admin/content/getImageData.json",image_data_request_method:"POST",coockie_name:"eip_ieditor_state",preloader_src:"/images/cms/eip/loader.gif",preloader_holder_css_class:"eip-ieditor-preloader",collection:{editor_id_attribute:"data-ieditor-id"},editor:{menu_wrapper_css_class:"eip-ieditor-menu-wrapper",img_wrapper_css_class:"eip-ieditor-img-wrapper",animation_speed:100},layout:{extended:{css_class:"eip-ieditor-layout-extended",right_margin:"5px",bottom_margin:"5px"},simple:{css_class:"eip-ieditor-layout-simple",right_margin:"5px",bottom_margin:"5px"},bubble:{css_class:"eip-ieditor-layout-bubble",arrow_css_class:"eip-ieditor-layout-bubble-arrow",bottom_margin:-50,bottom_margin_delta:0},big_img_min_width:300,big_img_min_height:350,small_img_max_width:150,small_img_max_height:150},module:{module_css_class:"eip-ieditor-module",icon_holder_css_class:"eip-ieditor-module-icon",title_holder_css_class:"eip-ieditor-module-title",upload_module:{url:"/udata/content/ieditor/upload.json",iframe_name:"eip-ieditor-upload-iframe",file_input_name:"eip-ieditor-upload-fileinput[]",css_class:"eip-ieditor-module-upload"},filemanager_module:{css_class:"eip-ieditor-module-filemanager"},edit_module:{css_class:"eip-ieditor-module-edit"},crop_module:{css_class:"eip-ieditor-module-crop"},resize_module:{css_class:"eip-ieditor-module-resize"},rotate_module:{css_class:"eip-ieditor-module-rotate"},popup_module:{css_class:"eip-ieditor-module-popup",fancybox_css_class:"fancybox-group",wrapper_css_class:"eip-ieditor-module-popup-wrapper",thumb_width:100},delete_module:{css_class:"eip-ieditor-module-delete"},apply_module:{css_class:"eip-ieditor-module-apply"},cancel_module:{css_class:"eip-ieditor-module-cancel"}},img_area_select:{css_class:"eip-ieditor-imgareaselect-wrapper",plugin_options:{parent:null,hide:true,handles:true,instance:true,keys:true,movable:true,persistent:true,resizeMargin:10,zIndex:100001}},filemanager:{url:"/styles/common/other/elfinder/umifilebrowser.html?lang=ru",window_width:660,window_height:530},browser_modules:{msie:[v,p,r,b,d,h,n,a],mozilla:[v,p,j,r,b,c,x,d,h,n,a],opera:[v,p,j,r,b,c,x,d,h,n,a],webkit:[v,p,j,r,b,c,x,d,h,n,a]}};uAdmin.inherit=function(A,z){var B=function(){};B.prototype=z.prototype;A.prototype=new B();A.prototype.constructor=A;A.superclass=z.prototype};var g=function(){if(!uAdmin||!uAdmin.eip){throw"Edit-in-place is not initialized"}this.COOKIE_NAME=t.coockie_name;this.COOKIE_ENABLED_VALUE="enabled";this.COOKIE_DISABLED_VALUE="disabled";this.jqToggleButton=null;this.bEnabled=true;this.skipDeactivateClick=false;var z=this;uAdmin.eip.bind("Enable",function(A){if(A=="after"){z.addPanelButton()}});uAdmin.eip.bind("Disable",function(A){if(A=="after"){z.removePanelButton();z.disable()}});uAdmin.eip.bind("ActiveEditorCommit",function(A){if(A=="before"&&uAdmin.eip.editor.info.field_type=="wysiwyg"&&uAdmin.eip.editor.info.old_value&&uAdmin.eip.editor.info.new_value){uAdmin.eip.editor.info.old_value=uAdmin.eip.editor.info.old_value.replace(/\sdata-ieditor-id=["']{1}[0-9\._]+["']{1}/gi,"");uAdmin.eip.editor.info.new_value=uAdmin.eip.editor.info.new_value.replace(/\sdata-ieditor-id=["']{1}[0-9\._]+["']{1}/gi,"");uAdmin.eip.editor.info.old_value=uAdmin.eip.editor.info.old_value.replace(/(src=".*)\?[0-9]+/gi,"$1");uAdmin.eip.editor.info.new_value=uAdmin.eip.editor.info.new_value.replace(/(src=".*)\?[0-9]+/gi,"$1")}else{uAdmin.eip.normalizeBoxes()}});uAdmin.eip.bind("AddPhotoToAlbum",function(D,B){if(D=="after"&&B&&B.newNode&&B.newNode.length){var C=y.getInstance().EDITOR_ID_ATTRIBUTE;B.newNode.find("img["+C+"]").addBack().removeAttr(C);if(!uAdmin.ieditor.isEnabled()){return}var E=B.newNode.find("img")[0],A=jQuery(E),F=y.getInstance().initEditor(E);if(F instanceof o){A.on("load",function(){F.init(A,A.attr(C));F.setEditMode()})}}});uAdmin.onLoad("wysiwyg",function(){tinymce.on("AddEditor",function(A){A.editor.on("SetAttrib",function(C){jQuery(C.attrElm).on("load",function(D){if(!uAdmin.ieditor.isEnabled()){return}var E=y.getInstance().initEditor(this);if(E.getEditState()){return}E.destroy(true);E.setEditState(true);E.init(jQuery(this),jQuery(this).attr(y.getInstance().EDITOR_ID_ATTRIBUTE));window.setTimeout(function(){tinymce.activeEditor.selection.collapse()},0)})});A.editor.on("init",function(C){var D=this.dom.select("img:not(.mce-object)");if(uAdmin.ieditor.isEnabled()&&D&&D.length){uAdmin.ieditor.enable(D)}});var B=A.editor.windowManager.open;A.editor.windowManager.open=function(){uAdmin.ieditor.disable();var D=B.apply(this,arguments);D.on("close",function C(){setTimeout(function(){uAdmin.ieditor.enable()},500)});return D}})});jQuery("body").on("click",function(B){if((jQuery(B.target).closest("."+t.collection.editor_id_attribute+", ."+t.img_area_select.css_class).length)||(jQuery(B.target).is(".mce-resizehandle, img"))){return}var C=y.getInstance().getActiveEditor();if((C instanceof o===false)||(uAdmin.ieditor.skipDeactivateClick)){return}var A=C.getEnabledModule();A.cancel();A.deactivate();C.setEditState(false);C.hide();C.switchOn();C.redrawMenu();C.drawDeleteButton()});if(uAdmin.eip.enabled){this.addPanelButton()}};g.prototype.isEnabled=function(){return this.bEnabled};g.prototype.getNodes=g.getNodes=function(z){jqNodes=jQuery("img[umi\\:field-name], .mceEditor img, [umi\\:field-type='wysiwyg'] img, img[umi\\:slider-id]");return z?jqNodes:jqNodes.toArray()};g.prototype.enable=function(C){if(!uAdmin.eip.enabled){return}if(!C){C=this.getNodes()}var z=y.getInstance(),B=z.getActiveEditor();for(var A=0;A<C.length;A++){if(z.getEditorByNode(C[A])){if(!B||B.jqImgNode[0]!==C[A]){z.getEditorByNode(C[A]).destroy();z.initEditor(C[A])}}else{z.initEditor(C[A])}}this.removeEipDeleteButtons();this.bEnabled=true;this.jqToggleButton.addClass("act")};g.prototype.disable=function(){if(!this.isEnabled()){return}var z=y.getInstance().getActiveEditor();if(z instanceof o){z.getEnabledModule()&&z.getEnabledModule().cancel()}y.getInstance().removeAllEditors();y.getInstance().turnOffEditMode();this.addEipDeleteButtons();this.bEnabled=false;this.jqToggleButton.removeClass("act")};g.prototype.reinit=function(){y.getInstance().reinitActiveEditors()};g.prototype.setSettings=function(A){var z=function(C,D){for(var B in C){if(!C.hasOwnProperty(B)||!D.hasOwnProperty(B)){continue}if(typeof C[B]==="object"&&C[B] instanceof Object){z(C[B],D[B])}else{D[B]=C[B]}}};z(A,t);y.getInstance().reinitActiveEditors()};g.prototype.getEditorsCollection=function(){return y.getInstance()};g.prototype.removeEipDeleteButtons=function(){this.jqEipDeleteButtonsNodes=this.getNodes(true);if(!this.jqEipDeleteButtonsNodes.length){return}var z=this.jqEipDeleteButtonsNodes.parents("[umi\\:delete]").filter(function(A,B){return !!jQuery(this).parents("[umi\\:module='photoalbum']").length});this.jqEipDeleteButtonsNodes=this.jqEipDeleteButtonsNodes.filter("[umi\\:delete]").add(z);this.jqEipDeleteButtonsNodes.removeAttr("umi:delete");uAdmin.eip.dropDeleteButtons()};g.prototype.addEipDeleteButtons=function(){if(!this.jqEipDeleteButtonsNodes||!this.jqEipDeleteButtonsNodes.length){return}this.jqEipDeleteButtonsNodes.attr("umi:delete","delete");uAdmin.eip.dropDeleteButtons()};g.prototype.addPanelButton=function(){var z=this;this.jqToggleButton=jQuery("<div/>");this.jqToggleButton.attr("id","ieditor-switcher").text(getLabel("js-ieditor-switcher")).appendTo(uAdmin.panel.quickpanel).on("click",function(){if(z.isEnabled()){z.disable()}else{z.enable()}z.saveStateToCockie()});jQuery('<span class="in_ico_bg">').prependTo(this.jqToggleButton);this.applyStateFromCookie()};g.prototype.removePanelButton=function(){this.jqToggleButton&&this.jqToggleButton.length&&this.jqToggleButton.remove()};g.prototype.applyStateFromCookie=function(){if(!jQuery.cookie){return}if(jQuery.cookie(this.COOKIE_NAME)==this.COOKIE_ENABLED_VALUE){this.enable()}else{if(jQuery.cookie(this.COOKIE_NAME)==this.COOKIE_DISABLED_VALUE){this.disable()}else{this.enable()}}};g.prototype.saveStateToCockie=function(){if(!jQuery.cookie){return}var A=this.isEnabled()?this.COOKIE_ENABLED_VALUE:this.COOKIE_DISABLED_VALUE,z=new Date();z.setTime(z.getTime()+(3*24*60*60*1000));jQuery.cookie(this.COOKIE_NAME,A,{path:"/",expires:z})};var e=function(){this.oEventHandlers={}};e.prototype.bindEvent=function(z,A){if(typeof A!="function"){return false}if(!this.oEventHandlers[z]){this.oEventHandlers[z]=[]}this.oEventHandlers[z].push({context:this,handler:A});return true};e.prototype.triggerEvent=function(C,z){var B=this._getHandlersForObjectEvent(C,this);if(!B||!B.length){return false}for(var A=0;A<B.length;A++){B[A].apply(this,z)}return true};e.prototype._getHandlersForObjectEvent=function(D,B){var z=this.oEventHandlers[D];if(!z){return[]}var C=[];for(var A in z){if(z.hasOwnProperty(A)&&z[A].context===B&&typeof z[A].handler=="function"){C.push(z[A].handler)}}return C};var y=function(){this.settings=t;this.EDITOR_ID_ATTRIBUTE=t.collection.editor_id_attribute;this.BIG_IMG_MIN_WIDTH=t.collection.big_img_min_width;this.BIG_IMG_MIN_HEIGHT=t.collection.big_img_min_height;this.SMALL_IMG_MAX_WIDTH=t.collection.small_img_max_width;this.SMALL_IMG_MAX_HEIGHT=t.collection.small_img_max_height;this._arEditors={};this.oActiveEditor=null;this.bEditMode=false;jQuery("body").on("mouseenter","img",function(B){if(!uAdmin.eip.enabled||!uAdmin.ieditor.isEnabled()){return false}if(y.getInstance().isInEditState()){return false}var z=jQuery(this),A=y.getInstance().EDITOR_ID_ATTRIBUTE;if(!z.attr(A)){return false}var C=y.getInstance().initEditor(this);C.init(z,z.attr(A));C.show();window.setTimeout(function(){if(!C.isImageInFocus()){C.hide(function(){C.destroy(true)})}},100);return true}).on("mousemove",function(z){window.mouseX=z.pageX||z.clientX+jQuery(document).scrollLeft();window.mouseY=z.pageY||z.clientY+jQuery(document).scrollTop()})};y._instance=null;y.getInstance=function(){if(!y._instance){y._instance=new y()}return y._instance};y.cleanupHtml=function(z){return new o.cleanupHtml(z)};y.prototype.initEditor=function(B){if(y.getInstance().isInEditState()){return new u()}if(this.getEditorByNode(B)){return this.getEditorByNode(B)}var z=jQuery(B),A=this.getUniqueId();z.attr(this.EDITOR_ID_ATTRIBUTE,A);var C=new f();this._arEditors[A]=C;return C};y.prototype.reinitActiveEditors=function(){var A=[];for(var z in this._arEditors){if(!this._arEditors.hasOwnProperty(z)||this._arEditors[z] instanceof o===false){continue}A.push(this._arEditors[z].jqImgNode[0])}this.removeAllEditors();for(z=0;z<A.length;z++){this.initEditor(A[z])}};y.prototype.updateEditorsByNodes=function(z){jQuery("img",z).filter(function(){return !!jQuery(this).attr(y.getInstance().EDITOR_ID_ATTRIBUTE)}).each(function(A,B){var C=y.getInstance().initEditor(B);C.reinit()})};y.prototype.repositionActiveEditors=function(){for(var z in this._arEditors){if(!this._arEditors.hasOwnProperty(z)||this._arEditors[z] instanceof o===false){continue}if(!this._arEditors[z].jqImgNode||!this._arEditors[z].jqImgNode.length||!this._arEditors[z].jqImgNode.is(":visible")){this._arEditors[z].destroy();continue}this._arEditors[z].reinit()}};y.prototype.getEditorByNode=function(z){return this._arEditors[jQuery(z).attr(this.EDITOR_ID_ATTRIBUTE)]};y.prototype.getEditorByEditorId=function(z){return this._arEditors[z]};y.prototype.getAllEditors=function(){return this._arEditors};y.prototype.findEditors=function(C){var z=jQuery("img["+this.EDITOR_ID_ATTRIBUTE+"]",C),B=[],A=this;z.each(function(D,E){B.push(A.getEditorByNode(E))});return B};y.prototype.removeAllEditors=function(){for(var z in this._arEditors){if(!this._arEditors.hasOwnProperty(z)){continue}this.removeEditor(z)}this.oActiveEditor=null;this._arEditors={}};y.prototype.removeEditor=function(z){this._arEditors[z].destroy();delete this._arEditors[z]};y.prototype.removeEmptyEditors=function(){var z=this.getAllEditors();for(var A in z){if(!z.hasOwnProperty(A)){continue}var B=z[A];if(B instanceof o===false){continue}if(!B.getEditorId()){continue}if(!B.jqImgNode||!B.jqImgNode.length||!B.jqImgNode.is(":visible")){this.removeEditor(B.getEditorId())}}};y.prototype.getUniqueId=function(){var z="";do{z=new Date().getTime()+"_"+Math.random()}while(z in this._arEditors);return z};y.prototype.setActiveEditor=function(z){if(this.oActiveEditor&&this.oActiveEditor.deactivateEnabledModule){if(this.oActiveEditor.deactivateEnabledModule(true)){this.oActiveEditor=z;return true}else{return false}}else{this.oActiveEditor=z;return true}};y.prototype.getActiveEditor=function(){return this.oActiveEditor};y.prototype.deactivateActiveEditor=function(){return this.setActiveEditor(null)};y.prototype.turnOnEditMode=function(){this.bEditMode=true};y.prototype.turnOffEditMode=function(){this.bEditMode=false};y.prototype.isInEditState=function(){return this.bEditMode};y.prototype.each=function(B){if(typeof B!="function"){return}for(var z=0;z<this._arEditors;z++){var A=this._arEditors[z];if(A instanceof o===false){continue}B.call(A,z,A)}};var m=function(z){m.superclass.constructor.call(this);this.CSS_CLASS_NAME="";this.ANIMATIONS_SPEED=t.editor.animation_speed;this.oEditor=z};uAdmin.inherit(m,e);m.prototype.init=function(){this.oEditor.jqMenuWrapper.addClass(this.CSS_CLASS_NAME);this.reposition()};m.prototype.remove=function(){this.oEditor.jqMenuWrapper.removeClass(this.CSS_CLASS_NAME);this.resetPosition();this.oEditor.layout=null};m.prototype.reposition=function(){};m.prototype.resetPosition=function(){var z=this.oEditor.jqMenuWrapper[0];z.style.top="";z.style.bottom="";z.style.left="";z.style.right=""};m.prototype.show=function(){var z=this;this.oEditor.jqMenuWrapper.stop(true,true).fadeIn(this.ANIMATIONS_SPEED,function(){z.oEditor.triggerEvent("onShow")})};m.prototype.hide=function(A){var z=this;this.oEditor.jqMenuWrapper.add().stop(true,true).fadeOut(this.ANIMATIONS_SPEED,function(){if(typeof A=="function"){A()}z.oEditor.triggerEvent("onHide")})};var k=function(z){k.superclass.constructor.call(this,z);this.CSS_CLASS_NAME=t.layout.extended.css_class;this.init()};uAdmin.inherit(k,m);k.prototype.reposition=function(){this.oEditor.jqMenuWrapper.css({right:t.layout.extended.right_margin,bottom:t.layout.extended.bottom_margin})};var w=function(z){w.superclass.constructor.call(this,z);this.CSS_CLASS_NAME=t.layout.simple.css_class;this.init()};uAdmin.inherit(w,m);w.prototype.reposition=function(){this.oEditor.jqMenuWrapper.css({right:t.layout.simple.right_margin,bottom:t.layout.simple.bottom_margin})};var q=function(z){q.superclass.constructor.call(this,z);this.CSS_CLASS_NAME=t.layout.bubble.css_class;this.BUBBLE_ARROW_CSS_CLASS=t.layout.bubble.arrow_css_class;this.init()};uAdmin.inherit(q,m);q.prototype.init=function(){q.superclass.init.call(this);this.oEditor.jqMenuWrapper.prepend("<div class='"+this.BUBBLE_ARROW_CSS_CLASS+"'/>")};q.prototype.remove=function(){this.oEditor.jqMenuWrapper.find("."+this.BUBBLE_ARROW_CSS_CLASS).remove();q.superclass.remove.call(this)};q.prototype.reposition=function(){var z=this.oEditor.jqMenuWrapper.clone().css("left",-10000).appendTo("body").show();var A=(this.oEditor.jqImgWrapper.outerWidth()-z.outerWidth())/2;z.remove();this.oEditor.jqMenuWrapper.css({left:A+"px",bottom:t.layout.bubble.bottom_margin-t.layout.bubble.bottom_margin_delta+"px"})};q.prototype.show=function(){var z=this;this.oEditor.jqMenuWrapper.stop(true,true).fadeIn(this.ANIMATIONS_SPEED).animate({bottom:t.layout.bubble.bottom_margin+"px"},this.ANIMATIONS_SPEED,function(){z.oEditor.triggerEvent("onShow")})};q.prototype.hide=function(A){var z=this;this.oEditor.jqMenuWrapper.stop(true,true).animate({bottom:t.layout.bubble.bottom_margin-t.layout.bubble.bottom_margin_delta+"px"},this.ANIMATIONS_SPEED).fadeOut(this.ANIMATIONS_SPEED,function(){if(typeof A=="function"){A()}z.oEditor.triggerEvent("onHide")})};var o=function(){o.superclass.constructor.call(this);this.MENU_WRAPPER_CLASS_NAME=t.editor.menu_wrapper_css_class;this.IMG_WRAPPER_CLASS_NAME=t.editor.img_wrapper_css_class;this.ANIMATIONS_SPEED=t.editor.animation_speed;this.IMAGE_TYPE_UNKNOWN=0;this.IMAGE_TYPE_EIP=1;this.IMAGE_TYPE_WYSIWYG=2;this.IMAGE_TYPE_PHOTOALBUM=3;this.IMAGE_TYPE_SLIDER=4;this._imageUrl="";this.sEditorId="";this.layout="";this.jqImgNode=null;this.jqMenuWrapper=null;this.jqDeleteButton=null;this.jqCloseButton=null;this.jqImgWrapper=null;this.jqPreloader=null;this.iImageType=this.IMAGE_TYPE_UNKNOWN;this.bEditStateEnabled=false;this.arModulesSet=[];this.arDefaultModules=[r,j,v,p];this.arActiveModules=[];this.oEnabledModule=null;this.oEventHandlers={}};uAdmin.inherit(o,e);o.prototype.init=function(z,B){var A=this;if(!z){if(this.jqImgNode&&this.jqImgNode.length){z=this.jqImgNode}else{return false}}if(!B&&z&&z.length){B=z.attr(y.getInstance().EDITOR_ID_ATTRIBUTE)}this.sEditorId=B||z.attr(y.getInstance().EDITOR_ID_ATTRIBUTE);if(z.parents(".mceEditor").length||z.parents("[umi\\:field-type='wysiwyg']").length||z.parents(".mce-content-body").length){this.iImageType=this.IMAGE_TYPE_WYSIWYG}else{if(z.parents("[umi\\:module='photoalbum']").length){this.iImageType=this.IMAGE_TYPE_PHOTOALBUM}else{if(z.is("[umi\\:field-name]")){this.iImageType=this.IMAGE_TYPE_EIP}else{if(z.is("[umi\\:slider-id]")){this.iImageType=this.IMAGE_TYPE_SLIDER}}}}this.jqImgNode=z;this.jqImgWrapper=jQuery("<div/>").addClass(this.IMG_WRAPPER_CLASS_NAME);this.hideTimer=null;this.jqImgWrapper.attr(y.getInstance().EDITOR_ID_ATTRIBUTE,this.sEditorId).on("click",function(C){if(jQuery(C.target).parents("."+A.MENU_WRAPPER_CLASS_NAME).length){return false}A.jqImgNode.trigger("click");return false}).on("contextmenu",function(C){if(!tinymce||!tinymce.activeEditor){return true}C.preventDefault();C.target=A.jqImgNode[0];C.originalEvent.target=A.jqImgNode[0];C.currentTarget=A.jqImgNode[0];C.delegateTarget=A.jqImgNode[0];tinymce.activeEditor.selection.select(A.jqImgNode[0]);tinymce.activeEditor.dom.fire(A.jqImgNode[0],"contextmenu",C);return false}).appendTo("body");this.applyImageSizes();this.drawMenu();this.switchOn();if(this.getEditState()===true){this.setEditMode()}this.jqImgNode.on("mousemove mouseover mouseout mouseenter mouseleave",function(C){C.stopPropagation();C.stopImmediatePropagation();C.preventDefault();return false});this.triggerEvent("onInit")};o.prototype.reinit=function(){var z=y.getInstance().EDITOR_ID_ATTRIBUTE;this.jqImgNode=jQuery("img["+z+"='"+this.sEditorId+"']");this.jqImgWrapper=jQuery("."+this.IMG_WRAPPER_CLASS_NAME).filter("["+z+"='"+this.sEditorId+"']").first();if(!this.jqImgWrapper.length){return}this.jqMenuWrapper=this.jqImgWrapper.find("."+this.MENU_WRAPPER_CLASS_NAME).first();if(!this.jqImgNode.length){return}this.applyImageSizes();this.layout.reposition();this.jqImgWrapper.offset(this.jqImgNode.offset())};o.prototype.initLayout=function(){if(this.layout instanceof m){this.layout.remove()}var A=this.jqImgNode.width(),z=this.jqImgNode.height();if(A>=t.layout.big_img_min_width&&z>=t.layout.big_img_min_height){this.layout=new k(this)}else{if(A<=t.layout.small_img_max_width||z<=t.layout.small_img_max_height){this.layout=new q(this)}else{this.layout=new w(this)}}};o.prototype.drawMenu=function(z){this.jqMenuWrapper=jQuery("<div/>").addClass(this.MENU_WRAPPER_CLASS_NAME);this.initLayout();this.drawModules(z);if(!this.isStub()||this.iImageType===this.IMAGE_TYPE_PHOTOALBUM){this.drawDeleteButton()}this.reposition();this.jqMenuWrapper.appendTo(this.jqImgWrapper)};o.prototype.applyImageBoxSizes=function(A){if(!A||!A.length){A=this.jqImgNode}var z=this,B=function(C){return A.css(C)};this.jqImgWrapper.css({width:B("width"),height:B("height"),paddingTop:B("paddingTop"),paddingRight:B("paddingRight"),paddingBottom:B("paddingBottom"),paddingLeft:B("paddingLeft"),borderTop:B("borderTop"),borderRight:B("borderRight"),borderBottom:B("borderBottom"),borderLeft:B("borderLeft"),marginTop:B("marginTop"),marginRight:B("marginRight"),marginBottom:B("marginBottom"),marginLeft:B("marginLeft")})};o.prototype.applyImageSizes=function(z){if(!z||!z.length){z=this.jqImgNode}this.applyImageBoxSizes(z);this.jqImgWrapper.offset(z.offset())};o.prototype.lockImageSize=function(){this.jqImgNode.css({maxWidth:this.jqImgNode.parent().width(),maxHeight:this.jqImgNode.parent().height()})};o.prototype.redrawMenu=function(z){for(var A in this.arActiveModules){var B=this.arActiveModules[A];if(B instanceof l){B.remove()}}this.jqMenuWrapper.children().remove();this.removeCloseButton();this.drawModules(z);this.initLayout()};o.prototype.drawModules=function(z){if(this.isPopupThumb()){z=[d]}this.resetModules();if(!z){this.setDefaultModules()}else{for(var B in z){this.addModule(z[B])}}var C=this.isStub();this.arActiveModules=[];for(var B in this.arModulesSet){if(!this.arModulesSet.hasOwnProperty(B)){continue}if(C&&this.arModulesSet[B]==r){continue}if(jQuery.browser.msie&&(this.arModulesSet[B]==c||this.arModulesSet[B]==x||this.arModulesSet[B]==j)){continue}var A=new this.arModulesSet[B](this);this.arActiveModules.push(A);this.jqMenuWrapper.append(A.getView(true))}};o.prototype.drawDeleteButton=function(A){if(this.iImageType==this.IMAGE_TYPE_SLIDER){return false}if(this.jqDeleteButton&&this.jqDeleteButton.length){this.jqDeleteButton.remove()}var B=a,z=this;if(!this.checkModule(B)){return false}B=new B(this);this.jqDeleteButton=B.getView(true);this.jqDeleteButton.addClass(this.layout.CSS_CLASS_NAME);this.jqImgWrapper.append(this.jqDeleteButton);if(A){this.jqDeleteButton.show()}return true};o.prototype.removeDeleteButton=function(){if(this.iImageType==this.IMAGE_TYPE_SLIDER){return false}this.jqDeleteButton&&this.jqDeleteButton.length&&this.jqDeleteButton.remove()&&(this.jqDeleteButton=null)};o.prototype.addCloseButton=function(z){if(this.jqCloseButton&&this.jqCloseButton.length){return}this.jqCloseButton=jQuery("<span/>").html("&times;");this.jqCloseButton.css({position:"absolute",top:0,right:0,cursor:"pointer",color:"white",fontSize:"15px",lineHeight:"10px",fontWeight:"bold",padding:"3px"}).on("click",function(A){if(typeof z=="function"){z(A)}}).appendTo(this.jqMenuWrapper)};o.prototype.removeCloseButton=function(){this.jqCloseButton&&this.jqCloseButton.length&&this.jqCloseButton.remove()&&(this.jqCloseButton=null)};o.prototype.showPreloader=function(){this.jqPreloader&&this.jqPreloader.length&&this.hidePreloader();this.jqPreloader=jQuery("<div/>").addClass(t.preloader_holder_css_class).append("<img src='"+t.preloader_src+"'>").appendTo(this.jqImgWrapper);if(!this.jqImgWrapper.data("incrementedZIndex")){this.jqImgWrapper.data("incrementedZIndex",true);this.jqImgWrapper.css("zIndex",parseInt(this.jqImgWrapper.css("zIndex"))*10||999999)}this.setEditState(true);this.switchOff()};o.prototype.hidePreloader=function(){this.jqPreloader&&this.jqPreloader.length&&this.jqPreloader.remove()&&(this.jqPreloader=null);if(this.jqImgWrapper.data("incrementedZIndex")){this.jqImgWrapper.removeData();this.jqImgWrapper.css("zIndex",Math.floor(parseInt(this.jqImgWrapper.css("zIndex"))/10)||99999)}};o.prototype.reposition=function(){this.layout.reposition()};o.prototype.destroy=function(z){this.reinit();this.jqImgWrapper.remove();this.jqImgNode.off("mousemove mouseover mouseout mouseenter mouseleave");if(!z){this.jqImgNode.removeAttr(y.getInstance().EDITOR_ID_ATTRIBUTE)}this.triggerEvent("onDestroy")};o.prototype.show=function(){this.jqDeleteButton&&this.jqDeleteButton.length&&this.jqDeleteButton.show();this.layout.show()};o.prototype.hide=function(z){this.jqDeleteButton&&this.jqDeleteButton.length&&this.jqDeleteButton.hide();this.layout.hide(z)};o.prototype.switchOn=function(){var z=this;this.jqImgWrapper.css("zIndex",parseInt(this.jqImgWrapper.css("zIndex"))||99999).on("mouseenter",function(){if(z.hideTimer){clearTimeout(z.hideTimer);z.hideTimer=null}z.show();if(z.jqDeleteButton&&z.jqDeleteButton.length){z.jqDeleteButton.stop(true,true).show(z.ANIMATIONS_SPEED)}}).on("mouseleave",function(){z.hideTimer=window.setTimeout(function(){z.hideTimer=null;if(z.jqDeleteButton&&z.jqDeleteButton.length){z.jqDeleteButton.stop(true,true).hide(z.ANIMATIONS_SPEED)}z.hide(function(){z.destroy(true)})},200)})};o.prototype.switchOff=function(z){this.jqImgWrapper.off("mouseenter mouseleave");if(z){this.hide();this.jqDeleteButton.hide()}};o.prototype.checkModule=function(B){var A=B==r&&this.checkImageIsEmpty(),D=false;for(var C in t.browser_modules){if(!t.browser_modules.hasOwnProperty(C)||!jQuery.browser[C]){continue}for(var z=0;z<t.browser_modules[C].length;z++){if(t.browser_modules[C][z]===B){D=true;break}}}return typeof B==="function"&&!!B.isImageEditorModule&&!A&&D};o.prototype.addModule=function(z){if(this.checkModule(z)){this.arModulesSet.push(z);this.triggerEvent("onAddModule",[z])}};o.prototype.resetModules=function(){this.arModulesSet=[]};o.prototype.setDefaultModules=function(){this.resetModules();for(var z in this.arDefaultModules){this.addModule(this.arDefaultModules[z])}};o.prototype.isThumb=function(){return(!!this.jqImgNode.attr("src").match(/\/thumbs\//gi)||!!this.jqImgNode.attr("src").match(/\/autothumbs\//gi))};o.prototype.isPopupThumb=function(){if(typeof d=="undefined"){return false}return !!this.jqImgNode.parents("."+d.WRAPPER_CSS_CLASS).length};o.prototype.isStub=function(){var z=this.jqImgNode.attr("umi:is-stub")=="true",A=this.jqImgNode[0]&&this.jqImgNode[0].complete&&!this.jqImgNode[0].naturalWidth&&!this.jqImgNode[0].naturalHeight;return z||A};o.prototype.getImageUrl=function(){if(!this._imageUrl){if(this.iImageType===this.IMAGE_TYPE_WYSIWYG){this._imageUrl=this.jqImgNode.attr("src")}else{var B=uAdmin.eip.searchAttr(this.jqImgNode);var z=jQuery.ajax({async:false,url:"/udata/content/getImageUrl/"+B.id+"/"+B.field_name+"/.json",type:"GET"});var A=jQuery.parseJSON(z.responseText);this._imageUrl=A.result}}return this._imageUrl};o.prototype.getCurrentImageUrl=function(){return this.isThumb()?this.getImageUrl():this.jqImgNode.attr("src")};o.prototype.getEipInfo=function(z){z=z||this.jqImgNode[0];return uAdmin.eip.searchAttr(z)};o.prototype.getEipNode=function(){var z=this.getEipInfo();if(!z||!z.node){return null}return z.node};o.prototype.getEditorId=function(){return this.sEditorId};o.prototype.checkImageIsEmpty=function(){return this.jqImgNode.attr("src")==this.jqImgNode.attr("umi:empty")};o.prototype.setEnabledModule=function(z){if(!z||!z.deactivate){return false}if(!this.deactivateEnabledModule(z!=r)){return false}this.oEnabledModule=z;y.getInstance().setActiveEditor(this);return true};o.prototype.getEnabledModule=function(){return this.oEnabledModule};o.prototype.deactivateEnabledModule=function(z){if(!this.oEnabledModule||!this.oEnabledModule.deactivate){this.oEnabledModule=null;return true}if(!z){this.oEnabledModule=null;return true}this.oEnabledModule.cancel();if(this.oEnabledModule.deactivate()){this.oEnabledModule=null;return true}return false};o.prototype.cleanupHtml=function(z){return z.replace(/\sdata-ieditor-id=["']{1}[0-9\._]+["']{1}/gi,"")};o.prototype.setEditMode=function(z){if(r){var A=new r(this);A.activate(z)}};o.prototype.setEditState=function(z){z?y.getInstance().turnOnEditMode():y.getInstance().turnOffEditMode();this.bEditStateEnabled=!!z};o.prototype.getEditState=function(){return this.bEditStateEnabled};o.prototype.isImageInFocus=function(){var C=this.jqImgNode.offset().top,z=this.jqImgNode.offset().top+this.jqImgNode.height(),B=this.jqImgNode.offset().left,A=this.jqImgNode.offset().left+this.jqImgNode.width();return window.mouseX>B&&window.mouseX<A&&window.mouseY>C&&window.mouseY<z};var f=function(){f.superclass.constructor.call(this)};uAdmin.inherit(f,o);var u=function(){};u.prototype.show=function(){};u.prototype.hide=function(){};u.prototype.reposition=function(){};u.prototype.initLayout=function(){};u.prototype.init=function(){};u.prototype.reinit=function(){};u.prototype.destroy=function(){};u.prototype.switchOn=function(){};u.prototype.switchOff=function(){};u.prototype.setEditMode=function(){};u.prototype.setEditState=function(){};u.prototype.getEditState=function(){};var l=function(){l.superclass.constructor.call(this);this.MODULE_CSS_CLASS=t.module.module_css_class;this.MODULE_ICON_HOLDER_CSS_CLASS=t.module.icon_holder_css_class;this.MODULE_TITLE_HOLDER_CSS_CLASS=t.module.title_holder_css_class;this.BACKEND_REQUEST_URL=t.backend_request_url;this.BACKEND_REQUEST_METHOD=t.backend_request_method;this.title="";this.cssClass="";this.jqElement=null;this.oEditor=null};uAdmin.inherit(l,e);l.prototype.init=function(z){this.oEditor=z;this.jqElement=jQuery("<div/>");this.jqElement.addClass(this.cssClass);this.jqElement.addClass(this.MODULE_CSS_CLASS);this.jqElement.append(jQuery("<span/>"));jQuery("<span/>").addClass(this.MODULE_TITLE_HOLDER_CSS_CLASS).appendTo(this.jqElement);this.setIcon(this.MODULE_ICON_HOLDER_CSS_CLASS);this.setTitle(this.title);this.bindEvents();this.triggerEvent("onInit")};l.prototype.setIcon=function(A){var z=this.jqElement.find("span").first();z.get(0).className="";z.addClass(A)};l.prototype.setTitle=function(z){if(!z){z=this.title}this.title=z;this.jqElement.find("span").first().attr("title",z);this.jqElement.find("span").last().text(z)};l.prototype.bindEvents=function(){var z=this;this.jqElement.on("click",function(A){A.stopPropagation();A.stopImmediatePropagation();A.preventDefault();z.activate();return false})};l.prototype.getView=function(z){if(z===true){return this.jqElement}return this.jqElement[0].outerHTML};l.prototype.activate=function(){var z=this;y.getInstance().deactivateActiveEditor();this.oEditor.setEnabledModule(this);this.triggerEvent("onActivate")};l.prototype.deactivate=function(){this.triggerEvent("onDeactivate");return true};l.prototype.save=function(){this.triggerEvent("onSave")};l.prototype.cancel=function(){this.triggerEvent("onCancel")};l.prototype.remove=function(){this.jqElement.remove();this.triggerEvent("onRemove")};l.prototype.process=function(z,A){if(!z){return{result:false,error:getLabel("js-ieditor-invalid-action")}}this.oEditor.showPreloader();if(!A){A={}}A.image_url=this.oEditor.jqImgNode.attr("src");A.empty_url=this.oEditor.jqImgNode.attr("umi:empty");A.action=z;var D=uAdmin.eip.searchAttr(this.oEditor.jqImgNode[0]);if(D){A.element_id=D.id;A.field_name=D.field_name}var B=jQuery.ajax({async:false,url:this.BACKEND_REQUEST_URL+z+"/.json",type:this.BACKEND_REQUEST_METHOD,data:A});var C=jQuery.parseJSON(B.responseText);this.processResult(C);return C};l.prototype.processResult=function(z){if(!z){uAdmin.eip.message(getLabel("js-ieditor-request-failed"));this.oEditor.hidePreloader()}else{if(z.error&&typeof z.error=="string"){uAdmin.eip.message(z.error);this.oEditor.hidePreloader()}else{if(z.error&&z.error.message){uAdmin.eip.message(z.error.message);this.oEditor.hidePreloader()}else{if(z.result&&z.result.length){this.setNewImage(z.result)}else{uAdmin.eip.message(getLabel("js-ieditor-request-failed"));this.oEditor.hidePreloader()}}}}};l.prototype.addToEipQueue=function(C,B,z){var A=this.oEditor.getEipInfo(z);if(!A||!A.node){return false}if(this.oEditor.iImageType==this.oEditor.IMAGE_TYPE_WYSIWYG){A.old_value=B||A.node.innerHTML;A.new_value=C||A.node.innerHTML.replace(this.oEditor.jqImgNode.attr("src"),C);A.field_type="wysiwyg"}else{A.old_value={src:B||this.oEditor.getCurrentImageUrl()};A.new_value={src:C};A.field_type="img_file"}uAdmin.eip.queue.add(A);return true};l.prototype.getWysiwygContent=function(z){z=z||this.oEditor.getEipNode();if(!z||!z){return null}if(tinymce&&tinymce.activeEditor){return tinymce.activeEditor.getContent()}else{return z.innerHTML}};l.prototype.setNewImage=function(C,B){var z=this,A=(C||"");if(B!==false){this.oEditor.showPreloader();A+="?"+new Date().getTime()}if(this.oEditor.iImageType==this.oEditor.IMAGE_TYPE_WYSIWYG){if(d&&d.changeImage){d.changeImage(this.oEditor,!C)}if(!C){this.oEditor.jqImgNode.remove();this.oEditor.jqImgWrapper.remove()}else{this.oEditor.jqImgNode.attr("src",A);if(this.oEditor.jqImgNode.attr("data-mce-src")){this.oEditor.jqImgNode.attr("data-mce-src",A)}}}else{this.oEditor.jqImgNode.attr({src:A,"umi:is-stub":false})}this.oEditor.jqImgNode.on("load",function(){z.oEditor.hidePreloader();if(z.oEditor.jqImgNode){z.oEditor.jqImgNode.removeAttr("width").removeAttr("height").css({width:"",height:""})}z.oEditor.reinit();window.setTimeout(function(){uAdmin.eip.normalizeBoxes()},0)});this.oEditor.triggerEvent("onImageChange",{target:this,sNewSrc:C,sNewSrcNoCache:A})};l.prototype.getImageFromFilemanager=function(z){if(typeof z!="function"){return false}jQuery.openPopupLayer({name:"Filemanager",title:getLabel("js-file-manager"),width:t.filemanager.window_width,height:t.filemanager.window_height,url:t.filemanager.url,afterClose:function(A){if(A){z(A)}},success:function(){var A='<div id="watermark_wrapper"><label for="add_watermark">';A+=window.parent.getLabel("js-water-mark");A+='</label><input type="checkbox" name="add_watermark" id="add_watermark"/>';A+='<label for="remember_last_folder">';A+=window.parent.getLabel("js-remember-last-dir");A+='</label><input type="checkbox" name="remember_last_folder" id="remember_last_folder"';if(jQuery.cookie("remember_last_folder")){A+='checked="checked"'}A+="/></div>";window.parent.jQuery("#popupLayer_Filemanager .popupBody").append(A)}});return true};function j(z){j.superclass.constructor.call(this);this.UPLOAD_URL=t.module.upload_module.url;this.IFRAME_NAME=t.module.upload_module.iframe_name;this.FILE_INPUT_NAME=t.module.upload_module.file_input_name;this.title=getLabel("js-ieditor-module-upload-title");if(z.iImageType==z.IMAGE_TYPE_SLIDER){this.cssClass="eip-ieditor-empty"}else{this.cssClass=t.module.upload_module.css_class}this.jqFileInput=null;this.jqForm=null;this.jqIframe=null;this.init(z)}uAdmin.inherit(j,l);j.isImageEditorModule=true;j.prototype.init=function(A){var z=this;j.superclass.init.call(this,A);this.jqElement.css({overflow:"hidden",position:"relative"});this.jqFileInput=jQuery("<input/>").attr({type:"file",name:this.FILE_INPUT_NAME,title:this.title}).css({opacity:0,cursor:"pointer"}).on("click",function(B){B.stopPropagation();B.stopImmediatePropagation();z.activate()});this.jqForm=jQuery("<form/>").attr({method:"post",action:this.UPLOAD_URL,target:this.IFRAME_NAME,enctype:"multipart/form-data"}).css({padding:0,margin:0,border:"none",position:"absolute",top:0,right:0}).appendTo(this.jqElement).append(this.jqFileInput);this.jqForm.append('<input type="hidden" name="action" value="upload">')};j.prototype.activate=function(){j.superclass.activate.call(this);this.oEditor.switchOff();var z=this;this.jqIframe=jQuery("<iframe/>").attr({name:this.IFRAME_NAME}).css({display:"none"}).appendTo("body").on("load",function(){if(!z.bImageChanged){return}z.oEditor.hidePreloader();z.oEditor.switchOn();var B=jQuery(this).contents().find("body").text();if(!B){uAdmin.eip.message(getLabel("js-ieditor-request-failed"))}else{var A=z.oEditor.jqImgNode.attr("src");z.setNewImage(B);z.oEditor.setEditMode();z.addToEipQueue(B,A)}z.cleanup()});this.jqFileInput.on("change",function(){z.oEditor.showPreloader();z.bImageChanged=true;z.jqForm.submit()});window.setTimeout(function(){z.oEditor.switchOn();if(jQuery.browser.webkit){z.oEditor.hide()}},1000)};j.prototype.cleanup=function(){this.oEditor.switchOn();this.jqIframe.remove()};function p(z){p.superclass.constructor.call(this);this.title=getLabel("js-ieditor-module-slider-title");if(z.iImageType==z.IMAGE_TYPE_SLIDER){this.cssClass="eip-ieditor-module-slider"}else{this.cssClass="eip-ieditor-empty"}this.init(z)}uAdmin.inherit(p,l);p.isImageEditorModule=true;p.prototype.activate=function(){p.superclass.activate.call(this);var z=$(this.oEditor.jqImgNode[0]);var A={slider_id:z.attr("umi:slider-id"),token:uAdmin.csrf,prefix:uAdmin.lang_prefix};$.openPopupLayer({name:"SliderEditor",title:getLabel("js-ieditor-module-slider-popup-title"),url:"/styles/common/other/slidereditor/slideEditor.html?"+$.param(A),width:710,height:700,success:function(){$("#popupLayer_SliderEditor .popupBody").css({padding:"0"});$("#popupLayer_SliderEditor iframe.umiPopupFrame").css({width:"100%"})}})};function v(z){v.superclass.constructor.call(this);this.title=getLabel("js-ieditor-module-filemanager-title");if(z.iImageType==z.IMAGE_TYPE_SLIDER){this.cssClass="eip-ieditor-empty"}else{this.cssClass=t.module.filemanager_module.css_class}this.init(z)}uAdmin.inherit(v,l);v.isImageEditorModule=true;v.prototype.activate=function(){v.superclass.activate.call(this);this.oEditor.switchOff();var z=this;this.getImageFromFilemanager(function(B){var A=z.oEditor.jqImgNode.attr("src");z.setNewImage(B[0]);z.oEditor.setEditMode();z.addToEipQueue(B[0],A)});window.setTimeout(function(){z.oEditor.switchOn();if(jQuery.browser.webkit){z.oEditor.hide()}},500)};function r(z){r.superclass.constructor.call(this);this.title=getLabel("js-ieditor-module-edit-title");if(z.iImageType==z.IMAGE_TYPE_SLIDER){this.cssClass="eip-ieditor-empty"}else{this.cssClass=t.module.edit_module.css_class}this.arEditorModules=[x,b];this.init(z)}uAdmin.inherit(r,l);r.isImageEditorModule=true;r.prototype.activate=function(A){r.superclass.activate.call(this);var z=this;if(this.oEditor.iImageType===this.oEditor.IMAGE_TYPE_WYSIWYG){if(!tinymce.activeEditor){var C=document.body.scrollTop;this.oEditor.reinit();var B=this.oEditor.jqImgNode.attr(y.getInstance().EDITOR_ID_ATTRIBUTE),D=this.oEditor.jqImgNode.attr("src"),E=window.setInterval(function(){if(!tinymce.activeEditor||!tinymce.activeEditor.initialized){return}var G=tinymce.activeEditor.dom.select('img[src="'+D+'"]')[0],F=jQuery(G),H=y.getInstance().initEditor(G);if(H instanceof o==false){return}H.destroy(true);H.setEditState(true);H.init(F,F.attr(y.getInstance().EDITOR_ID_ATTRIBUTE));window.clearInterval(E)},500);this.oEditor.jqImgNode.click();document.body.scrollTop=C;return}this.arEditorModules.push(c);this.arEditorModules.push(d)}this.oEditor.reinit();this.oEditor.hide();this.oEditor.redrawMenu(A||this.arEditorModules);this.oEditor.removeDeleteButton();this.oEditor.addCloseButton(function(F){z.oEditor.switchOn();z.oEditor.setEditState(false);z.oEditor.removeCloseButton();z.oEditor.reinit();z.oEditor.redrawMenu();z.oEditor.drawDeleteButton(true);F.preventDefault();F.stopPropagation();F.stopImmediatePropagation();return false});window.setTimeout(function(){z.oEditor.switchOff();z.oEditor.setEditState(true);z.oEditor.show()},100)};function x(z){x.superclass.constructor.call(this);this.title=getLabel("js-ieditor-module-crop-title");this.cssClass=t.module.crop_module.css_class;this.oOriginalImageData={path:"",scale:1,top:0,left:0,width:0,height:0};this.sImgAreaSelectWrapperCssClass=t.img_area_select.css_class;this.jqImgAreaSelectWrapper=null;this.imgAreaSelect=null;this.imgAreaSelectOptions=jQuery.extend({},t.img_area_select.plugin_options,{onSelectEnd:function(){var A=uAdmin.ieditor;A.skipDeactivateClick=true;window.setTimeout(function(){A.skipDeactivateClick=false},0)}});this.imgAreaSelectOptions.parent=this.jqImgAreaSelectWrapper;this.jqOriginalImage=null;this.originalRepositionHandler=null;this.init(z)}uAdmin.inherit(x,l);x.isImageEditorModule=true;x.prototype.init=function(z){x.superclass.init.call(this);this.oEditor=z};x.prototype.activate=function(){x.superclass.activate.call(this);var z=this;if(!jQuery.imgAreaSelect){return}this.originalRepositionHandler=this.oEditor.reposition;this.oEditor.reposition=function(){z.originalRepositionHandler.call(this);this.jqMenuWrapper.css({bottom:-10-this.jqMenuWrapper.height()+"px"})};this.oEditor.hide();this.oEditor.redrawMenu([h,n]);this.oEditor.removeCloseButton();this.oEditor.switchOff();this.oEditor.reposition();this.oEditor.show();this.oEditor.showPreloader();this.initOriginalImageData();this.drawOriginalImage()};x.prototype.save=function(){if(!this.imgAreaSelect){return}x.superclass.deactivate.call(this);var z=this.imgAreaSelect.getSelection();z.scale=this.oOriginalImageData.scale;z.displayWidth=this.oOriginalImageData.displayWidth;z.displayHeight=this.oOriginalImageData.displayHeight;this.oEditor.jqImgNode[0].style.width="";this.oEditor.jqImgNode[0].style.height="";this.oEditor.jqImgNode.removeAttr("data-mce-style width height");this.process("crop",z);this.cleanup()};x.prototype.cancel=function(){x.superclass.deactivate.call(this);this.cleanup()};x.prototype.cleanup=function(){this.oEditor.reposition=this.originalRepositionHandler;this.removeSelection();this.jqImgAreaSelectWrapper.remove();this.oEditor.initLayout();this.oEditor.reinit();this.oEditor.switchOn();this.oEditor.switchOff();var z=this;window.setTimeout(function(){if(z.oEditor.getEnabledModule() instanceof r===false){var A=new r(z.oEditor);A.activate()}},0)};x.prototype.initOriginalImageData=function(){if(this.oOriginalImageData&&this.oOriginalImageData.path&&this.oOriginalImageData.path!=""){return this.oOriginalImageData}var B=this.oEditor.getEipInfo();B.image_url=this.oEditor.jqImgNode.attr("src");delete B.node;var z=jQuery.ajax({async:false,url:t.image_data_url,type:t.image_data_request_method,data:B});var A=jQuery.parseJSON(z.responseText);if(A.path&&A.path!=""){delete A.method;delete A.module;this.oOriginalImageData=A;return this.oOriginalImageData}return false};x.prototype.drawOriginalImage=function(){var z=this;this.jqImgAreaSelectWrapper=jQuery("<div/>").addClass(this.sImgAreaSelectWrapperCssClass).css({display:"none",position:"absolute",top:this.oEditor.jqImgNode.css("paddingTop")||0,left:this.oEditor.jqImgNode.css("paddingLeft")||0,zIndex:100000}).offset(this.oEditor.jqImgNode.offset()).appendTo("body");this.jqOriginalImage=jQuery("<img/>").attr({src:this.oOriginalImageData.path+"?"+new Date().getMilliseconds()}).css({width:this.oOriginalImageData.naturalWidth||"",height:this.oOriginalImageData.naturalHeight||""}).appendTo(this.jqImgAreaSelectWrapper).one("load",function(){z.jqImgAreaSelectWrapper.show();z.repositionOriginalImage();z.setSelection();z.imgAreaSelect.show();z.repositionMenu();z.oEditor.hidePreloader()});this.imgAreaSelectOptions.parent=this.jqImgAreaSelectWrapper};x.prototype.repositionOriginalImage=function(){var D=0,A=0,C=0,B=0,z=1;D=this.oOriginalImageData.naturalWidth;C=this.oOriginalImageData.naturalHeight;if(this.oOriginalImageData.width){z=this.oEditor.jqImgNode.width()/this.oOriginalImageData.width}else{z=this.oEditor.jqImgNode.width()/D}this.oOriginalImageData.scale=z;A=D*z;B=C*z;this.jqOriginalImage.css({width:A,maxWidth:A,height:B,maxHeight:B});this.jqImgAreaSelectWrapper.width(A).height(B).offset({left:parseInt(this.oEditor.jqImgNode.css("paddingLeft"))+this.oEditor.jqImgNode.offset().left-(this.oOriginalImageData.left*z||0),top:parseInt(this.oEditor.jqImgNode.css("paddingTop"))+this.oEditor.jqImgNode.offset().top-(this.oOriginalImageData.top*z||0)});this.oOriginalImageData.displayWidth=this.jqOriginalImage.width();this.oOriginalImageData.displayHeight=this.jqOriginalImage.height()};x.prototype.repositionMenu=function(){if(this.jqOriginalImage.outerHeight(true)<=this.oEditor.jqImgNode.outerHeight(true)){return}this.oEditor.applyImageSizes(this.jqOriginalImage);this.oEditor.reposition()};x.prototype.setSelection=function(){this.imgAreaSelect=jQuery(this.jqOriginalImage).imgAreaSelect(this.imgAreaSelectOptions);var A=this.oOriginalImageData.left*this.oOriginalImageData.scale||0,C=this.oOriginalImageData.top*this.oOriginalImageData.scale||0,z=A+(this.oOriginalImageData.width*this.oOriginalImageData.scale||this.oEditor.jqImgNode.width()||0),B=C+(this.oOriginalImageData.height*this.oOriginalImageData.scale||this.oEditor.jqImgNode.height()||0);this.imgAreaSelect.setSelection(A,C,z,B);this.imgAreaSelect.setMode("crop")};x.prototype.removeSelection=function(){this.jqOriginalImage.imgAreaSelect({remove:true});this.imgAreaSelect=null};function c(z){c.superclass.constructor.call(this);this.title=getLabel("js-ieditor-module-resize-title");this.cssClass=t.module.resize_module.css_class;this.imgAreaSelect=null;this.imgAreaSelectOptions=jQuery.extend({},t.img_area_select.plugin_options);this.imgAreaSelectOptions.movable=false;this.imgAreaSelectOptions.parent="body";this.oInitialSize={width:0,height:0};this.init(z)}uAdmin.inherit(c,l);c.isImageEditorModule=true;c.prototype.init=function(z){c.superclass.init.call(this);this.oEditor=z;this.imgAreaSelectOptions.aspectRatio=this.oEditor.jqImgNode.width()+":"+this.oEditor.jqImgNode.height()};c.prototype.activate=function(){c.superclass.activate.call(this);var z=this;this.oInitialSize.width=this.oEditor.jqImgNode.width();this.oInitialSize.height=this.oEditor.jqImgNode.height();this.oEditor.hide();this.oEditor.redrawMenu([h,n]);this.oEditor.jqMenuWrapper.css({bottom:-15-this.oEditor.jqMenuWrapper.height()+"px"});this.oEditor.removeCloseButton();this.oEditor.switchOff();this.oEditor.show();this.setSelection();tinymce.activeEditor.on("ObjectResized",function(A){z.oEditor.applyImageSizes();z.oEditor.reposition();z.setSelection()})};c.prototype.save=function(){c.superclass.deactivate.call(this);var A={width:this.oEditor.jqImgNode.width(),height:this.oEditor.jqImgNode.height()};this.process("resize",A);this.removeSelection();var z=this;window.setTimeout(function(){z.oEditor.setEditMode()},0)};c.prototype.cancel=function(){this.cleanup();this.oEditor.jqImgNode.width("").height("").removeAttr("width height")};c.prototype.cleanup=function(){this.removeSelection();var z=this;window.setTimeout(function(){if(z.oEditor.getEditState()&&(z.oEditor.getEnabledModule() instanceof r===false)){var A=new r(z.oEditor);A.activate()}},0)};c.prototype.setSelection=function(){var z=this;this.oEditor.applyImageSizes();tinymce.activeEditor.settings.object_resizing=true;tinymce.activeEditor.selection.controlSelection.showResizeRect(this.oEditor.jqImgNode[0])};c.prototype.removeSelection=function(){if(tinymce&&tinymce.activeEditor){tinymce.activeEditor.selection.controlSelection.hideResizeRect();tinymce.activeEditor.settings.object_resizing=false}this.oEditor.applyImageSizes()};function b(z){b.superclass.constructor.call(this);this.title=getLabel("js-ieditor-module-rotate-title");this.cssClass=t.module.rotate_module.css_class;this.init(z)}uAdmin.inherit(b,l);b.isImageEditorModule=true;b.prototype.activate=function(){this.oEditor.showPreloader();b.superclass.activate.call(this);this.process("rotate");this.oEditor.jqImgNode.removeAttr("data-mce-style")};function d(z){d.superclass.constructor.call(this);this.title=getLabel("js-ieditor-module-popup-title");this.cssClass=t.module.popup_module.css_class;this.jqWrapper=null;this.bEnabled=false;this.init(z)}uAdmin.inherit(d,l);d.isImageEditorModule=true;d.FANCYBOX_CSS_CLASS=t.module.popup_module.fancybox_css_class;d.WRAPPER_CSS_CLASS=t.module.popup_module.wrapper_css_class;d.THUMB_WIDTH=t.module.popup_module.thumb_width;d.prototype.init=function(z){d.superclass.init.call(this,z);this.jqWrapper=this.oEditor.jqImgNode.parents("."+d.WRAPPER_CSS_CLASS);if(!this.jqWrapper.length){this.bEnabled=false;this.setTitle(getLabel("js-ieditor-module-popup-title"));this.jqWrapper=jQuery("<a/>").addClass(d.FANCYBOX_CSS_CLASS).addClass(d.WRAPPER_CSS_CLASS).attr("href",this.oEditor.jqImgNode.attr("src"))}else{this.bEnabled=true;this.setTitle(getLabel("js-ieditor-module-popup-title-active"))}};d.prototype.activate=function(){d.superclass.activate.call(this);if(this.bEnabled){this.turnOff()}else{this.turnOn()}this.oEditor.reinit();this.oEditor.initLayout();this.oEditor.setEditState(false);uAdmin.ieditor.disable();uAdmin.ieditor.enable()};d.prototype.turnOn=function(){var C=this.oEditor.getEipNode(),z="",B="";if(C){z=this.oEditor.cleanupHtml(C.innerHTML)}var A=this.oEditor.jqImgNode.width()/this.oEditor.jqImgNode.height();this.oEditor.jqImgNode.width(d.THUMB_WIDTH).height(Math.round(d.THUMB_WIDTH/A)).attr({width:d.THUMB_WIDTH,height:Math.round(d.THUMB_WIDTH/A)}).wrap(this.jqWrapper).removeAttr("data-mce-style");if(C){B=this.oEditor.cleanupHtml(C.innerHTML)}if(tinymce&&tinymce.activeEditor){tinymce.activeEditor.on("remove",function(){window.setTimeout(fancybox_init,100)})}uAdmin.eip.bind("Disable",function(D){if(D=="after"){window.setTimeout(fancybox_init,500)}});this.addToEipQueue(B,z);uAdmin.eip.message(getLabel("js-ieditor-module-popup-title-msg"));uAdmin.eip.normalizeBoxes();this.bEnabled=true};d.prototype.turnOff=function(){var B=this.oEditor.getEipNode(),z="",A="";if(B){z=this.oEditor.cleanupHtml(B.innerHTML)}this.jqWrapper=this.oEditor.jqImgNode.parents("."+d.WRAPPER_CSS_CLASS);this.oEditor.jqImgNode.insertAfter(this.jqWrapper);this.jqWrapper.remove();this.oEditor.jqImgNode[0].style.width="";this.oEditor.jqImgNode[0].style.height="";this.oEditor.jqImgNode.removeAttr("data-mce-style width height");if(B){A=this.oEditor.cleanupHtml(B.innerHTML)}this.addToEipQueue(A,z);uAdmin.eip.message(getLabel("js-ieditor-module-popup-title-active-msg"));uAdmin.eip.normalizeBoxes();this.bEnabled=false};d.changeImage=function(B,A){if(B instanceof o===false){return}var z=new d(B);z.init(B);if(z.bEnabled){if(A){z.jqWrapper.remove()}else{z.turnOff();z.turnOn()}}z=null};function a(z){a.superclass.constructor.call(this);this.title=getLabel("js-ieditor-module-delete-title");this.cssClass=t.module.delete_module.css_class;this.init(z)}uAdmin.inherit(a,l);a.isImageEditorModule=true;a.prototype.init=function(z){a.superclass.init.call(this,z);this.jqElement.find("."+this.MODULE_ICON_HOLDER_CSS_CLASS).html("&times;")};a.prototype.activate=function(){a.superclass.activate.call(this);var E={};switch(this.oEditor.iImageType){case this.oEditor.IMAGE_TYPE_EIP:case this.oEditor.IMAGE_TYPE_PHOTOALBUM:var D=this.oEditor.jqImgNode.attr("umi:empty"),B=this.oEditor.jqImgNode.attr("src");this.setNewImage(D,false);this.oEditor.jqImgNode.attr("umi:is-stub",true);this.oEditor.redrawMenu();this.addToEipQueue(D,B);break;case this.oEditor.IMAGE_TYPE_WYSIWYG:var z=this.oEditor.getEipNode(),A=this.getWysiwygContent(z),C="";this.setNewImage("");C=this.getWysiwygContent(z);this.addToEipQueue(C,A,z);break}y.getInstance().removeEmptyEditors();uAdmin.eip.normalizeBoxes();this.triggerEvent("onActivate")};function h(z){n.superclass.constructor.call(this);this.title=getLabel("js-ieditor-module-apply-title");this.cssClass=t.module.apply_module.css_class;this.oActiveModule=z.getEnabledModule();this.init(z)}uAdmin.inherit(h,l);h.isImageEditorModule=true;h.prototype.activate=function(){if(this.oActiveModule instanceof l){this.oActiveModule.save();this.oEditor.reinit()}};function n(z){n.superclass.constructor.call(this);this.title=getLabel("js-ieditor-module-cancel-title");this.cssClass=t.module.cancel_module.css_class;this.oActiveModule=z.getEnabledModule();this.init(z)}uAdmin.inherit(n,l);n.isImageEditorModule=true;n.prototype.activate=function(){if(this.oActiveModule instanceof l){this.oActiveModule.cancel()}};return s(g,this)});uAdmin(".editor",function(b){function a(){}a.prototype.get=function(d,c){var e=uAdmin.eip.searchAttr(d);if(e){this.info=e;this.files=c;return this.load()}return false};a.prototype.load=function(){var o=this,h,e,j,n,m,l=uAdmin.eip.queue.search(o.info);if(l){if(l.add){if(o.info.field_name=="name"){o.info.field_type="string"}else{if(jQuery(o.info.node).attr("umi:field-type")){o.info.field_type=jQuery(o.info.node).attr("umi:field-type")}else{h=jQuery.ajax({url:"/utype/"+l.type_id+".json",async:false,dataType:"json"});h=JSON.parse(h.responseText);for(n in h.type.fieldgroups.group){n=h.type.fieldgroups.group[n];for(m in n.field){m=n.field[m];if(m.name==o.info.field_name){o.info.field_type=m.type["data-type"];break}}if(o.info.field_type){break}}}}o.info.old_value=jQuery(o.info.node).attr("umi:empty");return o.draw(o.info.field_type)}o.info.old_value=l.new_value;o.info.field_type=l.field_type;o.info.params=l.params;o.info.node=l.node;if(o.info.field_type=="relation"){o.info.guide_id=l.guide_id;o.info.multiple=l.multiple;o.info["public"]=l["public"]}return o.draw(l.field_type)}var d=jQuery(o.info.node),k=d.attr("umi:field-type");if(k&&k!="relation"&&k!="symlink"){o.info.field_type=k;if(o.info.node.tagName=="IMG"){o.info.old_value={src:d.attr("src")}}else{o.info.old_value=(d.attr("umi:empty")&&d.attr("umi:empty")==d.html())?"":d.html()}return o.draw(o.info.field_type)}e={};var g=jQuery(o.info.node).attr("umi:"+o.info.type+"-id");if(!g||g.match(/^new/)){g=jQuery(o.info.node).attr("umi:clone-source-id")||jQuery(o.info.node).parents("[umi\\:"+o.info.type+"-id]").first().attr("umi:clone-source-id")||o.info.id}e[o.info.type+"-id"]=g;e["field-name"]=o.info.field_name;e.qt=new Date().getTime();jQuery.ajax({async:false,type:"POST",url:"/admin/content/editValue/load.json",dataType:"json",data:e}).done(function(p){h=p});if(h.error){uAdmin.eip.message(h.error);return false}if(h.user&&h.user.type=="guest"){uAdmin.eip.message(getLabel("error-auth-required"));uAdmin.eip.closeMessages();uAdmin.session.sessionCloseMessage(true);return false}o.info.old_value={};if(h.property.type){d.attr("umi:field-type",h.property.type)}switch(h.property.type){case"relation":for(j in h.property.item){o.info.old_value[h.property.item[j].id]=h.property.item[j].name}o.info.guide_id=h.property["guide-id"];o.info.multiple=(h.property.multiple=="multiple");o.info["public"]=(h.property["public"]=="public");break;case"symlink":for(j in h.property.page){o.info.old_value[h.property.page[j].id]={name:h.property.page[j].name,type:{module:h.property.page[j].basetype.module,method:h.property.page[j].basetype.method}}}break;default:o.info.old_value=h.property.value}if(jQuery(o.info.node).attr("umi:clone-source-id")||jQuery(o.info.node).parents("[umi\\:clone-source-id]").length){var f=["img_file","swf_file","file","video_file"],c=["string","text","wysiwyg","int","date","boolean","password","float","formula","price","counter"];if(f.indexOf(h.property.type)!==-1){o.info.old_value={src:""}}else{if(c.indexOf(h.property.type)!==-1){o.info.old_value=""}else{o.info.old_value=[]}}}o.info.field_type=h.property.type;return o.draw(h.property.type)};a.prototype.bindFinishEvent=function(){var c=this;jQuery(document).on("click",function(h){if(!uAdmin.eip.enabled){return}if(jQuery(h.target).attr("contentEditable")=="true"){return}if(jQuery(h.target).attr("class")=="eip-ui-element"){return}if(jQuery(h.target).attr("class")=="ui-datepicker"){return}if(jQuery(h.target).attr("class")=="symlink-item-delete"){return}if(jQuery(h.target).parents().addBack().hasClass("eip_win")){return true}if(jQuery(h.target).parents().addBack().hasClass("eip-ieditor-img-wrapper")){return true}if(jQuery(h.target).parents().addBack().hasClass("eip-ieditor-imgareaselect-wrapper")){return true}if(jQuery(h.target).parents().addBack().filter("#mce-modal-block").length){return true}if(jQuery(h.target).parents().addBack().filter("#popupLayerScreenLocker").length){return true}if(jQuery(h.target).parents().addBack().filter("#jGrowl").length){return true}if(jQuery(h.target).parents(".eip-ui-element, .ui-datepicker, .ui-datepicker-title, .ui-datepicker-header, .ui-datepicker-calendar").length){return}var d=jQuery(h.target).parents();for(var g=0;g<d.length;g++){var f=d[g];if(f.tagName=="TABLE"){continue}if(f.tagName=="BODY"){break}if(jQuery(f).attr("class")=="symlink-item-delete"){return}if(jQuery(f).attr("contentEditable")=="true"){return}if(jQuery(f).hasClass("mceMenu")){return true}if(jQuery(f).hasClass("mceEditor")){return true}if(jQuery(f).parents().addBack().hasClass("mceColorSplitMenu")){return true}if(jQuery(f).parents().addBack().hasClass("mceMenuItem")){return true}if(jQuery(f).parents().addBack().hasClass("mce-panel")){return true}if(jQuery(f).parents().addBack().hasClass("eip-ieditor-imgareaselect-wrapper")){return true}}c.finish(true)})};a.prototype.draw=function(d){var c=this;if(typeof c.draw[d]=="function"){return c.draw[d](c)}uAdmin.eip.message('Unknown field type "'+d+'"');return false};a.prototype.draw["boolean"]=function(d){a.prototype.YES_TEXT=getLabel("js-cms-eip-editor-yes");a.prototype.NO_TEXT=getLabel("js-cms-eip-editor-no");var c=uAdmin.eip.nodePositionInfo(d.info.node);if(typeof d.info.old_value!="boolean"){switch(d.info.old_value){case a.prototype.NO_TEXT:case"0":d.info.old_value=false;break;case a.prototype.YES_TEXT:case"1":d.info.old_value=true;break;default:d.info.old_value=!!d.info.old_value;break}}if(d.info.node.tagName=="INPUT"&&d.info.node.type=="checkbox"){setTimeout(function(){d.info.new_value=!d.info.old_value;d.info.node.checked=d.info.new_value;d.commit();d.cleanup()},300);return d}var e=document.createElement("input");e.type="checkbox";document.body.appendChild(e);jQuery(window).bind("resize.ns"+d.info.guide_id,function(){var f=uAdmin.eip.nodePositionInfo(d.info.node);jQuery(e).css({left:f.x,top:f.y})});d.finish=function(f){if(f){d.info.new_value=e.checked;jQuery(d.info.node).text(d.info.new_value?a.prototype.YES_TEXT:a.prototype.NO_TEXT);d.commit()}jQuery(e).remove();jQuery(window).unbind("resize.ns"+d.info.guide_id);d.info.node.style.visibility="visible";d.cleanup()};e.checked=!!d.info.old_value;jQuery(e).attr("class","eip-ui-element eip-ui-boolean");jQuery(e).css({position:"absolute",left:c.x,top:c.y,"z-index":1100});uAdmin.eip.applyStyles(d.info.node,e);d.info.node.style.visibility="hidden";jQuery(e).click(function(){d.finish(true)});return d};a.prototype.draw["int"]=function(c){return c.draw.text(c)};a.prototype.draw["float"]=function(c){return c.draw.text(c)};a.prototype.draw.counter=function(c){return c.draw.text(c)};a.prototype.draw.price=function(c){return c.draw.text(c)};a.prototype.draw.string=function(c){return c.draw.text(c)};a.prototype.draw.tags=function(c){return c.draw.text(c)};a.prototype.draw.color=function(d){var h=jQuery(d.info.node);h.html("");h.addClass("u-eip-editing");var g=jQuery('<input type="text" class="color_value">').appendTo(h);var e=d.info.old_value;g.val(e);if(typeof colorControl=="undefined"){jQuery('<script src="/styles/common/js/color.control.js" type="text/javascript" charset="utf-8"><\/script>').appendTo("head")}var c=new colorControl(h);jQuery(document).bind("mousedown.color",function(){jQuery(document).unbind("mousedown.color");var k=h.find(event.target).length>0;var l=event.target==h.get(0);var m=jQuery("color-picker");var n=m.find(event.target).length>0;var j=event.target==m.get(0);if(!k&&!l&&!n&&!j){f()}});h.bind("hidePicker",function(){f()});function f(){var j=g.val();d.info.new_value=j;h.html(j);d.commit();h.addClass("u-eip-edit-box");h.removeClass("u-eip-editing");h.data("colorpicker",null);jQuery(".u-eip-add-button").css("display","block");uAdmin.eip.normalizeBoxes()}return d};a.prototype.draw.text=function(c,k){var f=jQuery(c.info.node),g=f.html();if(!c.info.old_value){c.info.old_value=""}if(k){c.info.old_value=c.info.old_value.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"')}if(!(c.info.field_type=="wysiwyg"&&uAdmin.wysiwyg.settings.inline)){f[0].innerHTML=c.info.old_value||"&nbsp;";f.attr("contentEditable",true)}f.blur().focus();c.finish=function(l){c.finish=function(){};jQuery(document).unbind("keyup");jQuery(document).unbind("click");f.attr("contentEditable",false);jQuery(".u-eip-sortable").sortable("enable");if(l){if(!k&&c.info.field_type!="wysiwyg"){var n=f.html();if(n.match(/\s<br>$/g)){n=n.replace(/<br>$/g,"")}var m=n;n=n.replace(/<!--[\w\W\n]*?-->/mig,"");n=n.replace(/<style[^>]*>[\w\W\n]*?<\/style>/mig,"");n=n.replace(/<([^>]+)>/mg,"");n=n.replace(/(\t|\n)/gi," ");n=n.replace(/[\s]{2,}/gi," ");if(jQuery.browser.safari){n=n.replace(/\bVersion:\d+\.\d+\s+StartHTML:\d+\s+EndHTML:\d+\s+StartFragment:\d+\s+EndFragment:\d+\s*\b/gi,"")}if(n!=m){f.html(n)}}c.info.new_value=f.html();if(c.info.new_value==" "||c.info.new_value=="&nbsp;"||c.info.new_value=="<p>&nbsp;</p>"){c.info.new_value="";f.html(c.info.new_value)}if(c.info.field_type!="wysiwyg"&&c.info.field_type!="text"){c.info.new_value=jQuery.trim(c.info.new_value);if(c.info.new_value.substr(-4,4)=="<br>"){c.info.new_value=c.info.new_value.substr(0,c.info.new_value.length-4)}}else{c.info.new_value=c.info.new_value.replace(/%[A-z0-9_]+(?:%20)+[A-z0-9_]+%28[A-z0-9%]*%29%/gi,unescape)}switch(c.info.field_type){case"int":case"float":case"price":case"counter":c.info.new_value=parseFloat(c.info.new_value);break}c.commit()}else{f.html(g)}c.cleanup()};c.bindFinishEvent();var e=f.width(),j=f.height(),h=null;jQuery(".u-eip-sortable").sortable("disable");f.focus();var d=null;jQuery(document).bind("keyup",function(l){if(e!=f.width()||j!=f.height()){e=f.width();j=f.height();if(h){clearTimeout(h)}h=setTimeout(function(){uAdmin.eip.normalizeBoxes();h=null},1000)}if(l.keyCode==46){if(d==f.html().length){if(d==1){f.html("")}}}}).bind("keydown",function(l){if(l.keyCode==46){d=f.html().length}if(l.keyCode==13&&c.info.field_type!="wysiwyg"&&c.info.field_type!="text"){c.finish(true);return false}if(l.keyCode==27){c.finish(false);return false}return true});return c};a.prototype.draw.wysiwyg=function(l){var g=jQuery(l.info.node),c=false,f=false,d=false,j=false,e=function(m){m=m.replace(/<![\s\S]*?--[ \t\n\r]*>/ig," ");m=m.replace(/<!--.*?-->/ig," ");if(jQuery.browser.mozilla){m=m.replace(/<\/?(style|font|title).*[^>]*>/ig,"")}m=m.replace(/<\/?(title|style|font|meta)\s*[^>]*>/ig,"");m=m.replace(/\s*mso-[^:]+:[^;""]+;?/ig,"");m=m.replace(/<\/?o:[^>]*\/?>/ig,"");m=m.replace(/ style=['"]?[^'"]*['"]?/ig,"");m=m.replace(/ class=['"]?[^'">]*['"]?/ig,"");m=m.replace(/<span\s*[^>]*>\s*&nbsp;\s*<\/span>/ig," ");m=m.replace(/<span\s*[^>]*>/ig,"");m=m.replace(/<\/span\s*[^>]*>/ig,"");m=m.replace(/<\/(b|i|s|u|strong|center)>[\t\n]*<\1[^>]*>/gi,"");m=m.replace(/<\/(b|i|s|u|strong|center)>\s*<\1[^>]*>/gi," ");m=m.replace(/<(b|i|s|u|strong|center)[^>]*>[\s\t\n\xC2\xA0]*<\/\1>/gi,"");m=m.replace(/(\t|\n)/gi," ");m=m.replace(/[\s]{2,}/gi," ");if(jQuery.browser.safari){m=m.replace(/\bVersion:\d+\.\d+\s+StartHTML:\d+\s+EndHTML:\d+\s+StartFragment:\d+\s+EndFragment:\d+\s*\b/gi,"")}return m};l.draw.text(l,true);jQuery(document).bind("keyup",function(n){if((n.keyCode==86||c)||(n.keyCode==45&&f)){if(!(tinymce&&tinymce.settings&&tinymce.settings.inline)){var m=e(g.html());if(m!=g.html()){g.html(m)}}if(c&&!n.ctrlKey){c=false}if(f&&!n.shiftKey){f=false}}switch(n.keyCode){case 16:if(!j){f=false}break;case 17:if(!d){c=false}break;case 45:j=false;break;case 86:d=false;break}}).bind("keydown",function(m){switch(m.keyCode){case 16:f=true;break;case 17:c=true;break;case 45:j=true;break;case 86:d=true;break}});var h=uAdmin.wysiwyg.init(l.info.node);var k=l.finish;l.finish=function(m){h.destroy();k(m);uAdmin.eip.bindEvents()};return l};a.prototype.draw.file=function(l,e){var c="./images/cms/data/",g="",d,h,f;l.finish=function(n){if(n){if(l.info.node.tagName=="IMG"){l.info.node.src=l.info.new_value.src}else{if(e){l.info.node.style.backgroundImage="url("+l.info.new_value.src+")"}else{l.info.node.innerText=l.info.new_value.src.substr(l.info.new_value.src.lastIndexOf("/")+1)}}l.commit();if(uAdmin&&uAdmin.eip&&uAdmin.eip.reinitEmptyLists){uAdmin.eip.reinitEmptyLists()}}l.cleanup()};if(l.info.old_value){if(l.info.old_value.src==undefined){l.info.old_value={src:l.info.old_value}}g=l.info.old_value.src.split(/\//g).pop();c="."+l.info.old_value.src.substr(0,l.info.old_value.src.length-g.length-1)}if(l.files&&l.files.length){d=l.files[0];d.folder=c;if(l.info.old_value){d.file=l.info.old_value.src}if(e){d.image=1}h=jQuery.ajax({url:"/admin/data/uploadfile/",async:false,data:d,type:"POST",dataType:"json"});h=JSON.parse(h.responseText);if(h.file.path){l.new_value=h.file.path;l.finish(true)}else{l.finish()}}else{f={folder:c,file:l.info.old_value?l.info.old_value.src:""};h=jQuery.ajax({url:"/admin/data/get_filemanager_info/",async:false,data:f,type:"POST",dataType:"json"});h=JSON.parse(h.responseText);var j="folder="+c;if(l.info.old_value){j+="&file="+l.info.old_value.src}if(e){j+="&image=1"}var k={flash:{height:460,url:"/styles/common/other/filebrowser/umifilebrowser.html?"+j},elfinder:{height:530,url:"/styles/common/other/elfinder/umifilebrowser.html?"+j+"&lang="+h.lang+"&file_hash="+h.file_hash+"&folder_hash="+h.folder_hash}};jQuery.openPopupLayer({name:"Filemanager",title:getLabel("js-file-manager"),width:660,height:k[h.filemanager].height,url:k[h.filemanager].url,afterClose:function(n){if(n){if(typeof n=="object"){n=n[0]}l.info.new_value=n?{src:n.toString()}:"";l.finish(true)}else{l.finish()}}});if(h.filemanager=="elfinder"){var m='<div id="watermark_wrapper"><label for="add_watermark">';m+=getLabel("js-water-mark");m+='</label><input type="checkbox" name="add_watermark" id="add_watermark"/>';m+='<label for="remember_last_folder">';m+=getLabel("js-remember-last-dir");m+='</label><input type="checkbox" name="remember_last_folder" id="remember_last_folder"';if(jQuery.cookie("remember_last_folder")){m+='checked="checked"'}m+="/></div>";jQuery("#popupLayer_Filemanager .popupBody").append(m)}}return l};a.prototype.draw.img_file=function(c){return c.draw.file(c,true)};a.prototype.draw.video_file=function(c){return c.draw.file(c)};a.prototype.draw.date=function(d){var e;if(d.info.old_value!=jQuery(d.info.node).attr("umi:empty")){e=d.info.old_value}e=moment(e,["DD-MM-YYYY hh:mm","DD-MM-YYYY","YYYY-MM-DD hh:mm","YYYY-MM-DD"]);if(!e.isValid()){e=moment()}d.info.old_value=e.format("DD-MM-YYYY");d.draw.text(d);var c=uAdmin.eip.nodePositionInfo(d.info.node);var f=jQuery("#u-datepicker-input");if(!f.length){f=document.createElement("input");f.id="u-datepicker-input";document.body.appendChild(f)}jQuery(window).bind("resize.ns"+d.info.guide_id,function(){var g=uAdmin.eip.nodePositionInfo(d.info.node);jQuery(".ui-datepicker-trigger").css({left:g.x+g.width+5,top:g.y});jQuery(f).css({left:(g.x+g.width+5),top:g.y})});d.finish=function(g){jQuery(window).unbind("resize.ns"+d.info.guide_id);jQuery(f).datepicker("destroy");jQuery(".ui-datepicker-trigger").remove();if(!d.info.new_value){d.info.new_value=jQuery(d.info.node).html()}d.cleanup();d.commit()};jQuery(f).css({position:"absolute",left:(c.x+c.width+5),top:(c.y),width:"1",height:"1",visibility:"hidden","font-size":"62.5%","z-index":560});jQuery(f).datepicker(jQuery.extend({},jQuery.datepicker.regional[uAdmin.data.lang],{showOn:"button",buttonImage:"/styles/common/other/calendar/icons_calendar_buttrefly_eip.png",buttonImageOnly:true,dateFormat:"dd-mm-yy",defaultDate:e.toDate(),onSelect:function(g){d.info.new_value=g;jQuery(d.info.node).html(g);jQuery(d.info.node).focus()}}));jQuery(d.info.node).html(d.info.old_value);uAdmin.eip.placeWith(d.info.node,jQuery(".ui-datepicker-trigger"),"right","middle");if(!d.info.id){d.info.old_value=""}jQuery(".ui-datepicker-trigger").css({left:(c.x+c.width+5),top:(c.y)});return d};a.prototype.draw.relation=function(m){jQuery(document).one("mouseup",function(){setTimeout(function(){m.bindFinishEvent()},100)});setTimeout(function(){jQuery(document).off("mouseup");m.bindFinishEvent()},1000);var f=uAdmin.eip.nodePositionInfo(m.info.node);var l=document.createElement("select");var k=document.createElement("input");document.body.appendChild(l);if(m.info.guide_id&&m.info["public"]){var g=document.createElement("input");g.type="button";g.value=" ";g.id="relationButton"+m.info.guide_id;g.className="relationAddButton";document.body.appendChild(g)}jQuery(l).attr("class","eip-ui-element");jQuery(l).css({position:"absolute",left:f.x,top:f.y,"z-index":1100});uAdmin.eip.applyStyles(m.info.node,l);jQuery(m.info.node).css("visibility","hidden");if(m.info.multiple){jQuery(l).attr("multiple","multiple");jQuery(l).attr("size",3)}for(var d in m.info.old_value){var e=document.createElement("option");jQuery(e).attr("value",d);jQuery(e).attr("selected","selected");jQuery(e).html(m.info.old_value[d]);l.appendChild(e)}jQuery(l).focus();jQuery(l).attr("name","rel_input");jQuery(l).attr("id","relationSelect"+m.info.guide_id);document.body.appendChild(k);uAdmin.eip.applyStyles(m.info.node,k);jQuery(k).attr({id:"relationInput"+m.info.guide_id,"class":"eip-ui-element",name:"rel_input_new"});if(typeof relationControl=="undefined"){jQuery('<script src="/styles/common/js/relation.control.js" type="text/javascript" charset="utf-8"><\/script>').appendTo("head")}var c=new relationControl(m.info.guide_id,null,true,"/admin/data/guide_items_all/");jQuery(window).bind("resize.ns"+m.info.guide_id,function(){var n=uAdmin.eip.nodePositionInfo(m.info.node);jQuery(l).css({left:n.x,top:n.y});jQuery(k).css({left:n.x,top:(n.y+jQuery(l).height()+5)});jQuery(g).css({left:(n.x+jQuery(k).width()+5),top:(n.y+jQuery(l).height()+Math.round((jQuery(k).height()-jQuery(g).height())/2))})});m.finish=function(){var o=[];m.info.new_value=c.getValue();m.commit();for(var n in m.info.new_value){o.push(m.info.new_value[n])}m.info.node.innerHTML=o.join(", ");m.info.node.style.visibility="visible";jQuery(l).resizable();jQuery(l).resizable("destroy");jQuery(l).remove();jQuery(k).remove();jQuery(g).remove();jQuery("#u-ep-search-trigger").remove();jQuery(window).unbind("resize.ns"+m.info.guide_id);m.cleanup()};c.loadItemsAll();if(m.info.multiple){var j=jQuery(l).height(),h=350;if(j<150){j=75;jQuery(l).css("height",j)}jQuery(l).resizable({minWidth:jQuery(l).width(),maxWidth:jQuery(l).width(),minHeight:j,maxHeight:h});jQuery(".ui-wrapper").css("z-index","1100")}jQuery(k).css({position:"absolute",width:jQuery(l).width(),left:f.x,top:(f.y+jQuery(l).height()+5),"z-index":1111});jQuery(g).css({position:"absolute",left:(f.x+jQuery(k).width()+5),top:(f.y+jQuery(l).height()+Math.round((jQuery(k).height()-jQuery(g).height())/2)),"z-index":1112});return m};a.prototype.draw.symlink=function(k){jQuery(document).one("mouseup",function(){setTimeout(function(){k.bindFinishEvent()},100)});setTimeout(function(){jQuery(document).off("mouseup");k.bindFinishEvent()},1000);var d=jQuery(k.info.node).attr("umi:type")?jQuery(k.info.node).attr("umi:type").split("::"):[];var g=uAdmin.eip.nodePositionInfo(k.info.node);var j=jQuery('<div><div id="symlinkInput'+k.info.id+'" /></div>').attr({"class":"eip-ui-element"}).css({position:"absolute",left:g.x,top:g.y,"z-index":1100}).appendTo("body");var l=150,h=jQuery(k.info.node).outerWidth(),c=(h>l?h:l);jQuery("#symlinkInput"+k.info.id).width(c);if(typeof symlinkControl=="undefined"){jQuery('<script src="/styles/common/js/symlink.control.js" type="text/javascript" charset="utf-8"><\/script>').appendTo("head")}var f=new symlinkControl(k.info.id,(d[0]||null),d,{inputName:k.info.field_name+"[]",fadeColorStart:[255,255,225],fadeColorEnd:[255,255,255]});if(jQuery.isEmptyObject(k.info.old_value)){f.addPlaceHolder()}for(var e in k.info.old_value){if(d.length===0){d=[k.info.old_value[e].type.module,k.info.old_value[e].type.method]}f.addItem(e,k.info.old_value[e].name,d,"")}jQuery(k.info.node).css("visibility","hidden");jQuery(window).bind("resize.ns"+k.info.guide_id,function(){var m=uAdmin.eip.nodePositionInfo(k.info.node);jQuery(j).css({left:m.x,top:m.y})});k.finish=function(){var m=jQuery('input[name="'+k.info.field_name+'[]"]'),p=[];jQuery(k.info.node).css("visibility","visible");k.info.new_value={};for(e=0;e<m.length;e++){if(m[e].value){var n=jQuery("ul li span",j)[e-1],o=jQuery(n).data("basetype").split(" ");k.info.new_value[m[e].value]={name:jQuery("ul li span",j)[e-1].innerHTML,type:{module:o[0],method:o[1]}};p.push(k.info.new_value[m[e].value].name)}}k.info.node.innerHTML=p.join(", ");k.commit();j.resizable();j.resizable("destroy");j.remove();jQuery("div.symlinkAutosuggest").remove();jQuery("#u-ep-search-trigger").remove();jQuery(window).unbind("resize.ns"+k.info.guide_id);k.cleanup()};f.loadItems();return k};a.prototype.replace=function(e,d,c){return e?this.replace[e.field_type](e,d,c):false};a.prototype.replace.img_file=function(f,q,o){var l=false,g=jQuery(f.node),m,k,j;var e=function(u,t){return u==t};var d=function(t){if(t.indexOf("/images/cms/thumbs/")>=0){return true}if(t.indexOf("/images/autothumbs/")>=0){return true}return false};var s=function(z,x,t){z=z.toString();var v=z.split(/\./g);if(v.length<2){return false}var w=v[v.length-1].toString();v=v[v.length-2].toString().split(/\//g);var u=v[v.length-1].toString();var y=z.substr(0,z.length-u.length-w.length-1);return"/images/autothumbs"+y+u+"_"+x+"_"+t+"."+w};if(f.node.tagName=="IMG"){if(e(g.attr("src"),o.src||"")){f.node.src=q.src||"";l=true}else{if(d(f.node.src)){var c=g.width();var r=g.height();var p=f.node.src;if(p.indexOf(c)!=-1&&p.indexOf(r)==-1){r="auto"}if(p.indexOf(c)==-1&&p.indexOf(r)!=-1){c="auto"}f.node.src=s(q.src,c,r);l=true}}g.one("load",function(){uAdmin.eip.normalizeBoxes()})}var n=f.node.style.backgroundImage.replace(/"/g,"");if(n.substr(0,4)!="url("){if(!l&&g.attr("childNodes")){m=g.attr("childNodes");for(j=0;j<m.length;j++){k=m.item(j);if(k&&jQuery(k).attr("tagName")){replaceImage(jQuery(k),q.src,o.src)}}}return l}n=n.substring(4,n.length-1);var h=window.location.protocol+"//"+window.location.host;if(n.substr(0,h.length)==h){n=n.substr(h.length)}if(!n){return l}if(e(n,o.src)){f.node.style.backgroundImage="url("+q.src+")";l=true}if(!l&&g.attr("childNodes")){m=g.attr("childNodes");for(j=0;j<m.length;j++){k=m.item(j);if(k&&jQuery(k).attr("tagName")){replaceImage(jQuery(k),q.src,o.src)}}}return l};a.prototype.replace.video_file=function(f,d,c){var e=function(g){return(navigator.appName.indexOf("Microsoft")!=-1)?window[g]:document[g]};e("UmiVideoPlayer").setVideoFile(d);return true};a.prototype.replace["boolean"]=function(e,d,c){if(e.node.tagName=="INPUT"&&e.node.type=="checkbox"){e.node.checked=d?true:false}else{jQuery(e.node).html(d?getLabel("js-cms-eip-editor-yes"):getLabel("js-cms-eip-editor-no"))}return true};a.prototype.replace.relation=function(g,f,c){var e=[],d;for(d in f){e.push(f[d])}jQuery(g.node).html(e.join(", "));return true};a.prototype.replace.symlink=function(g,f,c){var e="",d;for(d in f){e+="<span>"+f[d]+"</span><br />"}jQuery(g.node).html(e);return true};a.prototype.replace["int"]=function(e,d,c){return this.text(e,d,c)};a.prototype.replace["float"]=function(e,d,c){return this.text(e,d,c)};a.prototype.replace.counter=function(e,d,c){return this.text(e,d,c)};a.prototype.replace.price=function(e,d,c){return this.text(e,d,c)};a.prototype.replace.string=function(e,d,c){return jQuery(e.node).html(d)};a.prototype.replace.tags=function(e,d,c){return this.text(e,d,c)};a.prototype.replace.text=function(e,d,c){return jQuery(e.node).html(d)};a.prototype.replace.wysiwyg=function(e,d,c){return jQuery(e.node).html(d||"&nbsp;")};a.prototype.replace.file=function(e,d,c){return this.text(e,d,c)};a.prototype.replace.date=function(e,d,c){return this.text(e,d,c)};a.prototype.commit=function(){uAdmin.eip.trigger("ActiveEditorCommit","before");var d=this.info.new_value,c=this.info.old_value;if(this.info.field_type.match(/file/)){d=this.info.new_value.src;c=this.info.old_value?this.info.old_value.src:""}if(!this.equals(d,c)){jQuery(this.info.node).addClass("u-eip-modified");uAdmin.eip.queue.add(this.info)}else{if(uAdmin.eip.queue.search(this.info)){jQuery(this.info.node).addClass("u-eip-modified")}}uAdmin.eip.trigger("ActiveEditorCommit","after")};a.prototype.cleanup=function(){uAdmin.eip.bindEvents();this.finish=function(){this.cleanup()};uAdmin.eip.highlightNode(this.info.node);jQuery(".u-eip-add-button").css("display","block");uAdmin.eip.normalizeBoxes();this.info.node.blur();jQuery(this.info.node).removeClass("u-eip-editing")};a.prototype.finish=function(){this.cleanup()};a.prototype.equals=function(){var d=false,c=arguments,g=Object.prototype.toString,f,e={length:0};switch(true){case (c.length!==2):break;case (typeof c[0]!==typeof c[1]):break;case (g.call(c[0])!==g.call(c[1])):break;default:switch(typeof c[0]){case"undefined":break;case"object":if(g.call(c[0])=="[object Array]"){d=(c[0].length===c[1].length);if(d){for(f=0;f<c[0].length;f++){e[c[0][f]]=f;++e.length}for(f=0;f<c[1].length;f++){if(delete e[c[0][f]]){--e.length}}if(e.length===0){d=true}}}else{for(f in c[0]){e[f]=f;++e.length}for(f in c[1]){if(delete e[f]){--e.length}}if(e.length===0){d=true}if(d){for(f in c[0]){d=this.equals(c[0][f],c[1][f]);if(!d){break}}}}break;default:d=(c[0]===c[1])}}return d};return b(a,this)},"eip");uAdmin(".wysiwyg",function(extend){function WYSIWYG(){this.settings=jQuery.extend(this[this.type].settings,this.settings);this[this.type]();this.init=this[this.type].init}WYSIWYG.prototype.init=function(){return false};WYSIWYG.prototype.settings=function(){return false};WYSIWYG.prototype.inline=function(){jQuery('<script src="/js/cms/wysiwyg/inline/inlineWYSIWYG.js" type="text/javascript" charset="utf-8"><\/script>').appendTo("head")};WYSIWYG.prototype.inline.init=function(node){return new inlineWYSIWYG(node)};WYSIWYG.prototype.tinymce=function(){window.tinyMCEPreInit={suffix:"",base:"/js/cms/wysiwyg/tinymce/jscripts/tiny_mce"};jQuery('<script src="/js/cms/wysiwyg/tinymce/jscripts/tiny_mce/tiny_mce.js" type="text/javascript" charset="utf-8"><\/script>').appendTo("head");jQuery('<script src="/js/cms/wysiwyg/tinymce/jscripts/tiny_mce/tinymce_custom.js" type="text/javascript" charset="utf-8"><\/script>').appendTo("head")};WYSIWYG.prototype.tinymce.init=function(options){var editor={},selector="textarea.wysiwyg",settings={};if(uAdmin.eip&&uAdmin.eip.editor){editor={id:"mceEditor-"+new Date().getTime(),destroy:function(){tinyMCE.execCommand("mceToggleEditor",false,editor.id)}};options.id=editor.id;selector="#"+editor.id}settings.language=uAdmin.data["interface-lang"]||uAdmin.data.lang;settings=jQuery.extend(this.settings,settings);settings=jQuery.extend(settings,window.mceCustomSettings);var customSettings=options?(options.settings||{}):{};settings=jQuery.extend(settings,customSettings);tinyMCE.init(settings);if(options&&typeof options.selector==="string"){selector=options.selector}jQuery(selector).each(function(i,n){tinyMCE.execCommand("mceToggleEditor",false,n.id)});return editor};WYSIWYG.prototype.tinymce.settings={mode:"none",theme:"umi",width:"100%",language:typeof window.interfaceLang=="string"?interfaceLang:"ru",plugins:"safari,spellchecker,pagebreak,style,layer,table,save,advhr,advimage,advlink,emotions,iespell,inlinepopups,insertdatetime,preview,media,searchreplace,print,contextmenu,paste,directionality,fullscreen,noneditable,visualchars,nonbreaking,xhtmlxtras,template",inlinepopups_skin:"butterfly",toolbar_standart:"fontsettings,tablesettings,|,cut,copy,paste,|,pastetext,pasteword,|,selectall,cleanup,|,undo,redo,|,link,unlink,anchor,image,media,|,charmap,code",toolbar_tables:"table,delete_table,|,col_after,col_before,row_after,row_before,|,delete_col,delete_row,|,split_cells,merge_cells,|,row_props,cell_props",toolbar_fonts:"formatselect,fontselect,fontsizeselect,|,bold,italic,underline,|,justifyleft,justifycenter,justifyright,justifyfull,|,bullist,numlist,outdent,indent,|,forecolor,backcolor,|,sub,sup",theme_umi_toolbar_location:"top",theme_umi_toolbar_align:"left",theme_umi_statusbar_location:"bottom",theme_umi_resize_horizontal:false,theme_umi_resizing:true,convert_urls:false,relative_urls:false,file_browser_callback:function(field_name,url,type,win){if(type=="file"){var sTreeLinkUrl="/js/cms/wysiwyg/tinymce/jscripts/tiny_mce/themes/umi/treelink.html"+(window.lang_id?"?lang_id="+window.lang_id:"");tinyMCE.activeEditor.windowManager.open({url:sTreeLinkUrl,width:525,height:308,inline:true,scrollbars:false,resizable:false,maximizable:false,close_previous:false},{window:win,input:field_name,editor_id:tinyMCE.selectedInstance.editorId});return false}else{var input=win.document.getElementById(field_name),params={},qs=[];if(!input){return false}if(input.value.length){params.folder=input.value.substr(0,input.value.lastIndexOf("/"));params.file=input.value}qs.push("id="+field_name);switch(type){case"image":qs.push("image=1");break;case"media":qs.push("media=1");break}jQuery.ajax({url:"/admin/data/get_filemanager_info/",data:params,dataType:"json",success:function(data){if(data.filemanager=="flash"){if(input.value.length){qs.push("folder=."+params.folder);qs.push("file="+input.value)}}else{qs.push("folder_hash="+data.folder_hash);qs.push("file_hash="+data.file_hash);qs.push("lang="+data.lang)}var fm={flash:{height:460,url:"/styles/common/other/filebrowser/umifilebrowser.html?"+qs.join("&")},elfinder:{height:530,url:"/styles/common/other/elfinder/umifilebrowser.html?"+qs.join("&")}};jQuery.openPopupLayer({name:"Filemanager",title:getLabel("js-file-manager"),width:660,height:fm[data.filemanager].height,url:fm[data.filemanager].url});if(data.filemanager=="elfinder"){var options='<div id="watermark_wrapper"><label for="add_watermark">';options+=getLabel("js-water-mark");options+='</label><input type="checkbox" name="add_watermark" id="add_watermark"/>';options+='<label for="remember_last_folder">';options+=getLabel("js-remember-last-dir");options+='</label><input type="checkbox" name="remember_last_folder" id="remember_last_folder"';if(getCookie("remember_last_folder",true)){options+='checked="checked"'}options+="/></div>";window.parent.jQuery("#popupLayer_Filemanager .popupBody").append(options)}return false}})}return false},extended_valid_elements:"script[type=text/javascript|src|languge|lang],map[*],area[*],umi:*[*],input[*],noindex[*],nofollow[*],iframe[frameborder|src|width|height|name|align]",content_css:"/css/cms/style.css"};WYSIWYG.prototype.tinymce_umiru=function(){window.tinyMCEPreInit={suffix:"_src",base:"/js/cms/wysiwyg/tinymce/jscripts/tiny_mce"};jQuery('<script src="/js/cms/wysiwyg/tinymce/jscripts/tiny_mce/tiny_mce_src.js" type="text/javascript" charset="utf-8"><\/script>').appendTo("head")};WYSIWYG.prototype.tinymce_umiru.init=function(node){var editor,selector="textarea.wysiwyg",settings={};if(uAdmin.eip&&uAdmin.eip.editor){editor={id:"mceEditor-"+new Date().getTime(),destroy:function(){var oldNode=jQuery("#"+editor.id),newNode=jQuery("#"+editor.id+"_parent"),frame=jQuery("iframe",newNode)[0],content;content=frame.contentDocument.body.innerHTML;oldNode.html(content);newNode.remove();oldNode.css("display","");oldNode[0].id=""}};node.id=editor.id;selector="#"+editor.id}settings.language=uAdmin.data["interface-lang"]||uAdmin.data.lang;settings=jQuery.extend(this.settings,settings);tinyMCE.init(settings);jQuery(selector).each(function(i,n){tinyMCE.execCommand("mceAddControl",false,n.id)});return editor};WYSIWYG.prototype.tinymce_umiru.settings={mode:"none",theme:"umiru",language:typeof window.interfaceLang=="string"?interfaceLang:"ru",width:"100%",suffix:"_src",body_class:"text",theme_umi_resizing_use_cookie:false,init_instance_callback:"uAdmin.wysiwyg.initInstance",theme_umi_path:false,constrain_menus:false,extended_valid_elements:"script[src|*],style[*],map[*],area[*],umi:*[*],input[*],noindex[*],nofollow[*],iframe[frameborder|src|width|height|name|align],div[*],span[*],a[*]",plugins:"safari,spellchecker,pagebreak,style,layer,table,save,advhr,umiimage,advimage,advlink,emotions,iespell,inlinepopups,insertdatetime,preview,media,searchreplace,print,contextmenu,paste,directionality,fullscreen,noneditable,visualchars,nonbreaking,xhtmlxtras,template",inlinepopups_skin:"butterfly",setup:function(ed){function resize(ed,l){jQuery(ed.getContainer()).children("table.mceLayout").eq(0).css("height","auto");var i=jQuery(ed.getContentAreaContainer()).children("iframe")[0];var h=i.contentWindow.document.body;iHeight=Math.max(jQuery(h).parent().outerHeight(),jQuery(h).outerHeight());i.style.height=iHeight+"px";$("img",ed.getBody()).on("load",function(){resize(ed,l)})}ed.onChange.add(resize);ed.onKeyDown.add(resize);ed.onLoadContent.add(function(ed,o){if(o.content=="&nbsp;"||o.content==" "){ed.setContent("")}ed.focus();function backTrackTextnode(node){if(node.nodeType==3){return node}var subnodes=$(node).contents();for(var bkt=0;bkt<subnodes.length;bkt++){var result=backTrackTextnode(subnodes[bkt]);if(result){return result}}return false}var nodes_all=ed.dom.select("body");var node=backTrackTextnode(nodes_all[0]);if(!node){if(ed.dom.select("body *").length>0){node=ed.dom.select("body *")[0]}else{node=nodes_all[0]}}else{node=node.parentNode}var rng=ed.selection.getRng();if(!rng||typeof rng.selectNode=="undefined"){return}var tn=ed.getDoc().createTextNode(".");node.insertBefore(tn,node.firstChild);rng.selectNode(tn);rng.setStartBefore(tn);rng.setStartAfter(tn);ed.selection.setRng(rng);node.removeChild(tn);var panel=$("#"+ed.editorContainer+" .toolbarHolder");var panelWidth=1110;var bodyWidth=$("body").width();panel.css("position","fixed");panel.css("top",40);if(bodyWidth>panelWidth){panel.css("left",(bodyWidth-panelWidth)/2)}else{panel.css("left",(bodyWidth-800)/2)}})},toolbar_standart:"umiimage,tablesettings,|,pastetext,pasteword,|,cleanup,|,link,unlink,|,charmap,code",toolbar_tables:"table,delete_table,|,col_after,col_before,row_after,row_before,|,delete_col,delete_row,|,split_cells,merge_cells,|,row_props,cell_props",toolbar_fonts:"formatselect,fontselect,fontsizeselect,|,bold,italic,underline,|,justifyleft,justifycenter,justifyright,justifyfull,|,bullist,numlist,outdent,indent,|,forecolor,backcolor,|,sub,sup",theme_umi_toolbar_location:"top",theme_umi_toolbar_align:"left",theme_umi_statusbar_location:"bottom",theme_umi_resize_horizontal:false,theme_umi_resizing:false,convert_urls:false,relative_urls:false,file_browser_callback:"uAdmin.wysiwyg.umiFileBrowserCallback",template_external_list_url:"js/template_list.js",external_link_list_url:"",external_image_list_url:"",media_external_list_url:""};WYSIWYG.prototype.tinymce4=function(){window.tinyMCEPreInit={suffix:".min",base:"/js/cms/wysiwyg/tinymce4"};jQuery('<script src="/js/cms/wysiwyg/tinymce4/tinymce.min.js" type="text/javascript" charset="utf-8"><\/script>').appendTo("head");var jqToolbarHolder=jQuery("<div/>").addClass("toolbarHolder").css({position:"fixed",top:"40px",display:"none"}).appendTo("body");var repositionToolbarHolder=function(editor){if(!editor||editor instanceof tinymce.Editor===false){editor=tinymce&&tinymce.activeEditor}if(!editor){return false}var iDocWidth=jQuery(document).width(),iPanelWidth=Math.min(iDocWidth*0.9,1025),iLeft=(iDocWidth-iPanelWidth)/2;var jqPanel=jQuery(editor.theme.panel.getEl());jqToolbarHolder.width(iPanelWidth).offset({left:iLeft}).draggable().css("cursor","move");jqPanel.find(".mce-toolbar").css("display","inline-block").parent().css("white-space","normal");if(jQuery.draggable){jqPanel.draggable()}};jQuery(document).add(window).on("resize",function(oEvent){if(tinymce&&tinymce.activeEditor){repositionToolbarHolder(tinymce.activeEditor)}});tinymce.on("AddEditor",function(oEvent){oEvent.editor.on("ShowPanel",function(oEvent){repositionToolbarHolder(oEvent.target);window.setTimeout(function(){jQuery(".toolbarHolder").show()},0)})})};WYSIWYG.prototype.tinymce4.init=function(node){var editor,selector="textarea.wysiwyg",settings={};if(uAdmin.eip&&uAdmin.eip.editor){editor={id:"mceEditor-"+new Date().getTime(),destroy:function(){tinymce&&tinymce.activeEditor&&tinymce.activeEditor.destroy()}};node.id=editor.id;selector="#"+editor.id;settings.fixed_toolbar_container=".toolbarHolder";tinymce.on("AddEditor",function(oEvent){oEvent.editor.on("init",function(oEvent){this.fire("focus")})})}settings.language=uAdmin.data["interface-lang"]||uAdmin.data.lang;settings=jQuery.extend(this.settings,settings);settings=jQuery.extend(settings,window.mceCustomSettings);settings.selector=selector;tinymce.init(settings);return editor};WYSIWYG.prototype.tinymce4.settings={inline:true,theme:"modern",skin:"darkgray",language:typeof window.interfaceLang=="string"?interfaceLang:"ru",suffix:".min",schema:"html4",paste_as_text:true,convert_urls:false,toolbar_items_size:"small",extended_valid_elements:"script[src|*],style[*],map[*],area[*],umi:*[*],input[*],noindex[*],nofollow[*],iframe[frameborder|src|width|height|name|align],div[*],span[*],a[*]",plugins:"umiimage,spellchecker,pagebreak,layer,table,save,hr,image,link,emoticons,insertdatetime,preview,media,searchreplace,print,contextmenu,paste,directionality,fullscreen,noneditable,visualchars,nonbreaking,template,anchor,charmap,code,textcolor",inlinepopups_skin:"butterfly",toolbar1:"image table | paste pastetext | removeformat | link unlink | charmap code",toolbar2:"formatselect fontselect fontsizeselect",toolbar3:"bold italic underline",toolbar4:"alignleft aligncenter alignright alignjustify",toolbar5:"bullist numlist outdent indent",toolbar6:"forecolor backcolor",toolbar7:"subscript superscript",block_formats:getLabel("js-wysiwyg-paragraph")+"=p;Address=address;Pre=pre;Header 1=h1;Header 2=h2;Header 3=h3;Header 4=h4;Header 5=h5;Header 6=h6",menubar:false,statusbar:false,resize:false,object_resizing:false,convert_urls:false,relative_urls:false,file_browser_callback:function(){uAdmin.wysiwyg.umiFileBrowserCallback.apply(uAdmin.wysiwyg,arguments)},template_external_list_url:"js/template_list.js",external_link_list_url:"",external_image_list_url:"",media_external_list_url:""};WYSIWYG.prototype.initInstance=function(inst){jQuery("div.toolbarHolder").draggable();var el=jQuery(inst.getElement());var iframeBody=jQuery(inst.getDoc()).find("body").eq(0);var attrArray=["font-family","font-size","font-weight","font-style","color","text-transform","text-decoration","letter-spacing","word-spacing","line-height","text-align","vertical-align","direction","background-color","background-image","background-repeat","background-position","background-attachment","opacity","top","right","bottom","left","padding-top","padding-right","padding-bottom","padding-left","overflow-x","overflow-y","white-space","clip","list-style-image","list-style-position","list-style-type","marker-offset"];for(var i in attrArray){iframeBody.css(attrArray[i],el.css(attrArray[i]))}function getInternetExplorerVersion(){var rv=-1;if(navigator.appName=="Microsoft Internet Explorer"){var ua=navigator.userAgent;var re=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");if(re.exec(ua)!=null){rv=parseFloat(RegExp.$1)}}return rv}var ieVersion=getInternetExplorerVersion();if(ieVersion>-1&&ieVersion<=8){iframeBody.css("background-color","")}iframeBody.css("height","auto");var containerAttrArray=["margin-top","margin-right","margin-bottom","margin-left"];jQuery("#"+inst.editorContainer).css("display","block");for(var j in containerAttrArray){jQuery("#"+inst.editorContainer).css(containerAttrArray[j],el.css(containerAttrArray[j]))}inst.formatter.register({fontsize:{inline:"span",styles:{fontSize:"%value","line-height":"1.3em"}}});var cookie=tinymce.util.Cookie;cookie.set("tinymcePasteText","1",new Date(new Date().getFullYear()+1,12,31))};WYSIWYG.prototype.umiFileBrowserCallback=function(field_name,url,type,win){switch(type){case"file":uAdmin.wysiwyg.umiTreeLink(field_name,url,type,win);break;case"image":case"media":var input=win.document.getElementById(field_name);if(!input){return false}var folder="";var file="";if(input.value.length){folder=input.value.substr(0,input.value.lastIndexOf("/"));file=input.value}jQuery.ajax({url:"/admin/data/get_filemanager_info/",data:"folder="+folder+"&file="+file,dataType:"json",complete:function(data){data=jQuery.parseJSON(data.responseText);var folder_hash=data.folder_hash;var file_hash=data.file_hash;var lang=data.lang;var fm=data.filemanager;var functionName="uAdmin.wysiwyg.umi"+fm+"FileManager";eval(functionName+"(field_name, url, type, win, lang, folder_hash, file_hash)")}});break}return false};WYSIWYG.prototype.umielfinderFileManager=function(field_name,url,type,win,lang,folder_hash,file_hash){var qs=[];qs.push("id="+field_name);switch(type){case"image":qs.push("image=1");break;case"media":qs.push("media=1");break}qs.push("folder_hash="+folder_hash);qs.push("file_hash="+file_hash);qs.push("lang="+lang);$.openPopupLayer({name:"Filemanager",title:getLabel("js-file-manager"),width:660,height:530,url:"/styles/common/other/elfinder/umifilebrowser.html?"+qs.join("&")});if(tinymce&&tinymce.activeEditor&&tinymce.activeEditor.settings.inline){jQuery("#popupLayer_Filemanager .popupBody").append('<div id="watermark_wrapper"><label for="add_watermark">'+getLabel("js-water-mark")+'</label><input type="checkbox" name="add_watermark" id="add_watermark"></div>')}else{window.parent.jQuery("#popupLayer_Filemanager .popupBody").append('<div id="watermark_wrapper"><label for="add_watermark">'+getLabel("js-water-mark")+'</label><input type="checkbox" name="add_watermark" id="add_watermark"></div>')}return false};WYSIWYG.prototype.umiflashFileManager=function(field_name,url,type,win,lang,folder_hash,file_hash){var input=win.document.getElementById(field_name);if(!input){return false}var qs=[];qs.push("id="+field_name);switch(type){case"image":qs.push("image=1");break;case"media":qs.push("media=1");break}if(input.value.length){var folder=input.value.substr(0,input.value.lastIndexOf("/"));qs.push("folder=."+folder);qs.push("file="+input.value)}$.openPopupLayer({name:"Filemanager",title:getLabel("js-file-manager"),width:660,height:460,url:"/styles/common/other/filebrowser/umifilebrowser.html?"+qs.join("&")});return false};WYSIWYG.prototype.umiTreeLink=function(field_name,url,type,win){var domain_floated=window.pageData?window.pageData.domain:"";var domain_floated_id=window.pageData?window.pageData.domain_id:"";var lang_id=window.pageData.lang_id;var sTreeLinkUrl="";var iPageHight=0;if(tinyMCE.majorVersion<4){sTreeLinkUrl="/js/cms/wysiwyg/tinymce/jscripts/tiny_mce/themes/umi/treelink.html?domain="+domain_floated+"&domain_id="+domain_floated_id+"&lang_id="+lang_id;iPageHight=308}else{sTreeLinkUrl="/js/cms/wysiwyg/tinymce4/skins/lightgray/treelink.html?domain="+domain_floated+"&domain_id="+domain_floated_id+"&lang_id="+lang_id;iPageHight=320}tinyMCE.activeEditor.windowManager.open({url:sTreeLinkUrl,title:getLabel("js-choose-page"),width:525,height:iPageHight,inline:true,scrollbars:false,resizable:false,maximizable:false,close_previous:false},{window:win,input:field_name,editor_id:tinyMCE.activeEditor.id});return false};WYSIWYG.prototype.getFilemanagerFooter=function(filemanager){var footer="";if(filemanager=="elfinder"){footer='<div id="watermark_wrapper" class="ui-widget-header">';footer+='<label for="remember_last_folder">';footer+=getLabel("js-remember-last-dir");footer+='</label><input type="checkbox" name="remember_last_folder" id="remember_last_folder"';if(jQuery&&jQuery.cookie&&jQuery.cookie("remember_last_folder")){footer+='checked="checked"'}footer+="/></div>"}return footer};return extend(WYSIWYG,this)});window.tinyMCEPreInit={suffix:".min",base:"/js/cms/wysiwyg/tinymce4"};uAdmin.onLoad("wysiwyg",function(){uAdmin.wysiwyg.curr_mouse_position={top:0,left:0};$("body").click(function(a){uAdmin.wysiwyg.curr_mouse_position={top:a.pageY-window.pageYOffset,left:a.pageX-window.pageXOffset}})});uAdmin(".session",function(b){function a(){var c=this;c.access=!!c.access;c.lifetime=parseInt(c.lifetime)||10;c.pingInterval=Math.min((c.lifetime*60)/2,300);c.awayTimeout=0;c.lastPingedTime=new Date();c.currentMessage=null;this.lastActionTime=new Date();(function d(){jQuery(document).bind("click keydown mousedown",null,function(e){c.eventHandler(e)});setTimeout(function(){jQuery("iframe").each(function(){try{var g=this.contentWindow||this.contentDocument;if(g.document){jQuery(g.document).bind("click keydown mousedown",function(e){c.eventHandler(e)})}}catch(f){}})},5000);c.pingIntervalHandler=setInterval(function(){c.pingHandler()},c.pingInterval*1000)})()}a.prototype.sessionAjax=function(c,d){jQuery.get("/session.php",c,function(e){if(typeof d=="function"){d(e)}})};a.prototype.login=function(c,d,e){this.sessionAjax({"u-login":c,"u-password":d,a:"ping"},function(f){if(typeof e=="function"){e(f!="-1")}})};a.prototype.check=function(){var c=this;this.sessionAjax(null,function(d){c.checkHandler(d)})};a.prototype.ping=function(d){var c=this;if(((new Date()).getTime()-c.lastPingedTime.getTime()<5000)&&!d){return}c.lastPingedTime=new Date();c.sessionAjax({a:"ping"},function(e){c.checkHandler(e)})};a.prototype.checkHandler=function(d){switch(d){case"-1":case"0":this.showCloseMessage(true);break;default:this.awayTimeout=parseInt(d,10);if(this.awayTimeout<=this.pingInterval+10){this.showWarningMessage()}else{if(!this.pingIntervalHandler){var c=this;this.pingIntervalHandler=setInterval(function(){c.pingHandler()},this.pingInterval*1000)}this.closeMessage()}break}};a.prototype.isUserActive=function(){return(new Date().getTime()-this.lastActionTime.getTime())/1000<this.pingInterval};a.prototype.eventHandler=function(c){this.lastActionTime=new Date();switch(this.currentMessage){case"warning":this.closeMessage();this.ping(true);case"close":this.ping()}};a.prototype.pingHandler=function(){if(this.isUserActive()){this.ping()}else{this.check()}};a.prototype.showWarningMessage=function(d){var c=this;if(d){clearInterval(c.timer);c.timer=null}c.currentMessage="warning";if(c.timer){return}c.timer=setInterval(function(){if(c.awayTimeout>0){var j=c.awayTimeout;var f=parseInt(j/60);var g=j%60;if(g<10){g="0"+g}var h=f+":"+g;var e=parseInt((c.lifetime*60-c.awayTimeout)/60);c.message(getLabel("js-session-is-away")+" "+e+" "+getLabel("js-minutes")+". "+getLabel("js-session-warning")+"<br/>"+h);c.awayTimeout--}else{c.closeMessage();c.check()}},1000)};a.prototype.showCloseMessage=function(e){var c=this;if(e){clearInterval(c.timer);c.timer=null}if(c.currentMessage=="close"){return}c.currentMessage="close";if(c.pingIntervalHandler){clearInterval(c.pingIntervalHandler);c.pingIntervalHandler=0}var f=jQuery("<div><br />"+getLabel("js-session-was-away")+" "+c.lifetime+" "+getLabel("js-minutes")+", "+getLabel("js-session-close")+"<br/><br/></div>");var d=jQuery('\n			<form>\n				<table cellspacing="5" width="100%">\n					<tr>\n						<td>'+getLabel("js-label-login")+': </td>\n						<td><input type="text" name="session_contorl_login" /></td>\n					</tr>\n					<tr>\n						<td>'+getLabel("js-label-password")+':</td>\n						<td><input type="password" name="session_contorl_passsword" /></td>\n					</tr>\n				</table>\n				<br/>\n				<input type="submit" value="'+getLabel("js-label-login-do")+'">\n			</form>\n		').appendTo(f);if(c.access){jQuery("<br/> <br/><a href='/admin/config/main/' target='_blank'>"+getLabel("js-session-lifetime-configure")+"</a>").appendTo(d)}d.submit(function(){var h=jQuery.trim(this.session_contorl_login.value),g=jQuery.trim(this.session_contorl_passsword.value);if(h&&g){c.login(h,g,function(j){if(j){jQuery.getJSON("/admin/config/main/.json",{},function(k){if(uAdmin.csrf&&uAdmin.csrf!=k.csrf){uAdmin.csrf=k.csrf}else{if(csrfProtection&&csrfProtection.getToken()!=k.csrf){csrfProtection.changeToken(k.csrf)}}});c.closeMessage();c.pingIntervalHandler=setInterval(function(){c.pingHandler()},c.pingInterval*1000);jQuery.jGrowl(getLabel("js-session-restored"),{header:"UMI.CMS",life:5000})}else{jQuery.jGrowl(getLabel("js-label-text-error"),{header:"UMI.CMS",life:5000})}})}else{jQuery.jGrowl(getLabel("js-label-text-error"),{header:"UMI.CMS",life:5000})}return false});c.message(f)};a.prototype.message=function(e){var c=this;if(typeof e=="string"){e="<br/><p> "+e+" </p>"}if(!c.jgrowl){c.jgrowl=-1;jQuery.jGrowl(e,{header:"UMI.CMS",dont_close:true,beforeOpen:function(f){c.jgrowl=jQuery(f)},close:function(){c.closeMessage();c.ping(true)}});return}else{if(c.jgrowl!=-1){var d=c.jgrowl.find(".jGrowl-message");if(typeof e=="string"){d.html(e)}else{d.html("");d.append(e)}}}};a.prototype.closeMessage=function(){this.currentMessage=null;if(this.timer){clearInterval(this.timer);this.timer=null}if(this.jgrowl&&this.jgrowl!=-1){this.jgrowl.mouseout();this.jgrowl.remove();this.jgrowl=null}};a.prototype.destroy=function(){if(this.pingIntervalHandler){clearInterval(this.pingIntervalHandler);this.pingIntervalHandler=0}if(this.timer){clearInterval(this.timer);this.timer=null}return true};return b(a,this)});function RGBColor(g){this.ok=false;if(g.charAt(0)=="#"){g=g.substr(1,6)}g=g.replace(/ /g,"");g=g.toLowerCase();var a={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};for(var c in a){if(g==c){g=a[c]}}var h=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(j){return[parseInt(j[1]),parseInt(j[2]),parseInt(j[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(j){return[parseInt(j[1],16),parseInt(j[2],16),parseInt(j[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(j){return[parseInt(j[1]+j[1],16),parseInt(j[2]+j[2],16),parseInt(j[3]+j[3],16)]}}];for(var b=0;b<h.length;b++){var e=h[b].re;var d=h[b].process;var f=e.exec(g);if(f){channels=d(f);this.r=channels[0];this.g=channels[1];this.b=channels[2];this.ok=true}}this.r=(this.r<0||isNaN(this.r))?0:((this.r>255)?255:this.r);this.g=(this.g<0||isNaN(this.g))?0:((this.g>255)?255:this.g);this.b=(this.b<0||isNaN(this.b))?0:((this.b>255)?255:this.b);this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"};this.toHash=function(){return{red:this.r,green:this.g,blue:this.b}};this.inverse=function(){this.r=255-this.r;this.g=255-this.g;this.b=255-this.b};this.toHex=function(){var l=this.r.toString(16);var k=this.g.toString(16);var j=this.b.toString(16);if(l.length==1){l="0"+l}if(k.length==1){k="0"+k}if(j.length==1){j="0"+j}return"#"+l+k+j}}function relationControl(r,b,j,h){var e=this;var d=r;var v=b||r;var q=true;var y=null;var B=null;var s=null;var f=null;var C=null;var a=null;var c=null;var A=null;var t=null;var m=0;var l=0;var z=h||"/admin/data/guide_items_all/";var w=function(){y=document.getElementById("relationSelect"+v);B=document.getElementById("relationInput"+v);s=document.getElementById("relationButton"+v);if(!y){alert("Select input for field #"+v+" not found");return}jQuery("option",y).each(function(){if(!this.selected&&this.value.length!==0){q=false}});if(s){s.onclick=function(){e.addObjectToGuide(null,null,function(F,G){e.addItem(F,G)})}}if(B){B.onkeyup=function(G){var F=G?G.keyCode:event.keyCode;if(F==13&&s){e.addItem();return false}else{e.doSearch()}};B.onkeydown=function(G){var F=G?G.keyCode:event.keyCode;if(F==13){return false}}}var E=function(){if(q){e.loadItemsAll();q=false}};y.onmouseover=E;y.onfocus=E;for(var D=0;D<y.childNodes.length;D++){if(y.childNodes[D].nodeType!=1){y.removeChild(y.childNodes[D]);D=0}}if(j&&jQuery("option[value='']",y).length==0){jQuery(y).prepend("<option value=''></option>")}};this.addObjectToGuide=function(K,J,M){var G=(typeof(B)==="object"?B.value:K);var L=(parseInt(d)>0?parseInt(d):parseInt(J));var F={url:"",data:null};var H={id:0,name:""};var I=document.getElementById("relationButton"+v);var E=null;var D=null;if(typeof(G)!=="string"||G.length<=0||L<=0){return}F.url="/admin/udata://data/addObjectToGuide/.json";F.data={param0:G,param1:L};I.setAttribute("disabled","");jQuery.ajax({url:F.url,dataType:"json",data:F.data,type:"post",success:function(N){if(typeof(N.data)!=="undefined"&&typeof(N.data.object)!=="undefined"){H.id=parseInt(N.data.object.id);if(isNaN(H.id)||H.id<=0){return}H.name=N.data.object.name;if(typeof(M)==="function"){M(H.name,H.id)}I.removeAttribute("disabled");if(C){E=jQuery("option:selected",y);D=jQuery("option:last",y);E=E.detach();jQuery(D).replaceWith(E)}}},error:function(){I.removeAttribute("disabled")}})};this.rescan=function(){B=document.getElementById("relationInput"+v);if(B){B.onkeyup=function(E){var D=E?E.keyCode:event.keyCode;if(D==13&&s){e.addItem()}else{e.doSearch()}}}};this.getValue=function(){var F=jQuery("option:selected",jQuery(y));var D={};for(var E=0;E<F.length;E++){D[F[E].value]=jQuery(F[E]).text()}return D};this.loadItems=function(D){jQuery.ajax({url:z+d+".xml?limit&search[]="+encodeURIComponent(D),type:"get",complete:function(F,E){e.updateItems(F)}})};this.loadItemsAll=function(){jQuery.ajax({url:z+d+".xml?allow-empty",type:"get",complete:function(E,D){e.updateItemsAll(E)}})};this.updateItemsAll=function(E){if(E.responseXML.getElementsByTagName("empty").length){if(B){B.onkeyup=function(P){var O=P?P.keyCode:event.keyCode;switch(O){case 38:if(A.length&&(t>0||t==null)){g((t===null)?(A.length-1):(t-1))}break;case 40:if(A.length&&(t<(A.length-1)||t==null)){g((t===null)?0:(t+1))}break;case 13:k();n();break;case 27:n();break;default:clearTimeout(c);c=setTimeout(function(){e.doSearchAjax()},500)}};B.onblur=function(){if(a){if(m<parseInt(a.style.left)||m>(parseInt(a.style.left)+parseInt(a.offsetWidth))||l<parseInt(a.style.top)||l>(parseInt(a.style.top)+parseInt(a.offsetHeight))){n()}}};var K=E.responseXML.getElementsByTagName("empty")[0].getAttribute("total");if(!C){C=new Option(" ","");C.innerHTML=getLabel("js-relation-total")+K+". "+getLabel("js-relation-use_search");y.insertBefore(C,y.firstChild)}}return}var I=E.responseXML.getElementsByTagName("object");var L=[];var F=0;for(F=0;F<y.options.length;F++){if(y.options[F].selected){L.push(y.options[F].value)}}jQuery("option",y).each(function(){if(!this.selected||this.value.length===0){jQuery(this).remove()}});if(j){$(y).prepend("<option value=''> </option>")}for(F=0;F<I.length;F++){var J=I[F].getAttribute("id");var G=false;for(var M in L){if(L[M]==J){G=true;delete L[M];break}}if(!G){var N=I[F].getAttribute("name");var D=new Option(N,J);D.innerHTML=N;y.appendChild(D)}}if(jQuery.browser.msie){var H=y.style.display;y.style.display="none";y.style.display=H}};this.updateItems=function(E){t=null;A=E.responseXML.getElementsByTagName("object");if(!A.length){return}var F=null;if(!a){a=document.createElement("div");a.className="relationAutosuggest";var H=jQuery(B).offset();a.style.position="absolute";a.style.zIndex=1050;a.style.width=B.clientWidth+"px";a.style.top=(H.top+B.offsetHeight)+"px";a.style.left=H.left+"px";F=document.createElement("ul");a.appendChild(F);document.body.appendChild(a)}a.style.display="";jQuery(document).mousemove(o);F=a.firstChild;while(F.firstChild){F.removeChild(F.firstChild)}for(i=0;i<A.length;i++){var G=A[i].getAttribute("name");var D=document.createElement("li");D.innerHTML=G;D.onmouseover=function(){g(this.suggestIndex)};D.onmouseout=function(){this.className=""};D.onclick=function(){k();n()};D.suggestIndex=i;F.appendChild(D)}};var o=function(D){if(!D){m=event.clientX+document.body.scrollLeft;l=event.clientY+document.body.scrollTop}else{m=D.pageX;l=D.pageY}return true};this.addItem=function(E,D){if(!(E&&E.length)&&!(B&&B.value.length)){return}x();u();if(!y.multiple&&f&&!E&&!D){f.innerHTML=(D?"":"&rarr;&nbsp;&nbsp;")+B.value;f.value=D?D:B.value;y.selectedIndex=0}else{f=new Option(E?E:B.value,D?D:B.value);f.innerHTML=(D?"":"&rarr;&nbsp;&nbsp;")+(E?E:B.value);if(y.options.length){y.insertBefore(f,y.firstChild)}else{y.appendChild(f)}}B.value="";f.selected=true;if(jQuery.browser.msie){setTimeout(function(){f.selected=false;f.selected=true},20)}};var g=function(E){if(a.style.display!="none"){var F=a.firstChild;var D=F.childNodes.item(t);if(D){D.className=""}F.childNodes.item(E).className="active";t=E}};var k=function(){if(a&&a.style.display!="none"&&t!==null){var G=A[t].getAttribute("name");var F=A[t].getAttribute("id");var E=false;for(var D=0;D<y.options.length;D++){if(y.options[D].value==F){E=true;y.options[D].selected=true;break}}if(!E){e.addItem(G,F)}}else{if(B.value.length&&s){e.addItem()}}};var n=function(){if(a&&a.style.display!="none"){a.style.display="none";jQuery(document).unbind("mousemove",o)}};this.doSearch=function(){var G=B.value.toLowerCase();x();if(G==""){if(y.multiple){u()}return}for(var E=0;E<y.options.length;E++){var H=y.options[E].text;var F=H.replace(/^.\s\s/,"");if(H.substring(0,G.length).toLowerCase()===G||F.substring(0,G.length).toLowerCase()===G){if(y.multiple){if(y.firstChild.nodeName.toLowerCase()!="optgroup"){p();searchGroup=y.firstChild;itemsGroup=y.lastChild}var D=y.options[E];if(D.parentNode==searchGroup){continue}D.oldPrevSibling=D.previousSibling;itemsGroup.removeChild(D);searchGroup.appendChild(D);if(searchGroup.childNodes.length==5){return}}else{y.selectedIndex=E;return}}}};this.doSearchAjax=function(){if(B.value){this.loadItems(B.value)}};var p=function(){var E=document.createElement("optgroup");E.label="Search results";var D=document.createElement("optgroup");D.label="------------------------------------------------";while(y.firstChild){var F=y.firstChild;y.removeChild(F);D.appendChild(F)}y.appendChild(E);y.appendChild(D)};var u=function(){if(y.firstChild&&y.firstChild.nodeName.toLowerCase()=="optgroup"){y.removeChild(y.firstChild);var D=y.firstChild;while(D.firstChild){var E=D.firstChild;D.removeChild(E);y.appendChild(E)}y.removeChild(D)}};var x=function(){if(y.firstChild&&y.firstChild.nodeName.toLowerCase()=="optgroup"){var E=y.firstChild;var D=y.lastChild;while(E.firstChild){var F=E.firstChild;E.removeChild(F);if(F.oldPrevSibling!==undefined||F.oldPrevSibling==null){if(F.oldPrevSibling&&F.oldPrevSibling.nextSibling){D.insertBefore(F,F.oldPrevSibling.nextSibling)}else{if(F.oldPrevSibling===null){D.insertBefore(F,D.firstChild)}else{D.appendChild(F)}}F.oldPrevSibling=undefined}}}};w()}function symlinkControl(C,n,K,N,M,j){M=(M instanceof Array)?M:[M];var h=this;var B=C;var I=(K instanceof Array)?K:[K];var d=(I)?"&hierarchy_types="+I.join("-"):"";var p=(M instanceof Array)?"&hierarchy_types="+M.join(","):"";var c=n||null;var y=null;var m=null;var A=null;var v=null;var P=null;var w=null;var H=null;var E=0;var D=0;if(!N){N={}}var O=N.iconsPath||"/images/cms/admin/mac/tree/";var G=N.fadeColorStart||[255,0,0];var s=N.fadeColorEnd||[255,255,255];var q=N.inputName||("symlinkInput"+B);var t=N.noImages||false;var e=N.treeURL||"/styles/common/js/tree.html";var F=N.rootId;var J=N.popupTitle||getLabel("js-cms-eip-symlink-choose-element");var o=typeof(N.showSuggestType)==="undefined"?true:N.showSuggestType;var b=typeof(N.cutSuggestNames)==="undefined"?true:N.cutSuggestNames;var a=parseInt(N.suggestDivWidth);var l={};var u=(j?"&callback=symlinkControlsList."+B+".onlyOne":"");var L=function(){if(!window.symlinkControlsList){window.symlinkControlsList={}}window.symlinkControlsList[B]=h;y=document.getElementById("symlinkInput"+B);if(!y){alert("Symlink container #"+B+" not found");return}var R=document.createElement("input");R.type="hidden";R.name=q;y.parentNode.insertBefore(R,y);v=document.createElement("ul");y.appendChild(v);var S=document.createElement("div");y.appendChild(S);m=document.createElement("input");m.setAttribute("placeholder",getLabel("js-cms-eip-symlink-search"));S.className="pick-element";S.appendChild(m);var T=18,U=28;m.style.width=S.parentNode.offsetWidth-(T+U)+"px";m.style.minWidth=S.parentNode.offsetWidth-(T+U)+"px";A=t?document.createElement("input"):document.createElement("img");S.appendChild(A);m.type="text";if(t){A.type="button";A.value="╘"}else{A.src="/images/cms/admin/mac/tree.png";A.height="18"}A.className="treeButton";A.onclick=function(){jQuery.openPopupLayer({name:"Sitetree",title:J,width:620,height:335,url:e+"?id="+B+(c?"&module="+c:"")+p+(window.lang_id?"&lang_id="+window.lang_id:"")+(F?"&root_id="+F:"")+u})};v.className="pageslist";m.onkeypress=function(W){var V=W?W.keyCode:window.event.keyCode;if(V==13){return false}};m.onkeyup=function(W){var V=W?W.keyCode:window.event.keyCode;switch(V){case 38:if(w.length&&(H>0||H==null)){r((H===null)?(w.length-1):(H-1))}break;case 40:if(w.length&&(H<(w.length-1)||H==null)){r((H===null)?0:(H+1))}break;case 13:x();Q();return false;break;case 27:Q();break;default:h.doSearch()}};m.onblur=function(){if(P){if(E<parseInt(P.style.left)||E>(parseInt(P.style.left)+parseInt(P.offsetWidth))||D<parseInt(P.style.top)||D>(parseInt(P.style.top)+parseInt(P.offsetHeight))){Q()}}}};this.loadItems=function(R){jQuery.ajax({url:"/admin/content/load_tree_node.xml?limit&domain_id[]="+(window.domain_id?window.domain_id:"1")+d+(window.lang_id?"&lang_id="+window.lang_id:"")+(F?"&rel="+F:"")+"&search-all-text[]="+encodeURIComponent(R),type:"get",complete:function(T,S){h.updateItems(T)}})};this.onlyOne=function(S,T,R,U){jQuery.closePopupLayer("Sitetree");if(confirm(getLabel("js-island-change-symlink-warning"))){jQuery("a.button",v).click();h.addItem(S,T,U,R);jQuery('form input[name="save-mode"]:first').click()}};this.updateItems=function(T){var U=(jQuery("html.u-eip").length>0);var R=null;H=null;R=T.responseXML.getElementsByTagName("page");if(!R.length){return}w=R;var V=[];for(var W=0;W<w.length;W++){if(l[w[W].getAttribute("id")]){continue}V[V.length]=w[W]}w=V;var X=null;if(!P){P=document.createElement("div");P.className="symlinkAutosuggest";var aa=jQuery(m).offset();P.style.position="absolute";P.style.zIndex=1100;P.style.width=m.clientWidth+"px";if(!isNaN(a)){P.style.width=a+"px"}P.style.top=(aa.top+m.offsetHeight)+"px";P.style.left=aa.left+"px";if(U){P.style.backgroundColor="white";P.style.border="1px solid #ccc"}X=document.createElement("ul");P.appendChild(X);document.body.appendChild(P)}z();jQuery(document).mousemove(g);X=P.firstChild;while(X.firstChild){X.removeChild(X.firstChild)}for(W=0;W<w.length;W++){if(l[w[W].getAttribute("id")]){continue}var S=k(w[W].getElementsByTagName("name")[0]);var Y=k(w[W].getElementsByTagName("basetype")[0]);var Z=w[W].getAttribute("link");var ad=document.createElement("li");var ac=document.createElement("span");var ab=document.createElement("a");ad.title=S;if(b){if(S.length>20){S=S.substr(0,20)+"..."}}if(Z.length>55){Z=Z.substr(0,55)+"..."}ad.appendChild(document.createTextNode(S));if(o){ad.appendChild(ac)}ac.appendChild(document.createTextNode(" ("+Y+")"));if(!U){ad.appendChild(document.createElement("br"));ad.appendChild(ab);ab.appendChild(document.createTextNode(Z));ab.href=Z;ab.target="_blank"}else{ac.style.display="block";ad.className="symlink-item-delete";ad.style.padding="3px"}ad.onmouseover=function(){r(this.suggestIndex)};ad.onclick=function(){x();Q()};ad.suggestIndex=W;X.appendChild(ad)}};this.doSearch=function(){var R=m.value;h.loadItems(R)};var r=function(T){var S=(jQuery("html.u-eip").length>0);if(P.style.display!="none"){var U=P.firstChild;var R=U.childNodes.item(H);if(R){if(S){R.style.backgroundColor=""}else{R.className=""}}if(S){U.childNodes.item(T).style.backgroundColor="#ceeaf6"}else{U.childNodes.item(T).className="active"}H=T}};var x=function(){if(P&&P.style.display!="none"&&H!==null){var X=w[H].getAttribute("id");var S=k(w[H].getElementsByTagName("name")[0]);var R=w[H].getAttribute("link");var V=w[H].getElementsByTagName("basetype")[0];var U="";var T=(U=V.getAttribute("module"))?U:"";var W=(U=V.getAttribute("method"))?U:"";h.addItem(X,S,[T,W],R)}};this.addItem=function(W,T,X,U){this.delPlaceHolder();if(l[W]!==undefined){return}var Y=(jQuery("html.u-eip").length>0);var Z=document.createElement("li");var ae=document.createElement("span");var ac=document.createElement("a");var V=document.createElement("a");var ad=document.createElement("input");var aa=this;ad.type="hidden";ad.name=q;ad.value=W;V.input=ad;ac.href=U;if(t){V.appendChild(document.createTextNode("[x]"))}else{var S=document.createElement("img");S.src=O+"symlink_delete.png";S.alt="delete";if(Y){S.className="symlink-item-delete"}V.appendChild(S)}V.href="javascript:void(0);";if(Y){V.style.marginRight="5px"}else{V.className="button"}V.onclick=function(){this.input.parentNode.removeChild(this.input);v.removeChild(this.parentNode);aa.addPlaceHolder();delete l[W]};ae.dataset.basetype=X[0]+" "+X[1];if(Y){ae.style.marginLeft="5px"}ae.appendChild(document.createTextNode(T));ac.appendChild(document.createTextNode(U));if(!t){var ab=document.createElement("img");ab.src=O+"ico_"+X[0]+"_"+X[1]+".png";Z.appendChild(ab)}Z.appendChild(ae);var af=32,R=38;ae.style.maxWidth=v.parentNode.offsetWidth-(af+R)+"px";Z.appendChild(V);if(Y){delete ac}else{Z.appendChild(ac)}v.appendChild(Z);y.parentNode.insertBefore(ad,y);Z.style.backgroundColor=makeHexRgb(G);Z.startColor=G;Z.endColor=s;Z.pname=T;Z.fade=f;setTimeout(function(){Z.fade()},2000);l[W]=true;if(jQuery("#eip_page").length){frameElement.height=(jQuery("#eip_page").height()>500)?500:jQuery("#eip_page").height()}};this.delPlaceHolder=function(){if(jQuery(".eip-placeholder",v).length>=1){jQuery(".eip-placeholder",v).remove()}};this.addPlaceHolder=function(U){var R=document.createElement("li"),T=U||getLabel("js-cms-eip-symlink-no-elements"),S="eip-placeholder";R.className=S;R.appendChild(document.createTextNode(T));if(jQuery("li",v).length<1){v.appendChild(R)}};var f=function(){if(this.fadeColor==undefined){this.fadeColor=[];this.fadeColor[0]=this.startColor[0];this.fadeColor[1]=this.startColor[1];this.fadeColor[2]=this.startColor[2]}if(Math.round(this.fadeColor[0]+this.fadeColor[1]+this.fadeColor[2])==Math.round(this.endColor[0]+this.endColor[1]+this.endColor[2])){return}this.fadeColor[0]+=(this.endColor[0]-this.startColor[0])/50;this.fadeColor[1]+=(this.endColor[1]-this.startColor[1])/50;this.fadeColor[2]+=(this.endColor[2]-this.startColor[2])/50;this.style.backgroundColor=makeHexRgb(this.fadeColor);var R=this;setTimeout(function(){R.fade()},20)};var z=function(){if(P){var R=jQuery(m).offset();P.style.width=m.clientWidth;P.style.top=R.top+m.offsetHeight;P.style.left=R.left;P.style.display=""}};var Q=function(){if(P&&P.style.display!="none"){P.style.display="none";jQuery(document).unbind("mousemove",g)}};var g=function(R){if(!R){E=event.clientX+document.body.scrollLeft;D=event.clientY+document.body.scrollTop}else{E=R.pageX;D=R.pageY}return true};var k=function(R){return(R.firstChild&&R.firstChild.nodeType==3)?R.firstChild.nodeValue:R.nodeValue};L()}var hex=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function makeHexRgb(b){var a="";for(var c=0;c<3;c++){a=a+hex[Math.floor(b[c]/16)]+hex[Math.floor(b[c]%16)]}return"#"+a}(function(b,g){var d={};function c(m,n){var l,j=[];for(var k=0;k<m.length;++k){l=d[m[k]]||e(m[k]);if(!l){throw"module definition dependecy not found: "+m[k]}j.push(l)}n.apply(null,j)}function h(l,k,j){if(typeof l!=="string"){throw"invalid module definition, module id must be defined and be a string"}if(k===g){throw"invalid module definition, dependencies must be specified"}if(j===g){throw"invalid module definition, definition function must be specified"}c(k,function(){d[l]=j.apply(null,arguments)})}function f(j){return !!d[j]}function e(m){var k=b;var j=m.split(/[.\/]/);for(var l=0;l<j.length;++l){if(!k[j[l]]){return}k=k[j[l]]}return k}function a(l){for(var k=0;k<l.length;k++){var m=b;var o=l[k];var j=o.split(/[.\/]/);for(var n=0;n<j.length-1;++n){if(m[j[n]]===g){m[j[n]]={}}m=m[j[n]]}m[j[j.length-1]]=d[o]}}h("tinymce/dom/EventUtils",[],function(){var p="mce-data-";var l=/^(?:mouse|contextmenu)|click/;var k={keyLocation:1,layerX:1,layerY:1,returnValue:1};function m(t,s,u,r){if(t.addEventListener){t.addEventListener(s,u,r||false)}else{if(t.attachEvent){t.attachEvent("on"+s,u)}}}function o(t,s,u,r){if(t.removeEventListener){t.removeEventListener(s,u,r||false)}else{if(t.detachEvent){t.detachEvent("on"+s,u)}}}function j(t,x){var s,r=x||{},v;function u(){return false}function w(){return true}for(s in t){if(!k[s]){r[s]=t[s]}}if(!r.target){r.target=r.srcElement||document}if(t&&l.test(t.type)&&t.pageX===v&&t.clientX!==v){var A=r.target.ownerDocument||document;var z=A.documentElement;var y=A.body;r.pageX=t.clientX+(z&&z.scrollLeft||y&&y.scrollLeft||0)-(z&&z.clientLeft||y&&y.clientLeft||0);r.pageY=t.clientY+(z&&z.scrollTop||y&&y.scrollTop||0)-(z&&z.clientTop||y&&y.clientTop||0)}r.preventDefault=function(){r.isDefaultPrevented=w;if(t){if(t.preventDefault){t.preventDefault()}else{t.returnValue=false}}};r.stopPropagation=function(){r.isPropagationStopped=w;if(t){if(t.stopPropagation){t.stopPropagation()}else{t.cancelBubble=true}}};r.stopImmediatePropagation=function(){r.isImmediatePropagationStopped=w;r.stopPropagation()};if(!r.isDefaultPrevented){r.isDefaultPrevented=u;r.isPropagationStopped=u;r.isImmediatePropagationStopped=u}return r}function n(w,y,t){var v=w.document,u={type:"ready"};if(t.domLoaded){y(u);return}function s(){if(!t.domLoaded){t.domLoaded=true;y(u)}}function r(){if(v.readyState==="complete"){o(v,"readystatechange",r);s()}}function x(){try{v.documentElement.doScroll("left")}catch(z){setTimeout(x,0);return}s()}if(v.addEventListener){m(w,"DOMContentLoaded",s)}else{m(v,"readystatechange",r);if(v.documentElement.doScroll&&w===w.top){x()}}m(w,"load",s)}function q(){var r=this,t={},v,y,s,u,x;y=p+(+new Date()).toString(32);u="onmouseenter" in document.documentElement;s="onfocusin" in document.documentElement;x={mouseenter:"mouseover",mouseleave:"mouseout"};v=1;r.domLoaded=false;r.events=t;function w(C,F){var B,D,A,E,z=t[F];B=z&&z[C.type];if(B){for(D=0,A=B.length;D<A;D++){E=B[D];if(E&&E.func.call(E.scope,C)===false){C.preventDefault()}if(C.isImmediatePropagationStopped()){return}}}}r.bind=function(E,H,K,L){var A,B,C,z,I,G,J,D=window;function F(M){w(j(M||D.event),A)}if(!E||E.nodeType===3||E.nodeType===8){return}if(!E[y]){A=v++;E[y]=A;t[A]={}}else{A=E[y]}L=L||E;H=H.split(" ");C=H.length;while(C--){z=H[C];G=F;I=J=false;if(z==="DOMContentLoaded"){z="ready"}if(r.domLoaded&&z==="ready"&&E.readyState=="complete"){K.call(L,j({type:z}));continue}if(!u){I=x[z];if(I){G=function(M){var O,N;O=M.currentTarget;N=M.relatedTarget;if(N&&O.contains){N=O.contains(N)}else{while(N&&N!==O){N=N.parentNode}}if(!N){M=j(M||D.event);M.type=M.type==="mouseout"?"mouseleave":"mouseenter";M.target=O;w(M,A)}}}}if(!s&&(z==="focusin"||z==="focusout")){J=true;I=z==="focusin"?"focus":"blur";G=function(M){M=j(M||D.event);M.type=M.type==="focus"?"focusin":"focusout";w(M,A)}}B=t[A][z];if(!B){t[A][z]=B=[{func:K,scope:L}];B.fakeName=I;B.capture=J;B.nativeHandler=G;if(z==="ready"){n(E,G,r)}else{m(E,I||z,G,J)}}else{if(z==="ready"&&r.domLoaded){K({type:z})}else{B.push({func:K,scope:L})}}}E=B=0;return K};r.unbind=function(E,H,I){var A,C,D,J,z,B;if(!E||E.nodeType===3||E.nodeType===8){return r}A=E[y];if(A){B=t[A];if(H){H=H.split(" ");D=H.length;while(D--){z=H[D];C=B[z];if(C){if(I){J=C.length;while(J--){if(C[J].func===I){var G=C.nativeHandler;C=C.slice(0,J).concat(C.slice(J+1));C.nativeHandler=G;B[z]=C}}}if(!I||C.length===0){delete B[z];o(E,C.fakeName||z,C.nativeHandler,C.capture)}}}}else{for(z in B){C=B[z];o(E,C.fakeName||z,C.nativeHandler,C.capture)}B={}}for(z in B){return r}delete t[A];try{delete E[y]}catch(F){E[y]=null}}return r};r.fire=function(B,A,z){var C;if(!B||B.nodeType===3||B.nodeType===8){return r}z=j(null,z);z.type=A;z.target=B;do{C=B[y];if(C){w(z,C)}B=B.parentNode||B.ownerDocument||B.defaultView||B.parentWindow}while(B&&!z.isPropagationStopped());return r};r.clean=function(C){var A,z,B=r.unbind;if(!C||C.nodeType===3||C.nodeType===8){return r}if(C[y]){B(C)}if(!C.getElementsByTagName){C=C.document}if(C&&C.getElementsByTagName){B(C);z=C.getElementsByTagName("*");A=z.length;while(A--){C=z[A];if(C[y]){B(C)}}}return r};r.destroy=function(){t={}};r.cancel=function(z){if(z){z.preventDefault();z.stopImmediatePropagation()}return false}}q.Event=new q();q.Event.bind(window,"ready",function(){});return q});h("tinymce/dom/Sizzle",[],function(){var L,r,B,V,Z,aj,aI,X,W,am,P,C,aw,aq,aD,q,T,ay="sizzle"+-(new Date()),Y=window.document,aF={},aG=0,ar=0,l=N(),ax=N(),U=N(),ak=false,R=function(){return 0},aC=typeof g,ae=1<<31,aA=[],aB=aA.pop,ab=aA.push,k=aA.push,A=aA.slice,p=aA.indexOf||function(aL){var aK=0,aJ=this.length;for(;aK<aJ;aK++){if(this[aK]===aL){return aK}}return -1},D="[\\x20\\t\\r\\n\\f]",j="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",aa=j.replace("w","w#"),w="([*^$|!~]?=)",au="\\["+D+"*("+j+")"+D+"*(?:"+w+D+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+aa+")|)|)"+D+"*\\]",y=":("+j+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+au.replace(3,8)+")*)|.*)\\)|)",F=new RegExp("^"+D+"+|((?:^|[^\\\\])(?:\\\\.)*)"+D+"+$","g"),I=new RegExp("^"+D+"*,"+D+"*"),O=new RegExp("^"+D+"*([\\x20\\t\\r\\n\\f>+~])"+D+"*"),ag=new RegExp(y),ah=new RegExp("^"+aa+"$"),ap={ID:new RegExp("^#("+j+")"),CLASS:new RegExp("^\\.("+j+")"),NAME:new RegExp("^\\[name=['\"]?("+j+")['\"]?\\]"),TAG:new RegExp("^("+j.replace("w","w*")+")"),ATTR:new RegExp("^"+au),PSEUDO:new RegExp("^"+y),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+D+"*(even|odd|(([+-]|)(\\d*)n|)"+D+"*(?:([+-]|)"+D+"*(\\d+)|))"+D+"*\\)|)","i"),needsContext:new RegExp("^"+D+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+D+"*((?:-\\d)?\\d*)"+D+"*\\)|)(?=[^-]|$)","i")},an=/[\x20\t\r\n\f]*[+~]/,ad=/^[^{]+\{\s*\[native code/,af=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,o=/^(?:input|select|textarea|button)$/i,z=/^h\d$/i,ac=/'|\\/g,H=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,G=/\\([\da-fA-F]{1,6}[\x20\t\r\n\f]?|.)/g,at=function(aJ,aL){var aK="0x"+aL-65536;return aK!==aK?aL:aK<0?String.fromCharCode(aK+65536):String.fromCharCode(aK>>10|55296,aK&1023|56320)};try{k.apply((aA=A.call(Y.childNodes)),Y.childNodes);aA[Y.childNodes.length].nodeType}catch(Q){k={apply:aA.length?function(aK,aJ){ab.apply(aK,A.call(aJ))}:function(aM,aL){var aJ=aM.length,aK=0;while((aM[aJ++]=aL[aK++])){}aM.length=aJ-1}}}function S(aJ){return ad.test(aJ+"")}function N(){var aJ,aK=[];aJ=function(aL,aM){if(aK.push(aL+=" ")>B.cacheLength){delete aJ[aK.shift()]}aJ[aL]=aM;return aM};return aJ}function x(aJ){aJ[ay]=true;return aJ}function s(aJ){var aL=P.createElement("div");try{return !!aJ(aL)}catch(aK){return false}finally{aL=null}}function J(aR,aK,aV,aX){var aW,aO,aP,aT,aU,aN,aM,aJ,aL,aS;if((aK?aK.ownerDocument||aK:Y)!==P){am(aK)}aK=aK||P;aV=aV||[];if(!aR||typeof aR!=="string"){return aV}if((aT=aK.nodeType)!==1&&aT!==9){return[]}if(aw&&!aX){if((aW=af.exec(aR))){if((aP=aW[1])){if(aT===9){aO=aK.getElementById(aP);if(aO&&aO.parentNode){if(aO.id===aP){aV.push(aO);return aV}}else{return aV}}else{if(aK.ownerDocument&&(aO=aK.ownerDocument.getElementById(aP))&&T(aK,aO)&&aO.id===aP){aV.push(aO);return aV}}}else{if(aW[2]){k.apply(aV,aK.getElementsByTagName(aR));return aV}else{if((aP=aW[3])&&aF.getElementsByClassName&&aK.getElementsByClassName){k.apply(aV,aK.getElementsByClassName(aP));return aV}}}}if(aF.qsa&&!aq.test(aR)){aM=true;aJ=ay;aL=aK;aS=aT===9&&aR;if(aT===1&&aK.nodeName.toLowerCase()!=="object"){aN=u(aR);if((aM=aK.getAttribute("id"))){aJ=aM.replace(ac,"\\$&")}else{aK.setAttribute("id",aJ)}aJ="[id='"+aJ+"'] ";aU=aN.length;while(aU--){aN[aU]=aJ+v(aN[aU])}aL=an.test(aR)&&aK.parentNode||aK;aS=aN.join(",")}if(aS){try{k.apply(aV,aL.querySelectorAll(aS));return aV}catch(aQ){}finally{if(!aM){aK.removeAttribute("id")}}}}}return aE(aR.replace(F,"$1"),aK,aV,aX)}Z=J.isXML=function(aJ){var aK=aJ&&(aJ.ownerDocument||aJ).documentElement;return aK?aK.nodeName!=="HTML":false};am=J.setDocument=function(aJ){var aK=aJ?aJ.ownerDocument||aJ:Y;if(aK===P||aK.nodeType!==9||!aK.documentElement){return P}P=aK;C=aK.documentElement;aw=!Z(aK);aF.getElementsByTagName=s(function(aL){aL.appendChild(aK.createComment(""));return !aL.getElementsByTagName("*").length});aF.attributes=s(function(aM){aM.innerHTML="<select></select>";var aL=typeof aM.lastChild.getAttribute("multiple");return aL!=="boolean"&&aL!=="string"});aF.getElementsByClassName=s(function(aL){aL.innerHTML="<div class='hidden e'></div><div class='hidden'></div>";if(!aL.getElementsByClassName||!aL.getElementsByClassName("e").length){return false}aL.lastChild.className="e";return aL.getElementsByClassName("e").length===2});aF.getByName=s(function(aM){aM.id=ay+0;aM.appendChild(P.createElement("a")).setAttribute("name",ay);aM.appendChild(P.createElement("i")).setAttribute("name",ay);C.appendChild(aM);var aL=aK.getElementsByName&&aK.getElementsByName(ay).length===2+aK.getElementsByName(ay+0).length;C.removeChild(aM);return aL});aF.sortDetached=s(function(aL){return aL.compareDocumentPosition&&(aL.compareDocumentPosition(P.createElement("div"))&1)});B.attrHandle=s(function(aL){aL.innerHTML="<a href='#'></a>";return aL.firstChild&&typeof aL.firstChild.getAttribute!==aC&&aL.firstChild.getAttribute("href")==="#"})?{}:{href:function(aL){return aL.getAttribute("href",2)},type:function(aL){return aL.getAttribute("type")}};if(aF.getByName){B.find.ID=function(aN,aM){if(typeof aM.getElementById!==aC&&aw){var aL=aM.getElementById(aN);return aL&&aL.parentNode?[aL]:[]}};B.filter.ID=function(aM){var aL=aM.replace(G,at);return function(aN){return aN.getAttribute("id")===aL}}}else{B.find.ID=function(aN,aM){if(typeof aM.getElementById!==aC&&aw){var aL=aM.getElementById(aN);return aL?aL.id===aN||typeof aL.getAttributeNode!==aC&&aL.getAttributeNode("id").value===aN?[aL]:g:[]}};B.filter.ID=function(aM){var aL=aM.replace(G,at);return function(aO){var aN=typeof aO.getAttributeNode!==aC&&aO.getAttributeNode("id");return aN&&aN.value===aL}}}B.find.TAG=aF.getElementsByTagName?function(aL,aM){if(typeof aM.getElementsByTagName!==aC){return aM.getElementsByTagName(aL)}}:function(aL,aP){var aQ,aO=[],aN=0,aM=aP.getElementsByTagName(aL);if(aL==="*"){while((aQ=aM[aN++])){if(aQ.nodeType===1){aO.push(aQ)}}return aO}return aM};B.find.NAME=aF.getByName&&function(aL,aM){if(typeof aM.getElementsByName!==aC){return aM.getElementsByName(name)}};B.find.CLASS=aF.getElementsByClassName&&function(aM,aL){if(typeof aL.getElementsByClassName!==aC&&aw){return aL.getElementsByClassName(aM)}};aD=[];aq=[":focus"];if((aF.qsa=S(aK.querySelectorAll))){s(function(aL){aL.innerHTML="<select><option selected=''></option></select>";if(!aL.querySelectorAll("[selected]").length){aq.push("\\["+D+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)")}if(!aL.querySelectorAll(":checked").length){aq.push(":checked")}});s(function(aL){aL.innerHTML="<input type='hidden' i=''/>";if(aL.querySelectorAll("[i^='']").length){aq.push("[*^$]="+D+"*(?:\"\"|'')")}if(!aL.querySelectorAll(":enabled").length){aq.push(":enabled",":disabled")}aL.querySelectorAll("*,:x");aq.push(",.*:")})}if((aF.matchesSelector=S((q=C.matchesSelector||C.mozMatchesSelector||C.webkitMatchesSelector||C.oMatchesSelector||C.msMatchesSelector)))){s(function(aL){aF.disconnectedMatch=q.call(aL,"div");q.call(aL,"[s!='']:x");aD.push("!=",y)})}aq=new RegExp(aq.join("|"));aD=aD.length&&new RegExp(aD.join("|"));T=S(C.contains)||C.compareDocumentPosition?function(aM,aL){var aO=aM.nodeType===9?aM.documentElement:aM,aN=aL&&aL.parentNode;return aM===aN||!!(aN&&aN.nodeType===1&&(aO.contains?aO.contains(aN):aM.compareDocumentPosition&&aM.compareDocumentPosition(aN)&16))}:function(aM,aL){if(aL){while((aL=aL.parentNode)){if(aL===aM){return true}}}return false};R=C.compareDocumentPosition?function(aM,aL){if(aM===aL){ak=true;return 0}var aN=aL.compareDocumentPosition&&aM.compareDocumentPosition&&aM.compareDocumentPosition(aL);if(aN){if(aN&1||(X&&aL.compareDocumentPosition(aM)===aN)){if(aM===aK||T(Y,aM)){return -1}if(aL===aK||T(Y,aL)){return 1}return W?(p.call(W,aM)-p.call(W,aL)):0}return aN&4?-1:1}return aM.compareDocumentPosition?-1:1}:function(aM,aL){var aS,aP=0,aR=aM.parentNode,aO=aL.parentNode,aN=[aM],aQ=[aL];if(aM===aL){ak=true;return 0}else{if(!aR||!aO){return aM===aK?-1:aL===aK?1:aR?-1:aO?1:0}else{if(aR===aO){return m(aM,aL)}}}aS=aM;while((aS=aS.parentNode)){aN.unshift(aS)}aS=aL;while((aS=aS.parentNode)){aQ.unshift(aS)}while(aN[aP]===aQ[aP]){aP++}return aP?m(aN[aP],aQ[aP]):aN[aP]===Y?-1:aQ[aP]===Y?1:0};return P};J.matches=function(aK,aJ){return J(aK,null,null,aJ)};J.matchesSelector=function(aK,aM){if((aK.ownerDocument||aK)!==P){am(aK)}aM=aM.replace(H,"='$1']");if(aF.matchesSelector&&aw&&(!aD||!aD.test(aM))&&!aq.test(aM)){try{var aJ=q.call(aK,aM);if(aJ||aF.disconnectedMatch||aK.document&&aK.document.nodeType!==11){return aJ}}catch(aL){}}return J(aM,P,null,[aK]).length>0};J.contains=function(aJ,aK){if((aJ.ownerDocument||aJ)!==P){am(aJ)}return T(aJ,aK)};J.attr=function(aK,aJ){var aL;if((aK.ownerDocument||aK)!==P){am(aK)}if(aw){aJ=aJ.toLowerCase()}if((aL=B.attrHandle[aJ])){return aL(aK)}if(!aw||aF.attributes){return aK.getAttribute(aJ)}return((aL=aK.getAttributeNode(aJ))||aK.getAttribute(aJ))&&aK[aJ]===true?aJ:aL&&aL.specified?aL.value:null};J.error=function(aJ){throw new Error("Syntax error, unrecognized expression: "+aJ)};J.uniqueSort=function(aL){var aM,aN=[],aJ=0,aK=0;ak=!aF.detectDuplicates;X=!aF.sortDetached;W=!aF.sortStable&&aL.slice(0);aL.sort(R);if(ak){while((aM=aL[aK++])){if(aM===aL[aK]){aJ=aN.push(aK)}}while(aJ--){aL.splice(aN[aJ],1)}}return aL};function m(aK,aJ){var aM=aJ&&aK,aL=aM&&(~aJ.sourceIndex||ae)-(~aK.sourceIndex||ae);if(aL){return aL}if(aM){while((aM=aM.nextSibling)){if(aM===aJ){return -1}}}return aK?1:-1}function K(aJ){return function(aL){var aK=aL.nodeName.toLowerCase();return aK==="input"&&aL.type===aJ}}function n(aJ){return function(aL){var aK=aL.nodeName.toLowerCase();return(aK==="input"||aK==="button")&&aL.type===aJ}}function av(aJ){return x(function(aK){aK=+aK;return x(function(aL,aP){var aN,aM=aJ([],aL.length,aK),aO=aM.length;while(aO--){if(aL[(aN=aM[aO])]){aL[aN]=!(aP[aN]=aL[aN])}}})})}V=J.getText=function(aN){var aM,aK="",aL=0,aJ=aN.nodeType;if(!aJ){for(;(aM=aN[aL]);aL++){aK+=V(aM)}}else{if(aJ===1||aJ===9||aJ===11){if(typeof aN.textContent==="string"){return aN.textContent}else{for(aN=aN.firstChild;aN;aN=aN.nextSibling){aK+=V(aN)}}}else{if(aJ===3||aJ===4){return aN.nodeValue}}}return aK};B=J.selectors={cacheLength:50,createPseudo:x,match:ap,find:{},relative:{">":{dir:"parentNode",first:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:true},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(aJ){aJ[1]=aJ[1].replace(G,at);aJ[3]=(aJ[4]||aJ[5]||"").replace(G,at);if(aJ[2]==="~="){aJ[3]=" "+aJ[3]+" "}return aJ.slice(0,4)},CHILD:function(aJ){aJ[1]=aJ[1].toLowerCase();if(aJ[1].slice(0,3)==="nth"){if(!aJ[3]){J.error(aJ[0])}aJ[4]=+(aJ[4]?aJ[5]+(aJ[6]||1):2*(aJ[3]==="even"||aJ[3]==="odd"));aJ[5]=+((aJ[7]+aJ[8])||aJ[3]==="odd")}else{if(aJ[3]){J.error(aJ[0])}}return aJ},PSEUDO:function(aK){var aJ,aL=!aK[5]&&aK[2];if(ap.CHILD.test(aK[0])){return null}if(aK[4]){aK[2]=aK[4]}else{if(aL&&ag.test(aL)&&(aJ=u(aL,true))&&(aJ=aL.indexOf(")",aL.length-aJ)-aL.length)){aK[0]=aK[0].slice(0,aJ);aK[2]=aL.slice(0,aJ)}}return aK.slice(0,3)}},filter:{TAG:function(aJ){if(aJ==="*"){return function(){return true}}aJ=aJ.replace(G,at).toLowerCase();return function(aK){return aK.nodeName&&aK.nodeName.toLowerCase()===aJ}},CLASS:function(aJ){var aK=l[aJ+" "];return aK||(aK=new RegExp("(^|"+D+")"+aJ+"("+D+"|$)"))&&l(aJ,function(aL){return aK.test(aL.className||(typeof aL.getAttribute!==aC&&aL.getAttribute("class"))||"")})},ATTR:function(aL,aK,aJ){return function(aN){var aM=J.attr(aN,aL);if(aM==null){return aK==="!="}if(!aK){return true}aM+="";return aK==="="?aM===aJ:aK==="!="?aM!==aJ:aK==="^="?aJ&&aM.indexOf(aJ)===0:aK==="*="?aJ&&aM.indexOf(aJ)>-1:aK==="$="?aJ&&aM.slice(-aJ.length)===aJ:aK==="~="?(" "+aM+" ").indexOf(aJ)>-1:aK==="|="?aM===aJ||aM.slice(0,aJ.length+1)===aJ+"-":false}},CHILD:function(aK,aN,aM,aO,aL){var aQ=aK.slice(0,3)!=="nth",aJ=aK.slice(-4)!=="last",aP=aN==="of-type";return aO===1&&aL===0?function(aR){return !!aR.parentNode}:function(aX,aV,a0){var aR,a3,aY,a2,aZ,aU,aW=aQ!==aJ?"nextSibling":"previousSibling",a1=aX.parentNode,aT=aP&&aX.nodeName.toLowerCase(),aS=!a0&&!aP;if(a1){if(aQ){while(aW){aY=aX;while((aY=aY[aW])){if(aP?aY.nodeName.toLowerCase()===aT:aY.nodeType===1){return false}}aU=aW=aK==="only"&&!aU&&"nextSibling"}return true}aU=[aJ?a1.firstChild:a1.lastChild];if(aJ&&aS){a3=a1[ay]||(a1[ay]={});aR=a3[aK]||[];aZ=aR[0]===aG&&aR[1];a2=aR[0]===aG&&aR[2];aY=aZ&&a1.childNodes[aZ];while((aY=++aZ&&aY&&aY[aW]||(a2=aZ=0)||aU.pop())){if(aY.nodeType===1&&++a2&&aY===aX){a3[aK]=[aG,aZ,a2];break}}}else{if(aS&&(aR=(aX[ay]||(aX[ay]={}))[aK])&&aR[0]===aG){a2=aR[1]}else{while((aY=++aZ&&aY&&aY[aW]||(a2=aZ=0)||aU.pop())){if((aP?aY.nodeName.toLowerCase()===aT:aY.nodeType===1)&&++a2){if(aS){(aY[ay]||(aY[ay]={}))[aK]=[aG,a2]}if(aY===aX){break}}}}}a2-=aL;return a2===aO||(a2%aO===0&&a2/aO>=0)}}},PSEUDO:function(aM,aL){var aJ,aK=B.pseudos[aM]||B.setFilters[aM.toLowerCase()]||J.error("unsupported pseudo: "+aM);if(aK[ay]){return aK(aL)}if(aK.length>1){aJ=[aM,aM,"",aL];return B.setFilters.hasOwnProperty(aM.toLowerCase())?x(function(aP,aR){var aO,aN=aK(aP,aL),aQ=aN.length;while(aQ--){aO=p.call(aP,aN[aQ]);aP[aO]=!(aR[aO]=aN[aQ])}}):function(aN){return aK(aN,0,aJ)}}return aK}},pseudos:{not:x(function(aJ){var aK=[],aL=[],aM=aj(aJ.replace(F,"$1"));return aM[ay]?x(function(aO,aT,aR,aP){var aS,aN=aM(aO,null,aP,[]),aQ=aO.length;while(aQ--){if((aS=aN[aQ])){aO[aQ]=!(aT[aQ]=aS)}}}):function(aP,aO,aN){aK[0]=aP;aM(aK,null,aN,aL);return !aL.pop()}}),has:x(function(aJ){return function(aK){return J(aJ,aK).length>0}}),contains:x(function(aJ){return function(aK){return(aK.textContent||aK.innerText||V(aK)).indexOf(aJ)>-1}}),lang:x(function(aJ){if(!ah.test(aJ||"")){J.error("unsupported lang: "+aJ)}aJ=aJ.replace(G,at).toLowerCase();return function(aL){var aK;do{if((aK=aw?aL.lang:aL.getAttribute("xml:lang")||aL.getAttribute("lang"))){aK=aK.toLowerCase();return aK===aJ||aK.indexOf(aJ+"-")===0}}while((aL=aL.parentNode)&&aL.nodeType===1);return false}}),target:function(aJ){var aK=window.location&&window.location.hash;return aK&&aK.slice(1)===aJ.id},root:function(aJ){return aJ===C},focus:function(aJ){return aJ===P.activeElement&&(!P.hasFocus||P.hasFocus())&&!!(aJ.type||aJ.href||~aJ.tabIndex)},enabled:function(aJ){return aJ.disabled===false},disabled:function(aJ){return aJ.disabled===true},checked:function(aJ){var aK=aJ.nodeName.toLowerCase();return(aK==="input"&&!!aJ.checked)||(aK==="option"&&!!aJ.selected)},selected:function(aJ){if(aJ.parentNode){aJ.parentNode.selectedIndex}return aJ.selected===true},empty:function(aJ){for(aJ=aJ.firstChild;aJ;aJ=aJ.nextSibling){if(aJ.nodeName>"@"||aJ.nodeType===3||aJ.nodeType===4){return false}}return true},parent:function(aJ){return !B.pseudos.empty(aJ)},header:function(aJ){return z.test(aJ.nodeName)},input:function(aJ){return o.test(aJ.nodeName)},button:function(aK){var aJ=aK.nodeName.toLowerCase();return aJ==="input"&&aK.type==="button"||aJ==="button"},text:function(aK){var aJ;return aK.nodeName.toLowerCase()==="input"&&aK.type==="text"&&((aJ=aK.getAttribute("type"))==null||aJ.toLowerCase()===aK.type)},first:av(function(){return[0]}),last:av(function(aJ,aK){return[aK-1]}),eq:av(function(aJ,aL,aK){return[aK<0?aK+aL:aK]}),even:av(function(aJ,aL){var aK=0;for(;aK<aL;aK+=2){aJ.push(aK)}return aJ}),odd:av(function(aJ,aL){var aK=1;for(;aK<aL;aK+=2){aJ.push(aK)}return aJ}),lt:av(function(aJ,aM,aL){var aK=aL<0?aL+aM:aL;for(;--aK>=0;){aJ.push(aK)}return aJ}),gt:av(function(aJ,aM,aL){var aK=aL<0?aL+aM:aL;for(;++aK<aM;){aJ.push(aK)}return aJ})}};for(L in {radio:true,checkbox:true,file:true,password:true,image:true}){B.pseudos[L]=K(L)}for(L in {submit:true,reset:true}){B.pseudos[L]=n(L)}function u(aN,aS){var aK,aO,aQ,aR,aP,aL,aJ,aM=ax[aN+" "];if(aM){return aS?0:aM.slice(0)}aP=aN;aL=[];aJ=B.preFilter;while(aP){if(!aK||(aO=I.exec(aP))){if(aO){aP=aP.slice(aO[0].length)||aP}aL.push(aQ=[])}aK=false;if((aO=O.exec(aP))){aK=aO.shift();aQ.push({value:aK,type:aO[0].replace(F," ")});aP=aP.slice(aK.length)}for(aR in B.filter){if((aO=ap[aR].exec(aP))&&(!aJ[aR]||(aO=aJ[aR](aO)))){aK=aO.shift();aQ.push({value:aK,type:aR,matches:aO});aP=aP.slice(aK.length)}}if(!aK){break}}return aS?aP.length:aP?J.error(aN):ax(aN,aL).slice(0)}function v(aM){var aL=0,aK=aM.length,aJ="";for(;aL<aK;aL++){aJ+=aM[aL].value}return aJ}function E(aN,aL,aM){var aJ=aL.dir,aO=aM&&aJ==="parentNode",aK=ar++;return aL.first?function(aR,aQ,aP){while((aR=aR[aJ])){if(aR.nodeType===1||aO){return aN(aR,aQ,aP)}}}:function(aT,aR,aQ){var aV,aP,aS,aU=aG+" "+aK;if(aQ){while((aT=aT[aJ])){if(aT.nodeType===1||aO){if(aN(aT,aR,aQ)){return true}}}}else{while((aT=aT[aJ])){if(aT.nodeType===1||aO){aS=aT[ay]||(aT[ay]={});if((aP=aS[aJ])&&aP[0]===aU){if((aV=aP[1])===true||aV===r){return aV===true}}else{aP=aS[aJ]=[aU];aP[1]=aN(aT,aR,aQ)||r;if(aP[1]===true){return true}}}}}}}function aH(aJ){return aJ.length>1?function(aN,aM,aK){var aL=aJ.length;while(aL--){if(!aJ[aL](aN,aM,aK)){return false}}return true}:aJ[0]}function ao(aJ,aK,aL,aM,aP){var aN,aS=[],aO=0,aQ=aJ.length,aR=aK!=null;for(;aO<aQ;aO++){if((aN=aJ[aO])){if(!aL||aL(aN,aM,aP)){aS.push(aN);if(aR){aK.push(aO)}}}}return aS}function t(aL,aK,aN,aM,aO,aJ){if(aM&&!aM[ay]){aM=t(aM)}if(aO&&!aO[ay]){aO=t(aO,aJ)}return x(function(aZ,aW,aR,aY){var a1,aX,aT,aS=[],a0=[],aQ=aW.length,aP=aZ||M(aK||"*",aR.nodeType?[aR]:aR,[]),aU=aL&&(aZ||!aK)?ao(aP,aS,aL,aR,aY):aP,aV=aN?aO||(aZ?aL:aQ||aM)?[]:aW:aU;if(aN){aN(aU,aV,aR,aY)}if(aM){a1=ao(aV,a0);aM(a1,[],aR,aY);aX=a1.length;while(aX--){if((aT=a1[aX])){aV[a0[aX]]=!(aU[a0[aX]]=aT)}}}if(aZ){if(aO||aL){if(aO){a1=[];aX=aV.length;while(aX--){if((aT=aV[aX])){a1.push((aU[aX]=aT))}}aO(null,(aV=[]),a1,aY)}aX=aV.length;while(aX--){if((aT=aV[aX])&&(a1=aO?p.call(aZ,aT):aS[aX])>-1){aZ[a1]=!(aW[a1]=aT)}}}}else{aV=ao(aV===aW?aV.splice(aQ,aV.length):aV);if(aO){aO(null,aW,aV,aY)}else{k.apply(aW,aV)}}})}function az(aP){var aK,aN,aL,aO=aP.length,aS=B.relative[aP[0].type],aT=aS||B.relative[" "],aM=aS?1:0,aQ=E(function(aU){return aU===aK},aT,true),aR=E(function(aU){return p.call(aK,aU)>-1},aT,true),aJ=[function(aW,aV,aU){return(!aS&&(aU||aV!==aI))||((aK=aV).nodeType?aQ(aW,aV,aU):aR(aW,aV,aU))}];for(;aM<aO;aM++){if((aN=B.relative[aP[aM].type])){aJ=[E(aH(aJ),aN)]}else{aN=B.filter[aP[aM].type].apply(null,aP[aM].matches);if(aN[ay]){aL=++aM;for(;aL<aO;aL++){if(B.relative[aP[aL].type]){break}}return t(aM>1&&aH(aJ),aM>1&&v(aP.slice(0,aM-1)).replace(F,"$1"),aN,aM<aL&&az(aP.slice(aM,aL)),aL<aO&&az((aP=aP.slice(aL))),aL<aO&&v(aP))}aJ.push(aN)}}return aH(aJ)}function al(aM,aL){var aO=0,aJ=aL.length>0,aN=aM.length>0,aK=function(aY,aS,aX,aW,a4){var aT,aU,aZ,a3=[],a2=0,aV="0",aP=aY&&[],a0=a4!=null,a1=aI,aR=aY||aN&&B.find.TAG("*",a4&&aS.parentNode||aS),aQ=(aG+=a1==null?1:Math.random()||0.1);if(a0){aI=aS!==P&&aS;r=aO}for(;(aT=aR[aV])!=null;aV++){if(aN&&aT){aU=0;while((aZ=aM[aU++])){if(aZ(aT,aS,aX)){aW.push(aT);break}}if(a0){aG=aQ;r=++aO}}if(aJ){if((aT=!aZ&&aT)){a2--}if(aY){aP.push(aT)}}}a2+=aV;if(aJ&&aV!==a2){aU=0;while((aZ=aL[aU++])){aZ(aP,a3,aS,aX)}if(aY){if(a2>0){while(aV--){if(!(aP[aV]||a3[aV])){a3[aV]=aB.call(aW)}}}a3=ao(a3)}k.apply(aW,a3);if(a0&&!aY&&a3.length>0&&(a2+aL.length)>1){J.uniqueSort(aW)}}if(a0){aG=aQ;aI=a1}return aP};return aJ?x(aK):aK}aj=J.compile=function(aJ,aO){var aL,aK=[],aN=[],aM=U[aJ+" "];if(!aM){if(!aO){aO=u(aJ)}aL=aO.length;while(aL--){aM=az(aO[aL]);if(aM[ay]){aK.push(aM)}else{aN.push(aM)}}aM=U(aJ,al(aN,aK))}return aM};function M(aK,aN,aM){var aL=0,aJ=aN.length;for(;aL<aJ;aL++){J(aK,aN[aL],aM)}return aM}function aE(aL,aJ,aM,aP){var aN,aR,aK,aS,aQ,aO=u(aL);if(!aP){if(aO.length===1){aR=aO[0]=aO[0].slice(0);if(aR.length>2&&(aK=aR[0]).type==="ID"&&aJ.nodeType===9&&aw&&B.relative[aR[1].type]){aJ=(B.find.ID(aK.matches[0].replace(G,at),aJ)||[])[0];if(!aJ){return aM}aL=aL.slice(aR.shift().value.length)}aN=ap.needsContext.test(aL)?0:aR.length;while(aN--){aK=aR[aN];if(B.relative[(aS=aK.type)]){break}if((aQ=B.find[aS])){if((aP=aQ(aK.matches[0].replace(G,at),an.test(aR[0].type)&&aJ.parentNode||aJ))){aR.splice(aN,1);aL=aP.length&&v(aR);if(!aL){k.apply(aM,aP);return aM}break}}}}}aj(aL,aO)(aP,aJ,!aw,aM,an.test(aL));return aM}B.pseudos.nth=B.pseudos.eq;function ai(){}ai.prototype=B.filters=B.pseudos;B.setFilters=new ai();aF.sortStable=ay.split("").sort(R).join("")===ay;am();[0,0].sort(R);aF.detectDuplicates=ak;if(typeof h==="function"&&h.amd){h(function(){return J})}else{window.Sizzle=J}return J});h("tinymce/dom/DomQuery",["tinymce/dom/EventUtils","tinymce/dom/Sizzle"],function(p,m){var G=document,q=Array.prototype.push,y=Array.prototype.slice;var u=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/;var F=p.Event;function k(H){return typeof H!=="undefined"}function s(H){return typeof H==="string"}function x(I){var K,J,H;H=G.createElement("div");K=G.createDocumentFragment();H.innerHTML=I;while((J=H.firstChild)){K.appendChild(J)}return K}function t(H,J,K){var I;if(typeof J==="string"){J=x(J)}else{if(J.length){for(I=0;I<J.length;I++){t(H,J[I],K)}return H}}I=H.length;while(I--){K.call(H[I],J.parentNode?J:J)}return H}function l(I,H){return I&&H&&(" "+I.className+" ").indexOf(" "+H+" ")!==-1}function v(H,J){var I;H=H||[];if(typeof(H)=="string"){H=H.split(" ")}J=J||{};I=H.length;while(I--){J[H[I]]={}}return J}var j=v("fillOpacity fontWeight lineHeight opacity orphans widows zIndex zoom");function n(H,I){return new n.fn.init(H,I)}function D(L){var I=arguments,H,K,J;for(K=1;K<I.length;K++){H=I[K];for(J in H){L[J]=H[J]}}return L}function z(J){var K=[],I,H;for(I=0,H=J.length;I<H;I++){K[I]=J[I]}return K}function B(I,J){var H;if(J.indexOf){return J.indexOf(I)}H=J.length;while(H--){if(J[H]===I){return H}}return -1}var r=Array.isArray||function(H){return Object.prototype.toString.call(H)==="[object Array]"};var E=/^\s*|\s*$/g;var A=function(H){return(H===null||H===g)?"":(""+H).replace(E,"")};function o(M,N){var K,I,H,J,L;if(M){K=M.length;if(K===J){for(I in M){if(M.hasOwnProperty(I)){L=M[I];if(N.call(L,L,I)===false){break}}}}else{for(H=0;H<K;H++){L=M[H];if(N.call(L,L,I)===false){break}}}}return M}n.fn=n.prototype={constructor:n,selector:"",length:0,init:function(H,K){var I=this,J,L;if(!H){return I}if(H.nodeType){I.context=I[0]=H;I.length=1;return I}if(s(H)){if(H.charAt(0)==="<"&&H.charAt(H.length-1)===">"&&H.length>=3){J=[null,H,null]}else{J=u.exec(H)}if(J){if(J[1]){L=x(H).firstChild;while(L){this.add(L);L=L.nextSibling}}else{L=G.getElementById(J[2]);if(L.id!==J[2]){return I.find(H)}I.length=1;I[0]=L}}else{return n(K||document).find(H)}}else{this.add(H)}return I},toArray:function(){return z(this)},add:function(I){var H=this;if(!r(I)){if(I instanceof n){H.add(I.toArray())}else{q.call(H,I)}}else{q.apply(H,I)}return H},attr:function(I,J){var H=this;if(typeof I==="object"){o(I,function(L,K){H.attr(K,L)})}else{if(k(J)){this.each(function(){if(this.nodeType===1){this.setAttribute(I,J)}})}else{return H[0]&&H[0].nodeType===1?H[0].getAttribute(I):g}}return H},css:function(I,J){var H=this;if(typeof I==="object"){o(I,function(L,K){H.css(K,L)})}else{I=I.replace(/-(\D)/g,function(L,K){return K.toUpperCase()});if(k(J)){if(typeof(J)==="number"&&!j[I]){J+="px"}H.each(function(){var L=this.style;if(I==="opacity"&&this.runtimeStyle&&typeof(this.runtimeStyle.opacity)==="undefined"){L.filter=J===""?"":"alpha(opacity="+(J*100)+")"}try{L[I]=J}catch(K){}})}else{return H[0]?H[0].style[I]:g}}return H},remove:function(){var H=this,J,I=this.length;while(I--){J=H[I];F.clean(J);if(J.parentNode){J.parentNode.removeChild(J)}}return this},empty:function(){var H=this,J,I=this.length;while(I--){J=H[I];while(J.firstChild){J.removeChild(J.firstChild)}}return this},html:function(J){var H=this,I;if(k(J)){I=H.length;while(I--){H[I].innerHTML=J}return H}return H[0]?H[0].innerHTML:""},text:function(J){var H=this,I;if(k(J)){I=H.length;while(I--){H[I].innerText=H[0].textContent=J}return H}return H[0]?H[0].innerText||H[0].textContent:""},append:function(){return t(this,arguments,function(H){if(this.nodeType===1){this.appendChild(H)}})},prepend:function(){return t(this,arguments,function(H){if(this.nodeType===1){this.insertBefore(H,this.firstChild)}})},before:function(){var H=this;if(H[0]&&H[0].parentNode){return t(H,arguments,function(I){this.parentNode.insertBefore(I,this.nextSibling)})}return H},after:function(){var H=this;if(H[0]&&H[0].parentNode){return t(H,arguments,function(I){this.parentNode.insertBefore(I,this)})}return H},appendTo:function(H){n(H).append(this);return this},addClass:function(H){return this.toggleClass(H,true)},removeClass:function(H){return this.toggleClass(H,false)},toggleClass:function(I,J){var H=this;if(I.indexOf(" ")!==-1){o(I.split(" "),function(){H.toggleClass(this,J)})}else{H.each(function(){var L=this,K;if(l(L,I)!==J){K=L.className;if(J){L.className+=K?" "+I:I}else{L.className=A((" "+K+" ").replace(" "+I+" "," "))}}})}return H},hasClass:function(H){return l(this[0],H)},each:function(H){return o(this,H)},on:function(H,I){return this.each(function(){F.bind(this,H,I)})},off:function(H,I){return this.each(function(){F.unbind(this,H,I)})},show:function(){return this.css("display","")},hide:function(){return this.css("display","none")},slice:function(){return new n(y.apply(this,arguments))},eq:function(H){return H===-1?this.slice(H):this.slice(H,+H+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},replaceWith:function(I){var H=this;if(H[0]){H[0].parentNode.replaceChild(n(I)[0],H[0])}return H},wrap:function(H){H=n(H)[0];return this.each(function(){var I=this,J=H.cloneNode(false);I.parentNode.insertBefore(J,I);J.appendChild(I)})},unwrap:function(){return this.each(function(){var H=this,J=H.firstChild,I;while(J){I=J;J=J.nextSibling;H.parentNode.insertBefore(I,H)}})},clone:function(){var H=[];this.each(function(){H.push(this.cloneNode(true))});return n(H)},find:function(H){var K,I,J=[];for(K=0,I=this.length;K<I;K++){n.find(H,this[K],J)}return n(J)},push:q,sort:[].sort,splice:[].splice};D(n,{extend:D,toArray:z,inArray:B,isArray:r,each:o,trim:A,makeMap:v,find:m,expr:m.selectors,unique:m.uniqueSort,text:m.getText,isXMLDoc:m.isXML,contains:m.contains,filter:function(J,H,I){if(I){J=":not("+J+")"}return H.length===1?n.find.matchesSelector(H[0],J)?[H[0]]:[]:n.find.matches(J,H)}});function w(I,L,K){var H=[],J=I[L];while(J&&J.nodeType!==9&&(K===g||J.nodeType!==1||!n(J).is(K))){if(J.nodeType===1){H.push(J)}J=J[L]}return H}function C(L,J,I,H){var K=[];for(;L;L=L[I]){if((!H||L.nodeType===H)&&L!==J){K.push(L)}}return K}o({parent:function(I){var H=I.parentNode;return H&&H.nodeType!==11?H:null},parents:function(H){return w(H,"parentNode")},parentsUntil:function(H,I){return w(H,"parentNode",I)},next:function(H){return C(H,"nextSibling",1)},prev:function(H){return C(H,"previousSibling",1)},nextNodes:function(H){return C(H,"nextSibling")},prevNodes:function(H){return C(H,"previousSibling")},children:function(H){return C(H.firstChild,"nextSibling",1)},contents:function(H){return z((H.nodeName==="iframe"?H.contentDocument||H.contentWindow.document:H).childNodes)}},function(H,I){n.fn[H]=function(K){var L=this,J;if(L.length>1){throw new Error("DomQuery only supports traverse functions on a single node.")}if(L[0]){J=I(L[0],K)}J=n(J);if(K&&H!=="parentsUntil"){return J.filter(K)}return J}});n.fn.filter=function(H){return n.filter(H)};n.fn.is=function(H){return !!H&&this.filter(H).length>0};n.fn.init.prototype=n.fn;return n});h("tinymce/html/Styles",[],function(){return function(m,o){var s=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,p=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,k=/\s*([^:]+):\s*([^;]+);?/g,u=/\s+$/,n,q,j={},r,t="\uFEFF";m=m||{};r=("\\\" \\' \\; \\: ; : "+t).split(" ");for(q=0;q<r.length;q++){j[r[q]]=t+q;j[t+q]=r[q]}function l(w,z,y,v){function x(A){A=parseInt(A,10).toString(16);return A.length>1?A:"0"+A}return"#"+x(z)+x(y)+x(v)}return{toHex:function(v){return v.replace(s,l)},parse:function(B){var H={},z,w,F,A,E=m.url_converter,G=m.url_converter_scope||this;function y(L,O){var N,K,J,M;if(H["border-image"]==="none"){delete H["border-image"]}N=H[L+"-top"+O];if(!N){return}K=H[L+"-right"+O];if(N!=K){return}J=H[L+"-bottom"+O];if(K!=J){return}M=H[L+"-left"+O];if(J!=M){return}H[L+O]=M;delete H[L+"-top"+O];delete H[L+"-right"+O];delete H[L+"-bottom"+O];delete H[L+"-left"+O]}function D(K){var L=H[K],J;if(!L||L.indexOf(" ")<0){return}L=L.split(" ");J=L.length;while(J--){if(L[J]!==L[0]){return false}}H[K]=L[0];return true}function I(L,K,J,M){if(!D(K)){return}if(!D(J)){return}if(!D(M)){return}H[L]=H[K]+" "+H[J]+" "+H[M];delete H[K];delete H[J];delete H[M]}function C(J){A=true;return j[J]}function v(K,J){if(A){K=K.replace(/\uFEFF[0-9]/g,function(L){return j[L]})}if(!J){K=K.replace(/\\([\'\";:])/g,"$1")}return K}function x(K,J,N,M,O,L){O=O||L;if(O){O=v(O);return"'"+O.replace(/\'/g,"\\'")+"'"}J=v(J||N||M);if(E){J=E.call(G,J,"style")}return"url('"+J.replace(/\'/g,"\\'")+"')"}if(B){B=B.replace(/\\[\"\';:\uFEFF]/g,C).replace(/\"[^\"]+\"|\'[^\']+\'/g,function(J){return J.replace(/[;:]/g,C)});while((z=k.exec(B))){w=z[1].replace(u,"").toLowerCase();F=z[2].replace(u,"");if(w&&F.length>0){if(w==="font-weight"&&F==="700"){F="bold"}else{if(w==="color"||w==="background-color"){F=F.toLowerCase()}}F=F.replace(s,l);F=F.replace(p,x);H[w]=A?v(F,true):F}k.lastIndex=z.index+z[0].length}y("border","");y("border","-width");y("border","-color");y("border","-style");y("padding","");y("margin","");I("border","border-width","border-style","border-color");if(H.border==="medium none"){delete H.border}}return H},serialize:function(y,A){var x="",w,z;function v(C){var F,D,B,E;F=o.styles[C];if(F){for(D=0,B=F.length;D<B;D++){C=F[D];E=y[C];if(E!==n&&E.length>0){x+=(x.length>0?" ":"")+C+": "+E+";"}}}}if(A&&o&&o.styles){v("*");v(A)}else{for(w in y){z=y[w];if(z!==n&&z.length>0){x+=(x.length>0?" ":"")+w+": "+z+";"}}}return x}}}});h("tinymce/dom/TreeWalker",[],function(){return function(j,l){var k=j;function m(r,o,n,s){var q,p;if(r){if(!s&&r[o]){return r[o]}if(r!=l){q=r[n];if(q){return q}for(p=r.parentNode;p&&p!=l;p=p.parentNode){q=p[n];if(q){return q}}}}}this.current=function(){return k};this.next=function(n){k=m(k,"firstChild","nextSibling",n);return k};this.prev=function(n){k=m(k,"lastChild","previousSibling",n);return k}}});h("tinymce/util/Tools",[],function(){var y=/^\s*|\s*$/g;var k=function(z){return(z===null||z===g)?"":(""+z).replace(y,"")};var q=Array.isArray||function(z){return Object.prototype.toString.call(z)==="[object Array]"};function p(A,z){if(!z){return A!==g}if(z=="array"&&q(A)){return true}return typeof(A)==z}function m(B){var C=[],A,z;for(A=0,z=B.length;A<z;A++){C[A]=B[A]}return C}function l(z,C,B){var A;z=z||[];C=C||",";if(typeof(z)=="string"){z=z.split(C)}B=B||{};A=z.length;while(A--){B[z[A]]={}}return B}function t(C,z,B){var D,A;if(!C){return 0}B=B||C;if(C.length!==g){for(D=0,A=C.length;D<A;D++){if(z.call(B,C[D],D,C)===false){return 0}}}else{for(D in C){if(C.hasOwnProperty(D)){if(z.call(B,C[D],D,C)===false){return 0}}}}return 1}function j(z,A){var B=[];t(z,function(C){B.push(A(C))});return B}function w(z,A){var B=[];t(z,function(C){if(!A||A(C)){B.push(C)}});return B}function o(I,z,D){var H=this,A,C,E,F,B,G=0;I=/^((static) )?([\w.]+)(:([\w.]+))?/.exec(I);E=I[3].match(/(^|\.)(\w+)$/i)[2];C=H.createNS(I[3].replace(/\.\w+$/,""),D);if(C[E]){return}if(I[2]=="static"){C[E]=z;if(this.onCreate){this.onCreate(I[2],I[3],C[E])}return}if(!z[E]){z[E]=function(){};G=1}C[E]=z[E];H.extend(C[E].prototype,z);if(I[5]){A=H.resolve(I[5]).prototype;F=I[5].match(/\.(\w+)$/i)[1];B=C[E];if(G){C[E]=function(){return A[F].apply(this,arguments)}}else{C[E]=function(){this.parent=A[F];return B.apply(this,arguments)}}C[E].prototype[E]=C[E];H.each(A,function(J,K){C[E].prototype[K]=A[K]});H.each(z,function(J,K){if(A[K]){C[E].prototype[K]=function(){this.parent=A[K];return J.apply(this,arguments)}}else{if(K!=E){C[E].prototype[K]=J}}})}H.each(z["static"],function(J,K){C[E][K]=J})}function x(A,B){var C,z;if(A){for(C=0,z=A.length;C<z;C++){if(A[C]===B){return C}}}return -1}function r(F,D){var C,z,B,A=arguments,E;for(C=1,z=A.length;C<z;C++){D=A[C];for(B in D){if(D.hasOwnProperty(B)){E=D[B];if(E!==g){F[B]=E}}}}return F}function u(B,A,C,z){z=z||this;if(B){if(C){B=B[C]}t(B,function(E,D){if(A.call(z,E,D,C)===false){return false}u(E,A,C,z)})}}function n(C,B){var A,z;B=B||window;C=C.split(".");for(A=0;A<C.length;A++){z=C[A];if(!B[z]){B[z]={}}B=B[z]}return B}function v(C,B){var A,z;B=B||window;C=C.split(".");for(A=0,z=C.length;A<z;A++){B=B[C[A]];if(!B){break}}return B}function s(z,A){if(!z||p(z,"array")){return z}return j(z.split(A||","),k)}return{trim:k,isArray:q,is:p,toArray:m,makeMap:l,each:t,map:j,grep:w,inArray:x,extend:r,create:o,walk:u,createNS:n,resolve:v,explode:s}});h("tinymce/dom/Range",["tinymce/util/Tools"],function(j){function k(l){var W=this,n=l.doc,ac=0,N=1,s=2,M=true,aa=false,ae="startOffset",q="startContainer",Y="endContainer",I="endOffset",u=j.extend,x=l.nodeIndex;function F(){return n.createDocumentFragment()}function A(af,t){K(M,af,t)}function C(af,t){K(aa,af,t)}function p(t){A(t.parentNode,x(t))}function R(t){A(t.parentNode,x(t)+1)}function S(t){C(t.parentNode,x(t))}function D(t){C(t.parentNode,x(t)+1)}function J(t){if(t){W[Y]=W[q];W[I]=W[ae]}else{W[q]=W[Y];W[ae]=W[I]}W.collapsed=M}function G(t){p(t);D(t)}function O(t){A(t,0);C(t,t.nodeType===1?t.childNodes.length:t.nodeValue.length)}function E(ai,t){var al=W[q],ag=W[ae],ak=W[Y],af=W[I],aj=t.startContainer,an=t.startOffset,ah=t.endContainer,am=t.endOffset;if(ai===0){return P(al,ag,aj,an)}if(ai===1){return P(ak,af,aj,an)}if(ai===2){return P(ak,af,ah,am)}if(ai===3){return P(al,ag,ah,am)}}function z(){v(s)}function Q(){return v(ac)}function m(){return v(N)}function L(ai){var af=this[q],t=this[ae],ah,ag;if((af.nodeType===3||af.nodeType===4)&&af.nodeValue){if(!t){af.parentNode.insertBefore(ai,af)}else{if(t>=af.nodeValue.length){l.insertAfter(ai,af)}else{ah=af.splitText(t);af.parentNode.insertBefore(ai,ah)}}}else{if(af.childNodes.length>0){ag=af.childNodes[t]}if(ag){af.insertBefore(ai,ag)}else{if(af.nodeType==3){l.insertAfter(ai,af)}else{af.appendChild(ai)}}}}function V(af){var t=W.extractContents();W.insertNode(af);af.appendChild(t);W.selectNode(af)}function T(){return u(new k(l),{startContainer:W[q],startOffset:W[ae],endContainer:W[Y],endOffset:W[I],collapsed:W.collapsed,commonAncestorContainer:W.commonAncestorContainer})}function X(t,af){var ag;if(t.nodeType==3){return t}if(af<0){return t}ag=t.firstChild;while(ag&&af>0){--af;ag=ag.nextSibling}if(ag){return ag}return t}function w(){return(W[q]==W[Y]&&W[ae]==W[I])}function P(ah,aj,af,ai){var ak,ag,t,al,an,am;if(ah==af){if(aj==ai){return 0}if(aj<ai){return -1}return 1}ak=af;while(ak&&ak.parentNode!=ah){ak=ak.parentNode}if(ak){ag=0;t=ah.firstChild;while(t!=ak&&ag<aj){ag++;t=t.nextSibling}if(aj<=ag){return -1}return 1}ak=ah;while(ak&&ak.parentNode!=af){ak=ak.parentNode}if(ak){ag=0;t=af.firstChild;while(t!=ak&&ag<ai){ag++;t=t.nextSibling}if(ag<ai){return -1}return 1}al=l.findCommonAncestor(ah,af);an=ah;while(an&&an.parentNode!=al){an=an.parentNode}if(!an){an=al}am=af;while(am&&am.parentNode!=al){am=am.parentNode}if(!am){am=al}if(an==am){return 0}t=al.firstChild;while(t){if(t==an){return -1}if(t==am){return 1}t=t.nextSibling}}function K(af,ai,ah){var t,ag;if(af){W[q]=ai;W[ae]=ah}else{W[Y]=ai;W[I]=ah}t=W[Y];while(t.parentNode){t=t.parentNode}ag=W[q];while(ag.parentNode){ag=ag.parentNode}if(ag==t){if(P(W[q],W[ae],W[Y],W[I])>0){W.collapse(af)}}else{W.collapse(af)}W.collapsed=w();W.commonAncestorContainer=l.findCommonAncestor(W[q],W[Y])}function v(al){var ak,ah=0,an=0,af,aj,ag,ai,t,am;if(W[q]==W[Y]){return o(al)}for(ak=W[Y],af=ak.parentNode;af;ak=af,af=af.parentNode){if(af==W[q]){return B(ak,al)}++ah}for(ak=W[q],af=ak.parentNode;af;ak=af,af=af.parentNode){if(af==W[Y]){return ad(ak,al)}++an}aj=an-ah;ag=W[q];while(aj>0){ag=ag.parentNode;aj--}ai=W[Y];while(aj<0){ai=ai.parentNode;aj++}for(t=ag.parentNode,am=ai.parentNode;t!=am;t=t.parentNode,am=am.parentNode){ag=t;ai=am}return y(ag,ai,al)}function o(ak){var am,an,t,ag,ah,al,ai,af,aj;if(ak!=s){am=F()}if(W[ae]==W[I]){return am}if(W[q].nodeType==3){an=W[q].nodeValue;t=an.substring(W[ae],W[I]);if(ak!=N){ag=W[q];af=W[ae];aj=W[I]-W[ae];if(af===0&&aj>=ag.nodeValue.length-1){ag.parentNode.removeChild(ag)}else{ag.deleteData(af,aj)}W.collapse(M)}if(ak==s){return}if(t.length>0){am.appendChild(n.createTextNode(t))}return am}ag=X(W[q],W[ae]);ah=W[I]-W[ae];while(ag&&ah>0){al=ag.nextSibling;ai=H(ag,ak);if(am){am.appendChild(ai)}--ah;ag=al}if(ak!=N){W.collapse(M)}return am}function B(al,ai){var ak,aj,af,t,ah,ag;if(ai!=s){ak=F()}aj=r(al,ai);if(ak){ak.appendChild(aj)}af=x(al);t=af-W[ae];if(t<=0){if(ai!=N){W.setEndBefore(al);W.collapse(aa)}return ak}aj=al.previousSibling;while(t>0){ah=aj.previousSibling;ag=H(aj,ai);if(ak){ak.insertBefore(ag,ak.firstChild)}--t;aj=ah}if(ai!=N){W.setEndBefore(al);W.collapse(aa)}return ak}function ad(aj,ai){var al,af,ak,t,ah,ag;if(ai!=s){al=F()}ak=Z(aj,ai);if(al){al.appendChild(ak)}af=x(aj);++af;t=W[I]-af;ak=aj.nextSibling;while(ak&&t>0){ah=ak.nextSibling;ag=H(ak,ai);if(al){al.appendChild(ag)}--t;ak=ah}if(ai!=N){W.setStartAfter(aj);W.collapse(M)}return al}function y(aj,t,am){var ag,ao,ai,ak,al,af,an,ah;if(am!=s){ao=F()}ag=Z(aj,am);if(ao){ao.appendChild(ag)}ai=aj.parentNode;ak=x(aj);al=x(t);++ak;af=al-ak;an=aj.nextSibling;while(af>0){ah=an.nextSibling;ag=H(an,am);if(ao){ao.appendChild(ag)}an=ah;--af}ag=r(t,am);if(ao){ao.appendChild(ag)}if(am!=N){W.setStartAfter(aj);W.collapse(M)}return ao}function r(ak,al){var ag=X(W[Y],W[I]-1),am,aj;var ai,t,af,ah=ag!=W[Y];if(ag==ak){return U(ag,ah,aa,al)}am=ag.parentNode;aj=U(am,aa,aa,al);while(am){while(ag){ai=ag.previousSibling;t=U(ag,ah,aa,al);if(al!=s){aj.insertBefore(t,aj.firstChild)}ah=M;ag=ai}if(am==ak){return aj}ag=am.previousSibling;am=am.parentNode;af=U(am,aa,aa,al);if(al!=s){af.appendChild(aj)}aj=af}}function Z(ak,al){var ah=X(W[q],W[ae]),ai=ah!=W[q];var am,aj,ag,t,af;if(ah==ak){return U(ah,ai,M,al)}am=ah.parentNode;aj=U(am,aa,M,al);while(am){while(ah){ag=ah.nextSibling;t=U(ah,ai,M,al);if(al!=s){aj.appendChild(t)}ai=M;ah=ag}if(am==ak){return aj}ah=am.nextSibling;am=am.parentNode;af=U(am,aa,M,al);if(al!=s){af.appendChild(aj)}aj=af}}function U(t,ai,al,am){var ah,ag,aj,af,ak;if(ai){return H(t,am)}if(t.nodeType==3){ah=t.nodeValue;if(al){af=W[ae];ag=ah.substring(af);aj=ah.substring(0,af)}else{af=W[I];ag=ah.substring(0,af);aj=ah.substring(af)}if(am!=N){t.nodeValue=aj}if(am==s){return}ak=l.clone(t,aa);ak.nodeValue=ag;return ak}if(am==s){return}return l.clone(t,aa)}function H(af,t){if(t!=s){return t==N?l.clone(af,M):af}af.parentNode.removeChild(af)}function ab(){return l.create("body",null,m()).outerText}u(W,{startContainer:n,startOffset:0,endContainer:n,endOffset:0,collapsed:M,commonAncestorContainer:n,START_TO_START:0,START_TO_END:1,END_TO_END:2,END_TO_START:3,setStart:A,setEnd:C,setStartBefore:p,setStartAfter:R,setEndBefore:S,setEndAfter:D,collapse:J,selectNode:G,selectNodeContents:O,compareBoundaryPoints:E,deleteContents:z,extractContents:Q,cloneContents:m,insertNode:L,surroundContents:V,cloneRange:T,toStringIE:ab});return W}k.prototype.toString=function(){return this.toStringIE()};return k});h("tinymce/html/Entities",["tinymce/util/Tools"],function(m){var n=m.makeMap;var j,s,p,v=/[&<>\"\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,k=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,r=/[<>&\"\']/g,o=/&(#x|#)?([\w]+);/g,u={128:"\u20AC",130:"\u201A",131:"\u0192",132:"\u201E",133:"\u2026",134:"\u2020",135:"\u2021",136:"\u02C6",137:"\u2030",138:"\u0160",139:"\u2039",140:"\u0152",142:"\u017D",145:"\u2018",146:"\u2019",147:"\u201C",148:"\u201D",149:"\u2022",150:"\u2013",151:"\u2014",152:"\u02DC",153:"\u2122",154:"\u0161",155:"\u203A",156:"\u0153",158:"\u017E",159:"\u0178"};s={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;"};p={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"};function t(w){var x;x=document.createElement("div");x.innerHTML=w;return x.textContent||x.innerText||w}function q(x,A){var y,z,w,B={};if(x){x=x.split(",");A=A||10;for(y=0;y<x.length;y+=2){z=String.fromCharCode(parseInt(x[y],A));if(!s[z]){w="&"+x[y+1]+";";B[z]=w;B[w]=z}}return B}}j=q("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32);var l={encodeRaw:function(x,w){return x.replace(w?v:k,function(y){return s[y]||y})},encodeAllRaw:function(w){return(""+w).replace(r,function(x){return s[x]||x})},encodeNumeric:function(x,w){return x.replace(w?v:k,function(y){if(y.length>1){return"&#"+(((y.charCodeAt(0)-55296)*1024)+(y.charCodeAt(1)-56320)+65536)+";"}return s[y]||"&#"+y.charCodeAt(0)+";"})},encodeNamed:function(y,w,x){x=x||j;return y.replace(w?v:k,function(z){return s[z]||x[z]||z})},getEncodeFunc:function(w,z){z=q(z)||j;function x(B,A){return B.replace(A?v:k,function(C){return s[C]||z[C]||"&#"+C.charCodeAt(0)+";"||C})}function y(B,A){return l.encodeNamed(B,A,z)}w=n(w.replace(/\+/g,","));if(w.named&&w.numeric){return x}if(w.named){if(z){return y}return l.encodeNamed}if(w.numeric){return l.encodeNumeric}return l.encodeRaw},decode:function(w){return w.replace(o,function(y,x,z){if(x){z=parseInt(z,x.length===2?16:10);if(z>65535){z-=65536;return String.fromCharCode(55296+(z>>10),56320+(z&1023))}else{return u[z]||String.fromCharCode(z)}}return p[y]||j[y]||t(y)})}};return l});h("tinymce/Env",[],function(){var j=navigator,s=j.userAgent;var m,r,k,o,l,q,n;m=window.opera&&window.opera.buildNumber;r=/WebKit/.test(s);k=!r&&!m&&(/MSIE/gi).test(s)&&(/Explorer/gi).test(j.appName);k=k&&/MSIE (\w+)\./.exec(s)[1];o=s.indexOf("Trident")!=-1?11:false;k=k||o;l=!r&&/Gecko/.test(s);q=s.indexOf("Mac")!=-1;n=/(iPad|iPhone)/.test(s);var p=!n||s.match(/AppleWebKit\/(\d*)/)[1]>=534;return{opera:m,webkit:r,ie:k,gecko:l,mac:q,iOS:n,contentEditable:p,transparentSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",caretAfter:k!=8,range:window.getSelection&&"Range" in window,documentMode:k?(document.documentMode||7):10}});h("tinymce/dom/DOMUtils",["tinymce/dom/Sizzle","tinymce/html/Styles","tinymce/dom/EventUtils","tinymce/dom/TreeWalker","tinymce/dom/Range","tinymce/html/Entities","tinymce/Env","tinymce/util/Tools"],function(m,s,p,q,z,n,l,k){var o=k.each,r=k.is,t=k.grep,w=k.trim,A=k.extend;var x=l.webkit,v=l.ie;var u=/^([a-z0-9],?)+$/i;var B=/^[ \t\r\n]*$/;var j=k.makeMap("fillOpacity fontWeight lineHeight opacity orphans widows zIndex zoom"," ");function y(F,D){var C=this,E;C.doc=F;C.win=window;C.files={};C.counter=0;C.stdMode=!v||F.documentMode>=8;C.boxModel=!v||F.compatMode=="CSS1Compat"||C.stdMode;C.hasOuterHTML="outerHTML" in F.createElement("a");this.boundEvents=[];C.settings=D=A({keep_values:false,hex_colors:1},D);C.schema=D.schema;C.styles=new s({url_converter:D.url_converter,url_converter_scope:D.url_converter_scope},D.schema);C.fixDoc(F);C.events=D.ownEvents?new p(D.proxy):p.Event;E=D.schema?D.schema.getBlockElements():{};C.isBlock=function(H){if(!H){return false}var G=H.nodeType;if(G){return !!(G===1&&E[H.nodeName])}return !!E[H]}}y.prototype={root:null,props:{"for":"htmlFor","class":"className",className:"className",checked:"checked",disabled:"disabled",maxlength:"maxLength",readonly:"readOnly",selected:"selected",value:"value",id:"id",name:"name",type:"type"},fixDoc:function(E){var D=this.settings,C;if(v&&D.schema){("abbr article aside audio canvas details figcaption figure footer header hgroup mark menu meter nav output progress section summary time video").replace(/\w+/g,function(F){E.createElement(F)});for(C in D.schema.getCustomElements()){E.createElement(C)}}},clone:function(E,C){var D=this,G,F;if(!v||E.nodeType!==1||C){return E.cloneNode(C)}F=D.doc;if(!C){G=F.createElement(E.nodeName);o(D.getAttribs(E),function(H){D.setAttrib(G,H.nodeName,D.getAttrib(E,H.nodeName))});return G}return G.firstChild},getRoot:function(){var C=this;return C.get(C.settings.root_element)||C.doc.body},getViewPort:function(D){var C,E;D=!D?this.win:D;C=D.document;E=this.boxModel?C.documentElement:C.body;return{x:D.pageXOffset||E.scrollLeft,y:D.pageYOffset||E.scrollTop,w:D.innerWidth||E.clientWidth,h:D.innerHeight||E.clientHeight}},getRect:function(F){var C=this,E,D;F=C.get(F);E=C.getPos(F);D=C.getSize(F);return{x:E.x,y:E.y,w:D.w,h:D.h}},getSize:function(F){var D=this,C,E;F=D.get(F);C=D.getStyle(F,"width");E=D.getStyle(F,"height");if(C.indexOf("px")===-1){C=0}if(E.indexOf("px")===-1){E=0}return{w:parseInt(C,10)||F.offsetWidth||F.clientWidth,h:parseInt(E,10)||F.offsetHeight||F.clientHeight}},getParent:function(E,C,D){return this.getParents(E,C,D,false)},getParents:function(H,D,E,I){var G=this,F,C=[];H=G.get(H);I=I===g;E=E||(G.getRoot().nodeName!="BODY"?G.getRoot().parentNode:null);if(r(D,"string")){F=D;if(D==="*"){D=function(J){return J.nodeType==1}}else{D=function(J){return G.is(J,F)}}}while(H){if(H==E||!H.nodeType||H.nodeType===9){break}if(!D||D(H)){if(I){C.push(H)}else{return H}}H=H.parentNode}return I?C:null},get:function(D){var C;if(D&&this.doc&&typeof(D)=="string"){C=D;D=this.doc.getElementById(D);if(D&&D.id!==C){return this.doc.getElementsByName(C)[1]}}return D},getNext:function(D,C){return this._findSib(D,C,"nextSibling")},getPrev:function(D,C){return this._findSib(D,C,"previousSibling")},select:function(C,E){var D=this;return m(C,D.get(E)||D.get(D.settings.root_element)||D.doc,[])},is:function(E,C){var D;if(E.length===g){if(C==="*"){return E.nodeType==1}if(u.test(C)){C=C.toLowerCase().split(/,/);E=E.nodeName.toLowerCase();for(D=C.length-1;D>=0;D--){if(C[D]==E){return true}}return false}}if(E.nodeType&&E.nodeType!=1){return false}return m.matches(C,E.nodeType?[E]:E).length>0},add:function(H,E,D,G,F){var C=this;return this.run(H,function(J){var I;I=r(E,"string")?C.doc.createElement(E):E;C.setAttribs(I,D);if(G){if(G.nodeType){I.appendChild(G)}else{C.setHTML(I,G)}}return !F?J.appendChild(I):I})},create:function(D,C,E){return this.add(this.doc.createElement(D),D,C,E,1)},createHTML:function(D,C,F){var G="",E;G+="<"+D;for(E in C){if(C.hasOwnProperty(E)&&C[E]!==null){G+=" "+E+'="'+this.encode(C[E])+'"'}}if(typeof(F)!="undefined"){return G+">"+F+"</"+D+">"}return G+" />"},createFragment:function(D){var G,E,F=this.doc,C;C=F.createElement("div");G=F.createDocumentFragment();if(D){C.innerHTML=D}while((E=C.firstChild)){G.appendChild(E)}return G},remove:function(C,D){return this.run(C,function(F){var G,E=F.parentNode;if(!E){return null}if(D){while((G=F.firstChild)){if(!v||G.nodeType!==3||G.nodeValue){E.insertBefore(G,F)}else{F.removeChild(G)}}}return E.removeChild(F)})},setStyle:function(E,C,D){return this.run(E,function(J){var F=this,I,H;if(C){if(typeof(C)==="string"){I=J.style;C=C.replace(/-(\D)/g,function(L,K){return K.toUpperCase()});if(typeof(D)==="number"&&!j[C]){D+="px"}if(C==="opacity"&&J.runtimeStyle&&typeof(J.runtimeStyle.opacity)==="undefined"){I.filter=D===""?"":"alpha(opacity="+(D*100)+")"}if(C=="float"){C="cssFloat" in J.style?"cssFloat":"styleFloat"}try{I[C]=D}catch(G){}if(F.settings.update_styles){J.removeAttribute("data-mce-style")}}else{for(H in C){F.setStyle(J,H,C[H])}}}})},getStyle:function(F,C,E){F=this.get(F);if(!F){return}if(this.doc.defaultView&&E){C=C.replace(/[A-Z]/g,function(G){return"-"+G});try{return this.doc.defaultView.getComputedStyle(F,null).getPropertyValue(C)}catch(D){return null}}C=C.replace(/-(\D)/g,function(H,G){return G.toUpperCase()});if(C=="float"){C=v?"styleFloat":"cssFloat"}if(F.currentStyle&&E){return F.currentStyle[C]}return F.style?F.style[C]:g},setStyles:function(D,C){this.setStyle(D,C)},css:function(E,C,D){this.setStyle(E,C,D)},removeAllAttribs:function(C){return this.run(C,function(F){var E,D=F.attributes;for(E=D.length-1;E>=0;E--){F.removeAttributeNode(D.item(E))}})},setAttrib:function(E,F,C){var D=this;if(!E||!F){return}return this.run(E,function(I){var H=D.settings;var G=I.getAttribute(F);if(C!==null){switch(F){case"style":if(!r(C,"string")){o(C,function(J,K){D.setStyle(I,K,J)});return}if(H.keep_values){if(C){I.setAttribute("data-mce-style",C,2)}else{I.removeAttribute("data-mce-style",2)}}I.style.cssText=C;break;case"class":I.className=C||"";break;case"src":case"href":if(H.keep_values){if(H.url_converter){C=H.url_converter.call(H.url_converter_scope||D,C,F,I)}D.setAttrib(I,"data-mce-"+F,C,2)}break;case"shape":I.setAttribute("data-mce-style",C);break}}if(r(C)&&C!==null&&C.length!==0){I.setAttribute(F,""+C,2)}else{I.removeAttribute(F,2)}if(G!=C&&H.onSetAttrib){H.onSetAttrib({attrElm:I,attrName:F,attrValue:C})}})},setAttribs:function(E,D){var C=this;return this.run(E,function(F){o(D,function(H,G){C.setAttrib(F,G,H)})})},getAttrib:function(H,D,G){var F,C=this,E;H=C.get(H);if(!H||H.nodeType!==1){return G===E?false:G}if(!r(G)){G=""}if(/^(src|href|style|coords|shape)$/.test(D)){F=H.getAttribute("data-mce-"+D);if(F){return F}}if(v&&C.props[D]){F=H[C.props[D]];F=F&&F.nodeValue?F.nodeValue:F}if(!F){F=H.getAttribute(D,2)}if(/^(checked|compact|declare|defer|disabled|ismap|multiple|nohref|noshade|nowrap|readonly|selected)$/.test(D)){if(H[C.props[D]]===true&&F===""){return D}return F?D:""}if(H.nodeName==="FORM"&&H.getAttributeNode(D)){return H.getAttributeNode(D).nodeValue}if(D==="style"){F=F||H.style.cssText;if(F){F=C.serializeStyle(C.parseStyle(F),H.nodeName);if(C.settings.keep_values){H.setAttribute("data-mce-style",F)}}}if(x&&D==="class"&&F){F=F.replace(/(apple|webkit)\-[a-z\-]+/gi,"")}if(v){switch(D){case"rowspan":case"colspan":if(F===1){F=""}break;case"size":if(F==="+0"||F===20||F===0){F=""}break;case"width":case"height":case"vspace":case"checked":case"disabled":case"readonly":if(F===0){F=""}break;case"hspace":if(F===-1){F=""}break;case"maxlength":case"tabindex":if(F===32768||F===2147483647||F==="32768"){F=""}break;case"multiple":case"compact":case"noshade":case"nowrap":if(F===65535){return D}return G;case"shape":F=F.toLowerCase();break;default:if(D.indexOf("on")===0&&F){F=(""+F).replace(/^function\s+\w+\(\)\s+\{\s+(.*)\s+\}$/,"$1")}}}return(F!==E&&F!==null&&F!=="")?""+F:G},getPos:function(J,G){var D=this,C=0,I=0,E,F=D.doc,H;J=D.get(J);G=G||F.body;if(J){if(G===F.body&&J.getBoundingClientRect){H=J.getBoundingClientRect();G=D.boxModel?F.documentElement:F.body;C=H.left+(F.documentElement.scrollLeft||F.body.scrollLeft)-G.clientTop;I=H.top+(F.documentElement.scrollTop||F.body.scrollTop)-G.clientLeft;return{x:C,y:I}}E=J;while(E&&E!=G&&E.nodeType){C+=E.offsetLeft||0;I+=E.offsetTop||0;E=E.offsetParent}E=J.parentNode;while(E&&E!=G&&E.nodeType){C-=E.scrollLeft||0;I-=E.scrollTop||0;E=E.parentNode}}return{x:C,y:I}},parseStyle:function(C){return this.styles.parse(C)},serializeStyle:function(D,C){return this.styles.serialize(D,C)},addStyle:function(F){var D=this,G=D.doc,E,H;if(D!==y.DOM&&G===document){var C=y.DOM.addedStyles;C=C||[];if(C[F]){return}C[F]=true;y.DOM.addedStyles=C}H=G.getElementById("mceDefaultStyles");if(!H){H=G.createElement("style");H.id="mceDefaultStyles";H.type="text/css";E=G.getElementsByTagName("head")[0];if(E.firstChild){E.insertBefore(H,E.firstChild)}else{E.appendChild(H)}}if(H.styleSheet){H.styleSheet.cssText+=F}else{H.appendChild(G.createTextNode(F))}},loadCSS:function(D){var C=this,F=C.doc,E;if(C!==y.DOM&&F===document){y.DOM.loadCSS(D);return}if(!D){D=""}E=F.getElementsByTagName("head")[0];o(D.split(","),function(G){var H;if(C.files[G]){return}C.files[G]=true;H=C.create("link",{rel:"stylesheet",href:G});if(v&&F.documentMode&&F.recalc){H.onload=function(){if(F.recalc){F.recalc()}H.onload=null}}E.appendChild(H)})},addClass:function(D,C){return this.run(D,function(F){var E;if(!C){return 0}if(this.hasClass(F,C)){return F.className}E=this.removeClass(F,C);F.className=E=(E!==""?(E+" "):"")+C;return E})},removeClass:function(F,C){var D=this,E;return D.run(F,function(H){var G;if(D.hasClass(H,C)){if(!E){E=new RegExp("(^|\\s+)"+C+"(\\s+|$)","g")}G=H.className.replace(E," ");G=w(G!=" "?G:"");H.className=G;if(!G){H.removeAttribute("class");H.removeAttribute("className")}return G}return H.className})},hasClass:function(D,C){D=this.get(D);if(!D||!C){return false}return(" "+D.className+" ").indexOf(" "+C+" ")!==-1},toggleClass:function(E,C,D){D=D===g?!this.hasClass(E,C):D;if(this.hasClass(E,C)!==D){if(D){this.addClass(E,C)}else{this.removeClass(E,C)}}},show:function(C){return this.setStyle(C,"display","block")},hide:function(C){return this.setStyle(C,"display","none")},isHidden:function(C){C=this.get(C);return !C||C.style.display=="none"||this.getStyle(C,"display")=="none"},uniqueId:function(C){return(!C?"mce_":C)+(this.counter++)},setHTML:function(E,D){var C=this;return C.run(E,function(G){if(v){while(G.firstChild){G.removeChild(G.firstChild)}try{G.innerHTML="<br />"+D;G.removeChild(G.firstChild)}catch(F){var H=C.create("div");H.innerHTML="<br />"+D;o(t(H.childNodes),function(J,I){if(I&&G.canHaveHTML){G.appendChild(J)}})}}else{G.innerHTML=D}return D})},getOuterHTML:function(E){var D,C=this;E=C.get(E);if(!E){return null}if(E.nodeType===1&&C.hasOuterHTML){return E.outerHTML}D=(E.ownerDocument||C.doc).createElement("body");D.appendChild(E.cloneNode(true));return D.innerHTML},setOuterHTML:function(F,D,E){var C=this;return C.run(F,function(I){function H(){var K,J;J=E.createElement("body");J.innerHTML=D;K=J.lastChild;while(K){C.insertAfter(K.cloneNode(true),I);K=K.previousSibling}C.remove(I)}if(I.nodeType==1){E=E||I.ownerDocument||C.doc;if(v){try{if(I.nodeType==1&&C.hasOuterHTML){I.outerHTML=D}else{H()}}catch(G){H()}}else{H()}}})},decode:n.decode,encode:n.encodeAllRaw,insertAfter:function(C,D){D=this.get(D);return this.run(C,function(F){var E,G;E=D.parentNode;G=D.nextSibling;if(G){E.insertBefore(F,G)}else{E.appendChild(F)}return F})},replace:function(E,D,F){var C=this;return C.run(D,function(G){if(r(G,"array")){E=E.cloneNode(true)}if(F){o(t(G.childNodes),function(H){E.appendChild(H)})}return G.parentNode.replaceChild(E,G)})},rename:function(F,D){var C=this,E;if(F.nodeName!=D.toUpperCase()){E=C.create(D);o(C.getAttribs(F),function(G){C.setAttrib(E,G.nodeName,C.getAttrib(F,G.nodeName))});C.replace(E,F,1)}return E||F},findCommonAncestor:function(E,C){var F=E,D;while(F){D=C;while(D&&F!=D){D=D.parentNode}if(F==D){break}F=F.parentNode}if(!F&&E.ownerDocument){return E.ownerDocument.documentElement}return F},toHex:function(C){return this.styles.toHex(k.trim(C))},run:function(G,F,E){var D=this,C;if(typeof(G)==="string"){G=D.get(G)}if(!G){return false}E=E||this;if(!G.nodeType&&(G.length||G.length===0)){C=[];o(G,function(I,H){if(I){if(typeof(I)=="string"){I=D.get(I)}C.push(F.call(E,I,H))}});return C}return F.call(E,G)},getAttribs:function(E){var C;E=this.get(E);if(!E){return[]}if(v){C=[];if(E.nodeName=="OBJECT"){return E.attributes}if(E.nodeName==="OPTION"&&this.getAttrib(E,"selected")){C.push({specified:1,nodeName:"selected"})}var D=/<\/?[\w:\-]+ ?|=[\"][^\"]+\"|=\'[^\']+\'|=[\w\-]+|>/gi;E.cloneNode(false).outerHTML.replace(D,"").replace(/[\w:\-]+/gi,function(F){C.push({specified:1,nodeName:F})});return C}return E.attributes},isEmpty:function(F,D){var K=this,H,G,J,C,E,I=0;F=F.firstChild;if(F){C=new q(F,F.parentNode);D=D||K.schema?K.schema.getNonEmptyElements():null;do{J=F.nodeType;if(J===1){if(F.getAttribute("data-mce-bogus")){continue}E=F.nodeName.toLowerCase();if(D&&D[E]){if(E==="br"){I++;continue}return false}G=K.getAttribs(F);H=F.attributes.length;while(H--){E=F.attributes[H].nodeName;if(E==="name"||E==="data-mce-bookmark"){return false}}}if(J==8){return false}if((J===3&&!B.test(F.nodeValue))){return false}}while((F=C.next()))}return I<=1},createRng:function(){var C=this.doc;return C.createRange?C.createRange():new z(this)},nodeIndex:function(G,H){var C=0,E,F,D;if(G){for(E=G.nodeType,G=G.previousSibling,F=G;G;G=G.previousSibling){D=G.nodeType;if(H&&D==3){if(D==E||!G.nodeValue.length){continue}}C++;E=D}}return C},split:function(G,H,D){var K=this,C=K.createRng(),I,F,J;function E(P){var N,M=P.childNodes,O=P.nodeType;function Q(T){var S=T.previousSibling&&T.previousSibling.nodeName=="SPAN";var R=T.nextSibling&&T.nextSibling.nodeName=="SPAN";return S&&R}if(O==1&&P.getAttribute("data-mce-type")=="bookmark"){return}for(N=M.length-1;N>=0;N--){E(M[N])}if(O!=9){if(O==3&&P.nodeValue.length>0){var L=w(P.nodeValue).length;if(!K.isBlock(P.parentNode)||L>0||L===0&&Q(P)){return}}else{if(O==1){M=P.childNodes;if(M.length==1&&M[0]&&M[0].nodeType==1&&M[0].getAttribute("data-mce-type")=="bookmark"){P.parentNode.insertBefore(M[0],P)}if(M.length||/^(br|hr|input|img)$/i.test(P.nodeName)){return}}}K.remove(P)}return P}if(G&&H){C.setStart(G.parentNode,K.nodeIndex(G));C.setEnd(H.parentNode,K.nodeIndex(H));I=C.extractContents();C=K.createRng();C.setStart(H.parentNode,K.nodeIndex(H)+1);C.setEnd(G.parentNode,K.nodeIndex(G)+1);F=C.extractContents();J=G.parentNode;J.insertBefore(E(I),G);if(D){J.replaceChild(D,H)}else{J.insertBefore(H,G)}J.insertBefore(E(F),G);K.remove(G);return D||H}},bind:function(H,D,G,F){var C=this;if(k.isArray(H)){var E=H.length;while(E--){H[E]=C.bind(H[E],D,G,F)}return H}if(C.settings.collect&&(H===C.doc||H===C.win)){C.boundEvents.push([H,D,G,F])}return C.events.bind(H,D,G,F||C)},unbind:function(H,D,G){var C=this,E;if(k.isArray(H)){E=H.length;while(E--){H[E]=C.unbind(H[E],D,G)}return H}if(C.boundEvents&&(H===C.doc||H===C.win)){E=C.boundEvents.length;while(E--){var F=C.boundEvents[E];if(H==F[0]&&(!D||D==F[1])&&(!G||G==F[2])){this.events.unbind(F[0],F[1],F[2])}}}return this.events.unbind(H,D,G)},fire:function(E,D,C){return this.events.fire(E,D,C)},getContentEditable:function(D){var C;if(D.nodeType!=1){return null}C=D.getAttribute("data-mce-contenteditable");if(C&&C!=="inherit"){return C}return D.contentEditable!=="inherit"?D.contentEditable:null},destroy:function(){var C=this;if(C.boundEvents){var D=C.boundEvents.length;while(D--){var E=C.boundEvents[D];this.events.unbind(E[0],E[1],E[2])}C.boundEvents=null}C.win=C.doc=C.root=C.events=C.frag=null},dumpRng:function(C){return("startContainer: "+C.startContainer.nodeName+", startOffset: "+C.startOffset+", endContainer: "+C.endContainer.nodeName+", endOffset: "+C.endOffset)},_findSib:function(G,C,E){var D=this,F=C;if(G){if(typeof(F)=="string"){F=function(H){return D.is(H,C)}}for(G=G[E];G;G=G[E]){if(F(G)){return G}}}return null}};y.DOM=new y(document);return y});h("tinymce/dom/ScriptLoader",["tinymce/dom/DOMUtils","tinymce/util/Tools"],function(n,j){var l=n.DOM;var m=j.each,k=j.grep;function o(){var q=0,x=1,v=2,y={},w=[],s={},r=[],u=0,t;function p(B,F){var C=l,E,D;function z(){C.remove(D);if(E){E.onreadystatechange=E.onload=E=null}F()}function A(){if(typeof(console)!=="undefined"&&console.log){console.log("Failed to load: "+B)}}D=C.uniqueId();E=document.createElement("script");E.id=D;E.type="text/javascript";E.src=B;if("onreadystatechange" in E){E.onreadystatechange=function(){if(/loaded|complete/.test(E.readyState)){z()}}}else{E.onload=z}E.onerror=A;(document.getElementsByTagName("head")[0]||document.body).appendChild(E)}this.isDone=function(z){return y[z]==v};this.markDone=function(z){y[z]=v};this.add=this.load=function(z,C,A){var B=y[z];if(B==t){w.push(z);y[z]=q}if(C){if(!s[z]){s[z]=[]}s[z].push({func:C,scope:A||this})}};this.loadQueue=function(A,z){this.loadScripts(w,A,z)};this.loadScripts=function(z,D,C){var B;function A(E){m(s[E],function(F){F.func.call(F.scope)});s[E]=t}r.push({func:D,scope:C||this});B=function(){var E=k(z);z.length=0;m(E,function(F){if(y[F]==v){A(F);return}if(y[F]!=x){y[F]=x;u++;p(F,function(){y[F]=v;u--;A(F);B()})}});if(!u){m(r,function(F){F.func.call(F.scope)});r.length=0}};B()}}o.ScriptLoader=new o();return o});h("tinymce/AddOnManager",["tinymce/dom/ScriptLoader","tinymce/util/Tools"],function(m,j){var l=j.each;function k(){var n=this;n.items=[];n.urls={};n.lookup={}}k.prototype={get:function(n){if(this.lookup[n]){return this.lookup[n].instance}else{return g}},dependencies:function(o){var n;if(this.lookup[o]){n=this.lookup[o].dependencies}return n||[]},requireLangPack:function(n){if(k.language&&k.languageLoad!==false){m.ScriptLoader.add(this.urls[n]+"/langs/"+k.language+".js")}},add:function(p,n,o){this.items.push(n);this.lookup[p]={instance:n,dependencies:o};return n},createUrl:function(n,o){if(typeof o==="object"){return o}else{return{prefix:n.prefix,resource:o,suffix:n.suffix}}},addComponents:function(p,n){var o=this.urls[p];l(n,function(q){m.ScriptLoader.add(o+"/"+q)})},load:function(x,q,o,v){var r=this,p=q;function w(){var n=r.dependencies(x);l(n,function(t){var s=r.createUrl(q,t);r.load(s.resource,s,g,g)});if(o){if(v){o.call(v)}else{o.call(m)}}}if(r.urls[x]){return}if(typeof q==="object"){p=q.prefix+q.resource+q.suffix}if(p.indexOf("/")!==0&&p.indexOf("://")==-1){p=k.baseURL+"/"+p}r.urls[x]=p.substring(0,p.lastIndexOf("/"));if(r.lookup[x]){w()}else{m.ScriptLoader.add(p,w,v)}}};k.PluginManager=new k();k.ThemeManager=new k();return k});h("tinymce/html/Node",[],function(){var l=/^[ \t\r\n]*$/,m={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11};function j(s,t,r){var q,p,n=r?"lastChild":"firstChild",o=r?"prev":"next";if(s[n]){return s[n]}if(s!==t){q=s[o];if(q){return q}for(p=s.parent;p&&p!==t;p=p.parent){q=p[o];if(q){return q}}}}function k(n,o){this.name=n;this.type=o;if(o===1){this.attributes=[];this.attributes.map={}}}k.prototype={replace:function(o){var n=this;if(o.parent){o.remove()}n.insert(o,n);n.remove();return n},attr:function(p,s){var n=this,o,q,r;if(typeof p!=="string"){for(q in p){n.attr(q,p[q])}return n}if((o=n.attributes)){if(s!==r){if(s===null){if(p in o.map){delete o.map[p];q=o.length;while(q--){if(o[q].name===p){o=o.splice(q,1);return n}}}return n}if(p in o.map){q=o.length;while(q--){if(o[q].name===p){o[q].value=s;break}}}else{o.push({name:p,value:s})}o.map[p]=s;return n}else{return o.map[p]}}},clone:function(){var o=this,t=new k(o.name,o.type),p,n,s,q,r;if((s=o.attributes)){r=[];r.map={};for(p=0,n=s.length;p<n;p++){q=s[p];if(q.name!=="id"){r[r.length]={name:q.name,value:q.value};r.map[q.name]=q.value}}t.attributes=r}t.value=o.value;t.shortEnded=o.shortEnded;return t},wrap:function(o){var n=this;n.parent.insert(o,n);o.append(n);return n},unwrap:function(){var n=this,p,o;for(p=n.firstChild;p;){o=p.next;n.insert(p,n,true);p=o}n.remove()},remove:function(){var n=this,p=n.parent,o=n.next,q=n.prev;if(p){if(p.firstChild===n){p.firstChild=o;if(o){o.prev=null}}else{q.next=o}if(p.lastChild===n){p.lastChild=q;if(q){q.next=null}}else{o.prev=q}n.parent=n.next=n.prev=null}return n},append:function(p){var n=this,o;if(p.parent){p.remove()}o=n.lastChild;if(o){o.next=p;p.prev=o;n.lastChild=p}else{n.lastChild=n.firstChild=p}p.parent=n;return p},insert:function(p,n,q){var o;if(p.parent){p.remove()}o=n.parent||this;if(q){if(n===o.firstChild){o.firstChild=p}else{n.prev.next=p}p.prev=n.prev;p.next=n;n.prev=p}else{if(n===o.lastChild){o.lastChild=p}else{n.next.prev=p}p.next=n.next;p.prev=n;n.next=p}p.parent=o;return p},getAll:function(o){var n=this,p,q=[];for(p=n.firstChild;p;p=j(p,n)){if(p.name===o){q.push(p)}}return q},empty:function(){var o=this,n,p,q;if(o.firstChild){n=[];for(q=o.firstChild;q;q=j(q,o)){n.push(q)}p=n.length;while(p--){q=n[p];q.parent=q.firstChild=q.lastChild=q.next=q.prev=null}}o.firstChild=o.lastChild=null;return o},isEmpty:function(r){var n=this,q=n.firstChild,p,o;if(q){do{if(q.type===1){if(q.attributes.map["data-mce-bogus"]){continue}if(r[q.name]){return false}p=q.attributes.length;while(p--){o=q.attributes[p].name;if(o==="name"||o.indexOf("data-mce-")===0){return false}}}if(q.type===8){return false}if((q.type===3&&!l.test(q.value))){return false}}while((q=j(q,n)))}return true},walk:function(n){return j(this,null,n)}};k.create=function(o,n){var q,p;q=new k(o,m[o]||1);if(n){for(p in n){q.attr(p,n[p])}}return q};return k});h("tinymce/html/Schema",["tinymce/util/Tools"],function(j){var k={};var l=j.makeMap,p=j.each,m=j.extend,n=j.explode,r=j.inArray;function o(s,t){return s?s.split(t||" "):[]}function q(z){var w={},A,B,t;var x,y,s,v;function C(G,D,J){var I,H,K,F=arguments;function E(O){var N={},M,L;for(M=0,L=O.length;M<L;M++){N[O[M]]={}}return N}J=J||[];D=D||"";if(typeof(J)==="string"){J=o(J)}for(H=3;H<F.length;H++){if(typeof(F[H])==="string"){F[H]=o(F[H])}J.push.apply(J,F[H])}G=o(G);I=G.length;while(I--){K=[].concat(A,o(D));w[G[I]]={attributes:E(K),attributesOrder:K,children:E(J)}}}function u(G,F){var I,E,H,D;G=o(G);I=G.length;F=o(F);while(I--){E=w[G[I]];for(H=0,D=F.length;H<D;H++){E.attributes[F[H]]={};E.attributesOrder.push(F[H])}}}if(k[z]){return k[z]}A=o("id accesskey class dir lang style tabindex title");B=o("onabort onblur oncancel oncanplay oncanplaythrough onchange onclick onclose oncontextmenu oncuechange ondblclick ondrag ondragend ondragenter ondragleave ondragover ondragstart ondrop ondurationchange onemptied onended onerror onfocus oninput oninvalid onkeydown onkeypress onkeyup onload onloadeddata onloadedmetadata onloadstart onmousedown onmousemove onmouseout onmouseover onmouseup onmousewheel onpause onplay onplaying onprogress onratechange onreset onscroll onseeked onseeking onseeking onselect onshow onstalled onsubmit onsuspend ontimeupdate onvolumechange onwaiting");t=o("address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul");x=o("a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd label map noscript object q s samp script select small span strong sub sup textarea u var #text #comment");if(z!="html4"){A.push.apply(A,o("contenteditable contextmenu draggable dropzone hidden spellcheck translate"));t.push.apply(t,o("article aside details dialog figure header footer hgroup section nav"));x.push.apply(x,o("audio canvas command datalist mark meter output progress time wbr video ruby bdi keygen"))}if(z!="html5-strict"){A.push("xml:lang");v=o("acronym applet basefont big font strike tt");x.push.apply(x,v);p(v,function(D){C(D,"",x)});s=o("center dir isindex noframes");t.push.apply(t,s);y=[].concat(t,x);p(s,function(D){C(D,"",y)})}y=y||[].concat(t,x);C("html","manifest","head body");C("head","","base command link meta noscript script style title");C("title hr noscript br");C("base","href target");C("link","href rel media hreflang type sizes hreflang");C("meta","name http-equiv content charset");C("style","media type scoped");C("script","src async defer type charset");C("body","onafterprint onbeforeprint onbeforeunload onblur onerror onfocus onhashchange onload onmessage onoffline ononline onpagehide onpageshow onpopstate onresize onscroll onstorage onunload",y);C("address dt dd div caption","",y);C("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn","",x);C("blockquote","cite",y);C("ol","reversed start type","li");C("ul","","li");C("li","value",y);C("dl","","dt dd");C("a","href target rel media hreflang type",x);C("q","cite",x);C("ins del","cite datetime",y);C("img","src alt usemap ismap width height");C("iframe","src name width height",y);C("embed","src type width height");C("object","data type typemustmatch name usemap form width height",y,"param");C("param","name value");C("map","name",y,"area");C("area","alt coords shape href target rel media hreflang type");C("table","border","caption colgroup thead tfoot tbody tr"+(z=="html4"?" col":""));C("colgroup","span","col");C("col","span");C("tbody thead tfoot","","tr");C("tr","","td th");C("td","colspan rowspan headers",y);C("th","colspan rowspan headers scope abbr",y);C("form","accept-charset action autocomplete enctype method name novalidate target",y);C("fieldset","disabled form name",y,"legend");C("label","form for",x);C("input","accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate formtarget height list max maxlength min multiple name pattern readonly required size src step type value width");C("button","disabled form formaction formenctype formmethod formnovalidate formtarget name type value",z=="html4"?y:x);C("select","disabled form multiple name required size","option optgroup");C("optgroup","disabled label","option");C("option","disabled label selected value");C("textarea","cols dirname disabled form maxlength name readonly required rows wrap");C("menu","type label",y,"li");C("noscript","",y);if(z!="html4"){C("wbr");C("ruby","",x,"rt rp");C("figcaption","",y);C("mark rt rp summary bdi","",x);C("canvas","width height",y);C("video","src crossorigin poster preload autoplay mediagroup loop muted controls width height",y,"track source");C("audio","src crossorigin preload autoplay mediagroup loop muted controls",y,"track source");C("source","src type media");C("track","kind src srclang label default");C("datalist","",x,"option");C("article section nav aside header footer","",y);C("hgroup","","h1 h2 h3 h4 h5 h6");C("figure","",y,"figcaption");C("time","datetime",x);C("dialog","open",y);C("command","type label icon disabled checked radiogroup command");C("output","for form name",x);C("progress","value max",x);C("meter","value min max low high optimum",x);C("details","open",y,"summary");C("keygen","autofocus challenge disabled form keytype name")}if(z!="html5-strict"){u("script","language xml:space");u("style","xml:space");u("object","declare classid codebase codetype archive standby align border hspace vspace");u("param","valuetype type");u("a","charset name rev shape coords");u("br","clear");u("applet","codebase archive code object alt name width height align hspace vspace");u("img","name longdesc align border hspace vspace");u("iframe","longdesc frameborder marginwidth marginheight scrolling align");u("font basefont","size color face");u("input","usemap align");u("select","onchange");u("textarea");u("h1 h2 h3 h4 h5 h6 div p legend caption","align");u("ul","type compact");u("li","type");u("ol dl menu dir","compact");u("pre","width xml:space");u("hr","align noshade size width");u("isindex","prompt");u("table","summary width frame rules cellspacing cellpadding align bgcolor");u("col","width align char charoff valign");u("colgroup","width align char charoff valign");u("thead","align char charoff valign");u("tr","align char charoff valign bgcolor");u("th","axis align char charoff valign nowrap bgcolor width height");u("form","accept");u("td","abbr axis scope align char charoff valign nowrap bgcolor width height");u("tfoot","align char charoff valign");u("tbody","align char charoff valign");u("area","nohref");u("body","background bgcolor text link vlink alink")}if(z!="html4"){u("input button select textarea","autofocus");u("input textarea","placeholder");u("a","download");u("link script img","crossorigin");u("iframe","srcdoc sandbox seamless allowfullscreen")}p(o("a form meter progress dfn"),function(D){if(w[D]){delete w[D].children[D]}});delete w.caption.children.table;k[z]=w;return w}return function(L){var G=this,E={},v={},u=[],O,J;var A,C,K,D;var H,z,s,B={},w={};function y(R,P,Q){var S=L[R];if(!S){S=k[R];if(!S){S=l(P," ",l(P.toUpperCase()," "));S=m(S,Q);k[R]=S}}else{S=l(S,",",l(S.toUpperCase()," "))}return S}L=L||{};J=q(L.schema);if(L.verify_html===false){L.valid_elements="*[*]"}if(L.valid_styles){O={};p(L.valid_styles,function(Q,P){O[P]=n(Q)})}A=y("whitespace_elements","pre script noscript style textarea video audio iframe object");C=y("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr");K=y("short_ended_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr track");D=y("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls");z=y("non_empty_elements","td th iframe video audio object",K);s=y("text_block_elements","h1 h2 h3 h4 h5 h6 p div address pre form blockquote center dir fieldset header footer article section hgroup aside nav figure");H=y("block_elements","hr table tbody thead tfoot th tr td li ol ul caption dl dt dd noscript menu isindex samp option datalist select optgroup",s);p((L.special||"script noscript style textarea").split(" "),function(P){w[P]=new RegExp("</"+P+"[^>]*>","gi")});function t(P){return new RegExp("^"+P.replace(/([?+*])/g,".$1")+"$")}function N(W){var V,R,ak,af,Q,T,ae,ah,aa,aj,am,Z,U,ag,P,ac,S,an,ad,Y=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)\])?$/,ab=/^([!\-])?(\w+::\w+|[^=:<]+)?(?:([=:<])(.*))?$/,X=/[*?+]/;if(W){W=o(W,",");if(E["@"]){ac=E["@"].attributes;S=E["@"].attributesOrder}for(V=0,R=W.length;V<R;V++){Q=Y.exec(W[V]);if(Q){ag=Q[1];aa=Q[2];P=Q[3];ah=Q[5];Z={};U=[];T={attributes:Z,attributesOrder:U};if(ag==="#"){T.paddEmpty=true}if(ag==="-"){T.removeEmpty=true}if(Q[4]==="!"){T.removeEmptyAttrs=true}if(ac){for(an in ac){Z[an]=ac[an]}U.push.apply(U,S)}if(ah){ah=o(ah,"|");for(ak=0,af=ah.length;ak<af;ak++){Q=ab.exec(ah[ak]);if(Q){ae={};am=Q[1];aj=Q[2].replace(/::/g,":");ag=Q[3];ad=Q[4];if(am==="!"){T.attributesRequired=T.attributesRequired||[];T.attributesRequired.push(aj);ae.required=true}if(am==="-"){delete Z[aj];U.splice(r(U,aj),1);continue}if(ag){if(ag==="="){T.attributesDefault=T.attributesDefault||[];T.attributesDefault.push({name:aj,value:ad});ae.defaultValue=ad}if(ag===":"){T.attributesForced=T.attributesForced||[];T.attributesForced.push({name:aj,value:ad});ae.forcedValue=ad}if(ag==="<"){ae.validValues=l(ad,"?")}}if(X.test(aj)){T.attributePatterns=T.attributePatterns||[];ae.pattern=t(aj);T.attributePatterns.push(ae)}else{if(!Z[aj]){U.push(aj)}Z[aj]=ae}}}}if(!ac&&aa=="@"){ac=Z;S=U}if(P){T.outputName=aa;E[P]=T}if(X.test(aa)){T.pattern=t(aa);u.push(T)}else{E[aa]=T}}}}}function F(P){E={};u=[];N(P);p(J,function(R,Q){v[Q]=R.children})}function x(Q){var P=/^(~)?(.+)$/;if(Q){p(o(Q,","),function(V){var T=P.exec(V),U=T[1]==="~",W=U?"span":"div",S=T[2];v[S]=v[W];B[S]=W;if(!U){H[S.toUpperCase()]={};H[S]={}}if(!E[S]){var R=E[W];R=m({},R);delete R.removeEmptyAttrs;delete R.removeEmpty;E[S]=R}p(v,function(X){if(X[W]){X[S]=X[W]}})})}}function I(Q){var P=/^([+\-]?)(\w+)\[([^\]]+)\]$/;if(Q){p(o(Q,","),function(U){var T=P.exec(U),R,S;if(T){S=T[1];if(S){R=v[T[2]]}else{R=v[T[2]]={"#comment":{}}}R=v[T[2]];p(o(T[3],"|"),function(V){if(S==="-"){delete R[V]}else{R[V]={}}})}})}}function M(P){var R=E[P],Q;if(R){return R}Q=u.length;while(Q--){R=u[Q];if(R.pattern.test(P)){return R}}}if(!L.valid_elements){p(J,function(Q,P){E[P]={attributes:Q.attributes,attributesOrder:Q.attributesOrder};v[P]=Q.children});if(L.schema!="html5"){p(o("strong/b em/i"),function(P){P=o(P,"/");E[P[1]].outputName=P[0]})}E.img.attributesDefault=[{name:"alt",value:""}];p(o("ol ul sub sup blockquote span font a table tbody tr strong em b i"),function(P){if(E[P]){E[P].removeEmpty=true}});p(o("p h1 h2 h3 h4 h5 h6 th td pre div address caption"),function(P){E[P].paddEmpty=true});p(o("span"),function(P){E[P].removeEmptyAttrs=true})}else{F(L.valid_elements)}x(L.custom_elements);I(L.valid_children);N(L.extended_valid_elements);I("+ol[ul|ol],+ul[ul|ol]");if(L.invalid_elements){p(n(L.invalid_elements),function(P){if(E[P]){delete E[P]}})}if(!M("span")){N("span[!data-mce-type|*]")}G.children=v;G.styles=O;G.getBoolAttrs=function(){return D};G.getBlockElements=function(){return H};G.getTextBlockElements=function(){return s};G.getShortEndedElements=function(){return K};G.getSelfClosingElements=function(){return C};G.getNonEmptyElements=function(){return z};G.getWhiteSpaceElements=function(){return A};G.getSpecialElements=function(){return w};G.isValidChild=function(P,R){var Q=v[P];return !!(Q&&Q[R])};G.isValid=function(Q,P){var S,R,T=M(Q);if(T){if(P){if(T.attributes[P]){return true}S=T.attributePatterns;if(S){R=S.length;while(R--){if(S[R].pattern.test(Q)){return true}}}}else{return true}}return false};G.getElementRule=M;G.getCustomElements=function(){return B};G.addValidElements=N;G.setValidElements=F;G.addCustomElements=x;G.addValidChildren=I;G.elements=E}});h("tinymce/html/SaxParser",["tinymce/html/Schema","tinymce/html/Entities","tinymce/util/Tools"],function(k,m,j){var l=j.each;return function(o,q){var n=this,p=function(){};o=o||{};n.schema=q=q||new k();if(o.fix_self_closing!==false){o.fix_self_closing=true}l("comment cdata text start end pi doctype".split(" "),function(r){if(r){n[r]=o[r]||p}});n.parse=function(M){var y=this,s,O=0,Q,J,I=[],V,Y,K,A;var H,B,U,P,W;var E,x,v,C,aa,X,N;var ab,T,r;var Z,R,w,L,S,t,F=0;var u=m.decode,G;function D(ac){var ae,ad;ae=I.length;while(ae--){if(I[ae].name===ac){break}}if(ae>=0){for(ad=I.length-1;ad>=ae;ad--){ac=I[ad];if(ac.valid){y.end(ac.name)}}I.length=ae}}function z(ad,ac,ah,ag,af){var ai,ae;ac=ac.toLowerCase();ah=ac in P?ac:u(ah||ag||af||"");if(E&&!H&&ac.indexOf("data-")!==0){ai=X[ac];if(!ai&&N){ae=N.length;while(ae--){ai=N[ae];if(ai.pattern.test(ac)){break}}if(ae===-1){ai=null}}if(!ai){return}if(ai.validValues&&!(ah in ai.validValues)){return}}V.map[ac]=ah;V.push({name:ac,value:ah})}w=new RegExp("<(?:(?:!--([\\w\\W]*?)-->)|(?:!\\[CDATA\\[([\\w\\W]*?)\\]\\]>)|(?:!DOCTYPE([\\w\\W]*?)>)|(?:\\?([^\\s\\/<>]+) ?([\\w\\W]*?)[?/]>)|(?:\\/([^>]+)>)|(?:([A-Za-z0-9\\-\\:\\.]+)((?:\\s+[^\"'>]+(?:(?:\"[^\"]*\")|(?:'[^']*')|[^>]*))*|\\/|\\s+)>))","g");L=/([\w:\-]+)(?:\s*=\s*(?:(?:\"((?:[^\"])*)\")|(?:\'((?:[^\'])*)\')|([^>\s]+)))?/g;U=q.getShortEndedElements();R=o.self_closing_elements||q.getSelfClosingElements();P=q.getBoolAttrs();E=o.validate;B=o.remove_internals;G=o.fix_self_closing;S=q.getSpecialElements();while((s=w.exec(M))){if(O<s.index){y.text(u(M.substr(O,s.index-O)))}if((Q=s[6])){Q=Q.toLowerCase();if(Q.charAt(0)===":"){Q=Q.substr(1)}D(Q)}else{if((Q=s[7])){Q=Q.toLowerCase();if(Q.charAt(0)===":"){Q=Q.substr(1)}W=Q in U;if(G&&R[Q]&&I.length>0&&I[I.length-1].name===Q){D(Q)}if(!E||(x=q.getElementRule(Q))){v=true;if(E){X=x.attributes;N=x.attributePatterns}if((aa=s[8])){H=aa.indexOf("data-mce-type")!==-1;if(H&&B){v=false}V=[];V.map={};aa.replace(L,z)}else{V=[];V.map={}}if(E&&!H){ab=x.attributesRequired;T=x.attributesDefault;r=x.attributesForced;Z=x.removeEmptyAttrs;if(Z&&!V.length){v=false}if(r){Y=r.length;while(Y--){C=r[Y];A=C.name;t=C.value;if(t==="{$uid}"){t="mce_"+F++}V.map[A]=t;V.push({name:A,value:t})}}if(T){Y=T.length;while(Y--){C=T[Y];A=C.name;if(!(A in V.map)){t=C.value;if(t==="{$uid}"){t="mce_"+F++}V.map[A]=t;V.push({name:A,value:t})}}}if(ab){Y=ab.length;while(Y--){if(ab[Y] in V.map){break}}if(Y===-1){v=false}}if(V.map["data-mce-bogus"]){v=false}}if(v){y.start(Q,V,W)}}else{v=false}if((J=S[Q])){J.lastIndex=O=s.index+s[0].length;if((s=J.exec(M))){if(v){K=M.substr(O,s.index-O)}O=s.index+s[0].length}else{K=M.substr(O);O=M.length}if(v){if(K.length>0){y.text(K,true)}y.end(Q)}w.lastIndex=O;continue}if(!W){if(!aa||aa.indexOf("/")!=aa.length-1){I.push({name:Q,valid:v})}else{if(v){y.end(Q)}}}}else{if((Q=s[1])){y.comment(Q)}else{if((Q=s[2])){y.cdata(Q)}else{if((Q=s[3])){y.doctype(Q)}else{if((Q=s[4])){y.pi(Q,s[5])}}}}}}O=s.index+s[0].length}if(O<M.length){y.text(u(M.substr(O)))}for(Y=I.length-1;Y>=0;Y--){Q=I[Y];if(Q.valid){y.end(Q.name)}}}}});h("tinymce/html/DomParser",["tinymce/html/Node","tinymce/html/Schema","tinymce/html/SaxParser","tinymce/util/Tools"],function(l,n,j,k){var o=k.makeMap,p=k.each,m=k.explode,q=k.extend;return function(v,w){var u=this,t={},s=[],x={},r={};v=v||{};v.validate="validate" in v?v.validate:true;v.root_name=v.root_name||"body";u.schema=w=w||new n();function y(C){var E,F,L,K,N,D,G,A,J;var z,I,B,M,H;I=o("tr,td,th,tbody,thead,tfoot,table");z=w.getNonEmptyElements();B=w.getTextBlockElements();for(E=0;E<C.length;E++){F=C[E];if(!F.parent||F.fixed){continue}if(B[F.name]&&F.parent.name=="li"){M=F.next;while(M){if(B[M.name]){M.name="li";M.fixed=true;F.parent.insert(M,F.parent)}else{break}M=M.next}F.unwrap(F);continue}K=[F];for(L=F.parent;L&&!w.isValidChild(L.name,F.name)&&!I[L.name];L=L.parent){K.push(L)}if(L&&K.length>1){K.reverse();N=D=u.filterNode(K[0].clone());for(J=0;J<K.length-1;J++){if(w.isValidChild(D.name,K[J].name)){G=u.filterNode(K[J].clone());D.append(G)}else{G=D}for(A=K[J].firstChild;A&&A!=K[J+1];){H=A.next;G.append(A);A=H}D=G}if(!N.isEmpty(z)){L.insert(N,K[0],true);L.insert(F,N)}else{L.insert(F,K[0],true)}L=K[0];if(L.isEmpty(z)||L.firstChild===L.lastChild&&L.firstChild.name==="br"){L.empty().remove()}}else{if(F.parent){if(F.name==="li"){M=F.prev;if(M&&(M.name==="ul"||M.name==="ul")){M.append(F);continue}M=F.next;if(M&&(M.name==="ul"||M.name==="ul")){M.insert(F,M.firstChild,true);continue}F.wrap(u.filterNode(new l("ul",1)));continue}if(w.isValidChild(F.parent.name,"div")&&w.isValidChild("div",F.name)){F.wrap(u.filterNode(new l("div",1)))}else{if(F.name==="style"||F.name==="script"){F.empty().remove()}else{F.unwrap()}}}}}}u.filterNode=function(B){var A,z,C;if(z in t){C=x[z];if(C){C.push(B)}else{x[z]=[B]}}A=s.length;while(A--){z=s[A].name;if(z in B.attributes.map){C=r[z];if(C){C.push(B)}else{r[z]=[B]}}}return B};u.addNodeFilter=function(z,A){p(m(z),function(B){var C=t[B];if(!C){t[B]=C=[]}C.push(A)})};u.addAttributeFilter=function(z,A){p(m(z),function(B){var C;for(C=0;C<s.length;C++){if(s[C].name===B){s[C].callbacks.push(A);return}}s.push({name:B,callbacks:[A]})})};u.parse=function(J,A){var B,W,O,N,Q,P,K,F,S,aa,M;var C,R,Z=[],Y;var H,z,L,G;var D,I,E;A=A||{};x={};r={};C=q(o("script,style,head,html,body,title,meta,param"),w.getBlockElements());I=w.getNonEmptyElements();D=w.children;M=v.validate;E="forced_root_block" in A?A.forced_root_block:v.forced_root_block;G=w.getWhiteSpaceElements();R=/^[ \t\r\n]+/;H=/[ \t\r\n]+$/;z=/[ \t\r\n]+/g;L=/^[ \t\r\n]+$/;function T(){var ad=W.firstChild,ac,ae;function ab(af){if(af){ad=af.firstChild;if(ad&&ad.type==3){ad.value=ad.value.replace(R,"")}ad=af.lastChild;if(ad&&ad.type==3){ad.value=ad.value.replace(H,"")}}}if(!w.isValidChild(W.name,E.toLowerCase())){return}while(ad){ac=ad.next;if(ad.type==3||(ad.type==1&&ad.name!=="p"&&!C[ad.name]&&!ad.attr("data-mce-type"))){if(!ae){ae=X(E,1);W.insert(ae,ad);ae.append(ad)}else{ae.append(ad)}}else{ab(ae);ae=null}ad=ac}ab(ae)}function X(ab,ac){var ad=new l(ab,ac),ae;if(ab in t){ae=x[ab];if(ae){ae.push(ad)}else{x[ab]=[ad]}}return ad}function V(ad){var ae,ab,ac;for(ae=ad.prev;ae&&ae.type===3;){ab=ae.value.replace(H,"");if(ab.length>0){ae.value=ab;ae=ae.prev}else{ac=ae.prev;ae.remove();ae=ac}}}function U(ac){var ad,ab={};for(ad in ac){if(ad!=="li"&&ad!="p"){ab[ad]=ac[ad]}}return ab}B=new j({validate:M,self_closing_elements:U(w.getSelfClosingElements()),cdata:function(ab){O.append(X("#cdata",4)).value=ab},text:function(ad,ab){var ac;if(!Y){ad=ad.replace(z," ");if(O.lastChild&&C[O.lastChild.name]){ad=ad.replace(R,"")}}if(ad.length!==0){ac=X("#text",3);ac.raw=!!ab;O.append(ac).value=ad}},comment:function(ab){O.append(X("#comment",8)).value=ab},pi:function(ab,ac){O.append(X(ab,7)).value=ac;V(O)},doctype:function(ac){var ab;ab=O.append(X("#doctype",10));ab.value=ac;V(O)},start:function(ad,ac,ai){var af,ab,ah,ae,ag;ah=M?w.getElementRule(ad):{};if(ah){af=X(ah.outputName||ad,1);af.attributes=ac;af.shortEnded=ai;O.append(af);ag=D[O.name];if(ag&&D[af.name]&&!ag[af.name]){Z.push(af)}ab=s.length;while(ab--){ae=s[ab].name;if(ae in ac.map){S=r[ae];if(S){S.push(af)}else{r[ae]=[af]}}}if(C[ad]){V(af)}if(!ai){O=af}if(!Y&&G[ad]){Y=true}}},end:function(ab){var ag,ad,af,ac,ae;ad=M?w.getElementRule(ab):{};if(ad){if(C[ab]){if(!Y){ag=O.firstChild;if(ag&&ag.type===3){af=ag.value.replace(R,"");if(af.length>0){ag.value=af;ag=ag.next}else{ac=ag.next;ag.remove();ag=ac;while(ag&&ag.type===3){af=ag.value;ac=ag.next;if(af.length===0||L.test(af)){ag.remove();ag=ac}ag=ac}}}ag=O.lastChild;if(ag&&ag.type===3){af=ag.value.replace(H,"");if(af.length>0){ag.value=af;ag=ag.prev}else{ac=ag.prev;ag.remove();ag=ac;while(ag&&ag.type===3){af=ag.value;ac=ag.prev;if(af.length===0||L.test(af)){ag.remove();ag=ac}ag=ac}}}}}if(Y&&G[ab]){Y=false}if(ad.removeEmpty||ad.paddEmpty){if(O.isEmpty(I)){if(ad.paddEmpty){O.empty().append(new l("#text","3")).value="\u00a0"}else{if(!O.attributes.map.name&&!O.attributes.map.id){ae=O.parent;O.empty().remove();O=ae;return}}}}O=O.parent}}},w);W=O=new l(A.context||v.root_name,11);B.parse(J);if(M&&Z.length){if(!A.context){y(Z)}else{A.invalid=true}}if(E&&(W.name=="body"||A.isRootContent)){T()}if(!A.invalid){for(aa in x){S=t[aa];N=x[aa];K=N.length;while(K--){if(!N[K].parent){N.splice(K,1)}}for(Q=0,P=S.length;Q<P;Q++){S[Q](N,aa,A)}}for(Q=0,P=s.length;Q<P;Q++){S=s[Q];if(S.name in r){N=r[S.name];K=N.length;while(K--){if(!N[K].parent){N.splice(K,1)}}for(K=0,F=S.callbacks.length;K<F;K++){S.callbacks[K](N,S.name,A)}}}}return W};if(v.remove_trailing_brs){u.addNodeFilter("br",function(A){var F,E=A.length,B,K=q({},w.getBlockElements());var z=w.getNonEmptyElements(),I,G,D,J;var H,C;K.body=1;for(F=0;F<E;F++){B=A[F];I=B.parent;if(K[B.parent.name]&&B===I.lastChild){D=B.prev;while(D){J=D.name;if(J!=="span"||D.attr("data-mce-type")!=="bookmark"){if(J!=="br"){break}if(J==="br"){B=null;break}}D=D.prev}if(B){B.remove();if(I.isEmpty(z)){H=w.getElementRule(I.name);if(H){if(H.removeEmpty){I.remove()}else{if(H.paddEmpty){I.empty().append(new l("#text",3)).value="\u00a0"}}}}}}else{G=B;while(I&&I.firstChild===G&&I.lastChild===G){G=I;if(K[I.name]){break}I=I.parent}if(G===I){C=new l("#text",3);C.value="\u00a0";B.replace(C)}}}})}if(!v.allow_html_in_named_anchor){u.addAttributeFilter("id,name",function(z){var B=z.length,D,A,C,E;while(B--){E=z[B];if(E.name==="a"&&E.firstChild&&!E.attr("href")){C=E.parent;D=E.lastChild;do{A=D.prev;C.insert(D,E);D=A}while(D)}}})}}});h("tinymce/html/Writer",["tinymce/html/Entities","tinymce/util/Tools"],function(l,j){var k=j.makeMap;return function(q){var o=[],m,n,p,r,s;q=q||{};m=q.indent;n=k(q.indent_before||"");p=k(q.indent_after||"");r=l.getEncodeFunc(q.entity_encoding||"raw",q.entities);s=q.element_format=="html";return{start:function(w,v,z){var x,u,t,y;if(m&&n[w]&&o.length>0){y=o[o.length-1];if(y.length>0&&y!=="\n"){o.push("\n")}}o.push("<",w);if(v){for(x=0,u=v.length;x<u;x++){t=v[x];o.push(" ",t.name,'="',r(t.value,true),'"')}}if(!z||s){o[o.length]=">"}else{o[o.length]=" />"}if(z&&m&&p[w]&&o.length>0){y=o[o.length-1];if(y.length>0&&y!=="\n"){o.push("\n")}}},end:function(t){var u;o.push("</",t,">");if(m&&p[t]&&o.length>0){u=o[o.length-1];if(u.length>0&&u!=="\n"){o.push("\n")}}},text:function(u,t){if(u.length>0){o[o.length]=t?u:r(u)}},cdata:function(t){o.push("<![CDATA[",t,"]]>")},comment:function(t){o.push("<!--",t,"-->")},pi:function(t,u){if(u){o.push("<?",t," ",u,"?>")}else{o.push("<?",t,"?>")}if(m){o.push("\n")}},doctype:function(t){o.push("<!DOCTYPE",t,">",m?"\n":"")},reset:function(){o.length=0},getContent:function(){return o.join("").replace(/\n$/,"")}}}});h("tinymce/html/Serializer",["tinymce/html/Writer","tinymce/html/Schema"],function(k,j){return function(m,n){var l=this,o=new k(m);m=m||{};m.validate="validate" in m?m.validate:true;l.schema=n=n||new j();l.writer=o;l.serialize=function(r){var q,s;s=m.validate;q={3:function(t){o.text(t.value,t.raw)},8:function(t){o.comment(t.value)},7:function(t){o.pi(t.name,t.value)},10:function(t){o.doctype(t.value)},4:function(t){o.cdata(t.value)},11:function(t){if((t=t.firstChild)){do{p(t)}while((t=t.next))}}};o.reset();function p(u){var C=q[u.type],t,x,B,A,y,D,w,v,z;if(!C){t=u.name;x=u.shortEnded;B=u.attributes;if(s&&B&&B.length>1){D=[];D.map={};z=n.getElementRule(u.name);for(w=0,v=z.attributesOrder.length;w<v;w++){A=z.attributesOrder[w];if(A in B.map){y=B.map[A];D.map[A]=y;D.push({name:A,value:y})}}for(w=0,v=B.length;w<v;w++){A=B[w].name;if(!(A in D.map)){y=B.map[A];D.map[A]=y;D.push({name:A,value:y})}}B=D}o.start(u.name,B,x);if(!x){if((u=u.firstChild)){do{p(u)}while((u=u.next))}o.end(t)}}else{C(u)}}if(r.type==1&&!m.inner){p(r)}else{q[11](r)}return o.getContent()}}});h("tinymce/dom/Serializer",["tinymce/dom/DOMUtils","tinymce/html/DomParser","tinymce/html/Entities","tinymce/html/Serializer","tinymce/html/Node","tinymce/html/Schema","tinymce/Env","tinymce/util/Tools"],function(q,t,k,p,n,m,o,l){var r=l.each,j=l.trim;var s=q.DOM;return function(w,v){var y,x,u;if(v){y=v.dom;x=v.schema}y=y||s;x=x||new m(w);w.entity_encoding=w.entity_encoding||"named";w.remove_trailing_brs="remove_trailing_brs" in w?w.remove_trailing_brs:true;u=new t(w,x);u.addAttributeFilter("src,href,style",function(A,z){var E=A.length,B,G,D="data-mce-"+z;var F=w.url_converter,H=w.url_converter_scope,C;while(E--){B=A[E];G=B.attributes.map[D];if(G!==C){B.attr(z,G.length>0?G:null);B.attr(D,null)}else{G=B.attributes.map[z];if(z==="style"){G=y.serializeStyle(y.parseStyle(G),B.name)}else{if(F){G=F.call(H,G,z,B.name)}}B.attr(z,G.length>0?G:null)}}});u.addAttributeFilter("class",function(z){var A=z.length,B,C;while(A--){B=z[A];C=B.attr("class").replace(/(?:^|\s)mce-item-\w+(?!\S)/g,"");B.attr("class",C.length>0?C:null)}});u.addAttributeFilter("data-mce-type",function(z,B,A){var C=z.length,D;while(C--){D=z[C];if(D.attributes.map["data-mce-type"]==="bookmark"&&!A.cleanup){D.remove()}}});u.addAttributeFilter("data-mce-expando",function(z,A){var B=z.length;while(B--){z[B].attr(A,null)}});u.addNodeFilter("noscript",function(z){var A=z.length,B;while(A--){B=z[A].firstChild;if(B){B.value=k.decode(B.value)}}});u.addNodeFilter("script,style",function(A,B){var C=A.length,E,F;function z(G){return G.replace(/(<!--\[CDATA\[|\]\]-->)/g,"\n").replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,"")}while(C--){E=A[C];F=E.firstChild?E.firstChild.value:"";if(B==="script"){var D=(E.attr("type")||"text/javascript").replace(/^mce\-/,"");E.attr("type",D==="text/javascript"?null:D);if(F.length>0){E.firstChild.value="// <![CDATA[\n"+z(F)+"\n// ]]>"}}else{if(F.length>0){E.firstChild.value="<!--\n"+z(F)+"\n-->"}}}});u.addNodeFilter("#comment",function(z){var A=z.length,B;while(A--){B=z[A];if(B.value.indexOf("[CDATA[")===0){B.name="#cdata";B.type=4;B.value=B.value.replace(/^\[CDATA\[|\]\]$/g,"")}else{if(B.value.indexOf("mce:protected ")===0){B.name="#text";B.type=3;B.raw=true;B.value=unescape(B.value).substr(14)}}}});u.addNodeFilter("xml:namespace,input",function(z,A){var B=z.length,C;while(B--){C=z[B];if(C.type===7){C.remove()}else{if(C.type===1){if(A==="input"&&!("type" in C.attributes.map)){C.attr("type","text")}}}}});if(w.fix_list_elements){u.addNodeFilter("ul,ol",function(A){var B=A.length,C,z;while(B--){C=A[B];z=C.parent;if(z.name==="ul"||z.name==="ol"){if(C.prev&&C.prev.name==="li"){C.prev.append(C)}}}})}u.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,data-mce-selected",function(z,A){var B=z.length;while(B--){z[B].attr(A,null)}});return{schema:x,addNodeFilter:u.addNodeFilter,addAttributeFilter:u.addAttributeFilter,serialize:function(F,D){var C=this,B,G,A,z,E;if(o.ie&&y.select("script,style,select,map").length>0){E=F.innerHTML;F=F.cloneNode(false);y.setHTML(F,E)}else{F=F.cloneNode(true)}B=F.ownerDocument.implementation;if(B.createHTMLDocument){G=B.createHTMLDocument("");r(F.nodeName=="BODY"?F.childNodes:[F],function(H){G.body.appendChild(G.importNode(H,true))});if(F.nodeName!="BODY"){F=G.body.firstChild}else{F=G.body}A=y.doc;y.doc=G}D=D||{};D.format=D.format||"html";if(D.selection){D.forced_root_block=""}if(!D.no_events){D.node=F;C.onPreProcess(D)}z=new p(w,x);D.content=z.serialize(u.parse(j(D.getInner?F.innerHTML:y.getOuterHTML(F)),D));if(!D.cleanup){D.content=D.content.replace(/\uFEFF/g,"")}if(!D.no_events){C.onPostProcess(D)}if(A){y.doc=A}D.node=null;return D.content},addRules:function(z){x.addValidElements(z)},setRules:function(z){x.setValidElements(z)},onPreProcess:function(z){if(v){v.fire("PreProcess",z)}},onPostProcess:function(z){if(v){v.fire("PostProcess",z)}}}}});h("tinymce/dom/TridentSelection",[],function(){function j(l){var k=this,p=l.dom,n=false;function m(q,r){var s,B=0,y,v,u,t,w,z,x=-1,A;s=q.duplicate();s.collapse(r);A=s.parentElement();if(A.ownerDocument!==l.dom.doc){return}while(A.contentEditable==="false"){A=A.parentNode}if(!A.hasChildNodes()){return{node:A,inside:1}}u=A.children;y=u.length-1;while(B<=y){z=Math.floor((B+y)/2);t=u[z];s.moveToElementText(t);x=s.compareEndPoints(r?"StartToStart":"EndToEnd",q);if(x>0){y=z-1}else{if(x<0){B=z+1}else{return{node:t}}}}if(x<0){if(!t){s.moveToElementText(A);s.collapse(true);t=A;v=true}else{s.collapse(false)}w=0;while(s.compareEndPoints(r?"StartToStart":"StartToEnd",q)!==0){if(s.move("character",1)===0||A!=s.parentElement()){break}w++}}else{s.collapse(true);w=0;while(s.compareEndPoints(r?"StartToStart":"StartToEnd",q)!==0){if(s.move("character",-1)===0||A!=s.parentElement()){break}w++}}return{node:t,position:x,offset:w,inside:v}}function o(){var q=l.getRng(),y=p.createRng(),s,r,w,x,t;s=q.item?q.item(0):q.parentElement();if(s.ownerDocument!=p.doc){return y}r=l.isCollapsed();if(q.item){y.setStart(s.parentNode,p.nodeIndex(s));y.setEnd(y.startContainer,y.startOffset+1);return y}function v(G){var B=m(q,G),z,E,F=0,D,C,A;z=B.node;E=B.offset;if(B.inside&&!z.hasChildNodes()){y[G?"setStart":"setEnd"](z,0);return}if(E===C){y[G?"setStartBefore":"setEndAfter"](z);return}if(B.position<0){D=B.inside?z.firstChild:z.nextSibling;if(!D){y[G?"setStartAfter":"setEndAfter"](z);return}if(!E){if(D.nodeType==3){y[G?"setStart":"setEnd"](D,0)}else{y[G?"setStartBefore":"setEndBefore"](D)}return}while(D){A=D.nodeValue;F+=A.length;if(F>=E){z=D;F-=E;F=A.length-F;break}D=D.nextSibling}}else{D=z.previousSibling;if(!D){return y[G?"setStartBefore":"setEndBefore"](z)}if(!E){if(z.nodeType==3){y[G?"setStart":"setEnd"](D,z.nodeValue.length)}else{y[G?"setStartAfter":"setEndAfter"](D)}return}while(D){F+=D.nodeValue.length;if(F>=E){z=D;F-=E;break}D=D.previousSibling}}y[G?"setStart":"setEnd"](z,F)}try{v(true);if(!r){v()}}catch(u){if(u.number==-2147024809){t=k.getBookmark(2);w=q.duplicate();w.collapse(true);s=w.parentElement();if(!r){w=q.duplicate();w.collapse(false);x=w.parentElement();x.innerHTML=x.innerHTML}s.innerHTML=s.innerHTML;k.moveToBookmark(t);q=l.getRng();v(true);if(!r){v()}}else{throw u}}return y}this.getBookmark=function(t){var q=l.getRng(),s={};function u(A){var z,v,y,x,w=[];z=A.parentNode;v=p.getRoot().parentNode;while(z!=v&&z.nodeType!==9){y=z.children;x=y.length;while(x--){if(A===y[x]){w.push(x);break}}A=z;z=z.parentNode}return w}function r(w){var v;v=m(q,w);if(v){return{position:v.position,offset:v.offset,indexes:u(v.node),inside:v.inside}}}if(t===2){if(!q.item){s.start=r(true);if(!l.isCollapsed()){s.end=r()}}else{s.start={ctrl:true,indexes:u(q.item(0))}}}return s};this.moveToBookmark=function(s){var r,q=p.doc.body;function u(w){var z,y,v,x;z=p.getRoot();for(y=w.length-1;y>=0;y--){x=z.children;v=w[y];if(v<=x.length-1){z=x[v]}}return z}function t(A){var v=s[A?"start":"end"],y,x,w,z;if(v){y=v.position>0;x=q.createTextRange();x.moveToElementText(u(v.indexes));z=v.offset;if(z!==w){x.collapse(v.inside||y);x.moveStart("character",y?-z:z)}else{x.collapse(A)}r.setEndPoint(A?"StartToStart":"EndToStart",x);if(A){r.collapse(true)}}}if(s.start){if(s.start.ctrl){r=q.createControlRange();r.addElement(u(s.start.indexes));r.select()}else{r=q.createTextRange();t(true);t();r.select()}}};this.addRange=function(q){var v,t,s,x,D,y,B,A=l.dom.doc,u=A.body,z,C;function r(J){var F,I,E,H,G;E=p.create("a");F=J?s:D;I=J?x:y;H=v.duplicate();if(F==A||F==A.documentElement){F=u;I=0}if(F.nodeType==3){F.parentNode.insertBefore(E,F);H.moveToElementText(E);H.moveStart("character",I);p.remove(E);v.setEndPoint(J?"StartToStart":"EndToEnd",H)}else{G=F.childNodes;if(G.length){if(I>=G.length){p.insertAfter(E,G[G.length-1])}else{F.insertBefore(E,G[I])}H.moveToElementText(E)}else{if(F.canHaveHTML){F.innerHTML="<span>&#xFEFF;</span>";E=F.firstChild;H.moveToElementText(E);H.collapse(n)}}v.setEndPoint(J?"StartToStart":"EndToEnd",H);p.remove(E)}}s=q.startContainer;x=q.startOffset;D=q.endContainer;y=q.endOffset;v=u.createTextRange();if(s==D&&s.nodeType==1){if(x==y&&!s.hasChildNodes()){if(s.canHaveHTML){B=s.previousSibling;if(B&&!B.hasChildNodes()&&p.isBlock(B)){B.innerHTML="&#xFEFF;"}else{B=null}s.innerHTML="<span>&#xFEFF;</span><span>&#xFEFF;</span>";v.moveToElementText(s.lastChild);v.select();p.doc.selection.clear();s.innerHTML="";if(B){B.innerHTML=""}return}else{x=p.nodeIndex(s);s=s.parentNode}}if(x==y-1){try{C=s.childNodes[x];t=u.createControlRange();t.addElement(C);t.select();z=l.getRng();if(z.item&&C===z.item(0)){return}}catch(w){}}}r(true);r();v.select()};this.getRangeAt=o}return j});h("tinymce/util/VK",["tinymce/Env"],function(j){return{BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,modifierPressed:function(k){return k.shiftKey||k.ctrlKey||k.altKey},metaKeyPressed:function(k){return(j.mac?k.ctrlKey||k.metaKey:k.ctrlKey)&&!k.altKey}}});h("tinymce/dom/ControlSelection",["tinymce/util/VK","tinymce/util/Tools","tinymce/Env"],function(l,k,j){return function(y,n){var o=n.dom,P=k.each;var v,W,M,V,T;var C,A,J,I,D,G,N,r;var m,p,w=n.getDoc(),U=document,u=j.ie&&j.ie<11;M={n:[0.5,0,0,-1],e:[1,0.5,1,0],s:[0.5,1,0,1],w:[0,0.5,-1,0],nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]};var B=".mce-content-body";n.contentStyles.push(B+" div.mce-resizehandle {position: absolute;border: 1px solid black;background: #FFF;width: 5px;height: 5px;z-index: 10000}"+B+" .mce-resizehandle:hover {background: #000}"+B+" img[data-mce-selected], hr[data-mce-selected] {outline: 1px solid black;resize: none}"+B+" .mce-clonedresizable {position: absolute;"+(j.gecko?"":"outline: 1px dashed black;")+"opacity: .5;filter: alpha(opacity=50);z-index: 10000}");function Q(X){if(n.settings.object_resizing===false){return false}if(!/TABLE|IMG|DIV/.test(X.nodeName)){return false}if(X.getAttribute("data-mce-resize")==="false"){return false}return true}function q(Z){var Y,X;Y=Z.screenX-C;X=Z.screenY-A;m=Y*V[2]+D;p=X*V[3]+G;m=m<5?5:m;p=p<5?5:p;if(l.modifierPressed(Z)||(v.nodeName=="IMG"&&V[2]*V[3]!==0)){m=Math.round(p/N);p=Math.round(m*N)}o.setStyles(W,{width:m,height:p});if(V[2]<0&&W.clientWidth<=m){o.setStyle(W,"left",J+(D-m))}if(V[3]<0&&W.clientHeight<=p){o.setStyle(W,"top",I+(G-p))}if(!r){n.fire("ObjectResizeStart",{target:v,width:D,height:G});r=true}}function L(){r=false;function X(Y,Z){if(Z){if(v.style[Y]||!n.schema.isValid(v.nodeName.toLowerCase(),Y)){o.setStyle(v,Y,Z)}else{o.setAttrib(v,Y,Z)}}}X("width",m);X("height",p);o.unbind(w,"mousemove",q);o.unbind(w,"mouseup",L);if(U!=w){o.unbind(U,"mousemove",q);o.unbind(U,"mouseup",L)}o.remove(W);if(!u||v.nodeName=="TABLE"){H(v)}n.fire("ObjectResized",{target:v,width:m,height:p});n.nodeChanged()}function H(af,ac,Y){var Z,ae,aa,ab,ad;var X=n.getBody().offsetParent||n.getBody();Z=o.getPos(af,X);J=Z.x;I=Z.y;ad=af.getBoundingClientRect();ae=ad.width||(ad.right-ad.left);aa=ad.height||(ad.bottom-ad.top);if(v!=af){R();v=af;m=p=0}ab=n.fire("ObjectSelected",{target:af});if(Q(af)&&!ab.isDefaultPrevented()){P(M,function(aj,ah){var ai,ak;function ag(al){r=true;C=al.screenX;A=al.screenY;D=v.clientWidth;G=v.clientHeight;N=G/D;V=aj;W=v.cloneNode(true);o.addClass(W,"mce-clonedresizable");W.contentEditable=false;W.unSelectabe=true;o.setStyles(W,{left:J,top:I,margin:0});W.removeAttribute("data-mce-selected");n.getBody().appendChild(W);o.bind(w,"mousemove",q);o.bind(w,"mouseup",L);if(U!=w){o.bind(U,"mousemove",q);o.bind(U,"mouseup",L)}}if(ac){if(ah==ac){ag(Y)}return}ai=o.get("mceResizeHandle"+ah);if(!ai){ak=n.getBody();ai=o.add(ak,"div",{id:"mceResizeHandle"+ah,"data-mce-bogus":true,"class":"mce-resizehandle",contentEditable:false,unSelectabe:true,style:"cursor:"+ah+"-resize; margin:0; padding:0"});o.bind(ai,"mousedown",function(al){al.preventDefault();ag(al)})}else{o.show(ai)}o.setStyles(ai,{left:(ae*aj[0]+J)-(ai.offsetWidth/2),top:(aa*aj[1]+I)-(ai.offsetHeight/2)})})}else{E()}v.setAttribute("data-mce-selected","1")}function E(){var X,Y;if(v){v.removeAttribute("data-mce-selected")}for(X in M){Y=o.get("mceResizeHandle"+X);if(Y){o.unbind(Y);o.remove(Y)}}}function F(Z){var X;function Y(ab,aa){do{if(ab===aa){return true}}while((ab=ab.parentNode))}P(o.select("img[data-mce-selected],hr[data-mce-selected]"),function(aa){aa.removeAttribute("data-mce-selected")});X=Z.type=="mousedown"?Z.target:y.getNode();X=o.getParent(X,u?"table":"table,img,hr");if(X){K();if(Y(y.getStart(),X)&&Y(y.getEnd(),X)){if(!u||(X!=y.getStart()&&y.getStart().nodeName!=="IMG")){H(X);return}}}E()}function s(Z,X,Y){if(Z&&Z.attachEvent){Z.attachEvent("on"+X,Y)}}function z(Z,X,Y){if(Z&&Z.detachEvent){Z.detachEvent("on"+X,Y)}}function x(Z){var aa=Z.srcElement,ae,X,af,ad,ab,ac,Y;ae=aa.getBoundingClientRect();ac=T.clientX-ae.left;Y=T.clientY-ae.top;for(X in M){af=M[X];ad=aa.offsetWidth*af[0];ab=aa.offsetHeight*af[1];if(Math.abs(ad-ac)<8&&Math.abs(ab-Y)<8){V=af;break}}r=true;n.getDoc().selection.empty();H(aa,X,T)}function S(Y){var X=Y.srcElement;if(X!=v){R();if(X.id.indexOf("mceResizeHandle")===0){Y.returnValue=false;return}if(X.nodeName=="IMG"||X.nodeName=="TABLE"){E();v=X;s(X,"resizestart",x)}}}function R(){z(v,"resizestart",x)}function K(){try{n.getDoc().execCommand("enableObjectResizing",false,false)}catch(X){}}function t(Z){var Y;if(!u){return}Y=w.body.createControlRange();try{Y.addElement(Z);Y.select();return true}catch(X){}}n.on("init",function(){if(u){n.on("ObjectResized",function(X){if(X.target.nodeName!="TABLE"){E();t(X.target)}});s(n.getBody(),"controlselect",S);n.on("mousedown",function(X){T=X})}else{K();if(j.ie>=11){n.on("mouseup mousedown",function(X){if(X.target.nodeName=="IMG"||n.selection.getNode().nodeName=="IMG"){X.preventDefault();n.selection.select(X.target)}})}}n.on("nodechange mousedown ResizeEditor",F);n.on("keydown keyup",function(X){if(v&&v.nodeName=="TABLE"){F(X)}})});function O(){v=W=null;if(u){R();z(n.getBody(),"controlselect",S)}}return{isResizable:Q,showResizeRect:H,hideResizeRect:E,updateResizeRect:F,controlSelect:t,destroy:O}}});h("tinymce/dom/Selection",["tinymce/dom/TreeWalker","tinymce/dom/TridentSelection","tinymce/dom/ControlSelection","tinymce/Env","tinymce/util/Tools"],function(r,p,j,o,n){var q=n.each,s=n.grep,m=n.trim;var l=o.ie,k=o.opera;function t(y,x,w,v){var u=this;u.dom=y;u.win=x;u.serializer=w;u.editor=v;u.controlSelection=new j(u,v);if(!u.win.getSelection){u.tridentSel=new p(u)}}t.prototype={setCursorLocation:function(w,x){var v=this,u=v.dom.createRng();u.setStart(w,x);u.setEnd(w,x);v.setRng(u);v.collapse(false)},getContent:function(y){var w=this,v=w.getRng(),u=w.dom.create("body");var B=w.getSel(),A,z,x;y=y||{};A=z="";y.get=true;y.format=y.format||"html";y.selection=true;w.editor.fire("BeforeGetContent",y);if(y.format=="text"){return w.isCollapsed()?"":(v.text||(B.toString?B.toString():""))}if(v.cloneContents){x=v.cloneContents();if(x){u.appendChild(x)}}else{if(v.item!==g||v.htmlText!==g){u.innerHTML="<br>"+(v.item?v.item(0).outerHTML:v.htmlText);u.removeChild(u.firstChild)}else{u.innerHTML=v.toString()}}if(/^\s/.test(u.innerHTML)){A=" "}if(/\s+$/.test(u.innerHTML)){z=" "}y.getInner=true;y.content=w.isCollapsed()?"":A+w.serializer.serialize(u,y)+z;w.editor.fire("GetContent",y);return y.content},setContent:function(v,x){var C=this,u=C.getRng(),y,z=C.win.document,B,A;x=x||{format:"html"};x.set=true;x.selection=true;v=x.content=v;if(!x.no_events){C.editor.fire("BeforeSetContent",x)}v=x.content;if(u.insertNode){v+='<span id="__caret">_</span>';if(u.startContainer==z&&u.endContainer==z){z.body.innerHTML=v}else{u.deleteContents();if(z.body.childNodes.length===0){z.body.innerHTML=v}else{if(u.createContextualFragment){u.insertNode(u.createContextualFragment(v))}else{B=z.createDocumentFragment();A=z.createElement("div");B.appendChild(A);A.outerHTML=v;u.insertNode(B)}}}y=C.dom.get("__caret");u=z.createRange();u.setStartBefore(y);u.setEndBefore(y);C.setRng(u);C.dom.remove("__caret");try{C.setRng(u)}catch(w){}}else{if(u.item){z.execCommand("Delete",false,null);u=C.getRng()}if(/^\s+/.test(v)){u.pasteHTML('<span id="__mce_tmp">_</span>'+v);C.dom.remove("__mce_tmp")}else{u.pasteHTML(v)}}if(!x.no_events){C.editor.fire("SetContent",x)}},getStart:function(){var w=this,v=w.getRng(),x,u,z,y;if(v.duplicate||v.item){if(v.item){return v.item(0)}z=v.duplicate();z.collapse(1);x=z.parentElement();if(x.ownerDocument!==w.dom.doc){x=w.dom.getRoot()}u=y=v.parentElement();while((y=y.parentNode)){if(y==x){x=u;break}}return x}else{x=v.startContainer;if(x.nodeType==1&&x.hasChildNodes()){x=x.childNodes[Math.min(x.childNodes.length-1,v.startOffset)]}if(x&&x.nodeType==3){return x.parentNode}return x}},getEnd:function(){var v=this,u=v.getRng(),x,w;if(u.duplicate||u.item){if(u.item){return u.item(0)}u=u.duplicate();u.collapse(0);x=u.parentElement();if(x.ownerDocument!==v.dom.doc){x=v.dom.getRoot()}if(x&&x.nodeName=="BODY"){return x.lastChild||x}return x}else{x=u.endContainer;w=u.endOffset;if(x.nodeType==1&&x.hasChildNodes()){x=x.childNodes[w>0?w-1:w]}if(x&&x.nodeType==3){return x.parentNode}return x}},getBookmark:function(F,H){var J=this,B=J.dom,v,y,x,C,w,D,A="&#xFEFF;",I;function u(L,M){var K=0;q(B.select(L),function(O,N){if(O==M){K=N}});return K}function G(K){function L(Q){var M,P,O,N=Q?"start":"end";M=K[N+"Container"];P=K[N+"Offset"];if(M.nodeType==1&&M.nodeName=="TR"){O=M.childNodes;M=O[Math.min(Q?P:P-1,O.length-1)];if(M){P=Q?0:M.childNodes.length;K["set"+(Q?"Start":"End")](M,P)}}}L(true);L();return K}function z(){var L=J.getRng(true),K=B.getRoot(),M={};function N(Q,V){var P=Q[V?"startContainer":"endContainer"],U=Q[V?"startOffset":"endOffset"],O=[],R,T,S=0;if(P.nodeType==3){if(H){for(R=P.previousSibling;R&&R.nodeType==3;R=R.previousSibling){U+=R.nodeValue.length}}O.push(U)}else{T=P.childNodes;if(U>=T.length&&T.length){S=1;U=Math.max(0,T.length-1)}O.push(J.dom.nodeIndex(T[U],H)+S)}for(;P&&P!=K;P=P.parentNode){O.push(J.dom.nodeIndex(P,H))}return O}M.start=N(L,true);if(!J.isCollapsed()){M.end=N(L)}return M}if(F==2){D=J.getNode();w=D.nodeName;if(w=="IMG"){return{name:w,index:u(w,D)}}if(J.tridentSel){return J.tridentSel.getBookmark(F)}return z()}if(F){return{rng:J.getRng()}}v=J.getRng();x=B.uniqueId();C=J.isCollapsed();I="overflow:hidden;line-height:0px";if(v.duplicate||v.item){if(!v.item){y=v.duplicate();try{v.collapse();v.pasteHTML('<span data-mce-type="bookmark" id="'+x+'_start" style="'+I+'">'+A+"</span>");if(!C){y.collapse(false);v.moveToElementText(y.parentElement());if(v.compareEndPoints("StartToEnd",y)===0){y.move("character",-1)}y.pasteHTML('<span data-mce-type="bookmark" id="'+x+'_end" style="'+I+'">'+A+"</span>")}}catch(E){return null}}else{D=v.item(0);w=D.nodeName;return{name:w,index:u(w,D)}}}else{D=J.getNode();w=D.nodeName;if(w=="IMG"){return{name:w,index:u(w,D)}}y=G(v.cloneRange());if(!C){y.collapse(false);y.insertNode(B.create("span",{"data-mce-type":"bookmark",id:x+"_end",style:I},A))}v=G(v);v.collapse(true);v.insertNode(B.create("span",{"data-mce-type":"bookmark",id:x+"_start",style:I},A))}J.moveToBookmark({id:x,keep:1});return{id:x}},moveToBookmark:function(A){var E=this,y=E.dom,u,D,w,F,B,C;function v(L){var G=A[L?"start":"end"],I,J,K,H;if(G){K=G[0];for(J=D,I=G.length-1;I>=1;I--){H=J.childNodes;if(G[I]>H.length-1){return}J=H[G[I]]}if(J.nodeType===3){K=Math.min(G[0],J.nodeValue.length)}if(J.nodeType===1){K=Math.min(G[0],J.childNodes.length)}if(L){u.setStart(J,K)}else{u.setEnd(J,K)}}return true}function x(M){var H=y.get(A.id+"_"+M),L,G,J,K,I=A.keep;if(H){L=H.parentNode;if(M=="start"){if(!I){G=y.nodeIndex(H)}else{L=H.firstChild;G=1}w=F=L;B=C=G}else{if(!I){G=y.nodeIndex(H)}else{L=H.firstChild;G=1}F=L;C=G}if(!I){K=H.previousSibling;J=H.nextSibling;q(s(H.childNodes),function(N){if(N.nodeType==3){N.nodeValue=N.nodeValue.replace(/\uFEFF/g,"")}});while((H=y.get(A.id+"_"+M))){y.remove(H,1)}if(K&&J&&K.nodeType==J.nodeType&&K.nodeType==3&&!k){G=K.nodeValue.length;K.appendData(J.nodeValue);y.remove(J);if(M=="start"){w=F=K;B=C=G}else{F=K;C=G}}}}}function z(G){if(y.isBlock(G)&&!G.innerHTML&&!l){G.innerHTML='<br data-mce-bogus="1" />'}return G}if(A){if(A.start){u=y.createRng();D=y.getRoot();if(E.tridentSel){return E.tridentSel.moveToBookmark(A)}if(v(true)&&v()){E.setRng(u)}}else{if(A.id){x("start");x("end");if(w){u=y.createRng();u.setStart(z(w),B);u.setEnd(z(F),C);E.setRng(u)}}else{if(A.name){E.select(y.select(A.name)[A.index])}else{if(A.rng){E.setRng(A.rng)}}}}}},select:function(A,z){var x=this,B=x.dom,v=B.createRng(),u,y;x.lastFocusBookmark=null;y=B.schema.getNonEmptyElements();function w(D,F){var C=D,E=new r(D,C);do{if(D.nodeType==3&&m(D.nodeValue).length!==0){if(F){v.setStart(D,0)}else{v.setEnd(D,D.nodeValue.length)}return}if(y[D.nodeName]){if(F){v.setStartBefore(D)}else{if(D.nodeName=="BR"){v.setEndBefore(D)}else{v.setEndAfter(D)}}return}}while((D=(F?E.next():E.prev())));if(C.nodeName=="BODY"){if(F){v.setStart(C,0)}else{v.setEnd(C,C.childNodes.length)}}}if(A){if(!z&&x.controlSelection.controlSelect(A)){return}u=B.nodeIndex(A);v.setStart(A.parentNode,u);v.setEnd(A.parentNode,u+1);if(z){w(A,1);w(A)}x.setRng(v)}return A},isCollapsed:function(){var v=this,u=v.getRng(),w=v.getSel();if(!u||u.item){return false}if(u.compareEndPoints){return u.compareEndPoints("StartToEnd",u)===0}return !w||u.collapsed},collapse:function(u){var w=this,v=w.getRng(),x;if(v.item){x=v.item(0);v=w.win.document.body.createTextRange();v.moveToElementText(x)}v.collapse(!!u);w.setRng(v)},getSel:function(){var u=this.win;return u.getSelection?u.getSelection():u.document.selection},getRng:function(A){var D=this,C,u,z,B=D.win.document,w;if(!A&&D.lastFocusBookmark){var x=D.lastFocusBookmark;if(x.startContainer&&x.endContainer){u=B.createRange();try{u.setStart(x.startContainer,x.startOffset||0)}catch(v){u.setStart(x.startContainer,0)}try{u.setEnd(x.endContainer,x.endOffset||0)}catch(v){u.setEnd(x.endContainer,0)}}else{u=x}return u}if(A&&D.tridentSel){return D.tridentSel.getRangeAt(0)}try{if((C=D.getSel())){if(C.rangeCount>0){u=C.getRangeAt(0)}else{u=C.createRange?C.createRange():B.createRange()}}}catch(y){}if(l&&u&&u.setStart){try{w=B.selection.createRange()}catch(y){}if(w&&w.item){z=w.item(0);u=B.createRange();u.setStartBefore(z);u.setEndAfter(z)}}if(!u){u=B.createRange?B.createRange():B.body.createTextRange()}if(u.setStart&&u.startContainer.nodeType===9&&u.collapsed){z=D.dom.getRoot();u.setStart(z,0);u.setEnd(z,0)}if(D.selectedRange&&D.explicitRange){if(u.compareBoundaryPoints(u.START_TO_START,D.selectedRange)===0&&u.compareBoundaryPoints(u.END_TO_END,D.selectedRange)===0){u=D.explicitRange}else{D.selectedRange=null;D.explicitRange=null}}return u},setRng:function(u,w){var v=this,y;if(u.select){try{u.select()}catch(x){}return}if(!v.tridentSel){y=v.getSel();if(y){v.explicitRange=u;try{y.removeAllRanges();y.addRange(u)}catch(x){}if(w===false&&y.extend){y.collapse(u.endContainer,u.endOffset);y.extend(u.startContainer,u.startOffset)}v.selectedRange=y.rangeCount>0?y.getRangeAt(0):null}}else{if(u.cloneRange){try{v.tridentSel.addRange(u);return}catch(x){}}}},setNode:function(v){var u=this;u.setContent(u.dom.getOuterHTML(v));return v},getNode:function(){var w=this,v=w.getRng(),B;var y=v.startContainer,z=v.endContainer;var u=v.startOffset,x=v.endOffset;function A(D,C){var E=D;while(D&&D.nodeType===3&&D.length===0){D=C?D.nextSibling:D.previousSibling}return D||E}if(!v){return w.dom.getRoot()}if(v.setStart){B=v.commonAncestorContainer;if(!v.collapsed){if(y==z){if(x-u<2){if(y.hasChildNodes()){B=y.childNodes[u]}}}if(y.nodeType===3&&z.nodeType===3){if(y.length===u){y=A(y.nextSibling,true)}else{y=y.parentNode}if(x===0){z=A(z.previousSibling,false)}else{z=z.parentNode}if(y&&y===z){return y}}}if(B&&B.nodeType==3){return B.parentNode}return B}return v.item?v.item(0):v.parentElement()},getSelectedBlocks:function(x,w){var v=this,B=v.dom,y,u,A=[];u=B.getRoot();x=B.getParent(x||v.getStart(),B.isBlock);w=B.getParent(w||v.getEnd(),B.isBlock);if(x&&x!=u){A.push(x)}if(x&&w&&x!=w){y=x;var z=new r(x,u);while((y=z.next())&&y!=w){if(B.isBlock(y)){A.push(y)}}}if(w&&x!=w&&w!=u){A.push(w)}return A},isForward:function(){var w=this.dom,u=this.getSel(),x,v;if(!u||!u.anchorNode||!u.focusNode){return true}x=w.createRng();x.setStart(u.anchorNode,u.anchorOffset);x.collapse(true);v=w.createRng();v.setStart(u.focusNode,u.focusOffset);v.collapse(true);return x.compareBoundaryPoints(x.START_TO_START,v)<=0},normalize:function(){var v=this,u,y,x;function w(B){var A,D,z,E=v.dom,G=E.getRoot(),C,F,H;function K(L,M){var N=new r(L,E.getParent(L.parentNode,E.isBlock)||G);while((L=N[M?"prev":"next"]())){if(L.nodeName==="BR"){return true}}}function I(M,L){return M.previousSibling&&M.previousSibling.nodeName==L}function J(N,L){var O,M;L=L||A;O=new r(L,E.getParent(L.parentNode,E.isBlock)||G);while((C=O[N?"prev":"next"]())){if(C.nodeType===3&&C.nodeValue.length>0){A=C;D=N?C.nodeValue.length:0;y=true;return}if(E.isBlock(C)||F[C.nodeName.toLowerCase()]){return}M=C}if(x&&M){A=M;y=true;D=0}}A=u[(B?"start":"end")+"Container"];D=u[(B?"start":"end")+"Offset"];F=E.schema.getNonEmptyElements();if(A.nodeType===9){A=E.getRoot();D=0}if(A===G){if(B){C=A.childNodes[D>0?D-1:0];if(C){H=C.nodeName.toLowerCase();if(F[C.nodeName]||C.nodeName=="TABLE"){return}}}if(A.hasChildNodes()){D=Math.min(!B&&D>0?D-1:D,A.childNodes.length-1);A=A.childNodes[D];D=0;if(A.hasChildNodes()&&!/TABLE/.test(A.nodeName)){C=A;z=new r(A,G);do{if(C.nodeType===3&&C.nodeValue.length>0){D=B?0:C.nodeValue.length;A=C;y=true;break}if(F[C.nodeName.toLowerCase()]){D=E.nodeIndex(C);A=C.parentNode;if(C.nodeName=="IMG"&&!B){D++}y=true;break}}while((C=(B?z.next():z.prev())))}}}if(x){if(A.nodeType===3&&D===0){J(true)}if(A.nodeType===1){C=A.childNodes[D];if(C&&C.nodeName==="BR"&&!I(C,"A")&&!K(C)&&!K(C,true)){J(true,A.childNodes[D])}}}if(B&&!x&&A.nodeType===3&&D===A.nodeValue.length){J(false)}if(y){u["set"+(B?"Start":"End")](A,D)}}if(l){return}u=v.getRng();x=u.collapsed;w(true);if(!x){w()}if(y){if(x){u.collapse(true)}v.setRng(u,v.isForward())}},selectorChanged:function(u,x){var v=this,w;if(!v.selectorChangedData){v.selectorChangedData={};w={};v.editor.on("NodeChange",function(B){var A=B.element,C=v.dom,y=C.getParents(A,null,C.getRoot()),z={};q(v.selectorChangedData,function(E,D){q(y,function(F){if(C.is(F,D)){if(!w[D]){q(E,function(G){G(true,{node:F,selector:D,parents:y})});w[D]=E}z[D]=E;return false}})});q(w,function(E,D){if(!z[D]){delete w[D];q(E,function(F){F(false,{node:A,selector:D,parents:y})})}})})}if(!v.selectorChangedData[u]){v.selectorChangedData[u]=[]}v.selectorChangedData[u].push(x);return v},getScrollContainer:function(){var u,v=this.dom.getRoot();while(v&&v.nodeName!="BODY"){if(v.scrollHeight>v.clientHeight){u=v;break}v=v.parentNode}return u},scrollIntoView:function(x){var A,D,E=this,w=E.dom,B=w.getRoot(),u,C;function v(I){var F=0,H=0;var G=I;while(G&&G.nodeType){F+=G.offsetLeft||0;H+=G.offsetTop||0;G=G.offsetParent}return{x:F,y:H}}if(B.nodeName!="BODY"){var z=E.getScrollContainer();if(z){A=v(x).y-v(z).y;C=z.clientHeight;u=z.scrollTop;if(A<u||A+25>u+C){z.scrollTop=A<u?A:A-C+25}return}}D=w.getViewPort(E.editor.getWin());A=w.getPos(x).y;u=D.y;C=D.h;if(A<D.y||A+25>u+C){E.editor.getWin().scrollTo(0,A<u?A:A-C+25)}},destroy:function(){this.win=null;this.controlSelection.destroy()}};return t});h("tinymce/dom/RangeUtils",["tinymce/util/Tools"],function(j){var l=j.each;function k(m){this.walk=function(n,C){var s=n.startContainer,v=n.startOffset,D=n.endContainer,w=n.endOffset,t,q,y,r,B,A,o;o=m.select("td.mce-item-selected,th.mce-item-selected");if(o.length>0){l(o,function(E){C([E])});return}function p(E){var F;F=E[0];if(F.nodeType===3&&F===s&&v>=F.nodeValue.length){E.splice(0,1)}F=E[E.length-1];if(w===0&&E.length>0&&F===D&&F.nodeType===3){E.splice(E.length-1,1)}return E}function z(G,F,E){var H=[];for(;G&&G!=E;G=G[F]){H.push(G)}return H}function x(F,E){do{if(F.parentNode==E){return F}F=F.parentNode}while(F)}function u(G,F,H){var E=H?"nextSibling":"previousSibling";for(r=G,B=r.parentNode;r&&r!=F;r=B){B=r.parentNode;A=z(r==G?r:r[E],E);if(A.length){if(!H){A.reverse()}C(p(A))}}}if(s.nodeType==1&&s.hasChildNodes()){s=s.childNodes[v]}if(D.nodeType==1&&D.hasChildNodes()){D=D.childNodes[Math.min(w-1,D.childNodes.length-1)]}if(s==D){return C(p([s]))}t=m.findCommonAncestor(s,D);for(r=s;r;r=r.parentNode){if(r===D){return u(s,t,true)}if(r===t){break}}for(r=D;r;r=r.parentNode){if(r===s){return u(D,t)}if(r===t){break}}q=x(s,t)||s;y=x(D,t)||D;u(s,q,true);A=z(q==s?q:q.nextSibling,"nextSibling",y==D?y.nextSibling:y);if(A.length){C(p(A))}u(D,y)};this.split=function(o){var r=o.startContainer,n=o.startOffset,s=o.endContainer,q=o.endOffset;function p(t,u){return t.splitText(u)}if(r==s&&r.nodeType==3){if(n>0&&n<r.nodeValue.length){s=p(r,n);r=s.previousSibling;if(q>n){q=q-n;r=s=p(s,q).previousSibling;q=s.nodeValue.length;n=0}else{q=0}}}else{if(r.nodeType==3&&n>0&&n<r.nodeValue.length){r=p(r,n);n=0}if(s.nodeType==3&&q>0&&q<s.nodeValue.length){s=p(s,q).previousSibling;q=s.nodeValue.length}}return{startContainer:r,startOffset:n,endContainer:s,endOffset:q}}}k.compareRanges=function(n,m){if(n&&m){if(n.item||n.duplicate){if(n.item&&m.item&&n.item(0)===m.item(0)){return true}if(n.isEqual&&m.isEqual&&m.isEqual(n)){return true}}else{return n.startContainer==m.startContainer&&n.startOffset==m.startOffset}}return false};return k});h("tinymce/Formatter",["tinymce/dom/TreeWalker","tinymce/dom/RangeUtils","tinymce/util/Tools"],function(k,l,j){return function(ao){var ad={},n=ao.dom,F=ao.selection,aa=new l(n),o=ao.schema.isValidChild,U=n.isBlock,y=ao.settings.forced_root_block,H=n.nodeIndex,S="\uFEFF",p=/^(src|href|style)$/,ak=false,O=true,ac,P,K=n.getContentEditable,T,w;var ag=j.each,am=j.grep,C=j.walk,D=j.extend;function V(ap){if(ap.nodeType){ap=ap.nodeName}return !!ao.schema.getTextBlockElements()[ap.toLowerCase()]}function z(aq,ap){return n.getParents(aq,ap,n.getRoot())}function m(ap){return ap.nodeType===1&&ap.id==="_mce_caret"}function u(){x({alignleft:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"left"},defaultBlock:"div"},{selector:"img,table",collapsed:false,styles:{"float":"left"}}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"center"},defaultBlock:"div"},{selector:"img",collapsed:false,styles:{display:"block",marginLeft:"auto",marginRight:"auto"}},{selector:"table",collapsed:false,styles:{marginLeft:"auto",marginRight:"auto"}}],alignright:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"right"},defaultBlock:"div"},{selector:"img,table",collapsed:false,styles:{"float":"right"}}],alignjustify:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"justify"},defaultBlock:"div"}],bold:[{inline:"strong",remove:"all"},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all"}],italic:[{inline:"em",remove:"all"},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all"}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:true},{inline:"u",remove:"all"}],strikethrough:[{inline:"span",styles:{textDecoration:"line-through"},exact:true},{inline:"strike",remove:"all"}],forecolor:{inline:"span",styles:{color:"%value"},wrap_links:false},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},wrap_links:false},fontname:{inline:"span",styles:{fontFamily:"%value"}},fontsize:{inline:"span",styles:{fontSize:"%value"}},fontsize_class:{inline:"span",attributes:{"class":"%value"}},blockquote:{block:"blockquote",wrapper:1,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},code:{inline:"code"},link:{inline:"a",selector:"a",remove:"all",split:true,deep:true,onmatch:function(){return true},onformat:function(ar,ap,aq){ag(aq,function(au,at){n.setAttrib(ar,at,au)})}},removeformat:[{selector:"b,strong,em,i,font,u,strike,sub,sup",remove:"all",split:true,expand:false,block_expand:true,deep:true},{selector:"span",attributes:["style","class"],remove:"empty",split:true,expand:false,deep:true},{selector:"*",attributes:["style","class"],split:false,expand:false,deep:true}]});ag("p h1 h2 h3 h4 h5 h6 div address pre div dt dd samp".split(/\s/),function(ap){x(ap,{block:ap,remove:"all"})});x(ao.settings.formats)}function aj(){ao.addShortcut("ctrl+b","bold_desc","Bold");ao.addShortcut("ctrl+i","italic_desc","Italic");ao.addShortcut("ctrl+u","underline_desc","Underline");for(var ap=1;ap<=6;ap++){ao.addShortcut("ctrl+"+ap,"",["FormatBlock",false,"h"+ap])}ao.addShortcut("ctrl+7","",["FormatBlock",false,"p"]);ao.addShortcut("ctrl+8","",["FormatBlock",false,"div"]);ao.addShortcut("ctrl+9","",["FormatBlock",false,"address"])}function ai(ap){return ap?ad[ap]:ad}function x(ap,aq){if(ap){if(typeof(ap)!=="string"){ag(ap,function(at,ar){x(ar,at)})}else{aq=aq.length?aq:[aq];ag(aq,function(ar){if(ar.deep===P){ar.deep=!ar.selector}if(ar.split===P){ar.split=!ar.selector||ar.inline}if(ar.remove===P&&ar.selector&&!ar.inline){ar.remove="none"}if(ar.selector&&ar.inline){ar.mixed=true;ar.block_expand=true}if(typeof(ar.classes)==="string"){ar.classes=ar.classes.split(/\s+/)}});ad[ap]=aq}}}function t(aq){var ap;ao.dom.getParent(aq,function(ar){ap=ao.dom.getStyle(ar,"text-decoration");return ap&&ap!=="none"});return ap}function Y(ap){var aq;if(ap.nodeType===1&&ap.parentNode&&ap.parentNode.nodeType===1){aq=t(ap.parentNode);if(ao.dom.getStyle(ap,"color")&&aq){ao.dom.setStyle(ap,"text-decoration",aq)}else{if(ao.dom.getStyle(ap,"textdecoration")===aq){ao.dom.setStyle(ap,"text-decoration",null)}}}}function al(at,az,av){var aw=ai(at),aA=aw[0],ay,aq,ax=!av&&F.isCollapsed();function ap(aE,aD){aD=aD||aA;if(aE){if(aD.onformat){aD.onformat(aE,aD,az,av)}ag(aD.styles,function(aG,aF){n.setStyle(aE,aF,E(aG,az))});ag(aD.attributes,function(aG,aF){n.setAttrib(aE,aF,E(aG,az))});ag(aD.classes,function(aF){aF=E(aF,az);if(!n.hasClass(aE,aF)){n.addClass(aE,aF)}})}}function au(){function aF(aL,aJ){var aK=new k(aJ);for(av=aK.current();av;av=aK.prev()){if(av.childNodes.length>1||av==aL||av.tagName=="BR"){return av}}}var aE=ao.selection.getRng();var aI=aE.startContainer;var aD=aE.endContainer;if(aI!=aD&&aE.endOffset===0){var aH=aF(aI,aD);var aG=aH.nodeType==3?aH.length:aH.childNodes.length;aE.setEnd(aH,aG)}return aE}function ar(aG,aL,aJ,aI,aE){var aD=[],aF=-1,aK,aN=-1,aH=-1,aM;ag(aG.childNodes,function(aP,aO){if(aP.nodeName==="UL"||aP.nodeName==="OL"){aF=aO;aK=aP;return false}});ag(aG.childNodes,function(aP,aO){if(aP.nodeName==="SPAN"&&n.getAttrib(aP,"data-mce-type")=="bookmark"){if(aP.id==aL.id+"_start"){aN=aO}else{if(aP.id==aL.id+"_end"){aH=aO}}}});if(aF<=0||(aN<aF&&aH>aF)){ag(am(aG.childNodes),aE);return 0}else{aM=n.clone(aJ,ak);ag(am(aG.childNodes),function(aP,aO){if((aN<aF&&aO<aF)||(aN>aF&&aO>aF)){aD.push(aP);aP.parentNode.removeChild(aP)}});if(aN<aF){aG.insertBefore(aM,aK)}else{if(aN>aF){aG.insertBefore(aM,aK.nextSibling)}}aI.push(aM);ag(aD,function(aO){aM.appendChild(aO)});return aM}}function aB(aE,aG,aJ){var aD=[],aI,aF,aH=true;aI=aA.inline||aA.block;aF=n.create(aI);ap(aF);aa.walk(aE,function(aK){var aL;function aM(aN){var aS,aQ,aO,aP,aR;aR=aH;aS=aN.nodeName.toLowerCase();aQ=aN.parentNode.nodeName.toLowerCase();if(aN.nodeType===1&&K(aN)){aR=aH;aH=K(aN)==="true";aP=true}if(r(aS,"br")){aL=0;if(aA.block){n.remove(aN)}return}if(aA.wrapper&&L(aN,at,az)){aL=0;return}if(aH&&!aP&&aA.block&&!aA.wrapper&&V(aS)&&o(aQ,aI)){aN=n.rename(aN,aI);ap(aN);aD.push(aN);aL=0;return}if(aA.selector){ag(aw,function(aT){if("collapsed" in aT&&aT.collapsed!==ax){return}if(n.is(aN,aT.selector)&&!m(aN)){ap(aN,aT);aO=true}});if(!aA.inline||aO){aL=0;return}}if(aH&&!aP&&o(aI,aS)&&o(aQ,aI)&&!(!aJ&&aN.nodeType===3&&aN.nodeValue.length===1&&aN.nodeValue.charCodeAt(0)===65279)&&!m(aN)&&(!aA.inline||!U(aN))){if(!aL){aL=n.clone(aF,ak);aN.parentNode.insertBefore(aL,aN);aD.push(aL)}aL.appendChild(aN)}else{if(aS=="li"&&aG){aL=ar(aN,aG,aF,aD,aM)}else{aL=0;ag(am(aN.childNodes),aM);if(aP){aH=aR}aL=0}}}ag(aK,aM)});if(aA.wrap_links===false){ag(aD,function(aK){function aL(aP){var aO,aN,aM;if(aP.nodeName==="A"){aN=n.clone(aF,ak);aD.push(aN);aM=am(aP.childNodes);for(aO=0;aO<aM.length;aO++){aN.appendChild(aM[aO])}aP.appendChild(aN)}ag(am(aP.childNodes),aL)}aL(aK)})}ag(aD,function(aM){var aK;function aN(aP){var aO=0;ag(aP.childNodes,function(aQ){if(!q(aQ)&&!X(aQ)){aO++}});return aO}function aL(aO){var aQ,aP;ag(aO.childNodes,function(aR){if(aR.nodeType==1&&!X(aR)&&!m(aR)){aQ=aR;return ak}});if(aQ&&s(aQ,aA)){aP=n.clone(aQ,ak);ap(aP);n.replace(aP,aO,O);n.remove(aQ,1)}return aP||aO}aK=aN(aM);if((aD.length>1||!U(aM))&&aK===0){n.remove(aM,1);return}if(aA.inline||aA.wrapper){if(!aA.exact&&aK===1){aM=aL(aM)}ag(aw,function(aO){ag(n.select(aO.inline,aM),function(aQ){var aP;if(aO.wrap_links===false){aP=aQ.parentNode;do{if(aP.nodeName==="A"){return}}while((aP=aP.parentNode))}an(aO,az,aQ,aO.exact?aQ:null)})});if(L(aM.parentNode,at,az)){n.remove(aM,1);aM=0;return O}if(aA.merge_with_parents){n.getParent(aM.parentNode,function(aO){if(L(aO,at,az)){n.remove(aM,1);aM=0;return O}})}if(aM&&aA.merge_siblings!==false){aM=I(Q(aM),aM);aM=I(aM,Q(aM,O))}}})}if(aA){if(av){if(av.nodeType){aq=n.createRng();aq.setStartBefore(av);aq.setEndAfter(av);aB(B(aq,aw),null,true)}else{aB(av,null,true)}}else{if(!ax||!aA.inline||n.select("td.mce-item-selected,th.mce-item-selected").length){var aC=ao.selection.getNode();if(!y&&aw[0].defaultBlock&&!n.getParent(aC,n.isBlock)){al(aw[0].defaultBlock)}ao.selection.setRng(au());ay=F.getBookmark();aB(B(F.getRng(O),aw),ay);if(aA.styles&&(aA.styles.color||aA.styles.textDecoration)){C(aC,Y,"childNodes");Y(aC)}F.moveToBookmark(ay);ae(F.getRng(O));ao.nodeChanged()}else{ah("apply",at,az)}}}}function N(ar,az,au){var av=ai(ar),aC=av[0],ay,aq,aA=true;function at(aH){var aG,aF,aE,aJ,aI;if(aH.nodeType===1&&K(aH)){aJ=aA;aA=K(aH)==="true";aI=true}aG=am(aH.childNodes);if(aA&&!aI){for(aF=0,aE=av.length;aF<aE;aF++){if(an(av[aF],az,aH,aH)){break}}}if(aC.deep){if(aG.length){for(aF=0,aE=aG.length;aF<aE;aF++){at(aG[aF])}if(aI){aA=aJ}}}}function aw(aE){var aF;ag(z(aE.parentNode).reverse(),function(aG){var aH;if(!aF&&aG.id!="_start"&&aG.id!="_end"){aH=L(aG,ar,az);if(aH&&aH.split!==false){aF=aG}}});return aF}function ap(aH,aE,aJ,aM){var aN,aL,aK,aG,aI,aF;if(aH){aF=aH.parentNode;for(aN=aE.parentNode;aN&&aN!=aF;aN=aN.parentNode){aL=n.clone(aN,ak);for(aI=0;aI<av.length;aI++){if(an(av[aI],az,aL,aL)){aL=0;break}}if(aL){if(aK){aL.appendChild(aK)}if(!aG){aG=aL}aK=aL}}if(aM&&(!aC.mixed||!U(aH))){aE=n.split(aH,aE)}if(aK){aJ.parentNode.insertBefore(aK,aJ);aG.appendChild(aJ)}}return aE}function aB(aE){return ap(aw(aE),aE,aE,true)}function ax(aG){var aF=n.get(aG?"_start":"_end"),aE=aF[aG?"firstChild":"lastChild"];if(X(aE)){aE=aE[aG?"firstChild":"lastChild"]}n.remove(aF,true);return aE}function aD(aE){var aF,aG;aE=B(aE,av,O);if(aC.split){aF=Z(aE,O);aG=Z(aE);if(aF!=aG){if(/^(TR|TD)$/.test(aF.nodeName)&&aF.firstChild){if(aF.nodeName=="TD"){aF=aF.firstChild||aF}else{aF=aF.firstChild.firstChild||aF}}aF=af(aF,"span",{id:"_start","data-mce-type":"bookmark"});aG=af(aG,"span",{id:"_end","data-mce-type":"bookmark"});aB(aF);aB(aG);aF=ax(O);aG=ax()}else{aF=aG=aB(aF)}aE.startContainer=aF.parentNode;aE.startOffset=H(aF);aE.endContainer=aG.parentNode;aE.endOffset=H(aG)+1}aa.walk(aE,function(aH){ag(aH,function(aI){at(aI);if(aI.nodeType===1&&ao.dom.getStyle(aI,"text-decoration")==="underline"&&aI.parentNode&&t(aI.parentNode)==="underline"){an({deep:false,exact:true,inline:"span",styles:{textDecoration:"underline"}},null,aI)}})})}if(au){if(au.nodeType){aq=n.createRng();aq.setStartBefore(au);aq.setEndAfter(au);aD(aq)}else{aD(au)}return}if(!F.isCollapsed()||!aC.inline||n.select("td.mce-item-selected,th.mce-item-selected").length){ay=F.getBookmark();aD(F.getRng(O));F.moveToBookmark(ay);if(aC.inline&&v(ar,az,F.getStart())){ae(F.getRng(true))}ao.nodeChanged()}else{ah("remove",ar,az)}}function R(aq,at,ar){var ap=ai(aq);if(v(aq,at,ar)&&(!("toggle" in ap[0])||ap[0].toggle)){N(aq,at,ar)}else{al(aq,at,ar)}}function L(aq,ap,aw,au){var ar=ai(ap),ax,av,at;function ay(aC,aE,aF){var aB,aD,az=aE[aF],aA;if(aE.onmatch){return aE.onmatch(aC,aE,aF)}if(az){if(az.length===P){for(aB in az){if(az.hasOwnProperty(aB)){if(aF==="attributes"){aD=n.getAttrib(aC,aB)}else{aD=ab(aC,aB)}if(au&&!aD&&!aE.exact){return}if((!au||aE.exact)&&!r(aD,G(E(az[aB],aw),aB))){return}}}}else{for(aA=0;aA<az.length;aA++){if(aF==="attributes"?n.getAttrib(aC,az[aA]):ab(aC,az[aA])){return aE}}}}return aE}if(ar&&aq){for(av=0;av<ar.length;av++){ax=ar[av];if(s(aq,ax)&&ay(aq,ax,"attributes")&&ay(aq,ax,"styles")){if((at=ax.classes)){for(av=0;av<at.length;av++){if(!n.hasClass(aq,at[av])){return}}}return ax}}}}function v(ar,au,at){var aq;function ap(aw){var av=n.getRoot();aw=n.getParent(aw,function(ax){return ax.parentNode===av||!!L(ax,ar,au,true)});return L(aw,ar,au)}if(at){return ap(at)}at=F.getNode();if(ap(at)){return O}aq=F.getStart();if(aq!=at){if(ap(aq)){return O}}return ak}function J(au,at){var aq,ar=[],ap={};aq=F.getStart();n.getParent(aq,function(ax){var aw,av;for(aw=0;aw<au.length;aw++){av=au[aw];if(!ap[av]&&L(ax,av,at)){ap[av]=true;ar.push(av)}}},n.getRoot());return ar}function M(au){var aw=ai(au),at,ar,av,aq,ap;if(aw){at=F.getStart();ar=z(at);for(aq=aw.length-1;aq>=0;aq--){ap=aw[aq].selector;if(!ap||aw[aq].defaultBlock){return O}for(av=ar.length-1;av>=0;av--){if(n.is(ar[av],ap)){return O}}}}return ak}function W(ap,at,aq){var ar;if(!ac){ac={};ar={};ao.on("NodeChange",function(av){var au=z(av.element),aw={};ag(ac,function(ax,ay){ag(au,function(az){if(L(az,ay,{},ax.similar)){if(!ar[ay]){ag(ax,function(aA){aA(true,{node:az,format:ay,parents:au})});ar[ay]=ax}aw[ay]=ax;return false}})});ag(ar,function(ax,ay){if(!aw[ay]){delete ar[ay];ag(ax,function(az){az(false,{node:av.element,format:ay,parents:au})})}})})}ag(ap.split(","),function(au){if(!ac[au]){ac[au]=[];ac[au].similar=aq}ac[au].push(at)});return this}D(this,{get:ai,register:x,apply:al,remove:N,toggle:R,match:v,matchAll:J,matchNode:L,canApply:M,formatChanged:W});u();aj();ao.on("BeforeGetContent",function(){if(w){w()}});ao.on("mouseup keydown",function(ap){if(T){T(ap)}});function s(ap,aq){if(r(ap,aq.inline)){return O}if(r(ap,aq.block)){return O}if(aq.selector){return ap.nodeType==1&&n.is(ap,aq.selector)}}function r(aq,ap){aq=aq||"";ap=ap||"";aq=""+(aq.nodeName||aq);ap=""+(ap.nodeName||ap);return aq.toLowerCase()==ap.toLowerCase()}function ab(aq,ap){return G(n.getStyle(aq,ap),ap)}function G(aq,ap){if(ap=="color"||ap=="backgroundColor"){aq=n.toHex(aq)}if(ap=="fontWeight"&&aq==700){aq="bold"}if(ap=="fontFamily"){aq=aq.replace(/[\'\"]/g,"").replace(/,\s+/g,",")}return""+aq}function E(ap,aq){if(typeof(ap)!="string"){ap=ap(aq)}else{if(aq){ap=ap.replace(/%(\w+)/g,function(at,ar){return aq[ar]||at})}}return ap}function q(ap){return ap&&ap.nodeType===3&&/^([\t \r\n]+|)$/.test(ap.nodeValue)}function af(ar,aq,ap){var at=n.create(aq,ap);ar.parentNode.insertBefore(at,ar);at.appendChild(ar);return at}function B(ap,aB,at){var aC,aw,aA,ar=ap.startContainer,ax=ap.startOffset,aF=ap.endContainer,az=ap.endOffset;function aD(aM){var aH,aK,aJ,aI,aG;aH=aK=aM?ar:aF;aI=aM?"previousSibling":"nextSibling";aG=n.getRoot();function aL(aN){return aN.nodeName=="BR"&&aN.getAttribute("data-mce-bogus")&&!aN.nextSibling}if(aH.nodeType==3&&!q(aH)){if(aM?ax>0:az<aH.nodeValue.length){return aH}}for(;;){if(!aB[0].block_expand&&U(aK)){return aK}for(aJ=aK[aI];aJ;aJ=aJ[aI]){if(!X(aJ)&&!q(aJ)&&!aL(aJ)){return aK}}if(aK.parentNode==aG){aH=aK;break}aK=aK.parentNode}return aH}function av(aG,aH){if(aH===P){aH=aG.nodeType===3?aG.length:aG.childNodes.length}while(aG&&aG.hasChildNodes()){aG=aG.childNodes[aH];if(aG){aH=aG.nodeType===3?aG.length:aG.childNodes.length}}return{node:aG,offset:aH}}if(ar.nodeType==1&&ar.hasChildNodes()){aC=ar.childNodes.length-1;ar=ar.childNodes[ax>aC?aC:ax];if(ar.nodeType==3){ax=0}}if(aF.nodeType==1&&aF.hasChildNodes()){aC=aF.childNodes.length-1;aF=aF.childNodes[az>aC?aC:az-1];if(aF.nodeType==3){az=aF.nodeValue.length}}function aE(aH){var aG=aH;while(aG){if(aG.nodeType===1&&K(aG)){return K(aG)==="false"?aG:aH}aG=aG.parentNode}return aH}function ay(aH,aL,aN){var aK,aI,aM,aG;function aJ(aP,aR){var aS,aO,aQ=aP.nodeValue;if(typeof(aR)=="undefined"){aR=aN?aQ.length:0}if(aN){aS=aQ.lastIndexOf(" ",aR);aO=aQ.lastIndexOf("\u00a0",aR);aS=aS>aO?aS:aO;if(aS!==-1&&!at){aS++}}else{aS=aQ.indexOf(" ",aR);aO=aQ.indexOf("\u00a0",aR);aS=aS!==-1&&(aO===-1||aS<aO)?aS:aO}return aS}if(aH.nodeType===3){aM=aJ(aH,aL);if(aM!==-1){return{container:aH,offset:aM}}aG=aH}aK=new k(aH,n.getParent(aH,U)||ao.getBody());while((aI=aK[aN?"prev":"next"]())){if(aI.nodeType===3){aG=aI;aM=aJ(aI);if(aM!==-1){return{container:aI,offset:aM}}}else{if(U(aI)){break}}}if(aG){if(aN){aL=0}else{aL=aG.length}return{container:aG,offset:aL}}}function au(aH,aG){var aI,aJ,aL,aK;if(aH.nodeType==3&&aH.nodeValue.length===0&&aH[aG]){aH=aH[aG]}aI=z(aH);for(aJ=0;aJ<aI.length;aJ++){for(aL=0;aL<aB.length;aL++){aK=aB[aL];if("collapsed" in aK&&aK.collapsed!==ap.collapsed){continue}if(n.is(aI[aJ],aK.selector)){return aI[aJ]}}}return aH}function aq(aI,aG){var aJ,aH=n.getRoot();if(!aB[0].wrapper){aJ=n.getParent(aI,aB[0].block)}if(!aJ){aJ=n.getParent(aI.nodeType==3?aI.parentNode:aI,function(aK){return aK!=aH&&V(aK)})}if(aJ&&aB[0].wrapper){aJ=z(aJ,"ul,ol").reverse()[0]||aJ}if(!aJ){aJ=aI;while(aJ[aG]&&!U(aJ[aG])){aJ=aJ[aG];if(r(aJ,"br")){break}}}return aJ||aI}ar=aE(ar);aF=aE(aF);if(X(ar.parentNode)||X(ar)){ar=X(ar)?ar:ar.parentNode;ar=ar.nextSibling||ar;if(ar.nodeType==3){ax=0}}if(X(aF.parentNode)||X(aF)){aF=X(aF)?aF:aF.parentNode;aF=aF.previousSibling||aF;if(aF.nodeType==3){az=aF.length}}if(aB[0].inline){if(ap.collapsed){aA=ay(ar,ax,true);if(aA){ar=aA.container;ax=aA.offset}aA=ay(aF,az);if(aA){aF=aA.container;az=aA.offset}}aw=av(aF,az);if(aw.node){while(aw.node&&aw.offset===0&&aw.node.previousSibling){aw=av(aw.node.previousSibling)}if(aw.node&&aw.offset>0&&aw.node.nodeType===3&&aw.node.nodeValue.charAt(aw.offset-1)===" "){if(aw.offset>1){aF=aw.node;aF.splitText(aw.offset-1)}}}}if(aB[0].inline||aB[0].block_expand){if(!aB[0].inline||(ar.nodeType!=3||ax===0)){ar=aD(true)}if(!aB[0].inline||(aF.nodeType!=3||az===aF.nodeValue.length)){aF=aD()}}if(aB[0].selector&&aB[0].expand!==ak&&!aB[0].inline){ar=au(ar,"previousSibling");aF=au(aF,"nextSibling")}if(aB[0].block||aB[0].selector){ar=aq(ar,"previousSibling");aF=aq(aF,"nextSibling");if(aB[0].block){if(!U(ar)){ar=aD(true)}if(!U(aF)){aF=aD()}}}if(ar.nodeType==1){ax=H(ar);ar=ar.parentNode}if(aF.nodeType==1){az=H(aF)+1;aF=aF.parentNode}return{startContainer:ar,startOffset:ax,endContainer:aF,endOffset:az}}function an(aw,av,at,ap){var ar,aq,au;if(!s(at,aw)){return ak}if(aw.remove!="all"){ag(aw.styles,function(ay,ax){ay=G(E(ay,av),ax);if(typeof(ax)==="number"){ax=ay;ap=0}if(!ap||r(ab(ap,ax),ay)){n.setStyle(at,ax,"")}au=1});if(au&&n.getAttrib(at,"style")===""){at.removeAttribute("style");at.removeAttribute("data-mce-style")}ag(aw.attributes,function(az,ax){var ay;az=E(az,av);if(typeof(ax)==="number"){ax=az;ap=0}if(!ap||r(n.getAttrib(ap,ax),az)){if(ax=="class"){az=n.getAttrib(at,ax);if(az){ay="";ag(az.split(/\s+/),function(aA){if(/mce\w+/.test(aA)){ay+=(ay?" ":"")+aA}});if(ay){n.setAttrib(at,ax,ay);return}}}if(ax=="class"){at.removeAttribute("className")}if(p.test(ax)){at.removeAttribute("data-mce-"+ax)}at.removeAttribute(ax)}});ag(aw.classes,function(ax){ax=E(ax,av);if(!ap||n.hasClass(ap,ax)){n.removeClass(at,ax)}});aq=n.getAttribs(at);for(ar=0;ar<aq.length;ar++){if(aq[ar].nodeName.indexOf("_")!==0){return ak}}}if(aw.remove!="none"){A(at,aw);return O}}function A(ar,at){var ap=ar.parentNode,aq;function au(aw,av,ax){aw=Q(aw,av,ax);return !aw||(aw.nodeName=="BR"||U(aw))}if(at.block){if(!y){if(U(ar)&&!U(ap)){if(!au(ar,ak)&&!au(ar.firstChild,O,1)){ar.insertBefore(n.create("br"),ar.firstChild)}if(!au(ar,O)&&!au(ar.lastChild,ak,1)){ar.appendChild(n.create("br"))}}}else{if(ap==n.getRoot()){if(!at.list_block||!r(ar,at.list_block)){ag(am(ar.childNodes),function(av){if(o(y,av.nodeName.toLowerCase())){if(!aq){aq=af(av,y)}else{aq.appendChild(av)}}else{aq=0}})}}}}if(at.selector&&at.inline&&!r(at.inline,ar)){return}n.remove(ar,1)}function Q(aq,ap,ar){if(aq){ap=ap?"nextSibling":"previousSibling";for(aq=ar?aq:aq[ap];aq;aq=aq[ap]){if(aq.nodeType==1||!q(aq)){return aq}}}}function X(ap){return ap&&ap.nodeType==1&&ap.getAttribute("data-mce-type")=="bookmark"}function I(at,ar){var aq,ap;function av(ay,ax){if(ay.nodeName!=ax.nodeName){return ak}function aw(aA){var aB={};ag(n.getAttribs(aA),function(aC){var aD=aC.nodeName.toLowerCase();if(aD.indexOf("_")!==0&&aD!=="style"){aB[aD]=n.getAttrib(aA,aD)}});return aB}function az(aD,aC){var aB,aA;for(aA in aD){if(aD.hasOwnProperty(aA)){aB=aC[aA];if(aB===P){return ak}if(aD[aA]!=aB){return ak}delete aC[aA]}}for(aA in aC){if(aC.hasOwnProperty(aA)){return ak}}return O}if(!az(aw(ay),aw(ax))){return ak}if(!az(n.parseStyle(n.getAttrib(ay,"style")),n.parseStyle(n.getAttrib(ax,"style")))){return ak}return O}function au(ax,aw){for(aq=ax;aq;aq=aq[aw]){if(aq.nodeType==3&&aq.nodeValue.length!==0){return ax}if(aq.nodeType==1&&!X(aq)){return aq}}return ax}if(at&&ar){at=au(at,"previousSibling");ar=au(ar,"nextSibling");if(av(at,ar)){for(aq=at.nextSibling;aq&&aq!=ar;){ap=aq;aq=aq.nextSibling;at.appendChild(ap)}n.remove(ar);ag(am(ar.childNodes),function(aw){at.appendChild(aw)});return at}}return ar}function Z(aq,au){var ap,at,ar;ap=aq[au?"startContainer":"endContainer"];at=aq[au?"startOffset":"endOffset"];if(ap.nodeType==1){ar=ap.childNodes.length-1;if(!au&&at){at--}ap=ap.childNodes[at>ar?ar:at]}if(ap.nodeType===3&&au&&at>=ap.nodeValue.length){ap=new k(ap,ao.getBody()).next()||ap}if(ap.nodeType===3&&!au&&at===0){ap=new k(ap,ao.getBody()).prev()||ap}return ap}function ah(az,ap,ax){var aA="_mce_caret",aq=ao.settings.caret_debug;function ar(aE){var aD=n.create("span",{id:aA,"data-mce-bogus":true,style:aq?"color:red":""});if(aE){aD.appendChild(ao.getDoc().createTextNode(S))}return aD}function ay(aE,aD){while(aE){if((aE.nodeType===3&&aE.nodeValue!==S)||aE.childNodes.length>1){return false}if(aD&&aE.nodeType===1){aD.push(aE)}aE=aE.firstChild}return true}function av(aD){while(aD){if(aD.id===aA){return aD}aD=aD.parentNode}}function au(aD){var aE;if(aD){aE=new k(aD,aD);for(aD=aE.current();aD;aD=aE.next()){if(aD.nodeType===3){return aD}}}}function at(aF,aE){var aG,aD;if(!aF){aF=av(F.getStart());if(!aF){while((aF=n.get(aA))){at(aF,false)}}}else{aD=F.getRng(true);if(ay(aF)){if(aE!==false){aD.setStartBefore(aF);aD.setEndBefore(aF)}n.remove(aF)}else{aG=au(aF);if(aG.nodeValue.charAt(0)===S){aG=aG.deleteData(0,1)}n.remove(aF,1)}F.setRng(aD)}}function aw(){var aF,aD,aJ,aI,aG,aE,aH;aF=F.getRng(true);aI=aF.startOffset;aE=aF.startContainer;aH=aE.nodeValue;aD=av(F.getStart());if(aD){aJ=au(aD)}if(aH&&aI>0&&aI<aH.length&&/\w/.test(aH.charAt(aI))&&/\w/.test(aH.charAt(aI-1))){aG=F.getBookmark();aF.collapse(true);aF=B(aF,ai(ap));aF=aa.split(aF);al(ap,ax,aF);F.moveToBookmark(aG)}else{if(!aD||aJ.nodeValue!==S){aD=ar(true);aJ=aD.firstChild;aF.insertNode(aD);aI=1;al(ap,ax,aD)}else{al(ap,ax,aD)}F.setCursorLocation(aJ,aI)}}function aB(){var aD=F.getRng(true),aE,aH,aK,aJ,aF,aN,aM=[],aI,aL;aE=aD.startContainer;aH=aD.startOffset;aF=aE;if(aE.nodeType==3){if(aH!=aE.nodeValue.length||aE.nodeValue===S){aJ=true}aF=aF.parentNode}while(aF){if(L(aF,ap,ax)){aN=aF;break}if(aF.nextSibling){aJ=true}aM.push(aF);aF=aF.parentNode}if(!aN){return}if(aJ){aK=F.getBookmark();aD.collapse(true);aD=B(aD,ai(ap),true);aD=aa.split(aD);N(ap,ax,aD);F.moveToBookmark(aK)}else{aL=ar();aF=aL;for(aI=aM.length-1;aI>=0;aI--){aF.appendChild(n.clone(aM[aI],false));aF=aF.firstChild}aF.appendChild(n.doc.createTextNode(S));aF=aF.firstChild;var aG=n.getParent(aN,V);if(aG&&n.isEmpty(aG)){aN.parentNode.replaceChild(aL,aN)}else{n.insertAfter(aL,aN)}F.setCursorLocation(aF,1);if(n.isEmpty(aN)){n.remove(aN)}}}function aC(){var aD;aD=av(F.getStart());if(aD&&!n.isEmpty(aD)){C(aD,function(aE){if(aE.nodeType==1&&aE.id!==aA&&!n.isEmpty(aE)){n.setAttrib(aE,"data-mce-bogus",null)}},"childNodes")}}if(!ao._hasCaretEvents){w=function(){var aD=[],aE;if(ay(av(F.getStart()),aD)){aE=aD.length;while(aE--){n.setAttrib(aD[aE],"data-mce-bogus","1")}}};T=function(aE){var aD=aE.keyCode;at();if(aD==8||aD==37||aD==39){at(av(F.getStart()))}aC()};ao.on("SetContent",function(aD){if(aD.selection){aC()}});ao._hasCaretEvents=true}if(az=="apply"){aw()}else{aB()}}function ae(aq){var ap=aq.startContainer,ax=aq.startOffset,at,aw,av,ar,au;if(ap.nodeType==3&&ax>=ap.nodeValue.length){ax=H(ap);ap=ap.parentNode;at=true}if(ap.nodeType==1){ar=ap.childNodes;ap=ar[Math.min(ax,ar.length-1)];aw=new k(ap,n.getParent(ap,n.isBlock));if(ax>ar.length-1||at){aw.next()}for(av=aw.current();av;av=aw.next()){if(av.nodeType==3&&!q(av)){au=n.create("a",null,S);av.parentNode.insertBefore(au,av);aq.setStart(av,0);F.setRng(aq);n.remove(au);return}}}}}});h("tinymce/UndoManager",["tinymce/Env","tinymce/util/Tools"],function(k,l){var j=l.trim,m;m=new RegExp(["<span[^>]+data-mce-bogus[^>]+>[\u200B\uFEFF]+<\\/span>","<div[^>]+data-mce-bogus[^>]+><\\/div>",'\\s?data-mce-selected="[^"]+"'].join("|"),"gi");return function(r){var v,s=0,p=[],q,t,u;function n(){return j(r.getContent({format:"raw",no_events:1}).replace(m,""))}function o(){v.typing=false;v.add()}r.on("init",function(){v.add()});r.on("BeforeExecCommand",function(x){var w=x.command;if(w!="Undo"&&w!="Redo"&&w!="mceRepaint"){v.beforeChange()}});r.on("ExecCommand",function(x){var w=x.command;if(w!="Undo"&&w!="Redo"&&w!="mceRepaint"){v.add()}});r.on("ObjectResizeStart",function(){v.beforeChange()});r.on("SaveContent ObjectResized",o);r.dom.bind(r.dom.getRoot(),"dragend",o);r.dom.bind(r.getBody(),"focusout",function(){if(!r.removed&&v.typing){o()}});r.on("KeyUp",function(x){var w=x.keyCode;if((w>=33&&w<=36)||(w>=37&&w<=40)||w==45||w==13||x.ctrlKey){o();r.nodeChanged()}if(w==46||w==8||(k.mac&&(w==91||w==93))){r.nodeChanged()}if(t&&v.typing){if(!r.isDirty()){r.isNotDirty=!p[0]||n()==p[0].content;if(!r.isNotDirty){r.fire("change",{level:p[0],lastLevel:null})}}r.fire("TypingUndo");t=false;r.nodeChanged()}});r.on("KeyDown",function(x){var w=x.keyCode;if((w>=33&&w<=36)||(w>=37&&w<=40)||w==45){if(v.typing){o()}return}if((w<16||w>20)&&w!=224&&w!=91&&!v.typing){v.beforeChange();v.typing=true;v.add();t=true}});r.on("MouseDown",function(){if(v.typing){o()}});r.addShortcut("ctrl+z","","Undo");r.addShortcut("ctrl+y,ctrl+shift+z","","Redo");r.on("AddUndo Undo Redo ClearUndos MouseUp",function(w){if(!w.isDefaultPrevented()){r.nodeChanged()}});v={data:p,typing:false,beforeChange:function(){if(!u){q=r.selection.getBookmark(2,true)}},add:function(A){var x,y=r.settings,z;A=A||{};A.content=n();if(u||r.fire("BeforeAddUndo",{level:A}).isDefaultPrevented()){return null}z=p[s];if(z&&z.content==A.content){return null}if(p[s]){p[s].beforeBookmark=q}if(y.custom_undo_redo_levels){if(p.length>y.custom_undo_redo_levels){for(x=0;x<p.length-1;x++){p[x]=p[x+1]}p.length--;s=p.length}}A.bookmark=r.selection.getBookmark(2,true);if(s<p.length-1){p.length=s+1}p.push(A);s=p.length-1;var w={level:A,lastLevel:z};r.fire("AddUndo",w);if(s>0){r.fire("change",w);r.isNotDirty=false}return A},undo:function(){var w;if(v.typing){v.add();v.typing=false}if(s>0){w=p[--s];if(s===0){r.isNotDirty=true}r.setContent(w.content,{format:"raw"});r.selection.moveToBookmark(w.beforeBookmark);r.fire("undo",{level:w})}return w},redo:function(){var w;if(s<p.length-1){w=p[++s];r.setContent(w.content,{format:"raw"});r.selection.moveToBookmark(w.bookmark);r.fire("redo",{level:w})}return w},clear:function(){p=[];s=0;v.typing=false;r.fire("ClearUndos")},hasUndo:function(){return s>0||(v.typing&&p[0]&&n()!=p[0].content)},hasRedo:function(){return s<p.length-1&&!this.typing},transact:function(w){v.beforeChange();u=true;w();u=false;v.add()}};return v}});h("tinymce/EnterKey",["tinymce/dom/TreeWalker","tinymce/Env"],function(k,j){var l=j.ie&&j.ie<11;return function(p){var t=p.dom,o=p.selection,n=p.settings;var s=p.undoManager,q=p.schema,m=q.getNonEmptyElements();function r(L){var G=o.getRng(true),Q,u,K,F,A,W,M,z,v,y,E,T,H,N;function O(X){return X&&t.isBlock(X)&&!/^(TD|TH|CAPTION|FORM)$/.test(X.nodeName)&&!/^(fixed|absolute)/i.test(X.style.position)&&t.getContentEditable(X)!=="true"}function P(Y){var X;if(t.isBlock(Y)){X=o.getRng();Y.appendChild(t.create("span",null,"\u00a0"));o.select(Y);Y.lastChild.outerHTML="";o.setRng(X)}}function J(Z){var Y=Z,aa=[],X;while((Y=Y.firstChild)){if(t.isBlock(Y)){return}if(Y.nodeType==1&&!m[Y.nodeName.toLowerCase()]){aa.push(Y)}}X=aa.length;while(X--){Y=aa[X];if(!Y.hasChildNodes()||(Y.firstChild==Y.lastChild&&Y.firstChild.nodeValue==="")){t.remove(Y)}else{if(Y.nodeName=="A"&&(Y.innerText||Y.textContent)===" "){t.remove(Y)}}}}function x(Y){var ac,ab,X,aa=Y,Z;X=t.createRng();if(Y.hasChildNodes()){ac=new k(Y,Y);while((ab=ac.current())){if(ab.nodeType==3){X.setStart(ab,0);X.setEnd(ab,0);break}if(m[ab.nodeName.toLowerCase()]){X.setStartBefore(ab);X.setEndBefore(ab);break}aa=ab;ab=ac.next()}if(!ab){X.setStart(aa,0);X.setEnd(aa,0)}}else{if(Y.nodeName=="BR"){if(Y.nextSibling&&t.isBlock(Y.nextSibling)){if(!W||W<9){Z=t.create("br");Y.parentNode.insertBefore(Z,Y)}X.setStartBefore(Y);X.setEndBefore(Y)}else{X.setStartAfter(Y);X.setEndAfter(Y)}}else{X.setStart(Y,0);X.setEnd(Y,0)}}o.setRng(X);t.remove(Z);o.scrollIntoView(Y)}function C(Y){var Z=K,ab,aa,X;ab=Y||E=="TABLE"?t.create(Y||H):A.cloneNode(false);X=ab;if(n.keep_styles!==false){do{if(/^(SPAN|STRONG|B|EM|I|FONT|STRIKE|U)$/.test(Z.nodeName)){if(Z.id=="_mce_caret"){continue}aa=Z.cloneNode(false);t.setAttrib(aa,"id","");if(ab.hasChildNodes()){aa.appendChild(ab.firstChild);ab.appendChild(aa)}else{X=aa;ab.appendChild(aa)}}}while((Z=Z.parentNode))}if(!l){X.innerHTML='<br data-mce-bogus="1">'}return ab}function B(aa){var Z,Y,X;if(K.nodeType==3&&(aa?F>0:F<K.nodeValue.length)){return false}if(K.parentNode==A&&N&&!aa){return true}if(aa&&K.nodeType==1&&K==A.firstChild){return true}if(K.nodeName==="TABLE"||(K.previousSibling&&K.previousSibling.nodeName=="TABLE")){return(N&&!aa)||(!N&&aa)}Z=new k(K,A);if(K.nodeType==3){if(aa&&F===0){Z.prev()}else{if(!aa&&F==K.nodeValue.length){Z.next()}}}while((Y=Z.current())){if(Y.nodeType===1){if(!Y.getAttribute("data-mce-bogus")){X=Y.nodeName.toLowerCase();if(m[X]&&X!=="br"){return false}}}else{if(Y.nodeType===3&&!/^[ \t\r\n]*$/.test(Y.nodeValue)){return false}}if(aa){Z.prev()}else{Z.next()}}return true}function w(Y,ac){var ae,Z,aa,ab,ad,X,af=H||"P";Z=t.getParent(Y,t.isBlock);X=p.getBody().nodeName.toLowerCase();if(!Z||!O(Z)){Z=Z||u;if(!Z.hasChildNodes()){ae=t.create(af);Z.appendChild(ae);G.setStart(ae,0);G.setEnd(ae,0);return ae}ab=Y;while(ab.parentNode!=Z){ab=ab.parentNode}while(ab&&!t.isBlock(ab)){aa=ab;ab=ab.previousSibling}if(aa&&q.isValidChild(X,af.toLowerCase())){ae=t.create(af);aa.parentNode.insertBefore(ae,aa);ab=aa;while(ab&&!t.isBlock(ab)){ad=ab.nextSibling;ae.appendChild(ab);ab=ad}G.setStart(Y,ac);G.setEnd(Y,ac)}}return Y}function R(){function Y(ab){var aa=y[ab?"firstChild":"lastChild"];while(aa){if(aa.nodeType==1){break}aa=aa[ab?"nextSibling":"previousSibling"]}return aa===A}function Z(){var aa=y.parentNode;if(aa.nodeName=="LI"){return aa}return y}var X=y.parentNode.nodeName;if(/^(OL|UL|LI)$/.test(X)){H="LI"}z=H?C(H):t.create("BR");if(Y(true)&&Y()){if(X=="LI"){t.insertAfter(z,Z())}else{t.replace(z,y)}}else{if(Y(true)){if(X=="LI"){t.insertAfter(z,Z());z.appendChild(t.doc.createTextNode(" "));z.appendChild(y)}else{y.parentNode.insertBefore(z,y)}}else{if(Y()){t.insertAfter(z,Z());P(z)}else{y=Z();Q=G.cloneRange();Q.setStartAfter(A);Q.setEndAfter(y);v=Q.extractContents();t.insertAfter(v,y);t.insertAfter(z,y)}}}t.remove(A);x(z);s.add()}function I(){var Y=new k(K,A),X;while((X=Y.next())){if(m[X.nodeName.toLowerCase()]||X.length>0){return true}}}function V(){var Z,Y,X;if(K&&K.nodeType==3&&F>=K.nodeValue.length){if(!l&&!I()){Z=t.create("br");G.insertNode(Z);G.setStartAfter(Z);G.setEndAfter(Z);Y=true}}Z=t.create("br");G.insertNode(Z);if(l&&E=="PRE"&&(!W||W<8)){Z.parentNode.insertBefore(t.doc.createTextNode("\r"),Z)}X=t.create("span",{},"&nbsp;");Z.parentNode.insertBefore(X,Z);o.scrollIntoView(X);t.remove(X);if(!Y){G.setStartAfter(Z);G.setEndAfter(Z)}else{G.setStartBefore(Z);G.setEndBefore(Z)}o.setRng(G);s.add()}function D(X){do{if(X.nodeType===3){X.nodeValue=X.nodeValue.replace(/^[\r\n]+/,"")}X=X.firstChild}while(X)}function U(Z){var X=t.getRoot(),Y,aa;Y=Z;while(Y!==X&&t.getContentEditable(Y)!=="false"){if(t.getContentEditable(Y)==="true"){aa=Y}Y=Y.parentNode}return Y!==X?aa:X}function S(Y){var X;if(!l){Y.normalize();X=Y.lastChild;if(!X||(/^(left|right)$/gi.test(t.getStyle(X,"float",true)))){t.add(Y,"br")}}}if(!G.collapsed){p.execCommand("Delete");return}if(L.isDefaultPrevented()){return}K=G.startContainer;F=G.startOffset;H=(n.force_p_newlines?"p":"")||n.forced_root_block;H=H?H.toUpperCase():"";W=t.doc.documentMode;M=L.shiftKey;if(K.nodeType==1&&K.hasChildNodes()){N=F>K.childNodes.length-1;K=K.childNodes[Math.min(F,K.childNodes.length-1)]||K;if(N&&K.nodeType==3){F=K.nodeValue.length}else{F=0}}u=U(K);if(!u){return}s.beforeChange();if(!t.isBlock(u)&&u!=t.getRoot()){if(!H||M){V()}return}if((H&&!M)||(!H&&M)){K=w(K,F)}A=t.getParent(K,t.isBlock);y=A?t.getParent(A.parentNode,t.isBlock):null;E=A?A.nodeName.toUpperCase():"";T=y?y.nodeName.toUpperCase():"";if(T=="LI"&&!L.ctrlKey){A=y;E=T}if(E=="LI"){if(!H&&M){V();return}if(t.isEmpty(A)){R();return}}if(E=="PRE"&&n.br_in_pre!==false){if(!M){V();return}}else{if((!H&&!M&&E!="LI")||(H&&M)){V();return}}if(H&&A===p.getBody()){return}H=H||"P";if(B()){if(/^(H[1-6]|PRE|FIGURE)$/.test(E)&&T!="HGROUP"){z=C(H)}else{z=C()}if(n.end_container_on_empty_block&&O(y)&&t.isEmpty(A)){z=t.split(y,A)}else{t.insertAfter(z,A)}x(z)}else{if(B(true)){z=A.parentNode.insertBefore(C(),A);P(z);x(A)}else{Q=G.cloneRange();Q.setEndAfter(A);v=Q.extractContents();D(v);z=v.firstChild;t.insertAfter(v,A);J(z);S(A);x(z)}}t.setAttrib(z,"id","");p.fire("NewBlock",{newBlock:z});s.add()}p.on("keydown",function(u){if(u.keyCode==13){if(r(u)!==false){u.preventDefault()}}})}});h("tinymce/ForceBlocks",[],function(){return function(l){var k=l.settings,o=l.dom,j=l.selection;var n=l.schema,m=n.getBlockElements();function p(){var v=j.getStart(),t=l.getBody(),q;var w,B,F,D,u;var x,y=-16777215,C,r;var E,s,A;A=k.forced_root_block;if(!v||v.nodeType!==1||!A){return}while(v&&v!=t){if(m[v.nodeName]){return}v=v.parentNode}q=j.getRng();if(q.setStart){w=q.startContainer;B=q.startOffset;F=q.endContainer;D=q.endOffset;try{r=l.getDoc().activeElement===t}catch(z){}}else{if(q.item){v=q.item(0);q=l.getDoc().body.createTextRange();q.moveToElementText(v)}r=q.parentElement().ownerDocument===l.getDoc();E=q.duplicate();E.collapse(true);B=E.move("character",y)*-1;if(!E.collapsed){E=q.duplicate();E.collapse(false);D=(E.move("character",y)*-1)-B}}v=t.firstChild;s=t.nodeName.toLowerCase();while(v){if(((v.nodeType===3||(v.nodeType==1&&!m[v.nodeName])))&&n.isValidChild(s,A.toLowerCase())){if(v.nodeType===3&&v.nodeValue.length===0){x=v;v=v.nextSibling;o.remove(x);continue}if(!u){u=o.create(A);v.parentNode.insertBefore(u,v);C=true}x=v;v=v.nextSibling;u.appendChild(x)}else{u=null;v=v.nextSibling}}if(C&&r){if(q.setStart){q.setStart(w,B);q.setEnd(F,D);j.setRng(q)}else{try{q=l.getDoc().body.createTextRange();q.moveToElementText(t);q.collapse(true);q.moveStart("character",B);if(D>0){q.moveEnd("character",D)}q.select()}catch(z){}}l.nodeChanged()}}if(k.forced_root_block){l.on("NodeChange",p)}}});h("tinymce/EditorCommands",["tinymce/html/Serializer","tinymce/Env","tinymce/util/Tools"],function(r,p,m){var t=m.each,q=m.extend;var k=m.map,u=m.inArray,s=m.explode;var j=p.gecko,l=p.ie;var n=true,o=false;return function(D){var C=D.dom,F=D.selection,z={state:{},exec:{},value:{}},A=D.settings,G=D.formatter,E;function H(O,N,M){var L;O=O.toLowerCase();if((L=z.exec[O])){L(O,N,M);return n}return o}function B(M){var L;M=M.toLowerCase();if((L=z.state[M])){return L(M)}return -1}function x(M){var L;M=M.toLowerCase();if((L=z.value[M])){return L(M)}return o}function K(L,M){M=M||"exec";t(L,function(O,N){t(N.toLowerCase().split(","),function(P){z[M][P]=O})})}q(this,{execCommand:H,queryCommandState:B,queryCommandValue:x,addCommands:K});function v(N,M,L){if(M===g){M=o}if(L===g){L=null}return D.getDoc().execCommand(N,M,L)}function J(L){return G.match(L)}function I(L,M){G.toggle(L,M?{value:M}:g);D.nodeChanged()}function y(L){E=F.getBookmark(L)}function w(){F.moveToBookmark(E)}K({"mceResetDesignMode,mceBeginUndoLevel":function(){},"mceEndUndoLevel,mceAddUndoLevel":function(){D.undoManager.add()},"Cut,Copy,Paste":function(O){var N=D.getDoc(),L;try{v(O)}catch(M){L=n}if(L||!N.queryCommandSupported(O)){D.windowManager.alert("Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.")}},unlink:function(L){if(F.isCollapsed()){F.select(F.getNode())}v(L);F.collapse(o)},"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull":function(L){var M=L.substring(7);if(M=="full"){M="justify"}t("left,center,right,justify".split(","),function(N){if(M!=N){G.remove("align"+N)}});I("align"+M);H("mceRepaint")},"InsertUnorderedList,InsertOrderedList":function(N){var L,M;v(N);L=C.getParent(F.getNode(),"ol,ul");if(L){M=L.parentNode;if(/^(H[1-6]|P|ADDRESS|PRE)$/.test(M.nodeName)){y();C.split(M,L);w()}}},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(L){I(L)},"ForeColor,HiliteColor,FontName":function(N,M,L){I(N,L)},FontSize:function(O,N,M){var L,P;if(M>=1&&M<=7){P=s(A.font_size_style_values);L=s(A.font_size_classes);if(L){M=L[M-1]||M}else{M=P[M-1]||M}}I(O,M)},RemoveFormat:function(L){G.remove(L)},mceBlockQuote:function(){I("blockquote")},FormatBlock:function(N,M,L){return I(L||"p")},mceCleanup:function(){var L=F.getBookmark();D.setContent(D.getContent({cleanup:n}),{cleanup:n});F.moveToBookmark(L)},mceRemoveNode:function(O,N,M){var L=M||F.getNode();if(L!=D.getBody()){y();D.dom.remove(L,n);w()}},mceSelectNodeDepth:function(O,N,M){var L=0;C.getParent(F.getNode(),function(P){if(P.nodeType==1&&L++==M){F.select(P);return o}},D.getBody())},mceSelectNode:function(N,M,L){F.select(L)},mceInsertContent:function(Q,X,Z){var P,ac,U,ad,M,N;var T,O,Y,S,aa,L,V,R;function ab(ah){var ag,af,ai;ag=F.getRng(true);af=ag.startContainer;ai=ag.startOffset;function ae(aj){return af[aj]&&af[aj].nodeType==3}if(af.nodeType==3){if(ai>0){ah=ah.replace(/^&nbsp;/," ")}else{if(!ae("previousSibling")){ah=ah.replace(/^ /,"&nbsp;")}}if(ai<af.length){ah=ah.replace(/&nbsp;(<br>|)$/," ")}else{if(!ae("nextSibling")){ah=ah.replace(/(&nbsp;| )(<br>|)$/,"&nbsp;")}}}return ah}if(/^ | $/.test(Z)){Z=ab(Z)}P=D.parser;ac=new r({},D.schema);V='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;</span>';N={content:Z,format:"html",selection:true};D.fire("BeforeSetContent",N);Z=N.content;if(Z.indexOf("{$caret}")==-1){Z+="{$caret}"}Z=Z.replace(/\{\$caret\}/,V);if(!F.isCollapsed()){D.getDoc().execCommand("Delete",false,null)}U=F.getNode();var W={context:U.nodeName.toLowerCase()};M=P.parse(Z,W);aa=M.lastChild;if(aa.attr("id")=="mce_marker"){T=aa;for(aa=aa.prev;aa;aa=aa.walk(true)){if(aa.type==3||!C.isBlock(aa.name)){aa.parent.insert(T,aa,aa.name==="br");break}}}if(!W.invalid){Z=ac.serialize(M);aa=U.firstChild;L=U.lastChild;if(!aa||(aa===L&&aa.nodeName==="BR")){C.setHTML(U,Z)}else{F.setContent(Z)}}else{F.setContent(V);U=F.getNode();ad=D.getBody();if(U.nodeType==9){U=aa=ad}else{aa=U}while(aa!==ad){U=aa;aa=aa.parentNode}Z=U==ad?ad.innerHTML:C.getOuterHTML(U);Z=ac.serialize(P.parse(Z.replace(/<span (id="mce_marker"|id=mce_marker).+?<\/span>/i,function(){return ac.serialize(M)})));if(U==ad){C.setHTML(ad,Z)}else{C.setOuterHTML(U,Z)}}T=C.get("mce_marker");O=C.getRect(T);Y=C.getViewPort(D.getWin());if((O.y+O.h>Y.y+Y.h||O.y<Y.y)||(O.x>Y.x+Y.w||O.x<Y.x)){R=l?D.getDoc().documentElement:D.getBody();R.scrollLeft=O.x;R.scrollTop=O.y-Y.h+25}S=C.createRng();aa=T.previousSibling;if(aa&&aa.nodeType==3){S.setStart(aa,aa.nodeValue.length);if(!l){L=T.nextSibling;if(L&&L.nodeType==3){aa.appendData(L.data);L.parentNode.removeChild(L)}}}else{S.setStartBefore(T);S.setEndBefore(T)}C.remove(T);F.setRng(S);D.fire("SetContent",N);D.addVisual()},mceInsertRawHTML:function(N,M,L){F.setContent("tiny_mce_marker");D.setContent(D.getContent().replace(/tiny_mce_marker/g,function(){return L}))},mceToggleFormat:function(N,M,L){I(L)},mceSetContent:function(N,M,L){D.setContent(L)},"Indent,Outdent":function(P){var M,L,O;M=A.indentation;L=/[a-z%]+$/i.exec(M);M=parseInt(M,10);if(!B("InsertUnorderedList")&&!B("InsertOrderedList")){if(!A.forced_root_block&&!C.getParent(F.getNode(),C.isBlock)){G.apply("div")}t(F.getSelectedBlocks(),function(R){var Q;if(R.nodeName!="LI"){Q=C.getStyle(R,"direction",true)=="rtl"?"paddingRight":"paddingLeft";if(P=="outdent"){O=Math.max(0,parseInt(R.style[Q]||0,10)-M);C.setStyle(R,Q,O?O+L:"")}else{O=(parseInt(R.style[Q]||0,10)+M)+L;C.setStyle(R,Q,O)}}})}else{v(P);var N=F.getNode();if(N&&N.parentNode&&P=="indent"){C.setStyles(N.parentNode,{margin:"0 0 0 "+M+L})}}},mceRepaint:function(){if(j){try{y(n);if(F.getSel()){F.getSel().selectAllChildren(D.getBody())}F.collapse(n);w()}catch(L){}}},InsertHorizontalRule:function(){D.execCommand("mceInsertContent",false,"<hr />")},mceToggleVisualAid:function(){D.hasVisual=!D.hasVisual;D.addVisual()},mceReplaceContent:function(N,M,L){D.execCommand("mceInsertContent",false,L.replace(/\{\$selection\}/g,F.getContent({format:"text"})))},mceInsertLink:function(O,N,M){var L;if(typeof(M)=="string"){M={href:M}}L=C.getParent(F.getNode(),"a");if(!L||!M.href){G.remove("link")}if(M.href){G.apply("link",M,L)}},selectAll:function(){var M=C.getRoot(),L=C.createRng();if(F.getRng().setStart){L.setStart(M,0);L.setEnd(M,M.childNodes.length);F.setRng(L)}else{v("SelectAll")}},mceNewDocument:function(){D.setContent("")}});K({"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull":function(O){var M="align"+O.substring(7);var L=F.isCollapsed()?[C.getParent(F.getNode(),C.isBlock)]:F.getSelectedBlocks();var N=k(L,function(P){return !!G.matchNode(P,M)});return u(N,n)!==-1},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(L){return J(L)},mceBlockQuote:function(){return J("blockquote")},Outdent:function(){var L;if(A.inline_styles){if((L=C.getParent(F.getStart(),C.isBlock))&&parseInt(L.style.paddingLeft,10)>0){return n}if((L=C.getParent(F.getEnd(),C.isBlock))&&parseInt(L.style.paddingLeft,10)>0){return n}}return(B("InsertUnorderedList")||B("InsertOrderedList")||(!A.inline_styles&&!!C.getParent(F.getNode(),"BLOCKQUOTE")))},"InsertUnorderedList,InsertOrderedList":function(M){var L=C.getParent(F.getNode(),"ul,ol");return L&&(M==="insertunorderedlist"&&L.tagName==="UL"||M==="insertorderedlist"&&L.tagName==="OL")}},"state");K({"FontSize,FontName":function(N){var M=0,L;if((L=C.getParent(F.getNode(),"span"))){if(N=="fontsize"){M=L.style.fontSize}else{M=L.style.fontFamily.replace(/, /g,",").replace(/[\'\"]/g,"").toLowerCase()}}return M}},"value");K({Undo:function(){D.undoManager.undo()},Redo:function(){D.undoManager.redo()}})}});h("tinymce/util/URI",["tinymce/util/Tools"],function(l){var m=l.each,j=l.trim;function k(o,p){var n=this,r,q;o=j(o);p=n.settings=p||{};if(/^([\w\-]+):([^\/]{2})/i.test(o)||/^\s*#/.test(o)){n.source=o;return}if(o.indexOf("/")===0&&o.indexOf("//")!==0){o=(p.base_uri?p.base_uri.protocol||"http":"http")+"://mce_host"+o}if(!/^[\w\-]*:?\/\//.test(o)){q=p.base_uri?p.base_uri.path:new k(location.href).directory;o=((p.base_uri&&p.base_uri.protocol)||"http")+"://mce_host"+n.toAbsPath(q,o)}o=o.replace(/@@/g,"(mce_at)");o=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(o);m(["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],function(s,u){var t=o[u];if(t){t=t.replace(/\(mce_at\)/g,"@@")}n[s]=t});r=p.base_uri;if(r){if(!n.protocol){n.protocol=r.protocol}if(!n.userInfo){n.userInfo=r.userInfo}if(!n.port&&n.host==="mce_host"){n.port=r.port}if(!n.host||n.host==="mce_host"){n.host=r.host}n.source=""}}k.prototype={setPath:function(o){var n=this;o=/^(.*?)\/?(\w+)?$/.exec(o);n.path=o[0];n.directory=o[1];n.file=o[2];n.source="";n.getURI()},toRelative:function(r){var o=this,n;if(r==="./"){return r}r=new k(r,{base_uri:o});if((r.host!="mce_host"&&o.host!=r.host&&r.host)||o.port!=r.port||o.protocol!=r.protocol){return r.getURI()}var p=o.getURI(),q=r.getURI();if(p==q||(p.charAt(p.length-1)=="/"&&p.substr(0,p.length-1)==q)){return p}n=o.toRelPath(o.path,r.path);if(r.query){n+="?"+r.query}if(r.anchor){n+="#"+r.anchor}return n},toAbsolute:function(o,n){o=new k(o,{base_uri:this});return o.getURI(this.host==o.host&&this.protocol==o.protocol?n:0)},toRelPath:function(s,t){var o,r=0,p="",q,n;s=s.substring(0,s.lastIndexOf("/"));s=s.split("/");o=t.split("/");if(s.length>=o.length){for(q=0,n=s.length;q<n;q++){if(q>=o.length||s[q]!=o[q]){r=q+1;break}}}if(s.length<o.length){for(q=0,n=o.length;q<n;q++){if(q>=s.length||s[q]!=o[q]){r=q+1;break}}}if(r===1){return t}for(q=0,n=s.length-(r-1);q<n;q++){p+="../"}for(q=r-1,n=o.length;q<n;q++){if(q!=r-1){p+="/"+o[q]}else{p+=o[q]}}return p},toAbsPath:function(r,s){var p,n=0,u=[],q,t;q=/\/$/.test(s)?"/":"";r=r.split("/");s=s.split("/");m(r,function(o){if(o){u.push(o)}});r=u;for(p=s.length-1,u=[];p>=0;p--){if(s[p].length===0||s[p]==="."){continue}if(s[p]===".."){n++;continue}if(n>0){n--;continue}u.push(s[p])}p=r.length-n;if(p<=0){t=u.reverse().join("/")}else{t=r.slice(0,p).join("/")+"/"+u.reverse().join("/")}if(t.indexOf("/")!==0){t="/"+t}if(q&&t.lastIndexOf("/")!==t.length-1){t+=q}return t},getURI:function(p){var o,n=this;if(!n.source||p){o="";if(!p){if(n.protocol){o+=n.protocol+"://"}if(n.userInfo){o+=n.userInfo+"@"}if(n.host){o+=n.host}if(n.port){o+=":"+n.port}}if(n.path){o+=n.path}if(n.query){o+="?"+n.query}if(n.anchor){o+="#"+n.anchor}n.source=o}return n.source}};return k});h("tinymce/util/Class",["tinymce/util/Tools"],function(m){var n=m.each,o=m.extend;var l,k;function j(){}j.extend=l=function(p){var s=this,x=s.prototype,w,q,v;function r(){var B,y,A,z;if(!k){z=this;if(z.init){z.init.apply(z,arguments)}y=z.Mixins;if(y){B=y.length;while(B--){A=y[B];if(A.init){A.init.apply(z,arguments)}}}}}function t(){return this}function u(y,z){return function(){var A=this,C=A._super,B;A._super=x[y];B=z.apply(A,arguments);A._super=C;return B}}k=true;w=new s();k=false;if(p.Mixins){n(p.Mixins,function(y){y=y;for(var z in y){if(z!=="init"){p[z]=y[z]}}});if(x.Mixins){p.Mixins=x.Mixins.concat(p.Mixins)}}if(p.Methods){n(p.Methods.split(","),function(y){p[y]=t})}if(p.Properties){n(p.Properties.split(","),function(y){var z="_"+y;p[y]=function(C){var A=this,B;if(C!==B){A[z]=C;return A}return A[z]}})}if(p.Statics){n(p.Statics,function(z,y){r[y]=z})}if(p.Defaults&&x.Defaults){p.Defaults=o({},x.Defaults,p.Defaults)}for(q in p){v=p[q];if(typeof v=="function"&&x[q]){w[q]=u(q,v)}else{w[q]=v}}r.prototype=w;r.constructor=r;r.extend=l;return r};return j});h("tinymce/ui/Selector",["tinymce/util/Class","tinymce/util/Tools"],function(l,m){function q(u){var r=[],s=u.length,t;while(s--){t=u[s];if(!t.__checked){r.push(t);t.__checked=1}}s=r.length;while(s--){delete r[s].__checked}return r}var p=/^([\w\\*]+)?(?:#([\w\\]+))?(?:\.([\w\\\.]+))?(?:\[\@?([\w\\]+)([\^\$\*!~]?=)([\w\\]+)\])?(?:\:(.+))?/i;var j=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,o=/^\s*|\s*$/g,n;var k=l.extend({init:function(s){var u=this.match;function t(A){if(A){A=A.toLowerCase();return function(B){return A==="*"||B.type===A}}}function y(A){if(A){return function(B){return B._name===A}}}function v(A){if(A){A=A.split(".");return function(C){var B=A.length;while(B--){if(!C.hasClass(A[B])){return false}}return true}}}function r(B,C,A){if(B){return function(D){var E=D[B]?D[B]():"";return !C?!!A:C==="="?E===A:C==="*="?E.indexOf(A)>=0:C==="~="?(" "+E+" ").indexOf(" "+A+" ")>=0:C==="!="?E!=A:C==="^="?E.indexOf(A)===0:C==="$="?E.substr(E.length-A.length)===A:false}}}function x(A){var B;if(A){A=/(?:not\((.+)\))|(.+)/i.exec(A);if(!A[1]){A=A[2];return function(E,C,D){return A==="first"?C===0:A==="last"?C===D-1:A==="even"?C%2===0:A==="odd"?C%2===1:E[A]?E[A]():false}}else{B=w(A[1],[]);return function(C){return !u(C,B)}}}}function z(A,B,E){var D;function C(F){if(F){B.push(F)}}D=p.exec(A.replace(o,""));C(t(D[1]));C(y(D[2]));C(v(D[3]));C(r(D[4],D[5],D[6]));C(x(D[7]));B.psuedo=!!D[7];B.direct=E;return B}function w(B,D){var F=[],A,E,C;do{j.exec("");E=j.exec(B);if(E){B=E[3];F.push(E[1]);if(E[2]){A=E[3];break}}}while(E);if(A){w(A,D)}B=[];for(C=0;C<F.length;C++){if(F[C]!=">"){B.push(z(F[C],[],F[C-1]===">"))}}D.push(B);return D}this._selectors=w(s,[])},match:function(w,D){var x,t,y,u,v,F,C,s,A,r,B,z,E;D=D||this._selectors;for(x=0,t=D.length;x<t;x++){v=D[x];u=v.length;E=w;z=0;for(y=u-1;y>=0;y--){s=v[y];while(E){if(s.psuedo){B=E.parent().items();A=m.inArray(E,B);r=B.length}for(F=0,C=s.length;F<C;F++){if(!s[F](E,A,r)){F=C+1;break}}if(F===C){z++;break}else{if(y===u-1){break}}E=E.parent()}}if(z===u){return true}}return false},find:function(s){var w=[],u,r,t=this._selectors;function v(C,z,B){var A,y,E,D,F,x=z[B];for(A=0,y=C.length;A<y;A++){F=C[A];for(E=0,D=x.length;E<D;E++){if(!x[E](F,A,y)){E=D+1;break}}if(E===D){if(B==z.length-1){w.push(F)}else{if(F.items){v(F.items(),z,B+1)}}}else{if(x.direct){return}}if(F.items){v(F.items(),z,B)}}}if(s.items){for(u=0,r=t.length;u<r;u++){v(s.items(),t[u],0)}if(r>1){w=q(w)}}if(!n){n=k.Collection}return new n(w)}});return k});h("tinymce/ui/Collection",["tinymce/util/Tools","tinymce/ui/Selector","tinymce/util/Class"],function(m,j,k){var n,o,l=Array.prototype.push,p=Array.prototype.slice;o={length:0,init:function(q){if(q){this.add(q)}},add:function(r){var q=this;if(!m.isArray(r)){if(r instanceof n){q.add(r.toArray())}else{l.call(q,r)}}else{l.apply(q,r)}return q},set:function(s){var r=this,q=r.length,t;r.length=0;r.add(s);for(t=r.length;t<q;t++){delete r[t]}return r},filter:function(q){var s=this,u,r,w=[],v,t;if(typeof(q)==="string"){q=new j(q);t=function(x){return q.match(x)}}else{t=q}for(u=0,r=s.length;u<r;u++){v=s[u];if(t(v)){w.push(v)}}return new n(w)},slice:function(){return new n(p.apply(this,arguments))},eq:function(q){return q===-1?this.slice(q):this.slice(q,+q+1)},each:function(q){m.each(this,q);return this},toArray:function(){return m.toArray(this)},indexOf:function(s){var q=this,r=q.length;while(r--){if(q[r]===s){break}}return r},reverse:function(){return new n(m.toArray(this).reverse())},hasClass:function(q){return this[0]?this[0].hasClass(q):false},prop:function(r,u){var q=this,s,t;if(u!==s){q.each(function(v){if(v[r]){v[r](u)}});return q}t=q[0];if(t&&t[r]){return t[r]()}},exec:function(s){var q=this,r=m.toArray(arguments).slice(1);q.each(function(t){if(t[s]){t[s].apply(t,r)}});return q},remove:function(){var q=this.length;while(q--){this[q].remove()}return this}};m.each("fire on off show hide addClass removeClass append prepend before after reflow".split(" "),function(q){o[q]=function(){var r=m.toArray(arguments);this.each(function(s){if(q in s){s[q].apply(s,r)}});return this}});m.each("text name disabled active selected checked visible parent value data".split(" "),function(q){o[q]=function(r){return this.prop(q,r)}});n=k.extend(o);j.Collection=n;return n});h("tinymce/ui/DomUtils",["tinymce/util/Tools","tinymce/dom/DOMUtils"],function(j,k){return{id:function(){return k.DOM.uniqueId()},createFragment:function(l){return k.DOM.createFragment(l)},getWindowSize:function(){return k.DOM.getViewPort()},getSize:function(o){var m,l;if(o.getBoundingClientRect){var n=o.getBoundingClientRect();m=Math.max(n.width||(n.right-n.left),o.offsetWidth);l=Math.max(n.height||(n.bottom-n.bottom),o.offsetHeight)}else{m=o.offsetWidth;l=o.offsetHeight}return{width:m,height:l}},getPos:function(m,l){return k.DOM.getPos(m,l)},getViewPort:function(l){return k.DOM.getViewPort(l)},get:function(l){return document.getElementById(l)},addClass:function(m,l){return k.DOM.addClass(m,l)},removeClass:function(m,l){return k.DOM.removeClass(m,l)},hasClass:function(m,l){return k.DOM.hasClass(m,l)},toggleClass:function(n,l,m){return k.DOM.toggleClass(n,l,m)},css:function(n,l,m){return k.DOM.setStyle(n,l,m)},on:function(n,l,o,m){return k.DOM.bind(n,l,o,m)},off:function(m,l,n){return k.DOM.unbind(m,l,n)},fire:function(n,m,l){return k.DOM.fire(n,m,l)},innerHtml:function(m,l){k.DOM.setHTML(m,l)}}});h("tinymce/ui/Control",["tinymce/util/Class","tinymce/util/Tools","tinymce/ui/Collection","tinymce/ui/DomUtils"],function(k,o,p,j){var q=o.makeMap("focusin focusout scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave wheel keydown keypress keyup contextmenu"," ");var r={};var m="onmousewheel" in document;var n=false;var l=k.extend({Statics:{controlIdLookup:{}},isRtl:function(){return l.rtl},classPrefix:"mce-",init:function(v){var s=this,u,t;s.settings=v=o.extend({},s.Defaults,v);s._id=j.id();s._text=s._name="";s._width=s._height=0;s._aria={role:v.role};u=v.classes;if(u){u=u.split(" ");u.map={};t=u.length;while(t--){u.map[u[t]]=true}}s._classes=u||[];s.visible(true);o.each("title text width height name classes visible disabled active value".split(" "),function(w){var y=v[w],x;if(y!==x){s[w](y)}else{if(s["_"+w]===x){s["_"+w]=false}}});s.on("click",function(){if(s.disabled()){return false}});if(v.classes){o.each(v.classes.split(" "),function(w){s.addClass(w)})}s.settings=v;s._borderBox=s.parseBox(v.border);s._paddingBox=s.parseBox(v.padding);s._marginBox=s.parseBox(v.margin);if(v.hidden){s.hide()}},Properties:"parent,title,text,width,height,disabled,active,name,value",Methods:"renderHtml",getContainerElm:function(){return document.body},getParentCtrl:function(t){var s;while(t){s=l.controlIdLookup[t.id];if(s){break}t=t.parentNode}return s},parseBox:function(u){var s,t=10;if(!u){return}if(typeof(u)==="number"){u=u||0;return{top:u,left:u,bottom:u,right:u}}u=u.split(" ");s=u.length;if(s===1){u[1]=u[2]=u[3]=u[0]}else{if(s===2){u[2]=u[0];u[3]=u[1]}else{if(s===3){u[3]=u[1]}}}return{top:parseInt(u[0],t)||0,right:parseInt(u[1],t)||0,bottom:parseInt(u[2],t)||0,left:parseInt(u[3],t)||0}},borderBox:function(){return this._borderBox},paddingBox:function(){return this._paddingBox},marginBox:function(){return this._marginBox},measureBox:function(v,t){function s(w){var x=document.defaultView;if(x){w=w.replace(/[A-Z]/g,function(y){return"-"+y});return x.getComputedStyle(v,null).getPropertyValue(w)}return v.currentStyle[w]}function u(w){var x=parseFloat(s(w),10);return isNaN(x)?0:x}return{top:u(t+"TopWidth"),right:u(t+"RightWidth"),bottom:u(t+"BottomWidth"),left:u(t+"LeftWidth")}},initLayoutRect:function(){var I=this,A=I.settings,v,E;var C=I.getEl(),z,G,w,F,y;var s,u,H;v=I._borderBox=I._borderBox||I.measureBox(C,"border");I._paddingBox=I._paddingBox||I.measureBox(C,"padding");I._marginBox=I._marginBox||I.measureBox(C,"margin");H=j.getSize(C);s=A.minWidth;u=A.minHeight;w=s||H.width;F=u||H.height;z=A.width;G=A.height;y=A.autoResize;y=typeof(y)!="undefined"?y:!z&&!G;z=z||w;G=G||F;var B=v.left+v.right;var t=v.top+v.bottom;var x=A.maxWidth||65535;var D=A.maxHeight||65535;I._layoutRect=E={x:A.x||0,y:A.y||0,w:z,h:G,deltaW:B,deltaH:t,contentW:z-B,contentH:G-t,innerW:z-B,innerH:G-t,startMinWidth:s||0,startMinHeight:u||0,minW:Math.min(w,x),minH:Math.min(F,D),maxW:x,maxH:D,autoResize:y,scrollW:0};I._lastLayoutRect={};return E},layoutRect:function(t){var z=this,v=z._layoutRect,y,A,x,w,s,u;if(!v){v=z.initLayoutRect()}if(t){x=v.deltaW;w=v.deltaH;if(t.x!==s){v.x=t.x}if(t.y!==s){v.y=t.y}if(t.minW!==s){v.minW=t.minW}if(t.minH!==s){v.minH=t.minH}A=t.w;if(A!==s){A=A<v.minW?v.minW:A;A=A>v.maxW?v.maxW:A;v.w=A;v.innerW=A-x}A=t.h;if(A!==s){A=A<v.minH?v.minH:A;A=A>v.maxH?v.maxH:A;v.h=A;v.innerH=A-w}A=t.innerW;if(A!==s){A=A<v.minW-x?v.minW-x:A;A=A>v.maxW-x?v.maxW-x:A;v.innerW=A;v.w=A+x}A=t.innerH;if(A!==s){A=A<v.minH-w?v.minH-w:A;A=A>v.maxH-w?v.maxH-w:A;v.innerH=A;v.h=A+w}if(t.contentW!==s){v.contentW=t.contentW}if(t.contentH!==s){v.contentH=t.contentH}y=z._lastLayoutRect;if(y.x!==v.x||y.y!==v.y||y.w!==v.w||y.h!==v.h){u=l.repaintControls;if(u){if(u.map&&!u.map[z._id]){u.push(z);u.map[z._id]=true}}y.x=v.x;y.y=v.y;y.w=v.w;y.h=v.h}return z}return v},repaint:function(){var u=this,w,t,x,z,v=0,y=0,s;w=u.getEl().style;x=u._layoutRect;s=u._lastRepaintRect||{};z=u._borderBox;v=z.left+z.right;y=z.top+z.bottom;if(x.x!==s.x){w.left=x.x+"px";s.x=x.x}if(x.y!==s.y){w.top=x.y+"px";s.y=x.y}if(x.w!==s.w){w.width=(x.w-v)+"px";s.w=x.w}if(x.h!==s.h){w.height=(x.h-y)+"px";s.h=x.h}if(u._hasBody&&x.innerW!==s.innerW){t=u.getEl("body").style;t.width=(x.innerW)+"px";s.innerW=x.innerW}if(u._hasBody&&x.innerH!==s.innerH){t=t||u.getEl("body").style;t.height=(x.innerH)+"px";s.innerH=x.innerH}u._lastRepaintRect=s;u.fire("repaint",{},false)},on:function(v,z){var u=this,y,t,x,w;function s(A){var C,B;return function(D){if(!C){u.parents().each(function(F){var E=F.settings.callbacks;if(E&&(C=E[A])){B=F;return false}})}return C.call(B,D)}}if(z){if(typeof(z)=="string"){z=s(z)}x=v.toLowerCase().split(" ");w=x.length;while(w--){v=x[w];y=u._bindings;if(!y){y=u._bindings={}}t=y[v];if(!t){t=y[v]=[]}t.push(z);if(q[v]){if(!u._nativeEvents){u._nativeEvents={name:true}}else{u._nativeEvents[v]=true}if(u._rendered){u.bindPendingEvents()}}}}return u},off:function(s,z){var A=this,x,t=A._bindings,w,u,y,v;if(t){if(s){y=s.toLowerCase().split(" ");x=y.length;while(x--){s=y[x];w=t[s];if(!s){for(u in t){t[u].length=0}return A}if(w){if(!z){w.length=0}else{v=w.length;while(v--){if(w[v]===z){w.splice(v,1)}}}}}}else{A._bindings=[]}}return A},fire:function(s,z,A){var B=this,y,w,u,v;s=s.toLowerCase();function t(){return false}function x(){return true}z=z||{};if(!z.type){z.type=s}if(!z.control){z.control=B}if(!z.preventDefault){z.preventDefault=function(){z.isDefaultPrevented=x};z.stopPropagation=function(){z.isPropagationStopped=x};z.stopImmediatePropagation=function(){z.isImmediatePropagationStopped=x};z.isDefaultPrevented=t;z.isPropagationStopped=t;z.isImmediatePropagationStopped=t}if(B._bindings){u=B._bindings[s];if(u){for(y=0,w=u.length;y<w;y++){if(!z.isImmediatePropagationStopped()&&u[y].call(B,z)===false){break}}}}if(A!==false){v=B.parent();while(v&&!z.isPropagationStopped()){v.fire(s,z,false);v=v.parent()}}return z},hasEventListeners:function(s){return s in this._bindings},parents:function(s){var u=this,t=new p();for(u=u.parent();u;u=u.parent()){t.add(u)}if(s){t=t.filter(s)}return t},next:function(){var s=this.parent().items();return s[s.indexOf(this)+1]},prev:function(){var s=this.parent().items();return s[s.indexOf(this)-1]},findCommonAncestor:function(s,u){var t;while(s){t=u;while(t&&s!=t){t=t.parent()}if(s==t){break}s=s.parent()}return s},hasClass:function(s,u){var t=this._classes[u||"control"];s=this.classPrefix+s;return t&&!!t.map[s]},addClass:function(s,v){var t=this,u,w;s=this.classPrefix+s;u=t._classes[v||"control"];if(!u){u=[];u.map={};t._classes[v||"control"]=u}if(!u.map[s]){u.map[s]=s;u.push(s);if(t._rendered){w=t.getEl(v);if(w){w.className=u.join(" ")}}}return t},removeClass:function(s,w){var t=this,v,u,x;s=this.classPrefix+s;v=t._classes[w||"control"];if(v&&v.map[s]){delete v.map[s];u=v.length;while(u--){if(v[u]===s){v.splice(u,1)}}}if(t._rendered){x=t.getEl(w);if(x){x.className=v.join(" ")}}return t},toggleClass:function(s,u,v){var t=this;if(u){t.addClass(s,v)}else{t.removeClass(s,v)}return t},classes:function(t){var s=this._classes[t||"control"];return s?s.join(" "):""},innerHtml:function(s){j.innerHtml(this.getEl(),s);return this},getEl:function(t,s){var v,u=t?this._id+"-"+t:this._id;v=r[u]=(s===true?null:r[u])||j.get(u);return v},visible:function(u){var t=this,s;if(typeof(u)!=="undefined"){if(t._visible!==u){if(t._rendered){t.getEl().style.display=u?"":"none"}t._visible=u;s=t.parent();if(s){s._lastRect=null}t.fire(u?"show":"hide")}return t}return t._visible},show:function(){return this.visible(true)},hide:function(){return this.visible(false)},focus:function(){try{this.getEl().focus()}catch(s){}return this},blur:function(){this.getEl().blur();return this},aria:function(t,u){var s=this,v=s.getEl();if(typeof(u)==="undefined"){return s._aria[t]}else{s._aria[t]=u}if(s._rendered){if(t=="label"){v.setAttribute("aria-labeledby",s._id)}v.setAttribute(t=="role"?t:"aria-"+t,u)}return s},encode:function(t,s){if(s!==false&&l.translate){t=l.translate(t)}return(t||"").replace(/[&<>"]/g,function(u){return"&#"+u.charCodeAt(0)+";"})},before:function(t){var s=this,u=s.parent();if(u){u.insert(t,u.items().indexOf(s),true)}return s},after:function(t){var s=this,u=s.parent();if(u){u.insert(t,u.items().indexOf(s))}return s},remove:function(){var u=this,y=u.getEl(),x=u.parent(),v,w;if(u.items){var t=u.items().toArray();w=t.length;while(w--){t[w].remove()}}if(x&&x.items){v=[];x.items().each(function(z){if(z!==u){v.push(z)}});x.items().set(v);x._lastRect=null}if(u._eventsRoot&&u._eventsRoot==u){j.off(y)}delete l.controlIdLookup[u._id];delete r[u._id];if(y&&y.parentNode){var s=y.getElementsByTagName("*");w=s.length;while(w--){delete r[s[w].id]}y.parentNode.removeChild(y)}return u},renderBefore:function(t){var s=this;t.parentNode.insertBefore(j.createFragment(s.renderHtml()),t);s.postRender();return s},renderTo:function(t){var s=this;t=t||s.getContainerElm();t.appendChild(j.createFragment(s.renderHtml()));s.postRender();return s},postRender:function(){var t=this,x=t.settings,z,y,w,u,s;for(u in x){if(u.indexOf("on")===0){t.on(u.substr(2),x[u])}}if(t._eventsRoot){for(w=t.parent();!s&&w;w=w.parent()){s=w._eventsRoot}if(s){for(u in s._nativeEvents){t._nativeEvents[u]=true}}}t.bindPendingEvents();if(x.style){z=t.getEl();if(z){z.setAttribute("style",x.style);z.style.cssText=x.style}}if(!t._visible){j.css(t.getEl(),"display","none")}if(t.settings.border){y=t.borderBox();j.css(t.getEl(),{"border-top-width":y.top,"border-right-width":y.right,"border-bottom-width":y.bottom,"border-left-width":y.left})}l.controlIdLookup[t._id]=t;for(var v in t._aria){t.aria(v,t._aria[v])}t.fire("postrender",{},false)},scrollIntoView:function(u){function E(J,H){var F,I,G=J;F=I=0;while(G&&G!=H&&G.nodeType){F+=G.offsetLeft||0;I+=G.offsetTop||0;G=G.offsetParent}return{x:F,y:I}}var w=this.getEl(),v=w.parentNode;var B,A,s,D,C,t;var z=E(w,v);B=z.x;A=z.y;s=w.offsetWidth;D=w.offsetHeight;C=v.clientWidth;t=v.clientHeight;if(u=="end"){B-=C-s;A-=t-D}else{if(u=="center"){B-=(C/2)-(s/2);A-=(t/2)-(D/2)}}v.scrollLeft=B;v.scrollTop=A;return this},bindPendingEvents:function(){var C=this,x,v,A,u,y,t;function z(E){var D=C.getParentCtrl(E.target);if(D){D.fire(E.type,E)}}function w(){var D=u._lastHoverCtrl;if(D){D.fire("mouseleave",{target:D.getEl()});D.parents().each(function(E){E.fire("mouseleave",{target:E.getEl()})});u._lastHoverCtrl=null}}function B(I){var H=C.getParentCtrl(I.target),G=u._lastHoverCtrl,D=0,F,E,J;if(H!==G){u._lastHoverCtrl=H;E=H.parents().toArray().reverse();E.push(H);if(G){J=G.parents().toArray().reverse();J.push(G);for(D=0;D<J.length;D++){if(E[D]!==J[D]){break}}for(F=J.length-1;F>=D;F--){G=J[F];G.fire("mouseleave",{target:G.getEl()})}}for(F=D;F<E.length;F++){H=E[F];H.fire("mouseenter",{target:H.getEl()})}}}function s(D){D.preventDefault();if(D.type=="mousewheel"){D.deltaY=-1/40*D.wheelDelta;if(D.wheelDeltaX){D.deltaX=-1/40*D.wheelDeltaX}}else{D.deltaX=0;D.deltaY=D.detail}D=C.fire("wheel",D)}C._rendered=true;y=C._nativeEvents;if(y){A=C.parents().toArray();A.unshift(C);for(x=0,v=A.length;!u&&x<v;x++){u=A[x]._eventsRoot}if(!u){u=A[A.length-1]||C}C._eventsRoot=u;for(v=x,x=0;x<v;x++){A[x]._eventsRoot=u}for(t in y){if(!y){return false}if(t==="wheel"&&!n){if(m){j.on(C.getEl(),"mousewheel",s)}else{j.on(C.getEl(),"DOMMouseScroll",s)}continue}if(t==="mouseenter"||t==="mouseleave"){if(!u._hasMouseEnter){j.on(u.getEl(),"mouseleave",w);j.on(u.getEl(),"mouseover",B);u._hasMouseEnter=1}}else{if(!u[t]){j.on(u.getEl(),t,z);u[t]=true}}y[t]=false}}},reflow:function(){this.repaint();return this}});return l});h("tinymce/ui/Factory",[],function(){var j={},k;return{add:function(l,m){j[l.toLowerCase()]=m},has:function(l){return !!j[l.toLowerCase()]},create:function(p,o){var l,m,n;if(!k){n=tinymce.ui;for(m in n){j[m.toLowerCase()]=n[m]}k=true}if(typeof(p)=="string"){o=o||{};o.type=p}else{o=p;p=o.type}p=p.toLowerCase();l=j[p];if(!l){throw new Error("Could not find control by type: "+p)}l=new l(o);l.type=p;return l}}});h("tinymce/ui/Container",["tinymce/ui/Control","tinymce/ui/Collection","tinymce/ui/Selector","tinymce/ui/Factory","tinymce/util/Tools","tinymce/ui/DomUtils"],function(p,o,l,j,n,k){var m={};return p.extend({layout:"",innerClass:"container-inner",init:function(r){var q=this;q._super(r);r=q.settings;q._fixed=r.fixed;q._items=new o();if(q.isRtl()){q.addClass("rtl")}q.addClass("container");q.addClass("container-body","body");if(r.containerCls){q.addClass(r.containerCls)}q._layout=j.create((r.layout||q.layout)+"layout");if(q.settings.items){q.add(q.settings.items)}q._hasBody=true},items:function(){return this._items},find:function(q){q=m[q]=m[q]||new l(q);return q.find(this)},add:function(r){var q=this;q.items().add(q.create(r)).parent(q);return q},focus:function(){var q=this;if(q.keyNav){q.keyNav.focusFirst()}else{q._super()}return q},replace:function(u,t){var s,q=this.items(),r=q.length;while(r--){if(q[r]===u){q[r]=t;break}}if(r>=0){s=t.getEl();if(s){s.parentNode.removeChild(s)}s=u.getEl();if(s){s.parentNode.removeChild(s)}}t.parent(this)},create:function(r){var q=this,t,s=[];if(!n.isArray(r)){r=[r]}n.each(r,function(u){if(u){if(!(u instanceof p)){if(typeof(u)=="string"){u={type:u}}t=n.extend({},q.settings.defaults,u);u.type=t.type=t.type||u.type||q.settings.defaultType||(t.defaults?t.defaults.type:null);u=j.create(t)}s.push(u)}});return s},renderNew:function(){var q=this;q.items().each(function(t,s){var u,r;t.parent(q);if(!t._rendered){u=q.getEl("body");r=k.createFragment(t.renderHtml());if(u.hasChildNodes()&&s<=u.childNodes.length-1){u.insertBefore(r,u.childNodes[s])}else{u.appendChild(r)}t.postRender()}});q._layout.applyClasses(q);q._lastRect=null;return q},append:function(q){return this.add(q).renderNew()},prepend:function(r){var q=this;q.items().set(q.create(r).concat(q.items().toArray()));return q.renderNew()},insert:function(s,u,w){var r=this,t,q,v;s=r.create(s);t=r.items();if(!w&&u<t.length-1){u+=1}if(u>=0&&u<t.length){q=t.slice(0,u).toArray();v=t.slice(u).toArray();t.set(q.concat(s,v))}return r.renderNew()},fromJSON:function(s){var q=this;for(var r in s){q.find("#"+r).value(s[r])}return q},toJSON:function(){var q=this,r={};q.find("*").each(function(u){var s=u.name(),t=u.value();if(s&&typeof(t)!="undefined"){r[s]=t}});return r},preRender:function(){},renderHtml:function(){var q=this,r=q._layout;q.preRender();r.preRender(q);return('<div id="'+q._id+'" class="'+q.classes()+'" role="'+this.settings.role+'"><div id="'+q._id+'-body" class="'+q.classes("body")+'">'+(q.settings.html||"")+r.renderHtml(q)+"</div></div>")},postRender:function(){var q=this,r;q.items().exec("postRender");q._super();q._layout.postRender(q);q._rendered=true;if(q.settings.style){k.css(q.getEl(),q.settings.style)}if(q.settings.border){r=q.borderBox();k.css(q.getEl(),{"border-top-width":r.top,"border-right-width":r.right,"border-bottom-width":r.bottom,"border-left-width":r.left})}return q},initLayoutRect:function(){var q=this,r=q._super();q._layout.recalc(q);return r},recalc:function(){var q=this,s=q._layoutRect,r=q._lastRect;if(!r||r.w!=s.w||r.h!=s.h){q._layout.recalc(q);s=q.layoutRect();q._lastRect={x:s.x,y:s.y,w:s.w,h:s.h};return true}},reflow:function(){var r,q;if(this.visible()){p.repaintControls=[];p.repaintControls.map={};q=this.recalc();r=p.repaintControls.length;while(r--){p.repaintControls[r].repaint()}if(this.settings.layout!=="flow"&&this.settings.layout!=="stack"){this.repaint()}p.repaintControls=[]}return this}})});h("tinymce/ui/DragHelper",["tinymce/ui/DomUtils"],function(j){function k(){var s=document,t,o,m,r;var p,u,n,l,q=Math.max;t=s.documentElement;o=s.body;m=q(t.scrollWidth,o.scrollWidth);r=q(t.clientWidth,o.clientWidth);p=q(t.offsetWidth,o.offsetWidth);u=q(t.scrollHeight,o.scrollHeight);n=q(t.clientHeight,o.clientHeight);l=q(t.offsetHeight,o.offsetHeight);return{width:m<p?r:m,height:u<l?n:u}}return function(m,o){var v,u=document,l,n,t,r,q,p;o=o||{};function s(){return u.getElementById(o.handle||m)}n=function(x){var z=k(),w,y;x.preventDefault();l=x.button;w=s();q=x.screenX;p=x.screenY;if(window.getComputedStyle){y=window.getComputedStyle(w,null).getPropertyValue("cursor")}else{y=w.runtimeStyle.cursor}v=u.createElement("div");j.css(v,{position:"absolute",top:0,left:0,width:z.width,height:z.height,zIndex:2147483647,opacity:0.0001,background:"red",cursor:y});u.body.appendChild(v);j.on(u,"mousemove",r);j.on(u,"mouseup",t);o.start(x)};r=function(w){if(w.button!==l){return t(w)}w.deltaX=w.screenX-q;w.deltaY=w.screenY-p;w.preventDefault();o.drag(w)};t=function(w){j.off(u,"mousemove",r);j.off(u,"mouseup",t);v.parentNode.removeChild(v);if(o.stop){o.stop(w)}};this.destroy=function(){j.off(s())};j.on(s(),"mousedown",n)}});h("tinymce/ui/Scrollable",["tinymce/ui/DomUtils","tinymce/ui/DragHelper"],function(j,k){return{init:function(){var l=this;l.on("repaint",l.renderScroll)},renderScroll:function(){var m=this,n=2;function o(){var s,r,q;function p(x,w,z,F,E,v){var y,C,B;var u,t,A,D;var G,H;C=m.getEl("scroll"+x);if(C){G=w.toLowerCase();H=z.toLowerCase();if(m.getEl("absend")){j.css(m.getEl("absend"),G,m.layoutRect()[F]-1)}if(!E){j.css(C,"display","none");return}j.css(C,"display","block");y=m.getEl("body");B=m.getEl("scroll"+x+"t");u=y["client"+z]-(n*2);u-=s&&r?C["client"+v]:0;t=y["scroll"+z];A=u/t;D={};D[G]=y["offset"+w]+n;D[H]=u;j.css(C,D);D={};D[G]=y["scroll"+w]*A;D[H]=u*A;j.css(B,D)}}q=m.getEl("body");s=q.scrollWidth>q.clientWidth;r=q.scrollHeight>q.clientHeight;p("h","Left","Width","contentW",s,"Height");p("v","Top","Height","contentH",r,"Width")}function l(){function p(w,s,q,x,u){var v,r=m._id+"-scroll"+w,t=m.classPrefix;m.getEl().appendChild(j.createFragment('<div id="'+r+'" class="'+t+"scrollbar "+t+"scrollbar-"+w+'"><div id="'+r+'t" class="'+t+'scrollbar-thumb"></div></div>'));m.draghelper=new k(r+"t",{start:function(){v=m.getEl("body")["scroll"+s];j.addClass(j.get(r),t+"active")},drag:function(B){var y,D,A,C,z=m.layoutRect();D=z.contentW>z.innerW;A=z.contentH>z.innerH;C=m.getEl("body")["client"+q]-(n*2);C-=D&&A?m.getEl("scroll"+w)["client"+u]:0;y=C/m.getEl("body")["scroll"+q];m.getEl("body")["scroll"+s]=v+(B["delta"+x]/y)},stop:function(){j.removeClass(j.get(r),t+"active")}})}m.addClass("scroll");p("v","Top","Height","Y","Width");p("h","Left","Width","X","Height")}if(m.settings.autoScroll){if(!m._hasScroll){m._hasScroll=true;l();m.on("wheel",function(q){var p=m.getEl("body");p.scrollLeft+=(q.deltaX||0)*10;p.scrollTop+=q.deltaY*10;o()});j.on(m.getEl("body"),"scroll",o)}o()}}}});h("tinymce/ui/Panel",["tinymce/ui/Container","tinymce/ui/Scrollable"],function(k,j){return k.extend({Defaults:{layout:"fit",containerCls:"panel"},Mixins:[j],renderHtml:function(){var m=this,n=m._layout,l=m.settings.html;m.preRender();n.preRender(m);if(typeof(l)=="undefined"){l=('<div id="'+m._id+'-body" class="'+m.classes("body")+'">'+n.renderHtml(m)+"</div>")}else{if(typeof(l)=="function"){l=l.call(m)}m._hasBody=false}return('<div id="'+m._id+'" class="'+m.classes()+'" hideFocus="1" tabIndex="-1">'+(m._preBodyHtml||"")+l+"</div>")}})});h("tinymce/ui/Movable",["tinymce/ui/DomUtils"],function(j){function k(l,t,w){var v,p,s,q,u,n,r,m,o,z;o=j.getViewPort();p=j.getPos(t);s=p.x;q=p.y;if(l._fixed){s-=o.x;q-=o.y}v=l.getEl();z=j.getSize(v);u=z.width;n=z.height;z=j.getSize(t);r=z.width;m=z.height;w=(w||"").split("");if(w[0]==="b"){q+=m}if(w[1]==="r"){s+=r}if(w[0]==="c"){q+=Math.round(m/2)}if(w[1]==="c"){s+=Math.round(r/2)}if(w[3]==="b"){q-=n}if(w[4]==="r"){s-=u}if(w[3]==="c"){q-=Math.round(n/2)}if(w[4]==="c"){s-=Math.round(u/2)}return{x:s,y:q,w:u,h:n}}return{testMoveRel:function(p,m){var l=j.getViewPort();for(var n=0;n<m.length;n++){var o=k(this,p,m[n]);if(this._fixed){if(o.x>0&&o.x+o.w<l.w&&o.y>0&&o.y+o.h<l.h){return m[n]}}else{if(o.x>l.x&&o.x+o.w<l.w+l.x&&o.y>l.y&&o.y+o.h<l.h+l.y){return m[n]}}}return m[0]},moveRel:function(n,l){if(typeof(l)!="string"){l=this.testMoveRel(n,l)}var m=k(this,n,l);return this.moveTo(m.x,m.y)},moveBy:function(n,l){var m=this,o=m.layoutRect();m.moveTo(o.x+n,o.y+l);return m},moveTo:function(l,q){var n=this;function m(t,r,s){if(t<0){return 0}if(t+s>r){t=r-s;return t<0?0:t}return t}if(n.settings.constrainToViewport){var o=j.getViewPort(window);var p=n.layoutRect();l=m(l,o.w+o.x,p.w);q=m(q,o.h+o.y,p.h)}if(n._rendered){n.layoutRect({x:l,y:q}).repaint()}else{n.settings.x=l;n.settings.y=q}n.fire("move",{x:l,y:q});return n}}});h("tinymce/ui/Resizable",["tinymce/ui/DomUtils"],function(j){return{resizeToContent:function(){this._layoutRect.autoResize=true;this._lastRect=null;this.reflow()},resizeTo:function(k,l){if(k<=1||l<=1){var m=j.getWindowSize();k=k<=1?k*m.w:k;l=l<=1?l*m.h:l}this._layoutRect.autoResize=false;return this.layoutRect({minW:k,minH:l,w:k,h:l}).reflow()},resizeBy:function(l,n){var k=this,m=k.layoutRect();return k.resizeTo(m.w+l,m.h+n)}}});h("tinymce/ui/FloatPanel",["tinymce/ui/Panel","tinymce/ui/Movable","tinymce/ui/Resizable","tinymce/ui/DomUtils"],function(r,q,k,j){var n,l,s=[];var m=[],t;var o=r.extend({Mixins:[q,k],init:function(x){var v=this;function w(){var z,C=o.zIndex||65535,A;if(m.length){for(z=0;z<m.length;z++){if(m[z].modal){C++;A=m[z]}m[z].getEl().style.zIndex=C;m[z].zIndex=C;C++}}var B=document.getElementById(v.classPrefix+"modal-block");if(A){j.css(B,"z-index",A.zIndex-1)}else{if(B){B.parentNode.removeChild(B);t=false}}o.currentZIndex=C}function u(A,z){while(A){if(A==z){return true}A=A.parent()}}function y(z){var A=j.getViewPort().y;function B(F,C){var E;for(var D=0;D<s.length;D++){if(s[D]!=z){E=s[D].parent();while(E&&(E=E.parent())){if(E==z){s[D].fixed(F).moveBy(0,C).repaint()}}}}}if(z.settings.autofix){if(!z._fixed){z._autoFixY=z.layoutRect().y;if(z._autoFixY<A){z.fixed(true).layoutRect({y:0}).repaint();B(true,A-z._autoFixY)}}else{if(z._autoFixY>A){z.fixed(false).layoutRect({y:z._autoFixY}).repaint();B(false,z._autoFixY-A)}}}}v._super(x);v._eventsRoot=v;v.addClass("floatpanel");if(x.autohide){if(!n){n=function(C){var B,A=v.getParentCtrl(C.target);B=s.length;while(B--){var z=s[B];if(z.settings.autohide){if(A){if(u(A,z)||z.parent()===A){continue}}C=z.fire("autohide",{target:C.target});if(!C.isDefaultPrevented()){z.hide()}}}};j.on(document,"click",n)}s.push(v)}if(x.autofix){if(!l){l=function(){var z;z=s.length;while(z--){y(s[z])}};j.on(window,"scroll",l)}v.on("move",function(){y(this)})}v.on("postrender show",function(B){if(B.control==v){var A,z=v.classPrefix;if(v.modal&&!t){A=j.createFragment('<div id="'+z+'modal-block" class="'+z+"reset "+z+'fade"></div>');A=A.firstChild;v.getContainerElm().appendChild(A);setTimeout(function(){j.addClass(A,z+"in");j.addClass(v.getEl(),z+"in")},0);t=true}m.push(v);w()}});v.on("close hide",function(A){if(A.control==v){var z=m.length;while(z--){if(m[z]===v){m.splice(z,1)}}w()}});v.on("show",function(){v.parents().each(function(z){if(z._fixed){v.fixed(true);return false}})});if(x.popover){v._preBodyHtml='<div class="'+v.classPrefix+'arrow"></div>';v.addClass("popover").addClass("bottom").addClass(v.isRtl()?"end":"start")}},fixed:function(w){var v=this;if(v._fixed!=w){if(v._rendered){var u=j.getViewPort();if(w){v.layoutRect().y-=u.y}else{v.layoutRect().y+=u.y}}v.toggleClass("fixed",w);v._fixed=w}return v},show:function(){var u=this,v,w=u._super();v=s.length;while(v--){if(s[v]===u){break}}if(v===-1){s.push(u)}return w},hide:function(){p(this);return this._super()},hideAll:function(){o.hideAll()},close:function(){var u=this;u.fire("close");return u.remove()},remove:function(){p(this);this._super()}});o.hideAll=function(){var v=s.length;while(v--){var u=s[v];if(u.settings.autohide){u.fire("cancel",{},false);u.hide();s.splice(v,1)}}};function p(u){var v;v=s.length;while(v--){if(s[v]===u){s.splice(v,1)}}v=m.length;while(v--){if(m[v]===u){m.splice(v,1)}}}return o});h("tinymce/ui/KeyboardNavigation",["tinymce/ui/DomUtils"],function(j){return function(n){var v=n.root,w=n.enableUpDown!==false;var r=n.enableLeftRight!==false;var u=n.items,s;function t(){if(!u){u=[];if(v.find){v.find("*").each(function(B){if(B.canFocus){u.push(B.getEl())}})}else{var A=v.getEl().getElementsByTagName("*");for(var z=0;z<A.length;z++){if(A[z].id&&A[z]){u.push(A[z])}}}}}function q(){return document.getElementById(s)}function p(z){z=z||q();return z&&z.getAttribute("role")}function m(B){var A,z=B||q();while((z=z.parentNode)){if((A=p(z))){return A}}}function l(z){var A=document.getElementById(s);if(A){return A.getAttribute("aria-"+z)}}function o(){var z=q();if(z&&(z.nodeName=="TEXTAREA"||z.type=="text")){return}if(n.onAction){n.onAction(s)}else{j.fire(q(),"click",{keyboard:true})}return true}function x(){var z;if(n.onCancel){if((z=q())){z.blur()}n.onCancel()}else{n.root.fire("cancel")}}function y(D){var B=-1,C,E;var A=[];function z(G){var F=v?v.getEl():document.body;while(G&&G!=F){if(G.style.display=="none"){return false}G=G.parentNode}return true}t();E=A.length;for(E=0;E<u.length;E++){if(z(u[E])){A.push(u[E])}}E=A.length;while(E--){if(A[E].id===s){B=E;break}}B+=D;if(B<0){B=A.length-1}else{if(B>=A.length){B=0}}C=A[B];C.focus();s=C.id;if(n.actOnFocus){o()}}function k(){var z,A;A=p(n.root.getEl());t();z=u.length;while(z--){if(A=="toolbar"&&u[z].id===s){u[z].focus();return}}u[0].focus()}v.on("keydown",function(G){var D=37,C=39,I=38,J=40;var z=27,B=14,A=13,E=32,H=9;var F;switch(G.keyCode){case D:if(r){if(n.leftAction){n.leftAction()}else{y(-1)}F=true}break;case C:if(r){if(p()=="menuitem"&&m()=="menu"){if(l("haspopup")){o()}}else{y(1)}F=true}break;case I:if(w){y(-1);F=true}break;case J:if(w){if(p()=="menuitem"&&m()=="menubar"){o()}else{if(p()=="button"&&l("haspopup")){o()}else{y(1)}}F=true}break;case H:F=true;if(G.shiftKey){y(-1)}else{y(1)}break;case z:F=true;x();break;case B:case A:case E:F=o();break}if(F){G.stopPropagation();G.preventDefault()}});v.on("focusin",function(z){t();s=z.target.id});return{moveFocus:y,focusFirst:k,cancel:x}}});h("tinymce/ui/Window",["tinymce/ui/FloatPanel","tinymce/ui/Panel","tinymce/ui/DomUtils","tinymce/ui/KeyboardNavigation","tinymce/ui/DragHelper"],function(o,n,j,k,m){var l=o.extend({modal:true,Defaults:{border:1,layout:"flex",containerCls:"panel",role:"dialog",callbacks:{submit:function(){this.fire("submit",{data:this.toJSON()})},close:function(){this.close()}}},init:function(q){var p=this;p._super(q);if(p.isRtl()){p.addClass("rtl")}p.addClass("window");p._fixed=true;if(q.buttons){p.statusbar=new n({layout:"flex",border:"1 0 0 0",spacing:3,padding:10,align:"center",pack:p.isRtl()?"start":"end",defaults:{type:"button"},items:q.buttons});p.statusbar.addClass("foot");p.statusbar.parent(p)}p.on("click",function(r){if(r.target.className.indexOf(p.classPrefix+"close")!=-1){p.close()}});p.aria("label",q.title);p._fullscreen=false},recalc:function(){var p=this,s=p.statusbar,r,q,t;if(p._fullscreen){p.layoutRect(j.getWindowSize());p.layoutRect().contentH=p.layoutRect().innerH}p._super();r=p.layoutRect();if(p.settings.title&&!p._fullscreen){q=r.headerW;if(q>r.w){p.layoutRect({w:q});t=true}}if(s){s.layoutRect({w:p.layoutRect().innerW}).recalc();q=s.layoutRect().minW+r.deltaW;if(q>r.w){p.layoutRect({w:q});t=true}}if(t){p.recalc()}},initLayoutRect:function(){var p=this,t=p._super(),s=0,u;if(p.settings.title&&!p._fullscreen){u=p.getEl("head");var q=j.getSize(u);t.headerW=q.width;t.headerH=q.height;s+=t.headerH}if(p.statusbar){s+=p.statusbar.layoutRect().h}t.deltaH+=s;t.minH+=s;t.h+=s;var r=j.getWindowSize();t.x=Math.max(0,r.w/2-t.w/2);t.y=Math.max(0,r.h/2-t.h/2);return t},renderHtml:function(){var q=this,t=q._layout,w=q._id,u=q.classPrefix;var s=q.settings,p="",v="",r=s.html;q.preRender();t.preRender(q);if(s.title){p=('<div id="'+w+'-head" class="'+u+'window-head"><div class="'+u+'title">'+q.encode(s.title)+'</div><button type="button" class="'+u+'close" aria-hidden="true">&times;</button><div id="'+w+'-dragh" class="'+u+'dragh"></div></div>')}if(s.url){r='<iframe src="'+s.url+'" tabindex="-1"></iframe>'}if(typeof(r)=="undefined"){r=t.renderHtml(q)}if(q.statusbar){v=q.statusbar.renderHtml()}return('<div id="'+w+'" class="'+q.classes()+'" hideFocus="1" tabIndex="-1">'+p+'<div id="'+w+'-body" class="'+q.classes("body")+'">'+r+"</div>"+v+"</div>")},fullscreen:function(v){var p=this,u=document.documentElement,q,t=p.classPrefix,s;if(v!=p._fullscreen){j.on(window,"resize",function(){var x;if(p._fullscreen){if(!q){x=new Date().getTime();var w=j.getWindowSize();p.moveTo(0,0).resizeTo(w.w,w.h);if((new Date().getTime())-x>50){q=true}}else{if(!p._timer){p._timer=setTimeout(function(){var y=j.getWindowSize();p.moveTo(0,0).resizeTo(y.w,y.h);p._timer=0},50)}}}});s=p.layoutRect();p._fullscreen=v;if(!v){p._borderBox=p.parseBox(p.settings.border);p.getEl("head").style.display="";s.deltaH+=s.headerH;j.removeClass(u,t+"fullscreen");j.removeClass(document.body,t+"fullscreen");p.removeClass("fullscreen");p.moveTo(p._initial.x,p._initial.y).resizeTo(p._initial.w,p._initial.h)}else{p._initial={x:s.x,y:s.y,w:s.w,h:s.h};p._borderBox=p.parseBox("0");p.getEl("head").style.display="none";s.deltaH-=s.headerH+2;j.addClass(u,t+"fullscreen");j.addClass(document.body,t+"fullscreen");p.addClass("fullscreen");var r=j.getWindowSize();p.moveTo(0,0).resizeTo(r.w,r.h)}}return p.reflow()},postRender:function(){var q=this,p=[],t,s,r;setTimeout(function(){q.addClass("in")},0);q.keyboardNavigation=new k({root:q,enableLeftRight:false,enableUpDown:false,items:p,onCancel:function(){q.close()}});q.find("*").each(function(u){if(u.canFocus){s=s||u.settings.autofocus;t=t||u;if(u.type=="filepicker"){p.push(u.getEl("inp"));if(u.getEl("open")){p.push(u.getEl("open"))}}else{p.push(u.getEl())}}});if(q.statusbar){q.statusbar.find("*").each(function(u){if(u.canFocus){s=s||u.settings.autofocus;t=t||u;p.push(u.getEl())}})}q._super();if(q.statusbar){q.statusbar.postRender()}if(!s&&t){t.focus()}this.dragHelper=new m(q._id+"-dragh",{start:function(){r={x:q.layoutRect().x,y:q.layoutRect().y}},drag:function(u){q.moveTo(r.x+u.deltaX,r.y+u.deltaY)}});q.on("submit",function(u){if(!u.isDefaultPrevented()){q.close()}})},submit:function(){return this.fire("submit",{data:this.toJSON()})},remove:function(){var p=this;p.dragHelper.destroy();p._super();if(p.statusbar){this.statusbar.remove()}}});return l});h("tinymce/ui/MessageBox",["tinymce/ui/Window"],function(k){var j=k.extend({init:function(l){l={border:1,padding:20,layout:"flex",pack:"center",align:"center",containerCls:"panel",autoScroll:true,buttons:{type:"button",text:"Ok",action:"ok"},items:{type:"label",multiline:true,maxWidth:500,maxHeight:200}};this._super(l)},Statics:{OK:1,OK_CANCEL:2,YES_NO:3,YES_NO_CANCEL:4,msgBox:function(l){var m,n=l.callback||function(){};switch(l.buttons){case j.OK_CANCEL:m=[{type:"button",text:"Ok",subtype:"primary",onClick:function(o){o.control.parents()[1].close();n(true)}},{type:"button",text:"Cancel",onClick:function(o){o.control.parents()[1].close();n(false)}}];break;case j.YES_NO:m=[{type:"button",text:"Ok",subtype:"primary",onClick:function(o){o.control.parents()[1].close();n(true)}}];break;case j.YES_NO_CANCEL:m=[{type:"button",text:"Ok",subtype:"primary",onClick:function(o){o.control.parents()[1].close()}}];break;default:m=[{type:"button",text:"Ok",subtype:"primary",onClick:function(o){o.control.parents()[1].close();n(true)}}];break}return new k({padding:20,x:l.x,y:l.y,minWidth:300,minHeight:100,layout:"flex",pack:"center",align:"center",buttons:m,title:l.title,items:{type:"label",multiline:true,maxWidth:500,maxHeight:200,text:l.text},onClose:l.onClose}).renderTo(document.body).reflow()},alert:function(l,m){if(typeof(l)=="string"){l={text:l}}l.callback=m;return j.msgBox(l)},confirm:function(l,m){if(typeof(l)=="string"){l={text:l}}l.callback=m;l.buttons=j.OK_CANCEL;return j.msgBox(l)}}});return j});h("tinymce/WindowManager",["tinymce/ui/Window","tinymce/ui/MessageBox"],function(k,j){return function(n){var m=this,o=[];function l(){if(o.length){return o[o.length-1]}}m.windows=o;m.open=function(p,r){var q;n.editorManager.activeEditor=n;p.title=p.title||" ";p.url=p.url||p.file;if(p.url){p.width=parseInt(p.width||320,10);p.height=parseInt(p.height||240,10)}if(p.body){p.items={defaults:p.defaults,type:p.bodyType||"form",items:p.body}}if(!p.url&&!p.buttons){p.buttons=[{text:"Ok",subtype:"primary",onclick:function(){q.find("form")[0].submit();q.close()}},{text:"Cancel",onclick:function(){q.close()}}]}q=new k(p);o.push(q);q.on("close",function(){var s=o.length;while(s--){if(o[s]===q){o.splice(s,1)}}n.focus()});if(p.data){q.on("postRender",function(){this.find("*").each(function(t){var s=t.name();if(s in p.data){t.value(p.data[s])}})})}q.features=p||{};q.params=r||{};n.nodeChanged();return q.renderTo(document.body).reflow()};m.alert=function(q,r,p){j.alert(q,function(){if(r){r.call(p||this)}})};m.confirm=function(q,r,p){j.confirm(q,function(s){r.call(p||this,s)})};m.close=function(){if(l()){l().close()}};m.getParams=function(){return l()?l().params:null};m.setParams=function(p){if(l()){l().params=p}}}});h("tinymce/util/Quirks",["tinymce/util/VK","tinymce/dom/RangeUtils","tinymce/html/Node","tinymce/html/Entities","tinymce/Env","tinymce/util/Tools"],function(n,m,l,o,j,k){return function(p){var X=k.each;var t=n.BACKSPACE,B=n.DELETE,s=p.dom,D=p.selection,ab=p.settings,N=p.parser,G=p.serializer;var u=j.gecko,A=j.ie,U=j.webkit;function R(ah,ag){try{p.getDoc().execCommand(ah,false,ag)}catch(af){}}function F(){var af=p.getDoc().documentMode;return af?af:6}function Q(af){return af.isDefaultPrevented()}function ad(){function af(al){var ah,aj,ag,am,ai,ak,an;function ao(){if(ai.nodeType==3){if(al&&ak==ai.length){return true}if(!al&&ak===0){return true}}}ah=D.getRng();var ap=[ah.startContainer,ah.startOffset,ah.endContainer,ah.endOffset];if(!ah.collapsed){al=true}ai=ah[(al?"start":"end")+"Container"];ak=ah[(al?"start":"end")+"Offset"];if(ai.nodeType==3){aj=s.getParent(ah.startContainer,s.isBlock);if(al){aj=s.getNext(aj,s.isBlock)}if(aj&&(ao()||!ah.collapsed)){ag=s.create("em",{id:"__mceDel"});X(k.grep(aj.childNodes),function(aq){ag.appendChild(aq)});aj.appendChild(ag)}}ah=s.createRng();ah.setStart(ap[0],ap[1]);ah.setEnd(ap[2],ap[3]);D.setRng(ah);p.getDoc().execCommand(al?"ForwardDelete":"Delete",false,null);if(ag){am=D.getBookmark();while((an=s.get("__mceDel"))){s.remove(an,true)}D.moveToBookmark(am)}}p.on("keydown",function(ah){var ag;ag=ah.keyCode==B;if(!Q(ah)&&(ag||ah.keyCode==t)&&!n.modifierPressed(ah)){ah.preventDefault();af(ag)}});p.addCommand("Delete",function(){af()})}function J(){function af(ai){var ah=s.create("body");var aj=ai.cloneContents();ah.appendChild(aj);return D.serializer.serialize(ah,{format:"html"})}function ag(ah){var aj=af(ah);var ak=s.createRng();ak.selectNode(p.getBody());var ai=af(ak);return aj===ai}p.on("keydown",function(aj){var ai=aj.keyCode,ah;if(!Q(aj)&&(ai==B||ai==t)){ah=p.selection.isCollapsed();if(ah&&!s.isEmpty(p.getBody())){return}if(A&&!ah){return}if(!ah&&!ag(p.selection.getRng())){return}aj.preventDefault();p.setContent("");p.selection.setCursorLocation(p.getBody(),0);p.nodeChanged()}})}function ac(){p.on("keydown",function(af){if(!Q(af)&&af.keyCode==65&&n.metaKeyPressed(af)){af.preventDefault();p.execCommand("SelectAll")}})}function ae(){if(!p.settings.content_editable){s.bind(p.getDoc(),"focusin",function(){D.setRng(D.getRng())});s.bind(p.getDoc(),"mousedown",function(af){if(af.target==p.getDoc().documentElement){p.getWin().focus();D.setRng(D.getRng())}})}}function S(){p.on("keydown",function(ah){if(!Q(ah)&&ah.keyCode===t){if(D.isCollapsed()&&D.getRng(true).startOffset===0){var ag=D.getNode();var af=ag.previousSibling;if(ag.nodeName=="HR"){s.remove(ag);ah.preventDefault();return}if(af&&af.nodeName&&af.nodeName.toLowerCase()==="hr"){s.remove(af);ah.preventDefault()}}}})}function P(){if(!window.Range.prototype.getClientRects){p.on("mousedown",function(ag){if(!Q(ag)&&ag.target.nodeName==="HTML"){var af=p.getBody();af.blur();setTimeout(function(){af.focus()},0)}})}}function w(){p.on("click",function(af){af=af.target;if(/^(IMG|HR)$/.test(af.nodeName)){D.getSel().setBaseAndExtent(af,0,af,1)}if(af.nodeName=="A"&&s.hasClass(af,"mce-item-anchor")){D.select(af)}p.nodeChanged()})}function Y(){function ag(){var ah=s.getAttribs(D.getStart().cloneNode(false));return function(){var ai=D.getStart();if(ai!==p.getBody()){s.setAttrib(ai,"style",null);X(ah,function(aj){ai.setAttributeNode(aj.cloneNode(true))})}}}function af(){return !D.isCollapsed()&&s.getParent(D.getStart(),s.isBlock)!=s.getParent(D.getEnd(),s.isBlock)}p.on("keypress",function(ai){var ah;if(!Q(ai)&&(ai.keyCode==8||ai.keyCode==46)&&af()){ah=ag();p.getDoc().execCommand("delete",false,null);ah();ai.preventDefault();return false}});s.bind(p.getDoc(),"cut",function(ai){var ah;if(!Q(ai)&&af()){ah=ag();setTimeout(function(){ah()},0)}})}function q(){var ag,af;p.on("selectionchange",function(){if(af){clearTimeout(af);af=0}af=window.setTimeout(function(){var ah=D.getRng();if(!ag||!m.compareRanges(ah,ag)){p.nodeChanged();ag=ah}},50)})}function O(){document.body.setAttribute("role","application")}function M(){p.on("keydown",function(ag){if(!Q(ag)&&ag.keyCode===t){if(D.isCollapsed()&&D.getRng(true).startOffset===0){var af=D.getNode().previousSibling;if(af&&af.nodeName&&af.nodeName.toLowerCase()==="table"){ag.preventDefault();return false}}}})}function V(){if(F()>7){return}R("RespectVisibilityInDesign",true);p.contentStyles.push(".mceHideBrInPre pre br {display: none}");s.addClass(p.getBody(),"mceHideBrInPre");N.addNodeFilter("pre",function(af){var ah=af.length,aj,ag,ak,ai;while(ah--){aj=af[ah].getAll("br");ag=aj.length;while(ag--){ak=aj[ag];ai=ak.prev;if(ai&&ai.type===3&&ai.value.charAt(ai.value-1)!="\n"){ai.value+="\n"}else{ak.parent.insert(new l("#text",3),ak,true).value="\n"}}}});G.addNodeFilter("pre",function(af){var ah=af.length,aj,ag,ak,ai;while(ah--){aj=af[ah].getAll("br");ag=aj.length;while(ag--){ak=aj[ag];ai=ak.prev;if(ai&&ai.type==3){ai.value=ai.value.replace(/\r?\n$/,"")}}}})}function v(){s.bind(p.getBody(),"mouseup",function(){var ag,af=D.getNode();if(af.nodeName=="IMG"){if((ag=s.getStyle(af,"width"))){s.setAttrib(af,"width",ag.replace(/[^0-9%]+/g,""));s.setStyle(af,"width","")}if((ag=s.getStyle(af,"height"))){s.setAttrib(af,"height",ag.replace(/[^0-9%]+/g,""));s.setStyle(af,"height","")}}})}function r(){p.on("keydown",function(am){var al,ag,ah,ai,ak,an,aj,af;al=am.keyCode==B;if(!Q(am)&&(al||am.keyCode==t)&&!n.modifierPressed(am)){ag=D.getRng();ah=ag.startContainer;ai=ag.startOffset;aj=ag.collapsed;if(ah.nodeType==3&&ah.nodeValue.length>0&&((ai===0&&!aj)||(aj&&ai===(al?0:1)))){an=ah.previousSibling;if(an&&an.nodeName=="IMG"){return}af=p.schema.getNonEmptyElements();am.preventDefault();ak=s.create("br",{id:"__tmp"});ah.parentNode.insertBefore(ak,ah);p.getDoc().execCommand(al?"ForwardDelete":"Delete",false,null);ah=D.getRng().startContainer;an=ah.previousSibling;if(an&&an.nodeType==1&&!s.isBlock(an)&&s.isEmpty(an)&&!af[an.nodeName.toLowerCase()]){s.remove(an)}s.remove("__tmp")}}})}function aa(){p.on("keydown",function(aj){var ah,ag,ak,af,ai;if(Q(aj)||aj.keyCode!=n.BACKSPACE){return}ah=D.getRng();ag=ah.startContainer;ak=ah.startOffset;af=s.getRoot();ai=ag;if(!ah.collapsed||ak!==0){return}while(ai&&ai.parentNode&&ai.parentNode.firstChild==ai&&ai.parentNode!=af){ai=ai.parentNode}if(ai.tagName==="BLOCKQUOTE"){p.formatter.toggle("blockquote",null,ai);ah=s.createRng();ah.setStart(ag,0);ah.setEnd(ag,0);D.setRng(ah)}})}function Z(){function af(){p._refreshContentEditable();R("StyleWithCSS",false);R("enableInlineTableEditing",false);if(!ab.object_resizing){R("enableObjectResizing",false)}}if(!ab.readonly){p.on("BeforeExecCommand MouseDown",af)}}function L(){function af(){X(s.select("a"),function(ai){var ag=ai.parentNode,ah=s.getRoot();if(ag.lastChild===ai){while(ag&&!s.isBlock(ag)){if(ag.parentNode.lastChild!==ag||ag===ah){return}ag=ag.parentNode}s.add(ag,"br",{"data-mce-bogus":1})}})}p.on("SetContent ExecCommand",function(ag){if(ag.type=="setcontent"||ag.command==="mceInsertLink"){af()}})}function E(){if(ab.forced_root_block){p.on("init",function(){R("DefaultParagraphSeparator",ab.forced_root_block)})}}function H(){p.on("Undo Redo SetContent",function(af){if(!af.initial){p.execCommand("mceRepaint")}})}function x(){p.on("keydown",function(ag){var af;if(!Q(ag)&&ag.keyCode==t){af=p.getDoc().selection.createRange();if(af&&af.item){ag.preventDefault();p.undoManager.beforeChange();s.remove(af.item(0));p.undoManager.add()}}})}function K(){var af;if(F()>=10){af="";X("p div h1 h2 h3 h4 h5 h6".split(" "),function(ag,ah){af+=(ah>0?",":"")+ag+":empty"});p.contentStyles.push(af+"{padding-right: 1px !important}")}}function W(){if(F()<9){N.addNodeFilter("noscript",function(af){var ag=af.length,ah,ai;while(ag--){ah=af[ag];ai=ah.firstChild;if(ai){ah.attr("data-mce-innertext",ai.value)}}});G.addNodeFilter("noscript",function(af){var ag=af.length,ah,aj,ai;while(ag--){ah=af[ag];aj=af[ag].firstChild;if(aj){aj.value=o.decode(aj.value)}else{ai=ah.attributes.map["data-mce-innertext"];if(ai){ah.attr("data-mce-innertext",null);aj=new l("#text",3);aj.value=ai;aj.raw=true;ah.append(aj)}}}})}}function I(){var al=s.doc,ag=al.body,ai,aj,am;function ak(an,aq){var ao=ag.createTextRange();try{ao.moveToPoint(an,aq)}catch(ap){ao=null}return ao}function ah(ao){var an;if(ao.button){an=ak(ao.x,ao.y);if(an){if(an.compareEndPoints("StartToStart",aj)>0){an.setEndPoint("StartToStart",aj)}else{an.setEndPoint("EndToEnd",aj)}an.select()}}else{af()}}function af(){var an=al.selection.createRange();if(aj&&!an.item&&an.compareEndPoints("StartToEnd",an)===0){aj.select()}s.unbind(al,"mouseup",af);s.unbind(al,"mousemove",ah);aj=ai=0}al.documentElement.unselectable=true;s.bind(al,"mousedown contextmenu",function(an){if(an.target.nodeName==="HTML"){if(ai){af()}am=al.documentElement;if(am.scrollHeight>am.clientHeight){return}ai=1;aj=ak(an.x,an.y);if(aj){s.bind(al,"mouseup",af);s.bind(al,"mousemove",ah);s.win.focus();aj.select()}}})}function T(){p.on("keyup focusin",function(af){if(af.keyCode!=65||!n.metaKeyPressed(af)){D.normalize()}})}function y(){p.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}")}function z(){if(!p.inline){p.on("keydown",function(){if(document.activeElement==document.body){p.getWin().focus()}})}}function C(){if(!p.inline){p.contentStyles.push("body {min-height: 150px}");p.on("click",function(af){if(af.target.nodeName=="HTML"){p.execCommand("SelectAll");p.selection.collapse(true);p.nodeChanged()}})}}M();aa();J();T();if(U){r();ad();ae();w();E();if(j.iOS){q();z()}else{ac()}}if(A&&j.ie<11){S();O();V();v();x();K();W();I()}if(j.ie>=11){C()}if(u){S();P();Y();Z();L();H();y()}}});h("tinymce/util/Observable",["tinymce/util/Tools"],function(j){var l="__bindings";var m=j.makeMap("focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange mouseout mouseenter mouseleave keydown keypress keyup contextmenu dragend dragover draggesture dragdrop drop drag"," ");function k(){return false}function n(){return true}return{fire:function(o,s,t){var w=this,p,r,q,v,u;o=o.toLowerCase();s=s||{};s.type=o;if(!s.target){s.target=w}if(!s.preventDefault){s.preventDefault=function(){s.isDefaultPrevented=n};s.stopPropagation=function(){s.isPropagationStopped=n};s.stopImmediatePropagation=function(){s.isImmediatePropagationStopped=n};s.isDefaultPrevented=k;s.isPropagationStopped=k;s.isImmediatePropagationStopped=k}if(w[l]){p=w[l][o];if(p){for(r=0,q=p.length;r<q;r++){p[r]=v=p[r];if(s.isImmediatePropagationStopped()){break}if(v.call(w,s)===false){s.preventDefault();return s}}}}if(t!==false&&w.parent){u=w.parent();while(u&&!s.isPropagationStopped()){u.fire(o,s,false);u=u.parent()}}return s},on:function(q,u){var p=this,t,o,s,r;if(u===false){u=function(){return false}}if(u){s=q.toLowerCase().split(" ");r=s.length;while(r--){q=s[r];t=p[l];if(!t){t=p[l]={}}o=t[q];if(!o){o=t[q]=[];if(p.bindNative&&m[q]){p.bindNative(q)}}o.push(u)}}return p},off:function(o,v){var w=this,t,p=w[l],s,q,u,r;if(p){if(o){u=o.toLowerCase().split(" ");t=u.length;while(t--){o=u[t];s=p[o];if(!o){for(q in p){p[o].length=0}return w}if(s){if(!v){s.length=0}else{r=s.length;while(r--){if(s[r]===v){s.splice(r,1)}}}if(!s.length&&w.unbindNative&&m[o]){w.unbindNative(o);delete p[o]}}}}else{if(w.unbindNative){for(o in p){w.unbindNative(o)}}w[l]=[]}}return w},hasEventListeners:function(o){var p=this[l];o=o.toLowerCase();return !(!p||!p[o]||p[o].length===0)}}});h("tinymce/Shortcuts",["tinymce/util/Tools","tinymce/Env"],function(l,k){var n=l.each,m=l.explode;var j={f9:120,f10:121,f11:122};return function(q){var p=this,o={};q.on("keyup keypress keydown",function(r){if(r.altKey||r.ctrlKey||r.metaKey){n(o,function(s){var t=k.mac?(r.ctrlKey||r.metaKey):r.ctrlKey;if(s.ctrl!=t||s.alt!=r.altKey||s.shift!=r.shiftKey){return}if(r.keyCode==s.keyCode||(r.charCode&&r.charCode==s.charCode)){r.preventDefault();if(r.type=="keydown"){s.func.call(s.scope)}return true}})}});p.add=function(u,v,s,r){var t;t=s;if(typeof(s)==="string"){s=function(){q.execCommand(t,false,null)}}else{if(l.isArray(t)){s=function(){q.execCommand(t[0],t[1],t[2])}}}n(m(u.toLowerCase()),function(x){var w={func:s,scope:r||q,desc:q.translate(v),alt:false,ctrl:false,shift:false};n(m(x,"+"),function(y){switch(y){case"alt":case"ctrl":case"shift":w[y]=true;break;default:w.charCode=y.charCodeAt(0);w.keyCode=j[y]||y.toUpperCase().charCodeAt(0)}});o[(w.ctrl?"ctrl":"")+","+(w.alt?"alt":"")+","+(w.shift?"shift":"")+","+w.keyCode]=w});return true}}});h("tinymce/Editor",["tinymce/dom/DOMUtils","tinymce/AddOnManager","tinymce/html/Node","tinymce/dom/Serializer","tinymce/html/Serializer","tinymce/dom/Selection","tinymce/Formatter","tinymce/UndoManager","tinymce/EnterKey","tinymce/ForceBlocks","tinymce/EditorCommands","tinymce/util/URI","tinymce/dom/ScriptLoader","tinymce/dom/EventUtils","tinymce/WindowManager","tinymce/html/Schema","tinymce/html/DomParser","tinymce/util/Quirks","tinymce/Env","tinymce/util/Tools","tinymce/util/Observable","tinymce/Shortcuts"],function(S,C,x,K,I,E,z,n,J,F,v,D,s,t,M,o,k,B,N,q,m,P){var A=S.DOM,O=C.ThemeManager,R=C.PluginManager;var p=q.extend,L=q.each,r=q.explode;var Q=q.inArray,j=q.trim,u=q.resolve;var H=t.Event;var l=N.gecko,G=N.ie;function y(U,T){if(T=="selectionchange"||T=="drop"){return U.getDoc()}if(!U.inline&&/^mouse|click|contextmenu/.test(T)){return U.getDoc()}return U.getBody()}function w(Y,V,X){var U=this,T,W;T=U.documentBaseUrl=X.documentBaseURL;W=X.baseURI;U.settings=V=p({id:Y,theme:"modern",delta_width:0,delta_height:0,popup_css:"",plugins:"",document_base_url:T,add_form_submit_trigger:true,submit_patch:true,add_unload_trigger:true,convert_urls:true,relative_urls:true,remove_script_host:true,object_resizing:true,doctype:"<!DOCTYPE html>",visual:true,font_size_style_values:"xx-small,x-small,small,medium,large,x-large,xx-large",font_size_legacy_values:"xx-small,small,medium,large,x-large,xx-large,300%",forced_root_block:"p",hidden_input:true,padd_empty_editor:true,render_ui:true,indentation:"30px",inline_styles:true,convert_fonts_to_spans:true,indent:"simple",indent_before:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,ul,li,area,table,thead,tfoot,tbody,tr,section,article,hgroup,aside,figure,option,optgroup,datalist",indent_after:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,ul,li,area,table,thead,tfoot,tbody,tr,section,article,hgroup,aside,figure,option,optgroup,datalist",validate:true,entity_encoding:"named",url_converter:U.convertURL,url_converter_scope:U,ie7_compat:true},V);C.language=V.language||"en";C.languageLoad=V.language_load;C.baseURL=X.baseURL;U.id=V.id=Y;U.isNotDirty=true;U.plugins={};U.documentBaseURI=new D(V.document_base_url||T,{base_uri:W});U.baseURI=W;U.contentCSS=[];U.contentStyles=[];U.shortcuts=new P(U);U.execCommands={};U.queryStateCommands={};U.queryValueCommands={};U.loadedCSS={};U.suffix=X.suffix;U.editorManager=X;U.inline=V.inline;U.execCallback("setup",U);X.fire("SetupEditor",U)}w.prototype={render:function(){var T=this,W=T.settings,Z=T.id,Y=T.suffix;function V(){A.unbind(window,"ready",V);T.render()}if(!H.domLoaded){A.bind(window,"ready",V);return}if(!T.getElement()){return}if(!N.contentEditable){return}if(!W.inline){T.orgVisibility=T.getElement().style.visibility;T.getElement().style.visibility="hidden"}else{T.inline=true}var X=T.getElement().form||A.getParent(Z,"form");if(X){T.formElement=X;if(W.hidden_input&&!/TEXTAREA|INPUT/i.test(T.getElement().nodeName)){A.insertAfter(A.create("input",{type:"hidden",name:Z}),Z);T.hasHiddenInput=true}T.formEventDelegate=function(aa){T.fire(aa.type,aa)};A.bind(X,"submit reset",T.formEventDelegate);T.on("reset",function(){T.setContent(T.startContent,{format:"raw"})});if(W.submit_patch&&!X.submit.nodeType&&!X.submit.length&&!X._mceOldSubmit){X._mceOldSubmit=X.submit;X.submit=function(){T.editorManager.triggerSave();T.isNotDirty=true;return X._mceOldSubmit(X)}}}T.windowManager=new M(T);if(W.encoding=="xml"){T.on("GetContent",function(aa){if(aa.save){aa.content=A.encode(aa.content)}})}if(W.add_form_submit_trigger){T.on("submit",function(){if(T.initialized){T.save()}})}if(W.add_unload_trigger){T._beforeUnload=function(){if(T.initialized&&!T.destroyed&&!T.isHidden()){T.save({format:"raw",no_events:true,set_dirty:false})}};T.editorManager.on("BeforeUnload",T._beforeUnload)}function U(){var ab=s.ScriptLoader;if(W.language&&W.language!="en"){W.language_url=T.editorManager.baseURL+"/langs/"+W.language+".js"}if(W.language_url){ab.add(W.language_url)}if(W.theme&&typeof W.theme!="function"&&W.theme.charAt(0)!="-"&&!O.urls[W.theme]){var aa=W.theme_url;if(aa){aa=T.documentBaseURI.toAbsolute(aa)}else{aa="themes/"+W.theme+"/theme"+Y+".js"}O.load(W.theme,aa)}if(q.isArray(W.plugins)){W.plugins=W.plugins.join(" ")}L(W.external_plugins,function(ad,ac){R.load(ac,ad);W.plugins+=" "+ac});L(W.plugins.split(/[ ,]/),function(ac){ac=j(ac);if(ac&&!R.urls[ac]){if(ac.charAt(0)=="-"){ac=ac.substr(1,ac.length);var ad=R.dependencies(ac);L(ad,function(af){var ae={prefix:"plugins/",resource:af,suffix:"/plugin"+Y+".js"};af=R.createUrl(ae,af);R.load(af.resource,af)})}else{R.load(ac,{prefix:"plugins/",resource:ac,suffix:"/plugin"+Y+".js"})}}});ab.loadQueue(function(){if(!T.removed){T.init()}})}U()},init:function(){var Y=this,ai=Y.settings,W=Y.getElement();var X,ag,V,ac,aa,T,ak,af,ab,ae,U=[];Y.rtl=this.editorManager.i18n.rtl;Y.editorManager.add(Y);ai.aria_label=ai.aria_label||A.getAttrib(W,"aria-label",Y.getLang("aria.rich_text_area"));if(ai.theme){if(typeof ai.theme!="function"){ai.theme=ai.theme.replace(/-/,"");aa=O.get(ai.theme);Y.theme=new aa(Y,O.urls[ai.theme]);if(Y.theme.init){Y.theme.init(Y,O.urls[ai.theme]||Y.documentBaseUrl.replace(/\/$/,""))}}else{Y.theme=ai.theme}}function aj(ao){var an=R.get(ao),am,al;am=R.urls[ao]||Y.documentBaseUrl.replace(/\/$/,"");ao=j(ao);if(an&&Q(U,ao)===-1){L(R.dependencies(ao),function(ap){aj(ap)});al=new an(Y,am);Y.plugins[ao]=al;if(al.init){al.init(Y,am);U.push(ao)}}}L(ai.plugins.replace(/\-/g,"").split(/[ ,]/),aj);Y.fire("BeforeRenderUI");if(ai.render_ui&&Y.theme){Y.orgDisplay=W.style.display;if(typeof ai.theme!="function"){X=ai.width||W.style.width||W.offsetWidth;ag=ai.height||W.style.height||W.offsetHeight;V=ai.min_height||100;ab=/^[0-9\.]+(|px)$/i;if(ab.test(""+X)){X=Math.max(parseInt(X,10)+(aa.deltaWidth||0),100)}if(ab.test(""+ag)){ag=Math.max(parseInt(ag,10)+(aa.deltaHeight||0),V)}aa=Y.theme.renderUI({targetNode:W,width:X,height:ag,deltaWidth:ai.delta_width,deltaHeight:ai.delta_height});if(!ai.content_editable){A.setStyles(aa.sizeContainer||aa.editorContainer,{wi2dth:X,h2eight:ag});ag=(aa.iframeHeight||ag)+(typeof(ag)=="number"?(aa.deltaHeight||0):"");if(ag<V){ag=V}}}else{aa=ai.theme(Y,W);if(aa.editorContainer.nodeType){aa.editorContainer=aa.editorContainer.id=aa.editorContainer.id||Y.id+"_parent"}if(aa.iframeContainer.nodeType){aa.iframeContainer=aa.iframeContainer.id=aa.iframeContainer.id||Y.id+"_iframecontainer"}ag=aa.iframeHeight||W.offsetHeight}Y.editorContainer=aa.editorContainer}if(ai.content_css){L(r(ai.content_css),function(al){Y.contentCSS.push(Y.documentBaseURI.toAbsolute(al))})}if(ai.content_style){Y.contentStyles.push(ai.content_style)}if(ai.content_editable){W=ac=aa=null;return Y.initContentBody()}Y.iframeHTML=ai.doctype+"<html><head>";if(ai.document_base_url!=Y.documentBaseUrl){Y.iframeHTML+='<base href="'+Y.documentBaseURI.getURI()+'" />'}if(!N.caretAfter&&ai.ie7_compat){Y.iframeHTML+='<meta http-equiv="X-UA-Compatible" content="IE=7" />'}Y.iframeHTML+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';for(ae=0;ae<Y.contentCSS.length;ae++){var ad=Y.contentCSS[ae];Y.iframeHTML+='<link type="text/css" rel="stylesheet" href="'+ad+'" />';Y.loadedCSS[ad]=true}ak=ai.body_id||"tinymce";if(ak.indexOf("=")!=-1){ak=Y.getParam("body_id","","hash");ak=ak[Y.id]||ak}af=ai.body_class||"";if(af.indexOf("=")!=-1){af=Y.getParam("body_class","","hash");af=af[Y.id]||""}Y.iframeHTML+='</head><body id="'+ak+'" class="mce-content-body '+af+'" onload="window.parent.tinymce.get(\''+Y.id+"').fire('load');\"><br></body></html>";var Z='javascript:(function(){document.open();document.domain="'+document.domain+'";var ed = window.parent.tinymce.get("'+Y.id+'");document.write(ed.iframeHTML);document.close();ed.initContentBody(true);})()';if(document.domain!=location.hostname){T=Z}ac=A.add(aa.iframeContainer,"iframe",{id:Y.id+"_ifr",src:T||'javascript:""',frameBorder:"0",allowTransparency:"true",title:Y.editorManager.translate("Rich Text Area. Press ALT-F9 for menu. Press ALT-F10 for toolbar. Press ALT-0 for help"),style:{width:"100%",height:ag,display:"block"}});if(G){try{Y.getDoc()}catch(ah){ac.src=T=Z}}Y.contentAreaContainer=aa.iframeContainer;if(aa.editorContainer){A.get(aa.editorContainer).style.display=Y.orgDisplay}A.get(Y.id).style.display="none";A.setAttrib(Y.id,"aria-hidden",true);if(!T){Y.initContentBody()}W=ac=aa=null},initContentBody:function(U){var V=this,W=V.settings,X=A.get(V.id),Y=V.getDoc(),T,Z;if(!W.inline){V.getElement().style.visibility=V.orgVisibility}if(!U&&!W.content_editable){Y.open();Y.write(V.iframeHTML);Y.close()}if(W.content_editable){V.on("remove",function(){var aa=this.getBody();A.removeClass(aa,"mce-content-body");A.removeClass(aa,"mce-edit-focus");A.setAttrib(aa,"tabIndex",null);A.setAttrib(aa,"contentEditable",null)});A.addClass(X,"mce-content-body");X.tabIndex=-1;V.contentDocument=Y=W.content_document||document;V.contentWindow=W.content_window||window;V.bodyElement=X;W.content_document=W.content_window=null;W.root_name=X.nodeName.toLowerCase()}T=V.getBody();T.disabled=true;if(!W.readonly){T.contentEditable=V.getParam("content_editable_state",true)}T.disabled=false;V.schema=new o(W);V.dom=new S(Y,{keep_values:true,url_converter:V.convertURL,url_converter_scope:V,hex_colors:W.force_hex_style_colors,class_filter:W.class_filter,update_styles:true,root_element:W.content_editable?V.id:null,collect:W.content_editable,schema:V.schema,onSetAttrib:function(aa){V.fire("SetAttrib",aa)}});V.parser=new k(W,V.schema);V.parser.addAttributeFilter("src,href,style",function(aa,ab){var ac=aa.length,ae,ag=V.dom,af,ad;while(ac--){ae=aa[ac];af=ae.attr(ab);ad="data-mce-"+ab;if(!ae.attributes.map[ad]){if(ab==="style"){ae.attr(ad,ag.serializeStyle(ag.parseStyle(af),ae.name))}else{ae.attr(ad,V.convertURL(af,ab,ae.name))}}}});V.parser.addNodeFilter("script",function(aa){var ab=aa.length,ac;while(ab--){ac=aa[ab];ac.attr("type","mce-"+(ac.attr("type")||"text/javascript"))}});V.parser.addNodeFilter("#cdata",function(aa){var ab=aa.length,ac;while(ab--){ac=aa[ab];ac.type=8;ac.name="#comment";ac.value="[CDATA["+ac.value+"]]"}});V.parser.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",function(ab){var ac=ab.length,ad,aa=V.schema.getNonEmptyElements();while(ac--){ad=ab[ac];if(ad.isEmpty(aa)){ad.empty().append(new x("br",1)).shortEnded=true}}});V.serializer=new K(W,V);V.selection=new E(V.dom,V.getWin(),V.serializer,V);V.formatter=new z(V);V.undoManager=new n(V);V.forceBlocks=new F(V);V.enterKey=new J(V);V.editorCommands=new v(V);V.fire("PreInit");if(!W.browser_spellcheck&&!W.gecko_spellcheck){Y.body.spellcheck=false;A.setAttrib(T,"spellcheck","false")}V.fire("PostRender");V.quirks=B(V);if(W.directionality){T.dir=W.directionality}if(W.nowrap){T.style.whiteSpace="nowrap"}if(W.protect){V.on("BeforeSetContent",function(aa){L(W.protect,function(ab){aa.content=aa.content.replace(ab,function(ac){return"<!--mce:protected "+escape(ac)+"-->"})})})}V.on("SetContent",function(){V.addVisual(V.getBody())});if(W.padd_empty_editor){V.on("PostProcess",function(aa){aa.content=aa.content.replace(/^(<p[^>]*>(&nbsp;|&#160;|\s|\u00a0|)<\/p>[\r\n]*|<br \/>[\r\n]*)$/,"")})}V.load({initial:true,format:"html"});V.startContent=V.getContent({format:"raw"});V.initialized=true;L(V._pendingNativeEvents,function(aa){V.dom.bind(y(V,aa),aa,function(ab){V.fire(ab.type,ab)})});V.fire("init");V.focus(true);V.nodeChanged({initial:true});V.execCallback("init_instance_callback",V);if(V.contentStyles.length>0){Z="";L(V.contentStyles,function(aa){Z+=aa+"\r\n"});V.dom.addStyle(Z)}L(V.contentCSS,function(aa){if(!V.loadedCSS[aa]){V.dom.loadCSS(aa);V.loadedCSS[aa]=true}});if(W.auto_focus){setTimeout(function(){var aa=V.editorManager.get(W.auto_focus);aa.selection.select(aa.getBody(),1);aa.selection.collapse(1);aa.getBody().focus();aa.getWin().focus()},100)}X=Y=T=null},focus:function(W){var V,ab=this,aa=ab.selection,X=ab.settings.content_editable,T;var Y,Z=ab.getDoc(),U;if(!W){T=aa.getRng();if(T.item){Y=T.item(0)}ab._refreshContentEditable();if(!X){if(!N.opera){ab.getBody().focus()}ab.getWin().focus()}if(l||X){U=ab.getBody();if(U.setActive){U.setActive()}else{U.focus()}if(X){aa.normalize()}}if(Y&&Y.ownerDocument==Z){T=Z.body.createControlRange();T.addElement(Y);T.select()}}if(ab.editorManager.activeEditor!=ab){if((V=ab.editorManager.activeEditor)){V.fire("deactivate",{relatedTarget:ab})}ab.fire("activate",{relatedTarget:V})}ab.editorManager.activeEditor=ab},execCallback:function(U){var T=this,W=T.settings[U],V;if(!W){return}if(T.callbackLookup&&(V=T.callbackLookup[U])){W=V.func;V=V.scope}if(typeof(W)==="string"){V=W.replace(/\.\w+$/,"");V=V?u(V):0;W=u(W);T.callbackLookup=T.callbackLookup||{};T.callbackLookup[U]={func:W,scope:V}}return W.apply(V||T,Array.prototype.slice.call(arguments,1))},translate:function(V){var U=this.settings.language||"en",T=this.editorManager.i18n;if(!V){return""}return T.data[U+"."+V]||V.replace(/\{\#([^\}]+)\}/g,function(X,W){return T.data[U+"."+W]||"{#"+W+"}"})},getLang:function(T,U){return(this.editorManager.i18n.data[(this.settings.language||"en")+"."+T]||(U!==g?U:"{#"+T+"}"))},getParam:function(U,X,V){var W=U in this.settings?this.settings[U]:X,T;if(V==="hash"){T={};if(typeof(W)==="string"){L(W.indexOf("=")>0?W.split(/[;,](?![^=;,]*(?:[;,]|$))/):W.split(","),function(Y){Y=Y.split("=");if(Y.length>1){T[j(Y[0])]=j(Y[1])}else{T[j(Y[0])]=j(Y)}})}else{T=W}return T}return W},nodeChanged:function(){var U=this,W=U.selection,X,V,T;if(U.initialized&&!U.settings.disable_nodechange){T=U.getBody();X=W.getStart()||T;X=G&&X.ownerDocument!=U.getDoc()?U.getBody():X;if(X.nodeName=="IMG"&&W.isCollapsed()){X=X.parentNode}V=[];U.dom.getParent(X,function(Y){if(Y===T){return true}V.push(Y)});U.fire("NodeChange",{element:X,parents:V})}},addButton:function(U,V){var T=this;if(V.cmd&&!V.onclick){V.onclick=function(){T.execCommand(V.cmd)}}if(!V.text&&!V.icon){V.icon=U}T.buttons=T.buttons||{};V.tooltip=V.tooltip||V.title;T.buttons[U]=V},addMenuItem:function(U,V){var T=this;if(V.cmd){V.onclick=function(){T.execCommand(V.cmd)}}T.menuItems=T.menuItems||{};T.menuItems[U]=V},addCommand:function(T,V,U){this.execCommands[T]={func:V,scope:U||this}},addQueryStateHandler:function(T,V,U){this.queryStateCommands[T]={func:V,scope:U||this}},addQueryValueHandler:function(T,V,U){this.queryValueCommands[T]={func:V,scope:U||this}},addShortcut:function(V,W,U,T){this.shortcuts.add(V,W,U,T)},execCommand:function(Z,Y,X,U){var T=this,W=0,V;if(!/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint)$/.test(Z)&&(!U||!U.skip_focus)){T.focus()}U=p({},U);U=T.fire("BeforeExecCommand",{command:Z,ui:Y,value:X});if(U.isDefaultPrevented()){return false}if((V=T.execCommands[Z])){if(V.func.call(V.scope,Y,X)!==true){T.fire("ExecCommand",{command:Z,ui:Y,value:X});return true}}L(T.plugins,function(aa){if(aa.execCommand&&aa.execCommand(Z,Y,X)){T.fire("ExecCommand",{command:Z,ui:Y,value:X});W=true;return false}});if(W){return W}if(T.theme&&T.theme.execCommand&&T.theme.execCommand(Z,Y,X)){T.fire("ExecCommand",{command:Z,ui:Y,value:X});return true}if(T.editorCommands.execCommand(Z,Y,X)){T.fire("ExecCommand",{command:Z,ui:Y,value:X});return true}T.getDoc().execCommand(Z,Y,X);T.fire("ExecCommand",{command:Z,ui:Y,value:X})},queryCommandState:function(X){var U=this,T,W;if(U._isHidden()){return}if((T=U.queryStateCommands[X])){W=T.func.call(T.scope);if(W!==true){return W}}W=U.editorCommands.queryCommandState(X);if(W!==-1){return W}try{return U.getDoc().queryCommandState(X)}catch(V){}},queryCommandValue:function(X){var U=this,T,W;if(U._isHidden()){return}if((T=U.queryValueCommands[X])){W=T.func.call(T.scope);if(W!==true){return W}}W=U.editorCommands.queryCommandValue(X);if(W!==g){return W}try{return U.getDoc().queryCommandValue(X)}catch(V){}},show:function(){var T=this;A.show(T.getContainer());A.hide(T.id);T.load();T.fire("show")},hide:function(){var T=this,U=T.getDoc();if(G&&U){U.execCommand("SelectAll")}T.save();A.hide(T.getContainer());A.setStyle(T.id,"display",T.orgDisplay);T.fire("hide")},isHidden:function(){return !A.isHidden(this.id)},setProgressState:function(T,U){this.fire("ProgressState",{state:T,time:U})},load:function(U){var T=this,W=T.getElement(),V;if(W){U=U||{};U.load=true;V=T.setContent(W.value!==g?W.value:W.innerHTML,U);U.element=W;if(!U.no_events){T.fire("LoadContent",U)}U.element=W=null;return V}},save:function(U){var T=this,X=T.getElement(),V,W;if(!X||!T.initialized){return}U=U||{};U.save=true;U.element=X;V=U.content=T.getContent(U);if(!U.no_events){T.fire("SaveContent",U)}V=U.content;if(!/TEXTAREA|INPUT/i.test(X.nodeName)){X.innerHTML=V;if((W=A.getParent(T.id,"form"))){L(W.elements,function(Y){if(Y.name==T.id){Y.value=V;return false}})}}else{X.value=V}U.element=X=null;if(U.set_dirty!==false){T.isNotDirty=true}return V},setContent:function(Y,V){var U=this,T=U.getBody(),W;V=V||{};V.format=V.format||"html";V.set=true;V.content=Y;if(!V.no_events){U.fire("BeforeSetContent",V)}Y=V.content;if(Y.length===0||/^\s+$/.test(Y)){W=U.settings.forced_root_block;if(W&&U.schema.isValidChild(T.nodeName.toLowerCase(),W.toLowerCase())){if(G&&G<11){Y="<"+W+"></"+W+">"}else{Y="<"+W+'><br data-mce-bogus="1"></'+W+">"}}else{if(!G){Y='<br data-mce-bogus="1">'}}T.innerHTML=Y;U.fire("SetContent",V)}else{if(V.format!=="raw"){Y=new I({},U.schema).serialize(U.parser.parse(Y,{isRootContent:true}))}V.content=j(Y);U.dom.setHTML(T,V.content);if(!V.no_events){U.fire("SetContent",V)}}if(!V.initial){var Z=U.dom,X=U.selection;if(G<11&&Z.isBlock(T.firstChild)&&Z.isEmpty(T.firstChild)){T.firstChild.appendChild(Z.doc.createTextNode("\u00a0"));X.select(T.firstChild,true);Z.remove(T.firstChild.lastChild)}else{X.select(T,true);X.collapse(true)}}return V.content},getContent:function(V){var U=this,W,T=U.getBody();V=V||{};V.format=V.format||"html";V.get=true;V.getInner=true;if(!V.no_events){U.fire("BeforeGetContent",V)}if(V.format=="raw"){W=T.innerHTML}else{if(V.format=="text"){W=T.innerText||T.textContent}else{W=U.serializer.serialize(T,V)}}if(V.format!="text"){V.content=j(W)}else{V.content=W}if(!V.no_events){U.fire("GetContent",V)}return V.content},insertContent:function(T){this.execCommand("mceInsertContent",false,T)},isDirty:function(){return !this.isNotDirty},getContainer:function(){var T=this;if(!T.container){T.container=A.get(T.editorContainer||T.id+"_parent")}return T.container},getContentAreaContainer:function(){return this.contentAreaContainer},getElement:function(){return A.get(this.settings.content_element||this.id)},getWin:function(){var T=this,U;if(!T.contentWindow){U=A.get(T.id+"_ifr");if(U){T.contentWindow=U.contentWindow}}return T.contentWindow},getDoc:function(){var T=this,U;if(!T.contentDocument){U=T.getWin();if(U){T.contentDocument=U.document}}return T.contentDocument},getBody:function(){return this.bodyElement||this.getDoc().body},convertURL:function(V,U,X){var T=this,W=T.settings;if(W.urlconverter_callback){return T.execCallback("urlconverter_callback",V,X,true,U)}if(!W.convert_urls||(X&&X.nodeName=="LINK")||V.indexOf("file:")===0||V.length===0){return V}if(W.relative_urls){return T.documentBaseURI.toRelative(V)}V=T.documentBaseURI.toAbsolute(V,W.remove_script_host);return V},addVisual:function(X){var U=this,V=U.settings,W=U.dom,T;X=X||U.getBody();if(U.hasVisual===g){U.hasVisual=V.visual}L(W.select("table,a",X),function(Z){var Y;switch(Z.nodeName){case"TABLE":T=V.visual_table_class||"mce-item-table";Y=W.getAttrib(Z,"border");if(!Y||Y=="0"){if(U.hasVisual){W.addClass(Z,T)}else{W.removeClass(Z,T)}}return;case"A":if(!W.getAttrib(Z,"href",false)){Y=W.getAttrib(Z,"name")||Z.id;T="mce-item-anchor";if(Y){if(U.hasVisual){W.addClass(Z,T)}else{W.removeClass(Z,T)}}}return}});U.fire("VisualAid",{element:X,hasVisual:U.hasVisual})},remove:function(){var T=this;if(!T.removed){T.removed=1;if(T.hasHiddenInput){A.remove(T.getElement().nextSibling)}var U=T.getDoc();if(G&&U){U.execCommand("SelectAll")}T.save();A.setStyle(T.id,"display",T.orgDisplay);if(!T.settings.content_editable){H.unbind(T.getWin());H.unbind(T.getDoc())}var V=T.getContainer();H.unbind(T.getBody());H.unbind(V);T.fire("remove");T.editorManager.remove(T);A.remove(V);T.destroy()}},bindNative:function(U){var T=this;if(T.settings.readonly){return}if(T.initialized){T.dom.bind(y(T,U),U,function(V){T.fire(U,V)})}else{if(!T._pendingNativeEvents){T._pendingNativeEvents=[U]}else{T._pendingNativeEvents.push(U)}}},unbindNative:function(U){var T=this;if(T.initialized){T.dom.unbind(U)}},destroy:function(V){var T=this,U;if(T.destroyed){return}if(!V&&!T.removed){T.remove();return}if(V&&l){H.unbind(T.getDoc());H.unbind(T.getWin());H.unbind(T.getBody())}if(!V){T.editorManager.off("beforeunload",T._beforeUnload);if(T.theme&&T.theme.destroy){T.theme.destroy()}T.selection.destroy();T.dom.destroy()}U=T.formElement;if(U){if(U._mceOldSubmit){U.submit=U._mceOldSubmit;U._mceOldSubmit=null}A.unbind(U,"submit reset",T.formEventDelegate)}T.contentAreaContainer=T.formElement=T.container=null;T.settings.content_element=T.bodyElement=T.contentDocument=T.contentWindow=null;if(T.selection){T.selection=T.selection.win=T.selection.dom=T.selection.dom.doc=null}T.destroyed=1},_refreshContentEditable:function(){var U=this,T,V;if(U._isHidden()){T=U.getBody();V=T.parentNode;V.removeChild(T);V.appendChild(T);T.focus()}},_isHidden:function(){var T;if(!l){return 0}T=this.selection.getSel();return(!T||!T.rangeCount||T.rangeCount===0)}};p(w.prototype,m);return w});h("tinymce/util/I18n",[],function(){var j={};return{rtl:false,add:function(m,k){for(var l in k){j[l]=k[l]}this.rtl=this.rtl||j._dir==="rtl"},translate:function(l){if(typeof(l)=="undefined"){return l}if(typeof(l)!="string"&&l.raw){return l.raw}if(l.push){var k=l.slice(1);l=(j[l[0]]||l[0]).replace(/\{([^\}]+)\}/g,function(n,m){return k[m]})}return j[l]||l},data:j}});h("tinymce/FocusManager",["tinymce/dom/DOMUtils","tinymce/Env"],function(l,k){function j(q){function n(){try{return document.activeElement}catch(r){return document.body}}function p(r){if(r&&r.startContainer){return{startContainer:r.startContainer,startOffset:r.startOffset,endContainer:r.endContainer,endOffset:r.endOffset}}return r}function m(t,s){var r;if(s.startContainer){r=t.getDoc().createRange();try{r.setStart(s.startContainer,s.startOffset)}catch(u){r.setStart(s.startContainer)}try{r.setEnd(s.endContainer,s.endOffset)}catch(u){r.setEnd(s.endContainer)}}else{r=s}return r}function o(u){var s=u.editor,v,r;function t(w){return !!l.DOM.getParent(w,j.isEditorUIElement)}s.on("init",function(){if("onbeforedeactivate" in document&&k.ie<11){s.dom.bind(s.getBody(),"beforedeactivate",function(){var x=s.getDoc().selection;try{v=x&&x.createRange?x.createRange():s.selection.getRng()}catch(w){}})}else{if(s.inline||k.ie>10){s.on("nodechange keyup",function(){var w,x=document.activeElement;if(x&&x.id==s.id+"_ifr"){x=s.getBody()}while(x){if(x==s.getBody()){w=true;break}x=x.parentNode}if(w){v=s.selection.getRng()}});if(k.webkit){r=function(){var w=s.selection.getRng();if(!w.collapsed){v=w}};l.DOM.bind(document,"selectionchange",r);s.on("remove",function(){l.DOM.unbind(document,"selectionchange",r)})}}}});s.on("mousedown",function(){s.selection.lastFocusBookmark=null});s.on("focusin",function(){var w=q.focusedEditor;if(s.selection.lastFocusBookmark){s.selection.setRng(m(s,s.selection.lastFocusBookmark));s.selection.lastFocusBookmark=null}if(w!=s){if(w){w.fire("blur",{focusedEditor:s})}q.activeEditor=s;s.fire("focus",{blurredEditor:w});s.focus(false);q.focusedEditor=s}});s.on("focusout",function(){s.selection.lastFocusBookmark=p(v);window.setTimeout(function(){var w=q.focusedEditor;if(w!=s){s.selection.lastFocusBookmark=null}if(!t(n())&&w==s){s.fire("blur",{focusedEditor:null});q.focusedEditor=null;s.selection.lastFocusBookmark=null}},0)})}q.on("AddEditor",o)}j.isEditorUIElement=function(m){return m.className.indexOf("mce-")!==-1};return j});h("tinymce/EditorManager",["tinymce/Editor","tinymce/dom/DOMUtils","tinymce/util/URI","tinymce/Env","tinymce/util/Tools","tinymce/util/Observable","tinymce/util/I18n","tinymce/FocusManager"],function(m,s,v,o,j,q,k,n){var x=s.DOM;var r=j.explode,u=j.each,p=j.extend;var l=0,w;var t={majorVersion:"4",minorVersion:"0.8",releaseDate:"2013-10-10",editors:[],i18n:k,activeEditor:null,setup:function(){var B=this,D,z,E="",A;z=document.location.href.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,"");if(!/[\/\\]$/.test(z)){z+="/"}A=window.tinymce||window.tinyMCEPreInit;if(A){D=A.base||A.baseURL;E=A.suffix}else{var y=document.getElementsByTagName("script");for(var C=0;C<y.length;C++){var F=y[C].src;if(/tinymce(\.jquery|)(\.min|\.dev|)\.js/.test(F)){if(F.indexOf(".min")!=-1){E=".min"}D=F.substring(0,F.lastIndexOf("/"));break}}}B.baseURL=new v(z).toAbsolute(D);B.documentBaseURL=z;B.baseURI=new v(B.baseURL);B.suffix=E;B.focusManager=new n(B)},init:function(D){var y=this,E=[],C;function B(H){var G=H.id;if(!G){G=H.name;if(G&&!x.get(G)){G=H.name}else{G=x.uniqueId()}H.setAttribute("id",G)}return G}function F(I,J,G){var H=I[J];if(!H){return}return H.apply(G||this,Array.prototype.slice.call(arguments,2))}function A(H,G){return G.constructor===RegExp?G.test(H.className):x.hasClass(H,G)}function z(){var G,H;x.unbind(window,"ready",z);F(D,"onpageload");if(D.types){u(D.types,function(I){u(x.select(I.selector),function(K){var J=new m(B(K),p({},D,I),y);E.push(J);J.render(1)})});return}else{if(D.selector){u(x.select(D.selector),function(J){var I=new m(B(J),D,y);E.push(I);I.render(1)});return}}switch(D.mode){case"exact":G=D.elements||"";if(G.length>0){u(r(G),function(I){if(x.get(I)){C=new m(I,D,y);E.push(C);C.render(true)}else{u(document.forms,function(J){u(J.elements,function(K){if(K.name===I){I="mce_editor_"+l++;x.setAttrib(K,"id",I);C=new m(I,D,y);E.push(C);C.render(1)}})})}})}break;case"textareas":case"specific_textareas":u(x.select("textarea"),function(I){if(D.editor_deselector&&A(I,D.editor_deselector)){return}if(!D.editor_selector||A(I,D.editor_selector)){C=new m(B(I),D,y);E.push(C);C.render(true)}});break}if(D.oninit){G=H=0;u(E,function(I){H++;if(!I.initialized){I.on("init",function(){G++;if(G==H){F(D,"oninit")}})}else{G++}if(G==H){F(D,"oninit")}})}}y.settings=D;x.bind(window,"ready",z)},get:function(y){if(y===g){return this.editors}return this.editors[y]},add:function(z){var y=this,A=y.editors;A[z.id]=z;A.push(z);y.activeEditor=z;y.fire("AddEditor",{editor:z});if(!w){w=function(){y.fire("BeforeUnload")};x.bind(window,"beforeunload",w)}return z},createEditor:function(z,y){return this.add(new m(z,y,this))},remove:function(y){var z=this,A,D=z.editors,C,B;if(!y){for(A=D.length-1;A>=0;A--){z.remove(D[A])}return}if(typeof(y)=="string"){y=y.selector||y;u(x.select(y),function(E){z.remove(D[E.id])});return}C=y;if(!D[C.id]){return null}delete D[C.id];for(A=0;A<D.length;A++){if(D[A]==C){D.splice(A,1);B=true;break}}if(z.activeEditor==C){z.activeEditor=D[0]}if(B){z.fire("RemoveEditor",{editor:C})}if(!D.length){x.unbind(window,"beforeunload",w)}C.remove();return C},execCommand:function(C,B,A){var y=this,z=y.get(A);switch(C){case"mceAddEditor":if(!y.get(A)){new m(A,y.settings,y).render()}return true;case"mceRemoveEditor":if(z){z.remove()}return true;case"mceToggleEditor":if(!z){y.execCommand("mceAddEditor",0,A);return true}if(z.isHidden()){z.show()}else{z.hide()}return true}if(y.activeEditor){return y.activeEditor.execCommand(C,B,A)}return false},triggerSave:function(){u(this.editors,function(y){y.save()})},addI18n:function(z,y){k.add(z,y)},translate:function(y){return k.translate(y)}};p(t,q);t.setup();window.tinymce=window.tinyMCE=t;return t});h("tinymce/LegacyInput",["tinymce/EditorManager","tinymce/util/Tools"],function(k,j){var m=j.each,l=j.explode;k.on("AddEditor",function(o){var n=o.editor;n.on("preInit",function(){var r,u,t,q=n.settings;function p(w,v){m(v,function(y,x){if(y){t.setStyle(w,x,y)}});t.rename(w,"span")}function s(v){t=n.dom;if(q.convert_fonts_to_spans){m(t.select("font,u,strike",v.node),function(w){r[w.nodeName.toLowerCase()](t,w)})}}if(q.inline_styles){u=l(q.font_size_legacy_values);r={font:function(w,v){p(v,{backgroundColor:v.style.backgroundColor,color:v.color,fontFamily:v.face,fontSize:u[parseInt(v.size,10)-1]})},u:function(w,v){p(v,{textDecoration:"underline"})},strike:function(w,v){p(v,{textDecoration:"line-through"})}};n.on("PreProcess SetContent",s)}})})});h("tinymce/util/XHR",[],function(){return{send:function(k){var m,l=0;function j(){if(!k.async||m.readyState==4||l++>10000){if(k.success&&l<10000&&m.status==200){k.success.call(k.success_scope,""+m.responseText,m,k)}else{if(k.error){k.error.call(k.error_scope,l>10000?"TIMED_OUT":"GENERAL",m,k)}}m=null}else{setTimeout(j,10)}}k.scope=k.scope||this;k.success_scope=k.success_scope||k.scope;k.error_scope=k.error_scope||k.scope;k.async=k.async===false?false:true;k.data=k.data||"";m=new XMLHttpRequest();if(m){if(m.overrideMimeType){m.overrideMimeType(k.content_type)}m.open(k.type||(k.data?"POST":"GET"),k.url,k.async);if(k.content_type){m.setRequestHeader("Content-Type",k.content_type)}m.setRequestHeader("X-Requested-With","XMLHttpRequest");m.send(k.data);if(!k.async){return j()}setTimeout(j,10)}}}});h("tinymce/util/JSON",[],function(){function j(q,l){var p,k,n,m;l=l||'"';if(q===null){return"null"}n=typeof q;if(n=="string"){k="\bb\tt\nn\ff\rr\"\"''\\\\";return l+q.replace(/([\u0080-\uFFFF\x00-\x1f\"\'\\])/g,function(r,o){if(l==='"'&&r==="'"){return r}p=k.indexOf(o);if(p+1){return"\\"+k.charAt(p+1)}r=o.charCodeAt().toString(16);return"\\u"+"0000".substring(r.length)+r})+l}if(n=="object"){if(q.hasOwnProperty&&Object.prototype.toString.call(q)==="[object Array]"){for(p=0,k="[";p<q.length;p++){k+=(p>0?",":"")+j(q[p],l)}return k+"]"}k="{";for(m in q){if(q.hasOwnProperty(m)){k+=typeof q[m]!="function"?(k.length>1?","+l:l)+m+l+":"+j(q[m],l):""}}return k+"}"}return""+q}return{serialize:j,parse:function(l){try{return window[String.fromCharCode(101)+"val"]("("+l+")")}catch(k){}}}});h("tinymce/util/JSONRequest",["tinymce/util/JSON","tinymce/util/XHR","tinymce/util/Tools"],function(m,l,k){var n=k.extend;function j(o){this.settings=n({},o);this.count=0}j.sendRPC=function(p){return new j().send(p)};j.prototype={send:function(q){var p=q.error,o=q.success;q=n(this.settings,q);q.success=function(s,r){s=m.parse(s);if(typeof(s)=="undefined"){s={error:"JSON Parse error."}}if(s.error){p.call(q.error_scope||q.scope,s.error,r)}else{o.call(q.success_scope||q.scope,s.result)}};q.error=function(s,r){if(p){p.call(q.error_scope||q.scope,s,r)}};q.data=m.serialize({id:q.id||"c"+(this.count++),method:q.method,params:q.params});q.content_type="application/json";l.send(q)}};return j});h("tinymce/util/JSONP",["tinymce/dom/DOMUtils"],function(j){return{callbacks:{},count:0,send:function(l){var k=this,n=j.DOM,m=l.count!==g?l.count:k.count;var o="tinymce_jsonp_"+m;k.callbacks[m]=function(p){n.remove(o);delete k.callbacks[m];l.callback(p)};n.add(n.doc.body,"script",{id:o,src:l.url,type:"text/javascript"});k.count++}}});h("tinymce/util/LocalStorage",[],function(){var m,l,p,r,s,k;try{if(window.localStorage){return localStorage}}catch(o){}s="tinymce";l=document.documentElement;k=!!l.addBehavior;if(k){l.addBehavior("#default#userData")}function j(){r=[];for(var t in p){r.push(t)}m.length=r.length}function q(){var t,w,v,x=0;p={};if(!k){return}function u(y){var A,z;z=y!==g?x+y:w.indexOf(",",x);if(z===-1||z>w.length){return null}A=w.substring(x,z);x=z+1;return A}l.load(s);w=l.getAttribute(s)||"";do{t=u(parseInt(u(),32)||0);if(t!==null){v=u(parseInt(u(),32)||0);p[t]=v}}while(t!==null);j()}function n(){var v,u="";if(!k){return}for(var t in p){v=p[t];u+=(u?",":"")+t.length.toString(32)+","+t+","+v.length.toString(32)+","+v}l.setAttribute(s,u);l.save(s);j()}m={key:function(t){return r[t]},getItem:function(t){return t in p?p[t]:null},setItem:function(t,u){p[t]=""+u;n()},removeItem:function(t){delete p[t];n()},clear:function(){p={};n()}};q();return m});h("tinymce/Compat",["tinymce/dom/DOMUtils","tinymce/dom/EventUtils","tinymce/dom/ScriptLoader","tinymce/AddOnManager","tinymce/util/Tools","tinymce/Env"],function(n,p,o,m,k,j){var l=window.tinymce;l.DOM=n.DOM;l.ScriptLoader=o.ScriptLoader;l.PluginManager=m.PluginManager;l.ThemeManager=m.ThemeManager;l.dom=l.dom||{};l.dom.Event=p.Event;k.each(k,function(r,q){l[q]=r});k.each("isOpera isWebKit isIE isGecko isMac".split(" "),function(q){l[q]=j[q.substr(2).toLowerCase()]});return{}});h("tinymce/ui/Layout",["tinymce/util/Class","tinymce/util/Tools"],function(j,k){return j.extend({Defaults:{firstControlClass:"first",lastControlClass:"last"},init:function(l){this.settings=k.extend({},this.Defaults,l)},preRender:function(l){l.addClass(this.settings.containerClass,"body")},applyClasses:function(l){var n=this,q=n.settings,m,p,o;m=l.items().filter(":visible");p=q.firstControlClass;o=q.lastControlClass;m.each(function(r){r.removeClass(p).removeClass(o);if(q.controlClass){r.addClass(q.controlClass)}});m.eq(0).addClass(p);m.eq(-1).addClass(o)},renderHtml:function(l){var n=this,p=n.settings,m,o="";m=l.items();m.eq(0).addClass(p.firstControlClass);m.eq(-1).addClass(p.lastControlClass);m.each(function(q){if(p.controlClass){q.addClass(p.controlClass)}o+=q.renderHtml()});return o},recalc:function(){},postRender:function(){}})});h("tinymce/ui/AbsoluteLayout",["tinymce/ui/Layout"],function(j){return j.extend({Defaults:{containerClass:"abs-layout",controlClass:"abs-layout-item"},recalc:function(k){k.items().filter(":visible").each(function(m){var l=m.settings;m.layoutRect({x:l.x,y:l.y,w:l.w,h:l.h});if(m.recalc){m.recalc()}})},renderHtml:function(k){return'<div id="'+k._id+'-absend" class="'+k.classPrefix+'abs-end"></div>'+this._super(k)}})});h("tinymce/ui/Tooltip",["tinymce/ui/Control","tinymce/ui/Movable"],function(k,j){return k.extend({Mixins:[j],Defaults:{classes:"widget tooltip tooltip-n"},text:function(m){var l=this;if(typeof(m)!="undefined"){l._value=m;if(l._rendered){l.getEl().lastChild.innerHTML=l.encode(m)}return l}return l._value},renderHtml:function(){var l=this,m=l.classPrefix;return('<div id="'+l._id+'" class="'+l.classes()+'" role="presentation"><div class="'+m+'tooltip-arrow"></div><div class="'+m+'tooltip-inner">'+l.encode(l._text)+"</div></div>")},repaint:function(){var l=this,m,n;m=l.getEl().style;n=l._layoutRect;m.left=n.x+"px";m.top=n.y+"px";m.zIndex=65535+65535}})});h("tinymce/ui/Widget",["tinymce/ui/Control","tinymce/ui/Tooltip"],function(l,j){var m;var k=l.extend({init:function(o){var n=this;n._super(o);n.canFocus=true;if(o.tooltip&&k.tooltips!==false){n.on("mouseenter mouseleave",function(r){var q=n.tooltip().moveTo(-65535);if(r.control==n&&r.type=="mouseenter"){var p=q.text(o.tooltip).show().testMoveRel(n.getEl(),["bc-tc","bc-tl","bc-tr"]);q.toggleClass("tooltip-n",p=="bc-tc");q.toggleClass("tooltip-nw",p=="bc-tl");q.toggleClass("tooltip-ne",p=="bc-tr");q.moveRel(n.getEl(),p)}else{q.hide()}})}n.aria("label",o.tooltip)},tooltip:function(){var n=this;if(!m){m=new j({type:"tooltip"});m.renderTo(n.getContainerElm())}return m},active:function(p){var n=this,o;if(p!==o){n.aria("pressed",p);n.toggleClass("active",p)}return n._super(p)},disabled:function(p){var n=this,o;if(p!==o){n.aria("disabled",p);n.toggleClass("disabled",p)}return n._super(p)},postRender:function(){var n=this,o=n.settings;n._rendered=true;n._super();if(!n.parent()&&(o.width||o.height)){n.initLayoutRect();n.repaint()}if(o.autofocus){setTimeout(function(){n.focus()},0)}},remove:function(){this._super();if(m){m.remove();m=null}}});return k});h("tinymce/ui/Button",["tinymce/ui/Widget"],function(j){return j.extend({Defaults:{classes:"widget btn",role:"button"},init:function(m){var k=this,l;k.on("click mousedown",function(n){n.preventDefault()});k._super(m);l=m.size;if(m.subtype){k.addClass(m.subtype)}if(l){k.addClass("btn-"+l)}},repaint:function(){var k=this.getEl().firstChild.style;k.width=k.height="100%";this._super()},renderHtml:function(){var k=this,o=k._id,m=k.classPrefix;var l=k.settings.icon,n="";if(k.settings.image){l="none";n=" style=\"background-image: url('"+k.settings.image+"')\""}l=k.settings.icon?m+"ico "+m+"i-"+l:"";return('<div id="'+o+'" class="'+k.classes()+'" tabindex="-1"><button role="presentation" type="button" tabindex="-1">'+(l?'<i class="'+l+'"'+n+"></i>":"")+(k._text?(l?"\u00a0":"")+k.encode(k._text):"")+"</button></div>")}})});h("tinymce/ui/ButtonGroup",["tinymce/ui/Container"],function(j){return j.extend({Defaults:{defaultType:"button",role:"toolbar"},renderHtml:function(){var k=this,l=k._layout;k.addClass("btn-group");k.preRender();l.preRender(k);return('<div id="'+k._id+'" class="'+k.classes()+'"><div id="'+k._id+'-body">'+(k.settings.html||"")+l.renderHtml(k)+"</div></div>")}})});h("tinymce/ui/Checkbox",["tinymce/ui/Widget"],function(j){return j.extend({Defaults:{classes:"checkbox",role:"checkbox",checked:false},init:function(l){var k=this;k._super(l);k.on("click mousedown",function(m){m.preventDefault()});k.on("click",function(m){m.preventDefault();if(!k.disabled()){k.checked(!k.checked())}});k.checked(k.settings.checked)},checked:function(l){var k=this;if(typeof l!="undefined"){if(l){k.addClass("checked")}else{k.removeClass("checked")}k._checked=l;k.aria("checked",l);return k}return k._checked},value:function(k){return this.checked(k)},renderHtml:function(){var k=this,m=k._id,l=k.classPrefix;return('<div id="'+m+'" class="'+k.classes()+'" unselectable="on" aria-labeledby="'+m+'-al" tabindex="-1"><i class="'+l+"ico "+l+'i-checkbox"></i><span id="'+m+'-al" class="'+l+'label">'+k.encode(k._text)+"</span></div>")}})});h("tinymce/ui/PanelButton",["tinymce/ui/Button","tinymce/ui/FloatPanel"],function(j,k){return j.extend({showPanel:function(){var l=this,m=l.settings;l.active(true);if(!l.panel){var n=m.panel;if(n.type){n={layout:"grid",items:n}}n.popover=true;n.autohide=true;l.panel=new k(n).on("hide",function(){l.active(false)}).parent(l).renderTo(l.getContainerElm());l.panel.fire("show");l.panel.reflow()}else{l.panel.show()}l.panel.moveRel(l.getEl(),m.popoverAlign||(l.isRtl()?["bc-tr","bc-tc"]:["bc-tl","bc-tc"]))},hidePanel:function(){var l=this;if(l.panel){l.panel.hide()}},postRender:function(){var l=this;l.on("click",function(m){if(m.control===l){if(l.panel&&l.panel.visible()){l.hidePanel()}else{l.showPanel()}}});return l._super()}})});h("tinymce/ui/ColorButton",["tinymce/ui/PanelButton","tinymce/dom/DOMUtils"],function(k,j){var l=j.DOM;return k.extend({init:function(m){this._super(m);this.addClass("colorbutton")},color:function(m){if(m){this._color=m;this.getEl("preview").style.backgroundColor=m;return this}return this._color},renderHtml:function(){var m=this,q=m._id,o=m.classPrefix;var n=m.settings.icon?o+"ico "+o+"i-"+m.settings.icon:"";var p=m.settings.image?" style=\"background-image: url('"+m.settings.image+"')\"":"";return('<div id="'+q+'" class="'+m.classes()+'"><button role="presentation" hidefocus type="button" tabindex="-1">'+(n?'<i class="'+n+'"'+p+"></i>":"")+'<span id="'+q+'-preview" class="'+o+'preview"></span>'+(m._text?(n?" ":"")+(m._text):"")+'</button><button type="button" class="'+o+'open" hidefocus tabindex="-1"> <i class="'+o+'caret"></i></button></div>')},postRender:function(){var m=this,n=m.settings.onclick;m.on("click",function(o){if(o.control==m&&!l.getParent(o.target,"."+m.classPrefix+"open")){o.stopImmediatePropagation();n.call(m,o)}});delete m.settings.onclick;return m._super()}})});h("tinymce/ui/ComboBox",["tinymce/ui/Widget","tinymce/ui/DomUtils"],function(k,j){return k.extend({init:function(m){var l=this;l._super(m);l.addClass("combobox");l.on("click",function(n){var o=n.target;while(o){if(o.id&&o.id.indexOf("-open")!=-1){l.fire("action")}o=o.parentNode}});l.on("keydown",function(n){if(n.target.nodeName=="INPUT"&&n.keyCode==13){l.parents().reverse().each(function(o){n.preventDefault();l.fire("change");if(o.hasEventListeners("submit")&&o.toJSON){o.fire("submit",{data:o.toJSON()});return false}})}});if(m.placeholder){l.addClass("placeholder");l.on("focusin",function(){if(!l._hasOnChange){j.on(l.getEl("inp"),"change",function(){l.fire("change")});l._hasOnChange=true}if(l.hasClass("placeholder")){l.getEl("inp").value="";l.removeClass("placeholder")}});l.on("focusout",function(){if(l.value().length===0){l.getEl("inp").value=m.placeholder;l.addClass("placeholder")}})}},value:function(m){var l=this;if(typeof(m)!="undefined"){l._value=m;l.removeClass("placeholder");if(l._rendered){l.getEl("inp").value=m}return l}if(l._rendered){m=l.getEl("inp").value;if(m!=l.settings.placeholder){return m}return""}return l._value},disabled:function(m){var l=this;if(l._rendered&&typeof(m)!="undefined"){l.getEl("inp").disabled=m}return l._super(m)},focus:function(){this.getEl("inp").focus()},repaint:function(){var m=this,r=m.getEl(),l=m.getEl("open"),p=m.layoutRect();var o,n;if(l){o=p.w-j.getSize(l).width-10}else{o=p.w-10}var q=document;if(q.all&&(!q.documentMode||q.documentMode<=8)){n=(m.layoutRect().h-2)+"px"}j.css(r.firstChild,{width:o,lineHeight:n});m._super();return m},postRender:function(){var l=this;j.on(this.getEl("inp"),"change",function(){l.fire("change")});return l._super()},remove:function(){j.off(this.getEl("inp"));this._super()},renderHtml:function(){var l=this,s=l._id,n=l.settings,q=l.classPrefix;var p=n.value||n.placeholder||"";var m,r,o="";m=n.icon?q+"ico "+q+"i-"+n.icon:"";r=l._text;if(m||r){o=('<div id="'+s+'-open" class="'+q+"btn "+q+'open" tabIndex="-1"><button id="'+s+'-action" type="button" hidefocus tabindex="-1">'+(m?'<i class="'+m+'"></i>':'<i class="'+q+'caret"></i>')+(r?(m?" ":"")+r:"")+"</button></div>");l.addClass("has-open")}return('<div id="'+s+'" class="'+l.classes()+'"><input id="'+s+'-inp" class="'+q+"textbox "+q+'placeholder" value="'+p+'" hidefocus="true"'+(l.disabled()?' disabled="disabled"':"")+">"+o+"</div>")}})});h("tinymce/ui/Path",["tinymce/ui/Widget","tinymce/ui/KeyboardNavigation"],function(k,j){return k.extend({init:function(m){var l=this;if(!m.delimiter){m.delimiter="\u00BB"}l._super(m);l.addClass("path");l.canFocus=true;l.on("click",function(p){var n,o=p.target;if((n=o.getAttribute("data-index"))){l.fire("select",{value:l.data()[n],index:n})}})},focus:function(){var l=this;l.keyNav=new j({root:l,enableLeftRight:true});l.keyNav.focusFirst();return l},data:function(m){var l=this;if(typeof(m)!=="undefined"){l._data=m;l.update();return l}return l._data},update:function(){this.innerHtml(this._getPathHtml())},postRender:function(){var l=this;l._super();l.data(l.settings.data)},renderHtml:function(){var l=this;return('<div id="'+l._id+'" class="'+l.classes()+'">'+l._getPathHtml()+"</div>")},_getPathHtml:function(){var n=this,r=n._data||[],p,m,o="",q=n.classPrefix;for(p=0,m=r.length;p<m;p++){o+=((p>0?'<div class="'+q+'divider" aria-hidden="true"> '+n.settings.delimiter+" </div>":"")+'<div role="button" class="'+q+"path-item"+(p==m-1?" "+q+"last":"")+'" data-index="'+p+'" tabindex="-1" id="'+n._id+"-"+p+'">'+r[p].name+"</div>")}if(!o){o='<div class="'+q+'path-item">&nbsp;</div>'}return o}})});h("tinymce/ui/ElementPath",["tinymce/ui/Path","tinymce/EditorManager"],function(k,j){return k.extend({postRender:function(){var l=this,m=j.activeEditor;function n(o){return o.nodeType===1&&(o.nodeName=="BR"||!!o.getAttribute("data-mce-bogus"))}l.on("select",function(r){var p=[],q,o=m.getBody();m.focus();q=m.selection.getStart();while(q&&q!=o){if(!n(q)){p.push(q)}q=q.parentNode}m.selection.select(p[p.length-1-r.index]);m.nodeChanged()});m.on("nodeChange",function(s){var q=[],o=s.parents,r=o.length;while(r--){if(o[r].nodeType==1&&!n(o[r])){var p=m.fire("ResolveName",{name:o[r].nodeName.toLowerCase(),target:o[r]});q.push({name:p.name})}}l.data(q)});return l._super()}})});h("tinymce/ui/FormItem",["tinymce/ui/Container"],function(j){return j.extend({Defaults:{layout:"flex",align:"center",defaults:{flex:1}},renderHtml:function(){var k=this,l=k._layout,m=k.classPrefix;k.addClass("formitem");l.preRender(k);return('<div id="'+k._id+'" class="'+k.classes()+'" hideFocus="1" tabIndex="-1">'+(k.settings.title?('<div id="'+k._id+'-title" class="'+m+'title">'+k.settings.title+"</div>"):"")+'<div id="'+k._id+'-body" class="'+k.classes("body")+'">'+(k.settings.html||"")+l.renderHtml(k)+"</div></div>")}})});h("tinymce/ui/Form",["tinymce/ui/Container","tinymce/ui/FormItem"],function(j,k){return j.extend({Defaults:{containerCls:"form",layout:"flex",direction:"column",align:"stretch",flex:1,padding:20,labelGap:30,spacing:10,callbacks:{submit:function(){this.submit()}}},preRender:function(){var m=this,l=m.items();l.each(function(p){var o,n=p.settings.label;if(n){o=new k({layout:"flex",autoResize:"overflow",defaults:{flex:1},items:[{type:"label",text:n,flex:0,forId:p._id}]});o.type="formitem";if(typeof(p.settings.flex)=="undefined"){p.settings.flex=1}m.replace(p,o);o.add(p)}})},recalcLabels:function(){var l=this,o=0,p=[],m,n;if(l.settings.labelGapCalc===false){return}l.items().filter("formitem").each(function(s){var r=s.items()[0],q=r.getEl().clientWidth;o=q>o?q:o;p.push(r)});n=l.settings.labelGap||0;m=p.length;while(m--){p[m].settings.minWidth=o+n}},visible:function(l){var m=this._super(l);if(l===true&&this._rendered){this.recalcLabels()}return m},submit:function(){return this.fire("submit",{data:this.toJSON()})},postRender:function(){var l=this;l._super();l.recalcLabels();l.fromJSON(l.settings.data)}})});h("tinymce/ui/FieldSet",["tinymce/ui/Form"],function(j){return j.extend({Defaults:{containerCls:"fieldset",layout:"flex",direction:"column",align:"stretch",flex:1,padding:"25 15 5 15",labelGap:30,spacing:10,border:1},renderHtml:function(){var k=this,l=k._layout,m=k.classPrefix;k.preRender();l.preRender(k);return('<fieldset id="'+k._id+'" class="'+k.classes()+'" hideFocus="1" tabIndex="-1">'+(k.settings.title?('<legend id="'+k._id+'-title" class="'+m+'fieldset-title">'+k.settings.title+"</legend>"):"")+'<div id="'+k._id+'-body" class="'+k.classes("body")+'">'+(k.settings.html||"")+l.renderHtml(k)+"</div></fieldset>")}})});h("tinymce/ui/FilePicker",["tinymce/ui/ComboBox"],function(j){return j.extend({init:function(m){var k=this,l=tinymce.activeEditor,n;m.spellcheck=false;n=l.settings.file_browser_callback;if(n){m.icon="browse";m.onaction=function(){n(k.getEl("inp").id,k.getEl("inp").value,m.filetype,window)}}k._super(m)}})});h("tinymce/ui/FitLayout",["tinymce/ui/AbsoluteLayout"],function(j){return j.extend({recalc:function(l){var k=l.layoutRect(),m=l.paddingBox();l.items().filter(":visible").each(function(n){n.layoutRect({x:m.left,y:m.top,w:k.innerW-m.right-m.left,h:k.innerH-m.top-m.bottom});if(n.recalc){n.recalc()}})}})});h("tinymce/ui/FlexLayout",["tinymce/ui/AbsoluteLayout"],function(j){return j.extend({recalc:function(N){var aa,V,z,Y,u,D,U,x,n,ab,o,v;var W,m,p,r,t=[],s,G,S,K,L,Z;var R,F,w,q,ad,O,P,y,Q;var H,k,E,T,A,J,X;var M,I;var B=Math.max,ac=Math.min;z=N.items().filter(":visible");Y=N.layoutRect();u=N._paddingBox;D=N.settings;v=N.isRtl()?(D.direction||"row-reversed"):D.direction;U=D.align;x=N.isRtl()?(D.pack||"end"):D.pack;n=D.spacing||0;if(v=="row-reversed"||v=="column-reverse"){z=z.set(z.toArray().reverse());v=v.split("-")[0]}if(v=="column"){w="y";R="h";F="minH";q="maxH";O="innerH";ad="top";P="bottom";y="deltaH";Q="contentH";J="left";E="w";H="x";k="innerW";T="minW";A="maxW";X="right";M="deltaW";I="contentW"}else{w="x";R="w";F="minW";q="maxW";O="innerW";ad="left";P="right";y="deltaW";Q="contentW";J="top";E="h";H="y";k="innerH";T="minH";A="maxH";X="bottom";M="deltaH";I="contentH"}o=Y[O]-u[ad]-u[ad];Z=ab=0;for(aa=0,V=z.length;aa<V;aa++){W=z[aa];m=W.layoutRect();p=W.settings;r=p.flex;o-=(aa<V-1?n:0);if(r>0){ab+=r;if(m[q]){t.push(W)}m.flex=r}o-=m[F];s=u[J]+m[T]+u[X];if(s>Z){Z=s}}K={};if(o<0){K[F]=Y[F]-o+Y[y]}else{K[F]=Y[O]-o+Y[y]}K[T]=Z+Y[M];K[Q]=Y[O]-o;K[I]=Z;K.minW=ac(K.minW,Y.maxW);K.minH=ac(K.minH,Y.maxH);K.minW=B(K.minW,Y.startMinWidth);K.minH=B(K.minH,Y.startMinHeight);if(Y.autoResize&&(K.minW!=Y.minW||K.minH!=Y.minH)){K.w=K.minW;K.h=K.minH;N.layoutRect(K);this.recalc(N);if(N._lastRect===null){var C=N.parent();if(C){C._lastRect=null;C.recalc()}}return}S=o/ab;for(aa=0,V=t.length;aa<V;aa++){W=t[aa];m=W.layoutRect();G=m[q];s=m[F]+Math.ceil(m.flex*S);if(s>G){o-=(m[q]-m[F]);ab-=m.flex;m.flex=0;m.maxFlexSize=G}else{m.maxFlexSize=0}}S=o/ab;L=u[ad];K={};if(ab===0){if(x=="end"){L=o+u[ad]}else{if(x=="center"){L=Math.round((Y[O]/2)-((Y[O]-o)/2))+u[ad];if(L<0){L=u[ad]}}else{if(x=="justify"){L=u[ad];n=Math.floor(o/(z.length-1))}}}}K[H]=u[J];for(aa=0,V=z.length;aa<V;aa++){W=z[aa];m=W.layoutRect();s=m.maxFlexSize||m[F];if(U==="center"){K[H]=Math.round((Y[k]/2)-(m[E]/2))}else{if(U==="stretch"){K[E]=B(m[T]||0,Y[k]-u[J]-u[X]);K[H]=u[J]}else{if(U==="end"){K[H]=Y[k]-m[E]-u.top}}}if(m.flex>0){s+=Math.ceil(m.flex*S)}K[R]=s;K[w]=L;W.layoutRect(K);if(W.recalc){W.recalc()}L+=s+n}}})});h("tinymce/ui/FlowLayout",["tinymce/ui/Layout"],function(j){return j.extend({Defaults:{containerClass:"flow-layout",controlClass:"flow-layout-item",endClass:"break"},recalc:function(k){k.items().filter(":visible").each(function(l){if(l.recalc){l.recalc()}})}})});h("tinymce/ui/FormatControls",["tinymce/ui/Control","tinymce/ui/Widget","tinymce/ui/FloatPanel","tinymce/util/Tools","tinymce/EditorManager","tinymce/Env"],function(o,n,q,k,m,j){var p=k.each;m.on("AddEditor",function(r){if(r.editor.rtl){o.rtl=true}l(r.editor)});o.translate=function(r){return m.translate(r)};n.tooltips=!j.iOS;function l(w){var z;function v(I){var F,K,J=w.dom;var E="",G,H;H=w.settings.preview_styles;if(H===false){return""}if(!H){H="font-family font-size font-weight text-decoration text-transform color background-color border border-radius"}function D(L){return L.replace(/%(\w+)/g,"")}I=w.formatter.get(I);if(!I){return}I=I[0];F=I.block||I.inline||"span";K=J.create(F);p(I.styles,function(M,L){M=D(M);if(M){J.setStyle(K,L,M)}});p(I.attributes,function(M,L){M=D(M);if(M){J.setAttrib(K,L,M)}});p(I.classes,function(L){L=D(L);if(!J.hasClass(K,L)){J.addClass(K,L)}});w.fire("PreviewFormats");J.setStyles(K,{position:"absolute",left:-65535});w.getBody().appendChild(K);G=J.getStyle(w.getBody(),"fontSize",true);G=/px$/.test(G)?parseInt(G,10):0;p(H.split(" "),function(L){var M=J.getStyle(K,L,true);if(L=="background-color"&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(M)){M=J.getStyle(w.getBody(),L,true);if(J.toHex(M).toLowerCase()=="#ffffff"){return}}if(L=="color"){if(J.toHex(M).toLowerCase()=="#000000"){return}}if(L=="font-size"){if(/em|%$/.test(M)){if(G===0){return}M=parseFloat(M,10)/(/%$/.test(M)?100:1);M=(M*G)+"px"}}if(L=="border"&&M){E+="padding:0 2px;"}E+=L+":"+M+";"});w.fire("AfterPreviewFormats");J.remove(K);return E}function s(D,E){return function(){var F=this;w.on("nodeChange",function(I){var G=w.formatter;var H=null;p(I.parents,function(J){p(D,function(K){if(E){if(G.matchNode(J,E,{value:K.value})){H=K.value}}else{if(G.matchNode(J,K.value)){H=K.value}}if(H){return false}});if(H){return false}});F.value(H)})}}function x(D){D=D.split(";");var E=D.length;while(E--){D[E]=D[E].split("=")}return D}function t(){var G=0,F=[];var E=[{title:"Headers",items:[{title:"Header 1",format:"h1"},{title:"Header 2",format:"h2"},{title:"Header 3",format:"h3"},{title:"Header 4",format:"h4"},{title:"Header 5",format:"h5"},{title:"Header 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",icon:"bold",format:"bold"},{title:"Italic",icon:"italic",format:"italic"},{title:"Underline",icon:"underline",format:"underline"},{title:"Strikethrough",icon:"strikethrough",format:"strikethrough"},{title:"Superscript",icon:"superscript",format:"superscript"},{title:"Subscript",icon:"subscript",format:"subscript"},{title:"Code",icon:"code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Alignment",items:[{title:"Left",icon:"alignleft",format:"alignleft"},{title:"Center",icon:"aligncenter",format:"aligncenter"},{title:"Right",icon:"alignright",format:"alignright"},{title:"Justify",icon:"alignjustify",format:"alignjustify"}]}];function D(I){var J=[];if(!I){return}p(I,function(M){var L={text:M.title,icon:M.icon};if(M.items){L.menu=D(M.items)}else{var K=M.format||"custom"+G++;if(!M.format){M.name=K;F.push(M)}L.format=K}J.push(L)});return J}w.on("init",function(){p(F,function(I){w.formatter.register(I.name,I)})});var H=D(w.settings.style_formats||E);H={type:"menu",items:H,onPostRender:function(I){w.fire("renderFormatsMenu",{control:I.control})},itemDefaults:{preview:true,textStyle:function(){if(this.settings.format){return v(this.settings.format)}},onPostRender:function(){var I=this,J=this.settings.format;if(J){I.parent().on("show",function(){I.disabled(!w.formatter.canApply(J));I.active(w.formatter.match(J))})}},onclick:function(){if(this.settings.format){A(this.settings.format)}}}};return H}z=t();p({bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",subscript:"Subscript",superscript:"Superscript"},function(E,D){w.addButton(D,{tooltip:E,onPostRender:function(){var F=this;if(w.formatter){w.formatter.formatChanged(D,function(G){F.active(G)})}else{w.on("init",function(){w.formatter.formatChanged(D,function(G){F.active(G)})})}},onclick:function(){A(D)}})});p({outdent:["Decrease indent","Outdent"],indent:["Increase indent","Indent"],cut:["Cut","Cut"],copy:["Copy","Copy"],paste:["Paste","Paste"],help:["Help","mceHelp"],selectall:["Select all","SelectAll"],hr:["Insert horizontal rule","InsertHorizontalRule"],removeformat:["Clear formatting","RemoveFormat"],visualaid:["Visual aids","mceToggleVisualAid"],newdocument:["New document","mceNewDocument"]},function(E,D){w.addButton(D,{tooltip:E[0],cmd:E[1]})});p({blockquote:["Toggle blockquote","mceBlockQuote"],numlist:["Numbered list","InsertOrderedList"],bullist:["Bullet list","InsertUnorderedList"],subscript:["Subscript","Subscript"],superscript:["Superscript","Superscript"],alignleft:["Align left","JustifyLeft"],aligncenter:["Align center","JustifyCenter"],alignright:["Align right","JustifyRight"],alignjustify:["Justify","JustifyFull"]},function(E,D){w.addButton(D,{tooltip:E[0],cmd:E[1],onPostRender:function(){var F=this;if(w.formatter){w.formatter.formatChanged(D,function(G){F.active(G)})}else{w.on("init",function(){w.formatter.formatChanged(D,function(G){F.active(G)})})}}})});function u(){return w.undoManager?w.undoManager.hasUndo():false}function r(){return w.undoManager?w.undoManager.hasRedo():false}function y(){var D=this;D.disabled(!u());w.on("Undo Redo AddUndo TypingUndo",function(){D.disabled(!u())})}function C(){var D=this;D.disabled(!r());w.on("Undo Redo AddUndo TypingUndo",function(){D.disabled(!r())})}function B(){var D=this;w.on("VisualAid",function(E){D.active(E.hasVisual)});D.active(w.hasVisual)}w.addButton("undo",{tooltip:"Undo",onPostRender:y,cmd:"undo"});w.addButton("redo",{tooltip:"Redo",onPostRender:C,cmd:"redo"});w.addMenuItem("newdocument",{text:"New document",shortcut:"Ctrl+N",icon:"newdocument",cmd:"mceNewDocument"});w.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Ctrl+Z",onPostRender:y,cmd:"undo"});w.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Ctrl+Y",onPostRender:C,cmd:"redo"});w.addMenuItem("visualaid",{text:"Visual aids",selectable:true,onPostRender:B,cmd:"mceToggleVisualAid"});p({cut:["Cut","Cut","Ctrl+X"],copy:["Copy","Copy","Ctrl+C"],paste:["Paste","Paste","Ctrl+V"],selectall:["Select all","SelectAll","Ctrl+A"],bold:["Bold","Bold","Ctrl+B"],italic:["Italic","Italic","Ctrl+I"],underline:["Underline","Underline"],strikethrough:["Strikethrough","Strikethrough"],subscript:["Subscript","Subscript"],superscript:["Superscript","Superscript"],removeformat:["Clear formatting","RemoveFormat"]},function(E,D){w.addMenuItem(D,{text:E[0],icon:D,shortcut:E[2],cmd:E[1]})});w.on("mousedown",function(){q.hideAll()});function A(D){if(D.control){D=D.control.value()}if(D){w.execCommand("mceToggleFormat",false,D)}}w.addButton("styleselect",{type:"menubutton",text:"Formats",menu:z});w.addButton("formatselect",function(){var D=[],E=x(w.settings.block_formats||"Paragraph=p;Address=address;Pre=pre;Header 1=h1;Header 2=h2;Header 3=h3;Header 4=h4;Header 5=h5;Header 6=h6");p(E,function(F){D.push({text:F[0],value:F[1],textStyle:function(){return v(F[1])}})});return{type:"listbox",text:{raw:E[0][0]},values:D,fixedWidth:true,onselect:A,onPostRender:s(D)}});w.addButton("fontselect",function(){var E="Andale Mono=andale mono,times;Arial=arial,helvetica,sans-serif;Arial Black=arial black,avant garde;Book Antiqua=book antiqua,palatino;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier;Georgia=georgia,palatino;Helvetica=helvetica;Impact=impact,chicago;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco;Times New Roman=times new roman,times;Trebuchet MS=trebuchet ms,geneva;Verdana=verdana,geneva;Webdings=webdings;Wingdings=wingdings,zapf dingbats";var D=[],F=x(w.settings.font_formats||E);p(F,function(G){D.push({text:{raw:G[0]},value:G[1],textStyle:G[1].indexOf("dings")==-1?"font-family:"+G[1]:""})});return{type:"listbox",text:"Font Family",tooltip:"Font Family",values:D,fixedWidth:true,onPostRender:s(D,"fontname"),onselect:function(G){if(G.control.settings.value){w.execCommand("FontName",false,G.control.settings.value)}}}});w.addButton("fontsizeselect",function(){var D=[],F="8pt 10pt 12pt 14pt 18pt 24pt 36pt";var E=w.settings.fontsize_formats||F;p(E.split(" "),function(G){D.push({text:G,value:G})});return{type:"listbox",text:"Font Sizes",tooltip:"Font Sizes",values:D,fixedWidth:true,onPostRender:s(D,"fontsize"),onclick:function(G){if(G.control.settings.value){w.execCommand("FontSize",false,G.control.settings.value)}}}});w.addMenuItem("formats",{text:"Formats",menu:z})}});h("tinymce/ui/GridLayout",["tinymce/ui/AbsoluteLayout"],function(j){return j.extend({recalc:function(G){var V=G.settings,U,w,z,R,l,p,E,o,Q,K,J,I,H,r,t,O,u,q,n,S,B,A,M=[],k=[],C,W,P,N,s,v;V=G.settings;z=G.items().filter(":visible");R=G.layoutRect();w=V.columns||Math.ceil(Math.sqrt(z.length));U=Math.ceil(z.length/w);u=V.spacingH||V.spacing||0;q=V.spacingV||V.spacing||0;n=V.alignH||V.align;S=V.alignV||V.align;t=G._paddingBox;if(n&&typeof(n)=="string"){n=[n]}if(S&&typeof(S)=="string"){S=[S]}for(K=0;K<w;K++){M.push(0)}for(J=0;J<U;J++){k.push(0)}for(J=0;J<U;J++){for(K=0;K<w;K++){Q=z[J*w+K];if(!Q){break}o=Q.layoutRect();C=o.minW;W=o.minH;M[K]=C>M[K]?C:M[K];k[J]=W>k[J]?W:k[J]}}s=R.innerW-t.left-t.right;for(B=0,K=0;K<w;K++){B+=M[K]+(K>0?u:0);s-=(K>0?u:0)+M[K]}v=R.innerH-t.top-t.bottom;for(A=0,J=0;J<U;J++){A+=k[J]+(J>0?q:0);v-=(J>0?q:0)+k[J]}B+=t.left+t.right;A+=t.top+t.bottom;E={};E.minW=B+(R.w-R.innerW);E.minH=A+(R.h-R.innerH);E.contentW=E.minW-R.deltaW;E.contentH=E.minH-R.deltaH;E.minW=Math.min(E.minW,R.maxW);E.minH=Math.min(E.minH,R.maxH);E.minW=Math.max(E.minW,R.startMinWidth);E.minH=Math.max(E.minH,R.startMinHeight);if(R.autoResize&&(E.minW!=R.minW||E.minH!=R.minH)){E.w=E.minW;E.h=E.minH;G.layoutRect(E);this.recalc(G);if(G._lastRect===null){var D=G.parent();if(D){D._lastRect=null;D.recalc()}}return}if(R.autoResize){E=G.layoutRect(E);E.contentW=E.minW-R.deltaW;E.contentH=E.minH-R.deltaH}var F;if(V.packV=="start"){F=0}else{F=v>0?Math.floor(v/U):0}var T=0;var m=V.flexWidths;if(m){for(K=0;K<m.length;K++){T+=m[K]}}else{T=w}var L=s/T;for(K=0;K<w;K++){M[K]+=m?Math.ceil(m[K]*L):L}H=t.top;for(J=0;J<U;J++){I=t.left;p=k[J]+F;for(K=0;K<w;K++){Q=z[J*w+K];if(!Q){break}r=Q.settings;o=Q.layoutRect();l=M[K];P=N=0;o.x=I;o.y=H;O=r.alignH||(n?(n[K]||n[0]):null);if(O=="center"){o.x=I+(l/2)-(o.w/2)}else{if(O=="right"){o.x=I+l-o.w}else{if(O=="stretch"){o.w=l}}}O=r.alignV||(S?(S[K]||S[0]):null);if(O=="center"){o.y=H+(p/2)-(o.h/2)}else{if(O=="bottom"){o.y=H+p-o.h}else{if(O=="stretch"){o.h=p}}}Q.layoutRect(o);I+=l+u;if(Q.recalc){Q.recalc()}}H+=p+q}}})});h("tinymce/ui/Iframe",["tinymce/ui/Widget"],function(j){return j.extend({renderHtml:function(){var k=this;k.addClass("iframe");k.canFocus=false;return('<iframe id="'+k._id+'" class="'+k.classes()+'" tabindex="-1" src="'+(k.settings.url||"javascript:''")+'" frameborder="0"></iframe>')},src:function(k){this.getEl().src=k},html:function(m,n){var l=this,k=this.getEl().contentWindow.document.body;if(!k){setTimeout(function(){l.html(m)},0)}else{k.innerHTML=m;if(n){n()}}return this}})});h("tinymce/ui/Label",["tinymce/ui/Widget","tinymce/ui/DomUtils"],function(k,j){return k.extend({init:function(m){var l=this;l._super(m);l.addClass("widget");l.addClass("label");l.canFocus=false;if(m.multiline){l.addClass("autoscroll")}if(m.strong){l.addClass("strong")}},initLayoutRect:function(){var l=this,n=l._super();if(l.settings.multiline){var m=j.getSize(l.getEl());if(m.width>n.maxW){n.minW=n.maxW;l.addClass("multiline")}l.getEl().style.width=n.minW+"px";n.startMinH=n.h=n.minH=Math.min(n.maxH,j.getSize(l.getEl()).height)}return n},repaint:function(){var l=this;if(!l.settings.multiline){l.getEl().style.lineHeight=l.layoutRect().h+"px"}return l._super()},text:function(m){var l=this;if(l._rendered&&m){this.innerHtml(l.encode(m))}return l._super(m)},renderHtml:function(){var m=this,l=m.settings.forId;return('<label id="'+m._id+'" class="'+m.classes()+'"'+(l?' for="'+l:"")+'">'+m.encode(m._text)+"</label>")}})});h("tinymce/ui/Toolbar",["tinymce/ui/Container","tinymce/ui/KeyboardNavigation"],function(j,k){return j.extend({Defaults:{role:"toolbar",layout:"flow"},init:function(m){var l=this;l._super(m);l.addClass("toolbar")},postRender:function(){var l=this;l.items().addClass("toolbar-item");l.keyNav=new k({root:l,enableLeftRight:true});return l._super()}})});h("tinymce/ui/MenuBar",["tinymce/ui/Toolbar"],function(j){return j.extend({Defaults:{role:"menubar",containerCls:"menubar",defaults:{type:"menubutton"}}})});h("tinymce/ui/MenuButton",["tinymce/ui/Button","tinymce/ui/Factory","tinymce/ui/MenuBar"],function(m,k,l){function j(p,o){while(p){if(o===p){return true}p=p.parentNode}return false}var n=m.extend({init:function(p){var o=this;o._renderOpen=true;o._super(p);o.addClass("menubtn");if(p.fixedWidth){o.addClass("fixed-width")}o.aria("haspopup",true);o.hasPopup=true},showMenu:function(){var o=this,p=o.settings,q;if(o.menu&&o.menu.visible()){return o.hideMenu()}if(!o.menu){q=p.menu||[];if(q.length){q={type:"menu",items:q}}else{q.type=q.type||"menu"}o.menu=k.create(q).parent(o).renderTo(o.getContainerElm());o.fire("createmenu");o.menu.reflow();o.menu.on("cancel",function(r){if(r.control===o.menu){o.focus()}});o.menu.on("show hide",function(r){if(r.control==o.menu){o.activeMenu(r.type=="show")}}).fire("show");o.aria("expanded",true)}o.menu.show();o.menu.layoutRect({w:o.layoutRect().w});o.menu.moveRel(o.getEl(),o.isRtl()?["br-tr","tr-br"]:["bl-tl","tl-bl"])},hideMenu:function(){var o=this;if(o.menu){o.menu.items().each(function(p){if(p.hideMenu){p.hideMenu()}});o.menu.hide();o.aria("expanded",false)}},activeMenu:function(o){this.toggleClass("active",o)},renderHtml:function(){var o=this,r=o._id,q=o.classPrefix;var p=o.settings.icon?q+"ico "+q+"i-"+o.settings.icon:"";o.aria("role",o.parent() instanceof l?"menuitem":"button");return('<div id="'+r+'" class="'+o.classes()+'" tabindex="-1"><button id="'+r+'-open" role="presentation" type="button" tabindex="-1">'+(p?'<i class="'+p+'"></i>':"")+"<span>"+(o._text?(p?"\u00a0":"")+o.encode(o._text):"")+'</span> <i class="'+q+'caret"></i></button></div>')},postRender:function(){var o=this;o.on("click",function(p){if(p.control===o&&j(p.target,o.getEl())){o.showMenu();if(p.keyboard){o.menu.items()[0].focus()}}});o.on("mouseenter",function(s){var p=s.control,r=o.parent(),q;if(p&&r&&p instanceof n&&p.parent()==r){r.items().filter("MenuButton").each(function(t){if(t.hideMenu&&t!=p){if(t.menu&&t.menu.visible()){q=true}t.hideMenu()}});if(q){p.focus();p.showMenu()}}});return o._super()},text:function(r){var o=this,q,p;if(o._rendered){p=o.getEl("open").getElementsByTagName("span");for(q=0;q<p.length;q++){p[q].innerHTML=o.encode(r)}}return this._super(r)},remove:function(){this._super();if(this.menu){this.menu.remove()}}});return n});h("tinymce/ui/ListBox",["tinymce/ui/MenuButton"],function(j){return j.extend({init:function(p){var m=this,l,n,o,q,k;m._values=l=p.values;if(l){for(n=0;n<l.length;n++){o=l[n].selected||p.value===l[n].value;if(o){q=q||l[n].text;m._value=l[n].value}}p.menu=l}p.text=p.text||q||l[0].text;m._super(p);m.addClass("listbox");m.on("select",function(s){var r=s.control;if(k){s.lastControl=k}if(p.multiple){r.active(!r.active())}else{m.value(s.control.settings.value)}k=r})},value:function(m){var k=this,n,q,p,l;function o(s,r){s.items().each(function(t){n=t.value()===r;if(n){q=q||t.text()}t.active(n);if(t.menu){o(t.menu,r)}})}if(typeof(m)!="undefined"){if(k.menu){o(k.menu,m)}else{p=k.settings.menu;for(l=0;l<p.length;l++){n=p[l].value==m;if(n){q=q||p[l].text}p[l].active=n}}k.text(q||this.settings.text)}return k._super(m)}})});h("tinymce/ui/MenuItem",["tinymce/ui/Widget","tinymce/ui/Factory"],function(k,j){return k.extend({Defaults:{border:0,role:"menuitem"},init:function(m){var l=this;l.hasPopup=true;l._super(m);m=l.settings;l.addClass("menu-item");if(m.menu){l.addClass("menu-item-expand")}if(m.preview){l.addClass("menu-item-preview")}if(l._text==="-"||l._text==="|"){l.addClass("menu-item-sep");l.aria("role","separator");l.canFocus=false;l._text="-"}if(m.selectable){l.aria("role","menuitemcheckbox");l.aria("checked",true);l.addClass("menu-item-checkbox");m.icon="selected"}if(!m.preview&&!m.selectable){l.addClass("menu-item-normal")}l.on("mousedown",function(n){n.preventDefault()});l.on("mouseenter click",function(n){if(n.control===l){if(!m.menu&&n.type==="click"){l.parent().hideAll();l.fire("cancel");l.fire("select")}else{l.showMenu();if(n.keyboard){setTimeout(function(){l.menu.items()[0].focus()},0)}}}});if(m.menu){l.aria("haspopup",true)}},hasMenus:function(){return !!this.settings.menu},showMenu:function(){var m=this,o=m.settings,p,n=m.parent();n.items().each(function(q){if(q!==m){q.hideMenu()}});if(o.menu){p=m.menu;if(!p){p=o.menu;if(p.length){p={type:"menu",items:p}}else{p.type=p.type||"menu"}if(n.settings.itemDefaults){p.itemDefaults=n.settings.itemDefaults}p=m.menu=j.create(p).parent(m).renderTo(m.getContainerElm());p.reflow();p.fire("show");p.on("cancel",function(){m.focus()});p.on("hide",function(q){if(q.control===p){m.removeClass("selected")}})}else{p.show()}p._parentMenu=n;p.addClass("menu-sub");var l=p.testMoveRel(m.getEl(),m.isRtl()?["tl-tr","bl-br","tr-tl","br-bl"]:["tr-tl","br-bl","tl-tr","bl-br"]);p.moveRel(m.getEl(),l);l="menu-sub-"+l;p.removeClass(p._lastRel);p.addClass(l);p._lastRel=l;m.addClass("selected");m.aria("expanded",true)}},hideMenu:function(){var l=this;if(l.menu){l.menu.items().each(function(m){if(m.hideMenu){m.hideMenu()}});l.menu.hide();l.aria("expanded",false)}return l},renderHtml:function(){var l=this,r=l._id,n=l.settings,o=l.classPrefix,q=l.encode(l._text);var m=l.settings.icon,p="";if(m){l.parent().addClass("menu-has-icons")}if(n.image){m="none";p=" style=\"background-image: url('"+n.image+"')\""}m=o+"ico "+o+"i-"+(l.settings.icon||"none");return('<div id="'+r+'" class="'+l.classes()+'" tabindex="-1">'+(q!=="-"?'<i class="'+m+'"'+p+"></i>&nbsp;":"")+(q!=="-"?'<span id="'+r+'-text" class="'+o+'text">'+q+"</span>":"")+(n.shortcut?'<div id="'+r+'-shortcut" class="'+o+'menu-shortcut">'+n.shortcut+"</div>":"")+(n.menu?'<div class="'+o+'caret"></div>':"")+"</div>")},postRender:function(){var m=this,n=m.settings;var o=n.textStyle;if(typeof(o)=="function"){o=o.call(this)}if(o){var l=m.getEl("text");if(l){l.setAttribute("style",o)}}return m._super()},remove:function(){this._super();if(this.menu){this.menu.remove()}}})});h("tinymce/ui/Menu",["tinymce/ui/FloatPanel","tinymce/ui/KeyboardNavigation","tinymce/ui/MenuItem","tinymce/util/Tools"],function(n,k,m,j){var l=n.extend({Defaults:{defaultType:"menuitem",border:1,layout:"stack",role:"menu"},init:function(r){var p=this;r.autohide=true;r.constrainToViewport=true;if(r.itemDefaults){var o=r.items,q=o.length;while(q--){o[q]=j.extend({},r.itemDefaults,o[q])}}p._super(r);p.addClass("menu");p.keyNav=new k({root:p,enableUpDown:true,enableLeftRight:true,leftAction:function(){if(p.parent() instanceof m){p.keyNav.cancel()}},onCancel:function(){p.fire("cancel",{},false);p.hide()}})},repaint:function(){this.toggleClass("menu-align",true);this._super();this.getEl().style.height="";this.getEl("body").style.height="";return this},cancel:function(){var o=this;o.hideAll();o.fire("cancel");o.fire("select")},hideAll:function(){var o=this;this.find("menuitem").exec("hideMenu");return o._super()},preRender:function(){var o=this;o.items().each(function(q){var p=q.settings;if(p.icon||p.selectable){o._hasIcons=true;return false}});return o._super()}});return l});h("tinymce/ui/Radio",["tinymce/ui/Checkbox"],function(j){return j.extend({Defaults:{classes:"radio",role:"radio"}})});h("tinymce/ui/ResizeHandle",["tinymce/ui/Widget","tinymce/ui/DragHelper"],function(k,j){return k.extend({renderHtml:function(){var l=this,m=l.classPrefix;l.addClass("resizehandle");if(l.settings.direction=="both"){l.addClass("resizehandle-both")}l.canFocus=false;return('<div id="'+l._id+'" class="'+l.classes()+'"><i class="'+m+"ico "+m+'i-resize"></i></div>')},postRender:function(){var l=this;l._super();l.resizeDragHelper=new j(this._id,{start:function(){l.fire("ResizeStart")},drag:function(m){if(l.settings.direction!="both"){m.deltaX=0}l.fire("Resize",m)},end:function(){l.fire("ResizeEnd")}})},remove:function(){if(this.resizeDragHelper){this.resizeDragHelper.destroy()}return this._super()}})});h("tinymce/ui/Spacer",["tinymce/ui/Widget"],function(j){return j.extend({renderHtml:function(){var k=this;k.addClass("spacer");k.canFocus=false;return'<div id="'+k._id+'" class="'+k.classes()+'"></div>'}})});h("tinymce/ui/SplitButton",["tinymce/ui/MenuButton","tinymce/ui/DomUtils"],function(k,j){return k.extend({Defaults:{classes:"widget btn splitbtn",role:"splitbutton"},repaint:function(){var l=this,q=l.getEl(),o=l.layoutRect(),m,p,n;l._super();m=q.firstChild;p=q.lastChild;j.css(m,{width:o.w-j.getSize(p).width,height:o.h-2});j.css(p,{height:o.h-2});n=m.firstChild.style;n.width=n.height="100%";n=p.firstChild.style;n.width=n.height="100%";return l},activeMenu:function(m){var l=this;j.toggleClass(l.getEl().lastChild,l.classPrefix+"active",m)},renderHtml:function(){var l=this,o=l._id,n=l.classPrefix;var m=l.settings.icon?n+"ico "+n+"i-"+l.settings.icon:"";return('<div id="'+o+'" class="'+l.classes()+'"><button type="button" hidefocus tabindex="-1">'+(m?'<i class="'+m+'"></i>':"")+(l._text?(m?" ":"")+l._text:"")+'</button><button type="button" class="'+n+'open" hidefocus tabindex="-1">'+(l._menuBtnText?(m?"\u00a0":"")+l._menuBtnText:"")+' <i class="'+n+'caret"></i></button></div>')},postRender:function(){var l=this,m=l.settings.onclick;l.on("click",function(o){var n=o.target;if(o.control==this){while(n){if(n.nodeName=="BUTTON"&&n.className.indexOf("open")==-1){o.stopImmediatePropagation();m.call(this,o);return}n=n.parentNode}}});delete l.settings.onclick;return l._super()}})});h("tinymce/ui/StackLayout",["tinymce/ui/FlowLayout"],function(j){return j.extend({Defaults:{containerClass:"stack-layout",controlClass:"stack-layout-item",endClass:"break"}})});h("tinymce/ui/TabPanel",["tinymce/ui/Panel","tinymce/ui/DomUtils"],function(k,j){return k.extend({lastIdx:0,Defaults:{layout:"absolute",defaults:{type:"panel"}},activateTab:function(l){if(this.activeTabId){j.removeClass(this.getEl(this.activeTabId),this.classPrefix+"active")}this.activeTabId="t"+l;j.addClass(this.getEl("t"+l),this.classPrefix+"active");if(l!=this.lastIdx){this.items()[this.lastIdx].hide();this.lastIdx=l}this.items()[l].show().fire("showtab");this.reflow()},renderHtml:function(){var m=this,n=m._layout,l="",o=m.classPrefix;m.preRender();n.preRender(m);m.items().each(function(q,p){l+=('<div id="'+m._id+"-t"+p+'" class="'+o+'tab" unselectable="on">'+m.encode(q.settings.title)+"</div>")});return('<div id="'+m._id+'" class="'+m.classes()+'" hideFocus="1" tabIndex="-1"><div id="'+m._id+'-head" class="'+o+'tabs">'+l+'</div><div id="'+m._id+'-body" class="'+m.classes("body")+'">'+n.renderHtml(m)+"</div></div>")},postRender:function(){var l=this;l._super();l.settings.activeTab=l.settings.activeTab||0;l.activateTab(l.settings.activeTab);this.on("click",function(o){var n=o.target.parentNode;if(o.target.parentNode.id==l._id+"-head"){var m=n.childNodes.length;while(m--){if(n.childNodes[m]==o.target){l.activateTab(m)}}}})},initLayoutRect:function(){var m=this,p,l,o;l=j.getSize(m.getEl("head")).width;l=l<0?0:l;o=0;m.items().each(function(r,q){l=Math.max(l,r.layoutRect().minW);o=Math.max(o,r.layoutRect().minH);if(m.settings.activeTab!=q){r.hide()}});m.items().each(function(q){q.settings.x=0;q.settings.y=0;q.settings.w=l;q.settings.h=o;q.layoutRect({x:0,y:0,w:l,h:o})});var n=j.getSize(m.getEl("head")).height;m.settings.minWidth=l;m.settings.minHeight=o+n;p=m._super();p.deltaH+=n;p.innerH=p.h-p.deltaH;return p}})});h("tinymce/ui/TextBox",["tinymce/ui/Widget","tinymce/ui/DomUtils"],function(k,j){return k.extend({init:function(m){var l=this;l._super(m);l._value=m.value||"";l.addClass("textbox");if(m.multiline){l.addClass("multiline")}else{l.on("keydown",function(n){if(n.keyCode==13){l.parents().reverse().each(function(o){n.preventDefault();if(o.hasEventListeners("submit")&&o.toJSON){o.fire("submit",{data:o.toJSON()});return false}})}})}},disabled:function(m){var l=this;if(l._rendered&&typeof(m)!="undefined"){l.getEl().disabled=m}return l._super(m)},value:function(m){var l=this;if(typeof(m)!="undefined"){l._value=m;if(l._rendered){l.getEl().value=m}return l}if(l._rendered){return l.getEl().value}return l._value},repaint:function(){var m=this,o,p,s,n=0,q=0,l;o=m.getEl().style;p=m._layoutRect;l=m._lastRepaintRect||{};var r=document;if(!m.settings.multiline&&r.all&&(!r.documentMode||r.documentMode<=8)){o.lineHeight=(p.h-q)+"px"}s=m._borderBox;n=s.left+s.right+8;q=s.top+s.bottom+(m.settings.multiline?8:0);if(p.x!==l.x){o.left=p.x+"px";l.x=p.x}if(p.y!==l.y){o.top=p.y+"px";l.y=p.y}if(p.w!==l.w){o.width=(p.w-n)+"px";l.w=p.w}if(p.h!==l.h){o.height=(p.h-q)+"px";l.h=p.h}m._lastRepaintRect=l;m.fire("repaint",{},false);return m},renderHtml:function(){var l=this,p=l._id,m=l.settings,o=l.encode(l._value,false),n="";if("spellcheck" in m){n+=' spellcheck="'+m.spellcheck+'"'}if(m.maxLength){n+=' maxlength="'+m.maxLength+'"'}if(m.size){n+=' size="'+m.size+'"'}if(m.subtype){n+=' type="'+m.subtype+'"'}if(l.disabled()){n+=' disabled="disabled"'}if(m.multiline){return('<textarea id="'+p+'" class="'+l.classes()+'" '+(m.rows?' rows="'+m.rows+'"':"")+' hidefocus="true"'+n+">"+o+"</textarea>")}return'<input id="'+p+'" class="'+l.classes()+'" value="'+o+'" hidefocus="true"'+n+">"},postRender:function(){var l=this;j.on(l.getEl(),"change",function(m){l.fire("change",m)});return l._super()},remove:function(){j.off(this.getEl());this._super()}})});h("tinymce/ui/Throbber",["tinymce/ui/DomUtils"],function(j){return function(m){var k=this,l;k.show=function(n){k.hide();l=true;window.setTimeout(function(){if(l){m.appendChild(j.createFragment('<div class="mce-throbber"></div>'))}},n||0);return k};k.hide=function(){var n=m.lastChild;if(n&&n.className.indexOf("throbber")!=-1){n.parentNode.removeChild(n)}l=false;return k}}});a(["tinymce/dom/EventUtils","tinymce/dom/Sizzle","tinymce/dom/DomQuery","tinymce/html/Styles","tinymce/dom/TreeWalker","tinymce/util/Tools","tinymce/dom/Range","tinymce/html/Entities","tinymce/Env","tinymce/dom/DOMUtils","tinymce/dom/ScriptLoader","tinymce/AddOnManager","tinymce/html/Node","tinymce/html/Schema","tinymce/html/SaxParser","tinymce/html/DomParser","tinymce/html/Writer","tinymce/html/Serializer","tinymce/dom/Serializer","tinymce/dom/TridentSelection","tinymce/util/VK","tinymce/dom/ControlSelection","tinymce/dom/Selection","tinymce/dom/RangeUtils","tinymce/Formatter","tinymce/UndoManager","tinymce/EnterKey","tinymce/ForceBlocks","tinymce/EditorCommands","tinymce/util/URI","tinymce/util/Class","tinymce/ui/Selector","tinymce/ui/Collection","tinymce/ui/DomUtils","tinymce/ui/Control","tinymce/ui/Factory","tinymce/ui/Container","tinymce/ui/DragHelper","tinymce/ui/Scrollable","tinymce/ui/Panel","tinymce/ui/Movable","tinymce/ui/Resizable","tinymce/ui/FloatPanel","tinymce/ui/KeyboardNavigation","tinymce/ui/Window","tinymce/ui/MessageBox","tinymce/WindowManager","tinymce/util/Quirks","tinymce/util/Observable","tinymce/Shortcuts","tinymce/Editor","tinymce/util/I18n","tinymce/FocusManager","tinymce/EditorManager","tinymce/LegacyInput","tinymce/util/XHR","tinymce/util/JSON","tinymce/util/JSONRequest","tinymce/util/JSONP","tinymce/util/LocalStorage","tinymce/Compat","tinymce/ui/Layout","tinymce/ui/AbsoluteLayout","tinymce/ui/Tooltip","tinymce/ui/Widget","tinymce/ui/Button","tinymce/ui/ButtonGroup","tinymce/ui/Checkbox","tinymce/ui/PanelButton","tinymce/ui/ColorButton","tinymce/ui/ComboBox","tinymce/ui/Path","tinymce/ui/ElementPath","tinymce/ui/FormItem","tinymce/ui/Form","tinymce/ui/FieldSet","tinymce/ui/FilePicker","tinymce/ui/FitLayout","tinymce/ui/FlexLayout","tinymce/ui/FlowLayout","tinymce/ui/FormatControls","tinymce/ui/GridLayout","tinymce/ui/Iframe","tinymce/ui/Label","tinymce/ui/Toolbar","tinymce/ui/MenuBar","tinymce/ui/MenuButton","tinymce/ui/ListBox","tinymce/ui/MenuItem","tinymce/ui/Menu","tinymce/ui/Radio","tinymce/ui/ResizeHandle","tinymce/ui/Spacer","tinymce/ui/SplitButton","tinymce/ui/StackLayout","tinymce/ui/TabPanel","tinymce/ui/TextBox","tinymce/ui/Throbber"])})(this);!function(f){function c(e){!a&&window&&window.console&&(a=!0,console.log("Deprecated TinyMCE API call: "+e))}function b(j,g,h,e){j=j||this,this.add=function(l,k){function m(o){var p=[];if("string"==typeof h&&(h=h.split(" ")),h&&"function"!=typeof h){for(var n=0;n<h.length;n++){p.push(o[h[n]])}}("function"!=typeof h||(p=h(g,o,j)))&&(h||(p=[o]),p.unshift(e||j),l.apply(k||e||j,p)===!1&&o.stopImmediatePropagation())}return c("<target>.on"+g+".add(..)"),j.on(g,m),m},this.addToTop=this.add,this.remove=function(k){return j.off(g,k)},this.dispatch=function(){return j.fire(g),!0}}function d(k){function g(m,l){f.each(m.split(" "),function(o){k["on"+o]=new b(k,o,l)})}function h(o,m,l){return[m.level,l]}function e(l){return function(n,m){return !m.selection&&!l||m.selection==l?[m]:void 0}}if(!k.controlManager){k.controlManager={buttons:{},setDisabled:function(m,l){c("controlManager.setDisabled(..)"),this.buttons[m]&&this.buttons[m].disabled(l)},setActive:function(m,l){c("controlManager.setActive(..)"),this.buttons[m]&&this.buttons[m].active(l)}},g("PreInit BeforeRenderUI PostRender Load Init Remove Activate Deactivate","editor"),g("Click MouseUp MouseDown DblClick KeyDown KeyUp KeyPress ContextMenu Paste Submit Reset"),g("BeforeExecCommand ExecCommand","command ui value args"),g("PreProcess PostProcess LoadContent SaveContent Change"),g("BeforeSetContent BeforeGetContent SetContent GetContent",e(!1)),g("SetProgressState","state time"),g("VisualAid","element hasVisual"),g("Undo Redo",h),g("NodeChange",function(m,l){return[k.controlManager,l.element,k.selection.isCollapsed(),l]});var j=k.addButton;k.addButton=function(p,n){function m(){return k.controlManager.buttons[p]=this,o?o.call(this):void 0}var o;for(var l in n){"onpostrender"===l.toLowerCase()&&(o=n[l],n.onPostRender=m)}return o||(n.onPostRender=m),n.title=f.i18n.translate((k.settings.language||"en")+"."+n.title),j.call(this,p,n)},k.on("init",function(){var l=k.undoManager,m=k.selection;l.onUndo=new b(k,"Undo",h,null,l),l.onRedo=new b(k,"Redo",h,null,l),l.onBeforeAdd=new b(k,"BeforeAddUndo",null,l),l.onAdd=new b(k,"AddUndo",null,l),m.onBeforeGetContent=new b(k,"BeforeGetContent",e(!0),m),m.onGetContent=new b(k,"GetContent",e(!0),m),m.onBeforeSetContent=new b(k,"BeforeSetContent",e(!0),m),m.onSetContent=new b(k,"SetContent",e(!0),m),k.windowManager.createInstance=function(q,x,p,v,n,w){c("windowManager.createInstance(..)");var u=f.resolve(q);return new u(x,p,v,n,w)}})}}var a;f.onBeforeUnload=new b(f,"BeforeUnload"),f.onAddEditor=new b(f,"AddEditor","editor"),f.onRemoveEditor=new b(f,"RemoveEditor","editor"),f.on("SetupEditor",d),f.PluginManager.add("compat3x",d),f.addI18n=function(j,h){var k=f.util.I18n,g=f.each;return"string"==typeof j&&-1===j.indexOf(".")?(k.add(j,h),void 0):(f.is(j,"string")?g(h,function(l,e){k.data[j+"."+e]=l}):g(j,function(m,l){g(m,function(o,e){g(o,function(q,p){"common"===e?k.data[l+"."+p]=q:k.data[l+"."+e+"."+p]=q})})}),void 0)}}(tinymce);tinymce.ThemeManager.add("modern",function(j){var p=this,f=j.settings,c=tinymce.ui.Factory,n=tinymce.each,o=tinymce.DOM;var d={file:{title:"File",items:"newdocument"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall"},insert:{title:"Insert",items:"|"},view:{title:"View",items:"visualaid |"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript | formats | removeformat"},table:{title:"Table"},tools:{title:"Tools"}};var b="undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image";function m(){var r=[];function s(u){var v=[],t;if(!u){return}n(u.split(/[ ,]/),function(x){var y;function w(){var z=j.selection;if(y=="bullist"){z.selectorChanged("ul > li",function(C,A){var D,B=A.parents.length;while(B--){D=A.parents[B].nodeName;if(D=="OL"||D=="UL"){break}}x.active(C&&D=="UL")})}if(y=="numlist"){z.selectorChanged("ol > li",function(C,A){var D,B=A.parents.length;while(B--){D=A.parents[B].nodeName;if(D=="OL"||D=="UL"){break}}x.active(C&&D=="OL")})}if(x.settings.stateSelector){z.selectorChanged(x.settings.stateSelector,function(A){x.active(A)},true)}if(x.settings.disabledStateSelector){z.selectorChanged(x.settings.disabledStateSelector,function(A){x.disabled(A)})}}if(x=="|"){t=null}else{if(c.has(x)){x={type:x};if(f.toolbar_items_size){x.size=f.toolbar_items_size}v.push(x);t=null}else{if(!t){t={type:"buttongroup",items:[]};v.push(t)}if(j.buttons[x]){y=x;x=j.buttons[y];if(typeof(x)=="function"){x=x()}x.type=x.type||"button";if(f.toolbar_items_size){x.size=f.toolbar_items_size}x=c.create(x);t.items.push(x);if(j.initialized){w()}else{j.on("init",w)}}}}});r.push({type:"toolbar",layout:"flow",items:v});return true}for(var q=1;q<10;q++){if(!s(f["toolbar"+q])){break}}if(!r.length){s(f.toolbar||b)}return r}function l(){var s,x=[];function v(y){var z;if(y=="|"){return{text:"|"}}z=j.menuItems[y];return z}function q(C){var y,D,B,E,A;A=tinymce.makeMap((f.removed_menuitems||"").split(/[ ,]/));if(f.menu){D=f.menu[C];E=true}else{D=d[C]}if(D){y={text:D.title};B=[];n((D.items||"").split(/[ ,]/),function(G){var F=v(G);if(F&&!A[G]){B.push(v(G))}});if(!E){n(j.menuItems,function(F){if(F.context==C){if(F.separator=="before"){B.push({text:"|"})}if(F.prependToContext){B.unshift(F)}else{B.push(F)}if(F.separator=="after"){B.push({text:"|"})}}})}for(var z=0;z<B.length;z++){if(B[z].text=="|"){if(z===0||z==B.length-1){B.splice(z,1)}}}y.menu=B;if(!y.menu.length){return null}}return y}var r=[];if(f.menu){for(s in f.menu){r.push(s)}}else{for(s in d){r.push(s)}}var u=typeof(f.menubar)=="string"?f.menubar.split(/[ ,]/):r;for(var t=0;t<u.length;t++){var w=u[t];w=q(w);if(w){x.push(w)}}return x}function g(r){function q(s){var t=r.find(s)[0];if(t){t.focus()}}j.shortcuts.add("Alt+F9","",function(){q("menubar")});j.shortcuts.add("Alt+F10","",function(){q("toolbar")});j.shortcuts.add("Alt+F11","",function(){q("elementpath")});r.on("cancel",function(){j.focus()})}function h(s,r){var w,q,u,v;function t(x){return{width:x.clientWidth,height:x.clientHeight}}w=j.getContainer();q=j.getContentAreaContainer().firstChild;u=t(w);v=t(q);if(s!==null){s=Math.max(f.min_width||100,s);s=Math.min(f.max_width||65535,s);o.css(w,"width",s+(u.width-v.width));o.css(q,"width",s)}r=Math.max(f.min_height||100,r);r=Math.min(f.max_height||65535,r);o.css(q,"height",r);j.fire("ResizeEditor")}function e(q,r){var s=j.getContentAreaContainer();p.resizeTo(s.clientWidth+q,s.clientHeight+r)}function a(){var s,v;if(f.fixed_toolbar_container){v=o.select(f.fixed_toolbar_container)[0]}function r(){if(s&&s.moveRel&&s.visible()&&!s._fixed){var A=j.selection.getScrollContainer(),x=j.getBody();var y=0,w=0;if(A){var B=o.getPos(x),z=o.getPos(A);y=Math.max(0,z.x-B.x);w=Math.max(0,z.y-B.y)}s.fixed(false).moveRel(x,j.rtl?["tr-br","br-tr"]:["tl-bl","bl-tl"]).moveBy(y,w)}}function q(){if(s){s.show();r();o.addClass(j.getBody(),"mce-edit-focus");j.fire("ShowPanel")}}function t(){if(s){s.hide();o.removeClass(j.getBody(),"mce-edit-focus");j.fire("HidePanel")}}function u(){if(s){if(!s.visible()){q()}return}s=p.panel=c.create({type:v?"panel":"floatpanel",classes:"tinymce tinymce-inline",layout:"flow",direction:"column",align:"stretch",autohide:false,autofix:true,fixed:!!v,border:1,items:[f.menubar===false?null:{type:"menubar",border:"0 0 1 0",items:l()},f.toolbar===false?null:{type:"panel",name:"toolbar",layout:"stack",items:m()}]});s.renderTo(v||document.body).reflow();g(s);q();j.on("nodeChange",r);j.on("activate",q);j.on("deactivate",t)}f.content_editable=true;j.on("focus",u);j.on("blur",t);j.on("remove",function(){if(s){s.remove();s=null}});return{}}function k(s){var r,t,q;r=p.panel=c.create({type:"panel",classes:"tinymce",style:"visibility: hidden",layout:"stack",border:1,items:[f.menubar===false?null:{type:"menubar",border:"0 0 1 0",items:l()},f.toolbar===false?null:{type:"panel",layout:"stack",items:m()},{type:"panel",name:"iframe",layout:"stack",classes:"edit-area",html:"",border:"1 0 0 0"}]});if(f.resize!==false){t={type:"resizehandle",direction:f.resize,onResizeStart:function(){var u=j.getContentAreaContainer().firstChild;q={width:u.clientWidth,height:u.clientHeight}},onResize:function(u){if(f.resize=="both"){h(q.width+u.deltaX,q.height+u.deltaY)}else{h(null,q.height+u.deltaY)}}}}if(f.statusbar!==false){r.add({type:"panel",name:"statusbar",classes:"statusbar",layout:"flow",border:"1 0 0 0",items:[{type:"elementpath"},t]})}if(f.readonly){r.find("*").disabled(true)}r.renderBefore(s.targetNode).reflow();if(f.width){tinymce.DOM.setStyle(r.getEl(),"width",f.width)}j.on("remove",function(){r.remove();r=null});g(r);return{iframeContainer:r.find("#iframe")[0].getEl(),editorContainer:r.getEl()}}p.renderUI=function(r){var s=f.skin!==false?f.skin||"lightgray":false;if(s){var q=f.skin_url;if(q){q=j.documentBaseURI.toAbsolute(q)}else{q=tinymce.baseURL+"/skins/"+s}if(tinymce.Env.documentMode<=7){tinymce.DOM.loadCSS(q+"/skin.ie7.min.css")}else{tinymce.DOM.loadCSS(q+"/skin.min.css")}j.contentCSS.push(q+"/content"+(j.inline?".inline":"")+".min.css")}j.on("ProgressState",function(t){p.throbber=p.throbber||new tinymce.ui.Throbber(p.panel.getEl("body"));if(t.state){p.throbber.show(t.time)}else{p.throbber.hide()}});if(f.inline){return a(r)}return k(r)};p.resizeTo=h;p.resizeBy=e});(function(){tinymce.create("tinymce.plugins.UmiImagePlugin",{init:function(ed,url){ed.addCommand("mceUmiImage",function(){if(ed.dom.getAttrib(ed.selection.getNode(),"class").indexOf("mceItem")!=-1){return}var qs="folder=./images/cms/data/&image=1";jQuery.ajax({url:"/admin/data/get_filemanager_info/",data:"folder=./images/cms/data/&file=",dataType:"json",complete:function(data){data=eval("("+data.responseText+")");var folder_hash=data.folder_hash;var file_hash=data.file_hash;var lang=data.lang;var fm=data.filemanager;var functionName="draw"+fm+"ImageEditor";eval(functionName+"(qs, lang, folder_hash, file_hash)")}});var drawflashImageEditor=function(qs,lang,folder_hash,file_hash){jQuery.openPopupLayer({name:"Filemanager",title:getLabel("js-file-manager"),width:660,height:460,url:"/styles/common/other/filebrowser/umifilebrowser.html?"+qs,afterClose:function(value){if(value){if(typeof value=="object"){value=value[0]}newValue=value?value.toString():"";onFilemanagerFinish(value.toString())}}})};var drawelfinderImageEditor=function(qs,lang,folder_hash,file_hash){qs=qs+"&lang="+lang+"&file_hash="+file_hash+"&folder_hash="+folder_hash;jQuery.openPopupLayer({name:"Filemanager",title:getLabel("js-file-manager"),width:660,height:530,url:"/styles/common/other/elfinder/umifilebrowser.html?"+qs,afterClose:function(value){if(value){if(typeof value=="object"){value=value[0]}newValue=value?value.toString():"";onFilemanagerFinish(value.toString())}ed.fire("focus")}});jQuery("#popupLayer_Filemanager .popupBody").append(uAdmin.wysiwyg.getFilemanagerFooter("elfinder"))};function onFilemanagerFinish(img_src){var el,args={};if(tinymce.isWebKit){ed.getWin().focus()}args={src:img_src};el=ed.selection.getNode();if(el&&el.nodeName=="IMG"){ed.dom.setAttribs(el,args)}else{ed.execCommand("mceInsertContent",false,'<img id="__mce_tmp" />',{skip_undo:1});ed.dom.setAttribs("__mce_tmp",args);ed.dom.setAttrib("__mce_tmp","id","");ed.undoManager.add()}}});ed.addButton("umiimage",{title:"umiimage.image_desc",cmd:"mceUmiImage"})},getInfo:function(){return{longname:"Umi image (based on Advanced image)",author:"Moxiecode Systems AB && Krutuzick",authorurl:"http://tinymce.moxiecode.com && http://umi.ru",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/advimage && http://umi.ru",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("umiimage",tinymce.plugins.UmiImagePlugin)})();!function(z,E){function m(d,a){for(var g,c=[],f=0;f<d.length;++f){if(g=B[d[f]]||v(d[f]),!g){throw"module definition dependecy not found: "+d[f]}c.push(g)}a.apply(null,c)}function b(c,a,d){if("string"!=typeof c){throw"invalid module definition, module id must be defined and be a string"}if(a===E){throw"invalid module definition, dependencies must be specified"}if(d===E){throw"invalid module definition, definition function must be specified"}m(a,function(){B[c]=d.apply(null,arguments)})}function k(a){return !!B[a]}function v(a){for(var e=z,c=a.split(/[.\/]/),d=0;d<c.length;++d){if(!e[c[d]]){return}e=e[c[d]]}return e}function C(h){for(var f=0;f<h.length;f++){for(var g=z,e=h[f],d=e.split(/[.\/]/),c=0;c<d.length-1;++c){g[d[c]]===E&&(g[d[c]]={}),g=g[d[c]]}g[d[d.length-1]]=B[e]}}var B={},q="tinymce/spellcheckerplugin/DomTextMatcher",A="tinymce/spellcheckerplugin/Plugin",F="tinymce/PluginManager",D="tinymce/util/Tools",y="tinymce/ui/Menu",w="tinymce/dom/DOMUtils",x="tinymce/util/JSONRequest",j="tinymce/util/URI";b(q,[],function(){return function(U,I,N){function K(c){if(!c[0]){throw"findAndReplaceDOMText cannot handle zero-length matches"}var a=c.index;return[a,a+c[0].length,[c[0]]]}function M(c){var a;if(3===c.nodeType){return c.data}if(O[c.nodeName]&&!L[c.nodeName]){return""}if(a="",(L[c.nodeName]||G[c.nodeName])&&(a+="\n"),c=c.firstChild){do{a+=M(c)}while(c=c.nextSibling)}return a}function Q(Z,ae,h){var f,g,Y,ac,ab=[],p=0,aa=Z,af=ae.shift(),ad=0;Z:for(;;){if((L[aa.nodeName]||G[aa.nodeName])&&p++,3===aa.nodeType&&(!g&&aa.length+p>=af[1]?(g=aa,ac=af[1]-p):f&&ab.push(aa),!f&&aa.length+p>af[0]&&(f=aa,Y=af[0]-p),p+=aa.length),f&&g){if(aa=h({startNode:f,startNodeIndex:Y,endNode:g,endNodeIndex:ac,innerNodes:ab,match:af[2],matchIndex:ad}),p-=g.length-ac,f=null,g=null,ab=[],af=ae.shift(),ad++,!af){break}}else{if((!O[aa.nodeName]||L[aa.nodeName])&&aa.firstChild){aa=aa.firstChild;continue}if(aa.nextSibling){aa=aa.nextSibling;continue}}for(;;){if(aa.nextSibling){aa=aa.nextSibling;break}if(aa.parentNode===Z){break Z}aa=aa.parentNode}}}function X(d){var a;if("function"!=typeof d){var f=d.nodeType?d:S.createElement(d);a=function(l,g){var h=f.cloneNode(!1);return h.setAttribute("data-mce-index",g),l&&h.appendChild(S.createTextNode(l)),h}}else{a=d}return function c(af){var Z,g,Y,ac=af.startNode,ai=af.endNode,ah=af.matchIndex;if(ac===ai){var ab=ac;Y=ab.parentNode,af.startNodeIndex>0&&(Z=S.createTextNode(ab.data.substring(0,af.startNodeIndex)),Y.insertBefore(Z,ab));var ag=a(af.match[0],ah);return Y.insertBefore(ag,ab),af.endNodeIndex<ab.length&&(g=S.createTextNode(ab.data.substring(af.endNodeIndex)),Y.insertBefore(g,ab)),ab.parentNode.removeChild(ab),ag}Z=S.createTextNode(ac.data.substring(0,af.startNodeIndex)),g=S.createTextNode(ai.data.substring(af.endNodeIndex));for(var al=a(ac.data.substring(af.startNodeIndex),ah),ak=[],ae=0,ad=af.innerNodes.length;ad>ae;++ae){var t=af.innerNodes[ae],aa=a(t.data,ah);t.parentNode.replaceChild(aa,t),ak.push(aa)}var aj=a(ai.data.substring(0,af.endNodeIndex),ah);return Y=ac.parentNode,Y.insertBefore(Z,ac),Y.insertBefore(al,ac),Y.removeChild(ac),Y=ai.parentNode,Y.insertBefore(aj,ai),Y.insertBefore(g,ai),Y.removeChild(ai),aj}}function W(c){var a=[];return P(function(e,d){c(e,d)&&a.push(e)}),H=a,this}function P(c){for(var a=0,d=H.length;d>a&&c(H[a],a)!==!1;a++){}return this}function V(a){return H.length&&(R=H.length,Q(I,H,X(a))),this}var J,H=[],T,R=0,S,L,O,G;if(S=I.ownerDocument,L=N.getBlockElements(),O=N.getWhiteSpaceElements(),G=N.getShortEndedElements(),T=M(I),T&&U.global){for(;J=U.exec(T);){H.push(K(J))}}return{text:T,count:R,matches:H,each:P,filter:W,mark:V}}}),b(A,[q,F,D,y,w,x,j],function(h,f,p,g,l,d,c){f.add("spellchecker",function(O,J){function n(u){for(var s in u){return !1}return !0}function I(N,u){var t=[],R=e[u];p.each(R,function(S){t.push({text:S,onclick:function(){O.insertContent(S),M()}})}),t.push.apply(t,[{text:"-"},{text:"Ignore",onclick:function(){o(N,u)}},{text:"Ignore all",onclick:function(){o(N,u,!0)}},{text:"Finish",onclick:r}]),H=new g({items:t,context:"contextmenu",onautohide:function(S){-1!=S.target.className.indexOf("spellchecker")&&S.preventDefault()},onhide:function(){H.remove(),H=null}}),H.renderTo(document.body);var s=l.DOM.getPos(O.getContentAreaContainer()),Q=O.dom.getPos(N);s.x+=Q.x,s.y+=Q.y,H.moveTo(s.x,s.y+N.offsetHeight)}function P(){function U(s){return O.setProgressState(!1),n(s)?(O.windowManager.alert("No misspellings found"),L=!1,void 0):(e=s,T.filter(function(u){return !!s[u[2][0]]}).mark(O.dom.create("span",{"class":"mce-spellchecker-word","data-mce-bogus":1})),T=null,O.fire("SpellcheckStart"),void 0)}function Q(u,V,s){d.sendRPC({url:new c(J).toAbsolute(K.spellchecker_rpc_url),method:u,params:{lang:K.spellchecker_language||"en",words:V},success:function(W){s(W)},error:function(W,X){W="JSON Parse error."==W?"Non JSON response:"+X.responseText:"Error: "+W,O.windowManager.alert(W),O.setProgressState(!1),T=null,L=!1}})}var T,S=[],N={};if(L){return r(),void 0}L=!0;var t=O.getParam("spellchecker_wordchar_pattern")||new RegExp('[^\\s!"#$%&()*+,-./:;<=>?@[\\]^_{|}`\xa7\xa9\xab\xae\xb1\xb6\xb7\xb8\xbb\xbc\xbd\xbe\xbf\xd7\xf7\xa4\u201d\u201c\u201e]+',"g");T=new h(t,O.getBody(),O.schema).each(function(u){var s=u[2][0];if(!N[s]){if(/^\d+$/.test(s)||1==s.length){return}S.push(s),N[s]=!0}}),O.setProgressState(!0);var R=K.spellchecker_callback||Q;R("spellcheck",S,U)}function M(){O.dom.select("span.mce-spellchecker-word").length||r()}function G(u){var s=u.parentNode;s.insertBefore(u.firstChild,u),u.parentNode.removeChild(u)}function o(t,s,u){u?p.each(O.dom.select("span.mce-spellchecker-word"),function(Q){var N=Q.innerText||Q.textContent;N==s&&G(Q)}):G(t),M()}function r(){var t,u,s;for(L=!1,s=O.getBody(),u=s.getElementsByTagName("span"),t=u.length;t--;){s=u[t],s.getAttribute("data-mce-index")&&G(s)}O.fire("SpellcheckEnd")}function a(Q){var T,N,R,u=-1,t,S;for(Q=""+Q,T=O.getBody().getElementsByTagName("span"),N=0;N<T.length&&(R=T[N],"mce-spellchecker-word"!=R.className||(u=R.getAttribute("data-mce-index"),u===Q&&(u=Q,t||(t=R.firstChild),S=R.firstChild),u===Q||!S));N++){}var s=O.dom.createRng();return s.setStart(t,0),s.setEnd(S,S.length),O.selection.setRng(s),s}var e,L,H,K=O.settings;O.on("click",function(u){if("mce-spellchecker-word"==u.target.className){u.preventDefault();var s=a(u.target.getAttribute("data-mce-index"));I(u.target,s.toString())}}),O.addMenuItem("spellchecker",{text:"Spellcheck",context:"tools",onclick:P,selectable:!0,onPostRender:function(){var s=this;O.on("SpellcheckStart SpellcheckEnd",function(){s.active(L)})}}),O.addButton("spellchecker",{tooltip:"Spellcheck",onclick:P,onPostRender:function(){var s=this;O.on("SpellcheckStart SpellcheckEnd",function(){s.active(L)})}}),O.on("remove",function(){H&&(H.remove(),H=null)})})}),C([q,A])}(this);tinymce.PluginManager.add("pagebreak",function(f){var d,g="mce-pagebreak",c=f.getParam("pagebreak_separator","<!-- pagebreak -->"),b='<img src="'+tinymce.Env.transparentSrc+'" class="'+g+'" data-mce-resize="false" />';d=new RegExp(c.replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g,function(a){return"\\"+a}),"gi"),f.addCommand("mcePageBreak",function(){f.execCommand("mceInsertContent",0,b)}),f.addButton("pagebreak",{title:"Page break",cmd:"mcePageBreak"}),f.addMenuItem("pagebreak",{text:"Page break",icon:"pagebreak",cmd:"mcePageBreak",context:"insert"}),f.on("ResolveName",function(a){"IMG"==a.target.nodeName&&f.dom.hasClass(a.target,g)&&(a.name="pagebreak")}),f.on("click",function(a){a=a.target,"IMG"===a.nodeName&&f.dom.hasClass(a,g)&&f.selection.select(a)}),f.on("BeforeSetContent",function(a){a.content=a.content.replace(d,b)}),f.on("PreInit",function(){f.serializer.addNodeFilter("img",function(k){for(var j,l,h=k.length;h--;){j=k[h],l=j.attr("class"),l&&-1!==l.indexOf("mce-pagebreak")&&(j.type=3,j.value=c,j.raw=!0)}})})});tinymce.PluginManager.add("layer",function(f){function d(a){do{if(a.className&&-1!=a.className.indexOf("mceItemLayer")){return a}}while(a=a.parentNode)}function h(a){var e=f.dom;tinymce.each(e.select("div,p",a),function(j){/^(absolute|relative|fixed)$/i.test(j.style.position)&&(j.hasVisual?e.addClass(j,"mceItemVisualAid"):e.removeClass(j,"mceItemVisualAid"),e.addClass(j,"mceItemLayer"))})}function c(t){var k,q,j=[],p=d(f.selection.getNode()),e=-1,m=-1;for(q=[],tinymce.walk(f.getBody(),function(a){1==a.nodeType&&/^(absolute|relative|static)$/i.test(a.style.position)&&q.push(a)},"childNodes"),k=0;k<q.length;k++){j[k]=q[k].style.zIndex?parseInt(q[k].style.zIndex,10):0,0>e&&q[k]==p&&(e=k)}if(0>t){for(k=0;k<j.length;k++){if(j[k]<j[e]){m=k;break}}m>-1?(q[e].style.zIndex=j[m],q[m].style.zIndex=j[e]):j[e]>0&&(q[e].style.zIndex=j[e]-1)}else{for(k=0;k<j.length;k++){if(j[k]>j[e]){m=k;break}}m>-1?(q[e].style.zIndex=j[m],q[m].style.zIndex=j[e]):q[e].style.zIndex=j[e]+1}f.execCommand("mceRepaint")}function g(){var e=f.dom,j=e.getPos(e.getParent(f.selection.getNode(),"*")),a=f.getBody();f.dom.add(a,"div",{style:{position:"absolute",left:j.x,top:j.y>20?j.y:20,width:100,height:100},"class":"mceItemVisualAid mceItemLayer"},f.selection.getContent()||f.getLang("layer.content")),tinymce.Env.ie&&e.setHTML(a,a.innerHTML)}function b(){var a=d(f.selection.getNode());a||(a=f.dom.getParent(f.selection.getNode(),"DIV,P,IMG")),a&&("absolute"==a.style.position.toLowerCase()?(f.dom.setStyles(a,{position:"",left:"",top:"",width:"",height:""}),f.dom.removeClass(a,"mceItemVisualAid"),f.dom.removeClass(a,"mceItemLayer")):(a.style.left||(a.style.left="20px"),a.style.top||(a.style.top="20px"),a.style.width||(a.style.width=a.width?a.width+"px":"100px"),a.style.height||(a.style.height=a.height?a.height+"px":"100px"),a.style.position="absolute",f.dom.setAttrib(a,"data-mce-style",""),f.addVisual(f.getBody())),f.execCommand("mceRepaint"),f.nodeChanged())}f.addCommand("mceInsertLayer",g),f.addCommand("mceMoveForward",function(){c(1)}),f.addCommand("mceMoveBackward",function(){c(-1)}),f.addCommand("mceMakeAbsolute",function(){b()}),f.addButton("moveforward",{title:"layer.forward_desc",cmd:"mceMoveForward"}),f.addButton("movebackward",{title:"layer.backward_desc",cmd:"mceMoveBackward"}),f.addButton("absolute",{title:"layer.absolute_desc",cmd:"mceMakeAbsolute"}),f.addButton("insertlayer",{title:"layer.insertlayer_desc",cmd:"mceInsertLayer"}),f.on("init",function(){tinymce.Env.ie&&f.getDoc().execCommand("2D-Position",!1,!0)}),f.on("mouseup",function(e){var a=d(e.target);a&&f.dom.setAttrib(a,"data-mce-style","")}),f.on("mousedown",function(l){var j,k=l.target,e=f.getDoc();tinymce.Env.gecko&&(d(k)?"on"!==e.designMode&&(e.designMode="on",k=e.body,j=k.parentNode,j.removeChild(k),j.appendChild(k)):"on"==e.designMode&&(e.designMode="off"))}),f.on("NodeChange",h)});(function(b,g){var d={};function c(m,n){var l,j=[];for(var k=0;k<m.length;++k){l=d[m[k]]||e(m[k]);if(!l){throw"module definition dependecy not found: "+m[k]}j.push(l)}n.apply(null,j)}function h(l,k,j){if(typeof l!=="string"){throw"invalid module definition, module id must be defined and be a string"}if(k===g){throw"invalid module definition, dependencies must be specified"}if(j===g){throw"invalid module definition, definition function must be specified"}c(k,function(){d[l]=j.apply(null,arguments)})}function f(j){return !!d[j]}function e(m){var k=b;var j=m.split(/[.\/]/);for(var l=0;l<j.length;++l){if(!k[j[l]]){return}k=k[j[l]]}return k}function a(l){for(var k=0;k<l.length;k++){var m=b;var o=l[k];var j=o.split(/[.\/]/);for(var n=0;n<j.length-1;++n){if(m[j[n]]===g){m[j[n]]={}}m=m[j[n]]}m[j[j.length-1]]=d[o]}}h("tinymce/tableplugin/TableGrid",["tinymce/util/Tools","tinymce/Env"],function(l,k){var m=l.each;function j(o,n){return parseInt(o.getAttribute(n)||1,10)}return function(v,N){var o,R,J,w,Q=v.selection,M=Q.dom;function B(){var S=0;o=[];m(["thead","tbody","tfoot"],function(T){var U=M.select("> "+T+" tr",N);m(U,function(V,W){W+=S;m(M.select("> td, > th",V),function(ac,X){var Y,Z,aa,ab;if(o[W]){while(o[W][X]){X++}}aa=j(ac,"rowspan");ab=j(ac,"colspan");for(Z=W;Z<W+aa;Z++){if(!o[Z]){o[Z]=[]}for(Y=X;Y<X+ab;Y++){o[Z][Y]={part:T,real:Z==W&&Y==X,elm:ac,rowspan:aa,colspan:ab}}}})});S+=U.length})}function G(T,S){T=T.cloneNode(S);T.removeAttribute("id");return T}function F(S,U){var T;T=o[U];if(T){return T[S]}}function A(U,S,T){if(U){T=parseInt(T,10);if(T===1){U.removeAttribute(S,1)}else{U.setAttribute(S,T,1)}}}function q(S){return S&&(M.hasClass(S.elm,"mce-item-selected")||S==w)}function r(){var S=[];m(N.rows,function(T){m(T.cells,function(U){if(M.hasClass(U,"mce-item-selected")||U==w.elm){S.push(T);return false}})});return S}function z(){var S=M.createRng();S.setStartAfter(N);S.setEndAfter(N);Q.setRng(S);M.remove(N)}function n(S){var U,T={};if(v.settings.table_clone_elements!==false){T=l.makeMap((v.settings.table_clone_elements||"strong em b i span font h1 h2 h3 h4 h5 h6 p div").toUpperCase(),/[ ,]/)}l.walk(S,function(W){var V;if(W.nodeType==3){m(M.getParents(W.parentNode,null,S).reverse(),function(X){if(!T[X.nodeName]){return}X=G(X,false);if(!U){U=V=X}else{if(V){V.appendChild(X)}}V=X});if(V){V.innerHTML=k.ie?"&nbsp;":'<br data-mce-bogus="1" />'}return false}},"childNodes");S=G(S,false);A(S,"rowSpan",1);A(S,"colSpan",1);if(U){S.appendChild(U)}else{if(!k.ie){S.innerHTML='<br data-mce-bogus="1" />'}}return S}function y(){var S=M.createRng(),T;m(M.select("tr",N),function(U){if(U.cells.length===0){M.remove(U)}});if(M.select("tr",N).length===0){S.setStartBefore(N);S.setEndBefore(N);Q.setRng(S);M.remove(N);return}m(M.select("thead,tbody,tfoot",N),function(U){if(U.rows.length===0){M.remove(U)}});B();T=o[Math.min(o.length-1,R.y)];if(T){Q.select(T[Math.min(T.length-1,R.x)].elm,true);Q.collapse(true)}}function C(Z,X,ab,Y){var W,U,T,S,V,aa;W=o[X][Z].elm.parentNode;for(S=1;S<=ab;S++){W=M.getNext(W,"tr");if(!W){W=M.create("tr");U=M.create("td");W.appendChild(U);M.insertAfter(W,o[X][Z].elm.parentNode)}if(W){for(T=Z;T>=0;T--){aa=o[X+S][T].elm;if(aa.parentNode==W){for(V=1;V<=Y;V++){M.insertAfter(n(aa),aa)}break}}if(T==-1){for(V=1;V<=Y;V++){W.insertBefore(n(W.cells[0]),W.cells[0])}if(U){M.remove(U)}}}}}function I(){m(o,function(S,T){m(S,function(V,U){var Y,X,W;if(q(V)){V=V.elm;Y=j(V,"colspan");X=j(V,"rowspan");if(Y>1||X>1){A(V,"rowSpan",1);A(V,"colSpan",1);for(W=0;W<Y-1;W++){M.insertAfter(n(V),V)}C(U,T,X-1,Y)}}})})}function x(ac,Z,af){var Y,V,U,ae,ad,ab,X,aa,S,T,W;if(ac){Y=L(ac);V=Y.x;U=Y.y;ae=V+(Z-1);ad=U+(af-1)}else{R=J=null;m(o,function(ag,ah){m(ag,function(aj,ai){if(q(aj)){if(!R){R={x:ai,y:ah}}J={x:ai,y:ah}}})});V=R.x;U=R.y;ae=J.x;ad=J.y}aa=F(V,U);S=F(ae,ad);if(aa&&S&&aa.part==S.part){I();B();aa=F(V,U).elm;A(aa,"colSpan",(ae-V)+1);A(aa,"rowSpan",(ad-U)+1);for(X=U;X<=ad;X++){for(ab=V;ab<=ae;ab++){if(!o[X]||!o[X][ab]){continue}ac=o[X][ab].elm;if(ac!=aa){T=l.grep(ac.childNodes);m(T,function(ag){aa.appendChild(ag)});if(T.length){T=l.grep(aa.childNodes);W=0;m(T,function(ag){if(ag.nodeName=="BR"&&M.getAttrib(ag,"data-mce-bogus")&&W++<T.length-1){aa.removeChild(ag)}})}M.remove(ac)}}}y()}}function s(W){var S,Y,V,X,Z,aa,T,ab,U;m(o,function(ac,ad){m(ac,function(ae){if(q(ae)){ae=ae.elm;Z=ae.parentNode;aa=G(Z,false);S=ad;if(W){return false}}});if(W){return !S}});for(X=0;X<o[0].length;X++){if(!o[S][X]){continue}Y=o[S][X].elm;if(Y!=V){if(!W){U=j(Y,"rowspan");if(U>1){A(Y,"rowSpan",U+1);continue}}else{if(S>0&&o[S-1][X]){ab=o[S-1][X].elm;U=j(ab,"rowSpan");if(U>1){A(ab,"rowSpan",U+1);continue}}}T=n(Y);A(T,"colSpan",Y.colSpan);aa.appendChild(T);V=Y}}if(aa.hasChildNodes()){if(!W){M.insertAfter(aa,Z)}else{Z.parentNode.insertBefore(aa,Z)}}}function p(T){var U,S;m(o,function(V){m(V,function(X,W){if(q(X)){U=W;if(T){return false}}});if(T){return !U}});m(o,function(Y,Z){var V,W,X;if(!Y[U]){return}V=Y[U].elm;if(V!=S){X=j(V,"colspan");W=j(V,"rowspan");if(X==1){if(!T){M.insertAfter(n(V),V);C(U,Z,W-1,X)}else{V.parentNode.insertBefore(n(V),V);C(U,Z,W-1,X)}}else{A(V,"colSpan",V.colSpan+1)}S=V}})}function u(){var S=[];m(o,function(T){m(T,function(V,U){if(q(V)&&l.inArray(S,U)===-1){m(o,function(Y){var W=Y[U].elm,X;X=j(W,"colSpan");if(X>1){A(W,"colSpan",X-1)}else{M.remove(W)}});S.push(U)}})});y()}function t(){var T;function S(W){var V,X,U;V=M.getNext(W,"tr");m(W.cells,function(Y){var Z=j(Y,"rowSpan");if(Z>1){A(Y,"rowSpan",Z-1);X=L(Y);C(X.x,X.y,1,1)}});X=L(W.cells[0]);m(o[X.y],function(Y){var Z;Y=Y.elm;if(Y!=U){Z=j(Y,"rowSpan");if(Z<=1){M.remove(Y)}else{A(Y,"rowSpan",Z-1)}U=Y}})}T=r();m(T.reverse(),function(U){S(U)});y()}function K(){var S=r();M.remove(S);y();return S}function P(){var S=r();m(S,function(U,T){S[T]=G(U,true)});return S}function H(U,T){var V=r(),S=V[T?0:V.length-1],W=S.cells.length;if(!U){return}m(o,function(Y){var X;W=0;m(Y,function(Z){if(Z.real){W+=Z.colspan}if(Z.elm.parentNode==S){X=1}});if(X){return false}});if(!T){U.reverse()}m(U,function(aa){var Y,Z=aa.cells.length,X;for(Y=0;Y<Z;Y++){X=aa.cells[Y];A(X,"colSpan",1);A(X,"rowSpan",1)}for(Y=Z;Y<W;Y++){aa.appendChild(n(aa.cells[Z-1]))}for(Y=W;Y<Z;Y++){M.remove(aa.cells[Y])}if(T){S.parentNode.insertBefore(aa,S)}else{M.insertAfter(aa,S)}});M.removeClass(M.select("td.mce-item-selected,th.mce-item-selected"),"mce-item-selected")}function L(S){var T;m(o,function(U,V){m(U,function(X,W){if(X.elm==S){T={x:W,y:V};return false}});return !T});return T}function E(S){R=L(S)}function O(){var T,S;T=S=0;m(o,function(U,V){m(U,function(X,W){var Z,Y;if(q(X)){X=o[V][W];if(W>T){T=W}if(V>S){S=V}if(X.real){Z=X.colspan-1;Y=X.rowspan-1;if(Z){if(W+Z>T){T=W+Z}}if(Y){if(V+Y>S){S=V+Y}}}}})});return{x:T,y:S}}function D(aa){var V,U,ac,ab,T,S,W,X,Z,Y;J=L(aa);if(R&&J){V=Math.min(R.x,J.x);U=Math.min(R.y,J.y);ac=Math.max(R.x,J.x);ab=Math.max(R.y,J.y);T=ac;S=ab;for(Y=U;Y<=S;Y++){aa=o[Y][V];if(!aa.real){if(V-(aa.colspan-1)<V){V-=aa.colspan-1}}}for(Z=V;Z<=T;Z++){aa=o[U][Z];if(!aa.real){if(U-(aa.rowspan-1)<U){U-=aa.rowspan-1}}}for(Y=U;Y<=ab;Y++){for(Z=V;Z<=ac;Z++){aa=o[Y][Z];if(aa.real){W=aa.colspan-1;X=aa.rowspan-1;if(W){if(Z+W>T){T=Z+W}}if(X){if(Y+X>S){S=Y+X}}}}}M.removeClass(M.select("td.mce-item-selected,th.mce-item-selected"),"mce-item-selected");for(Y=U;Y<=S;Y++){for(Z=V;Z<=T;Z++){if(o[Y][Z]){M.addClass(o[Y][Z].elm,"mce-item-selected")}}}}}N=N||M.getParent(Q.getStart(),"table");B();w=M.getParent(Q.getStart(),"th,td");if(w){R=L(w);J=O();w=F(R.x,R.y)}l.extend(this,{deleteTable:z,split:I,merge:x,insertRow:s,insertCol:p,deleteCols:u,deleteRows:t,cutRows:K,copyRows:P,pasteRows:H,getPos:L,setStartCell:E,setEndCell:D})}});h("tinymce/tableplugin/Quirks",["tinymce/util/VK","tinymce/Env","tinymce/util/Tools"],function(n,k,l){var m=l.each;function j(p,o){return parseInt(p.getAttribute(o)||1,10)}return function(r){function s(){function t(C){var I=C.keyCode;function A(R,N){var M=R?"previousSibling":"nextSibling";var S=r.dom.getParent(N,"tr");var Q=S[M];if(Q){E(r,N,Q,R);C.preventDefault();return true}else{var T=r.dom.getParent(S,"table");var P=S.parentNode;var L=P.nodeName.toLowerCase();if(L==="tbody"||L===(R?"tfoot":"thead")){var O=v(R,T,P,"tbody");if(O!==null){return x(R,O,N)}}return H(R,S,M,T)}}function v(P,N,O,R){var M=r.dom.select(">"+R,N);var L=M.indexOf(O);if(P&&L===0||!P&&L===M.length-1){return y(P,N)}else{if(L===-1){var Q=O.tagName.toLowerCase()==="thead"?0:M.length-1;return M[Q]}else{return M[L+(P?-1:1)]}}}function y(O,N){var M=O?"thead":"tfoot";var L=r.dom.select(">"+M,N);return L.length!==0?L[0]:null}function x(O,N,M){var L=u(N,O);if(L){E(r,M,L,O)}C.preventDefault();return true}function H(R,O,L,Q){var M=Q[L];if(M){G(M);return true}else{var P=r.dom.getParent(Q,"td,th");if(P){return A(R,P,C)}else{var N=u(O,!R);G(N);C.preventDefault();return false}}}function u(M,L){var N=M&&M[L?"lastChild":"firstChild"];return N&&N.nodeName==="BR"?r.dom.getParent(N,"td,th"):N}function G(L){r.selection.setCursorLocation(L,0)}function D(){return I==n.UP||I==n.DOWN}function F(M){var N=M.selection.getNode();var L=M.dom.getParent(N,"tr");return L!==null}function B(M){var L=0;var N=M;while(N.previousSibling){N=N.previousSibling;L=L+j(N,"colspan")}return L}function w(N,L){var O=0,M=0;m(N.children,function(P,Q){O=O+j(P,"colspan");M=Q;if(O>L){return false}});return M}function E(N,Q,S,P){var R=B(r.dom.getParent(Q,"td,th"));var M=w(S,R);var L=S.childNodes[M];var O=u(L,P);G(O||L)}function K(L){var N=r.selection.getNode();var O=r.dom.getParent(N,"td,th");var M=r.dom.getParent(L,"td,th");return O&&O!==M&&z(O,M)}function z(M,L){return r.dom.getParent(M,"TABLE")===r.dom.getParent(L,"TABLE")}if(D()&&F(r)){var J=r.selection.getNode();setTimeout(function(){if(K(J)){A(!C.shiftKey&&I===n.UP,J,C)}},0)}}r.on("KeyDown",function(u){t(u)})}function o(){function t(v,w){var x=w.ownerDocument,u=x.createRange(),y;u.setStartBefore(w);u.setEnd(v.endContainer,v.endOffset);y=x.createElement("body");y.appendChild(u.cloneContents());return y.innerHTML.replace(/<(br|img|object|embed|input|textarea)[^>]*>/gi,"-").replace(/<[^>]+>/g,"").length===0}r.on("KeyDown",function(w){var u,v,x=r.dom;if(w.keyCode==37||w.keyCode==38){u=r.selection.getRng();v=x.getParent(u.startContainer,"table");if(v&&r.getBody().firstChild==v){if(t(u,v)){u=x.createRng();u.setStartBefore(v);u.setEndBefore(v);r.selection.setRng(u);w.preventDefault()}}}})}function q(){r.on("KeyDown SetContent VisualAid",function(){var t;for(t=r.getBody().lastChild;t;t=t.previousSibling){if(t.nodeType==3){if(t.nodeValue.length>0){break}}else{if(t.nodeType==1&&!t.getAttribute("data-mce-bogus")){break}}}if(t&&t.nodeName=="TABLE"){if(r.settings.forced_root_block){r.dom.add(r.getBody(),r.settings.forced_root_block,null,k.ie?"&nbsp;":'<br data-mce-bogus="1" />')}else{r.dom.add(r.getBody(),"br",{"data-mce-bogus":"1"})}}});r.on("PreProcess",function(u){var t=u.node.lastChild;if(t&&(t.nodeName=="BR"||(t.childNodes.length==1&&(t.firstChild.nodeName=="BR"||t.firstChild.nodeValue=="\u00a0")))&&t.previousSibling&&t.previousSibling.nodeName=="TABLE"){r.dom.remove(t)}})}function p(){function t(A,w,x,C){var y=3,D=A.dom.getParent(w.startContainer,"TABLE");var z,v,B;if(D){z=D.parentNode}v=w.startContainer.nodeType==y&&w.startOffset===0&&w.endOffset===0&&C&&(x.nodeName=="TR"||x==z);B=(x.nodeName=="TD"||x.nodeName=="TH")&&!C;return v||B}function u(){var w=r.selection.getRng();var y=r.selection.getNode();var x=r.dom.getParent(w.startContainer,"TD,TH");if(!t(r,w,y,x)){return}if(!x){x=y}var v=x.lastChild;while(v.lastChild){v=v.lastChild}w.setEnd(v,v.nodeValue.length);r.selection.setRng(w)}r.on("KeyDown",function(){u()});r.on("MouseDown",function(v){if(v.button!=2){u()}})}if(k.webkit){s();p()}if(k.gecko){o();q()}}});h("tinymce/tableplugin/CellSelection",["tinymce/tableplugin/TableGrid","tinymce/dom/TreeWalker","tinymce/util/Tools"],function(k,l,j){return function(r){var t=r.dom,o,s,n,p=true;function m(){r.getBody().style.webkitUserSelect="";if(p){r.dom.removeClass(r.dom.select("td.mce-item-selected,th.mce-item-selected"),"mce-item-selected");p=false}}function q(y){var w,v,x=y.target;if(s&&(o||x!=s)&&(x.nodeName=="TD"||x.nodeName=="TH")){v=t.getParent(x,"table");if(v==n){if(!o){o=new k(r,v);o.setStartCell(s);r.getBody().style.webkitUserSelect="none"}o.setEndCell(x);p=true}w=r.selection.getSel();try{if(w.removeAllRanges){w.removeAllRanges()}else{w.empty()}}catch(u){}y.preventDefault()}}r.on("MouseDown",function(u){if(u.button!=2){m();s=t.getParent(u.target,"td,th");n=t.getParent(s,"table")}});t.bind(r.getDoc(),"mouseover",q);r.on("remove",function(){t.unbind(r.getDoc(),"mouseover",q)});r.on("MouseUp",function(){var w,A=r.selection,v,B,z,y,u;function x(C,E){var D=new l(C,C);do{if(C.nodeType==3&&j.trim(C.nodeValue).length!==0){if(E){w.setStart(C,0)}else{w.setEnd(C,C.nodeValue.length)}return}if(C.nodeName=="BR"){if(E){w.setStartBefore(C)}else{w.setEndBefore(C)}return}}while((C=(E?D.next():D.prev())))}if(s){if(o){r.getBody().style.webkitUserSelect=""}v=t.select("td.mce-item-selected,th.mce-item-selected");if(v.length>0){w=t.createRng();z=v[0];u=v[v.length-1];w.setStartBefore(z);w.setEndAfter(z);x(z,1);B=new l(z,t.getParent(v[0],"table"));do{if(z.nodeName=="TD"||z.nodeName=="TH"){if(!t.hasClass(z,"mce-item-selected")){break}y=z}}while((z=B.next()));x(y);A.setRng(w)}r.nodeChanged();s=o=n=null}});r.on("KeyUp",function(){m()});return{clear:m}}});h("tinymce/tableplugin/Plugin",["tinymce/tableplugin/TableGrid","tinymce/tableplugin/Quirks","tinymce/tableplugin/CellSelection","tinymce/util/Tools","tinymce/dom/TreeWalker","tinymce/Env","tinymce/PluginManager"],function(q,p,r,j,o,l,k){var n=j.each;function m(u){var s,G,C=this;function x(K){return K?K.replace(/px$/,""):""}function D(K){if(/^[0-9]+$/.test(K)){K+="px"}return K}function J(K){n("left center right".split(" "),function(L){u.formatter.remove("align"+L,{},K)})}function t(){var N=u.dom,K,L,M;K=u.dom.getParent(u.selection.getStart(),"table");M=false;L={width:x(N.getStyle(K,"width")||N.getAttrib(K,"width")),height:x(N.getStyle(K,"height")||N.getAttrib(K,"height")),cellspacing:N.getAttrib(K,"cellspacing")||"",cellpadding:N.getAttrib(K,"cellpadding")||"",border:N.getAttrib(K,"border")||"",caption:!!N.select("caption",K)[0]};n("left center right".split(" "),function(O){if(u.formatter.matchNode(K,"align"+O)){L.align=O}});u.windowManager.open({title:"Table properties",items:{type:"form",layout:"grid",columns:2,data:L,defaults:{type:"textbox",maxWidth:50},items:[M?{label:"Cols",name:"cols",disabled:true}:null,M?{label:"Rows",name:"rows",disabled:true}:null,{label:"Width",name:"width"},{label:"Height",name:"height"},{label:"Cell spacing",name:"cellspacing"},{label:"Cell padding",name:"cellpadding"},{label:"Border",name:"border"},{label:"Caption",name:"caption",type:"checkbox"},{label:"Alignment",minWidth:150,name:"align",type:"listbox",text:"None",maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}]},onsubmit:function(){var P=this.toJSON(),O;u.undoManager.transact(function(){u.dom.setAttribs(K,{cellspacing:D(P.cellspacing),cellpadding:D(P.cellpadding),border:D(P.border),width:D(P.width),height:D(P.height)});u.dom.setStyles(K,{width:D(P.width),height:D(P.height)});var Q=N.select("td",K);u.dom.setStyles(Q,{borderWidth:D(P.border),padding:D(P.cellpadding),margin:D(P.cellspacing)});O=N.select("caption",K)[0];if(O&&!P.caption){N.remove(O)}if(!O&&P.caption){O=N.create("caption");if(!l.ie){O.innerHTML='<br data-mce-bogus="1"/>'}K.insertBefore(O,K.firstChild)}J(K);if(P.align){u.formatter.apply("align"+P.align,{},K)}u.focus();u.addVisual()})}})}function E(L,K){u.windowManager.alert("Plase select cells you would like to merge");return;u.windowManager.open({title:"Merge cells",body:[{label:"Cols",name:"cols",type:"textbox",size:10},{label:"Rows",name:"rows",type:"textbox",size:10}],onsubmit:function(){var M=this.toJSON();u.undoManager.transact(function(){L.merge(K,M.cols||1,M.rows||1)})}})}function w(){var P=u.dom,L,N,K=[];K=u.dom.select("td.mce-item-selected,th.mce-item-selected");L=u.dom.getParent(u.selection.getStart(),"td,th");if(!K.length&&L){K.push(L)}L=L||K[0];N={width:x(P.getStyle(L,"width")||P.getAttrib(L,"width")),height:x(P.getStyle(L,"height")||P.getAttrib(L,"height")),scope:P.getAttrib(L,"scope")};N.type=L.nodeName.toLowerCase();n("left center right".split(" "),function(Q){if(u.formatter.matchNode(L,"align"+Q)){N.align=Q}});var M=500,O=500;u.windowManager.open({title:"Cell properties",items:{type:"form",data:N,layout:"grid",columns:2,defaults:{type:"textbox",maxWidth:50},items:[{label:"Width",name:"width",onchange:function(){if(Number(this.value())>M){this.value(M)}}},{label:"Height",name:"height",onchange:function(){if(Number(this.value())>O){this.value(O)}}},{label:"Cell type",name:"type",type:"listbox",text:"None",minWidth:150,maxWidth:null,menu:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{label:"Scope",name:"scope",type:"listbox",text:"None",minWidth:150,maxWidth:null,menu:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{label:"Alignment",name:"align",type:"listbox",text:"None",minWidth:150,maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}]},onsubmit:function(){var Q=this.toJSON();u.undoManager.transact(function(){n(K,function(R){u.dom.setAttrib(R,"scope",Q.scope);Q.width=Q.width&&Number(Q.width)>M?M:Q.width;Q.height=Q.height&&Number(Q.height)>O?O:Q.height;u.dom.setStyles(R,{width:D(Q.width),height:D(Q.height)});if(Q.type&&R.nodeName.toLowerCase()!=Q.type){R=P.rename(R,Q.type)}J(R);if(Q.align){u.formatter.apply("align"+Q.align,{},R)}});u.focus()})}})}function y(){var P=u.dom,K,M,L,O,N=[];K=u.dom.getParent(u.selection.getStart(),"table");M=u.dom.getParent(u.selection.getStart(),"td,th");n(K.rows,function(Q){n(Q.cells,function(R){if(P.hasClass(R,"mce-item-selected")||R==M){N.push(Q);return false}})});L=N[0];O={height:x(P.getStyle(L,"height")||P.getAttrib(L,"height")),scope:P.getAttrib(L,"scope")};O.type=L.parentNode.nodeName.toLowerCase();n("left center right".split(" "),function(Q){if(u.formatter.matchNode(L,"align"+Q)){O.align=Q}});u.windowManager.open({title:"Row properties",items:{type:"form",data:O,columns:2,defaults:{type:"textbox"},items:[{type:"listbox",name:"type",label:"Row type",text:"None",maxWidth:null,menu:[{text:"Header",value:"thead"},{text:"Body",value:"tbody"},{text:"Footer",value:"tfoot"}]},{type:"listbox",name:"align",label:"Alignment",text:"None",maxWidth:null,menu:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height"}]},onsubmit:function(){var S=this.toJSON(),Q,R,T;u.undoManager.transact(function(){var U=S.type;n(N,function(V){u.dom.setAttrib(V,"scope",S.scope);u.dom.setStyles(V,{height:D(S.height)});if(U!=V.parentNode.nodeName.toLowerCase()){Q=P.getParent(V,"table");R=V.parentNode;T=P.select(U,Q)[0];if(!T){T=P.create(U);if(Q.firstChild){Q.insertBefore(T,Q.firstChild)}else{Q.appendChild(T)}}T.appendChild(V);if(!R.hasChildNodes()){P.remove(R)}}J(V);if(S.align){u.formatter.apply("align"+S.align,{},V)}});u.focus()})}})}function F(K){return function(){u.execCommand(K)}}function A(N,M){var O,K,L;L="<table><tbody>";for(O=0;O<M;O++){L+="<tr>";for(K=0;K<N;K++){L+="<td>"+(l.ie?" ":"<br>")+"</td>"}L+="</tr>"}L+="</tbody></table>";u.insertContent(L)}function H(L,K){function M(){L.disabled(!u.dom.getParent(u.selection.getStart(),K));u.selection.selectorChanged(K,function(N){L.disabled(!N)})}if(u.initialized){M()}else{u.on("init",M)}}function B(){H(this,"table")}function z(){H(this,"td,th")}function v(){var L="";L='<table role="presentation" class="mce-grid mce-grid-border">';for(var M=0;M<10;M++){L+="<tr>";for(var K=0;K<10;K++){L+='<td><a href="#" data-mce-index="'+K+","+M+'"></a></td>'}L+="</tr>"}L+="</table>";L+='<div class="mce-text-center">0 x 0</div>';return L}u.addMenuItem("inserttable",{text:"Insert table",icon:"table",context:"table",onhide:function(){u.dom.removeClass(this.menu.items()[0].getEl().getElementsByTagName("a"),"mce-active")},menu:[{type:"container",html:v(),onmousemove:function(N){var K,P,M=N.target;if(M.nodeName=="A"){var L=u.dom.getParent(M,"table");var O=M.getAttribute("data-mce-index");if(O!=this.lastPos){O=O.split(",");O[0]=parseInt(O[0],10);O[1]=parseInt(O[1],10);if(N.control.isRtl()){for(P=9;P>=0;P--){for(K=0;K<10;K++){u.dom.toggleClass(L.rows[P].childNodes[K].firstChild,"mce-active",K>=O[0]&&P<=O[1])}}O[0]=10-O[0];L.nextSibling.innerHTML=O[0]+" x "+(O[1]+1)}else{for(P=0;P<10;P++){for(K=0;K<10;K++){u.dom.toggleClass(L.rows[P].childNodes[K].firstChild,"mce-active",K<=O[0]&&P<=O[1])}}L.nextSibling.innerHTML=(O[0]+1)+" x "+(O[1]+1)}this.lastPos=O}}},onclick:function(K){if(K.target.nodeName=="A"&&this.lastPos){K.preventDefault();A(this.lastPos[0]+1,this.lastPos[1]+1);this.parent().cancel()}}}]});u.addMenuItem("tableprops",{text:"Table properties",context:"table",onPostRender:B,onclick:t});u.addMenuItem("deletetable",{text:"Delete table",context:"table",onPostRender:B,cmd:"mceTableDelete"});u.addMenuItem("cell",{separator:"before",text:"Cell",context:"table",menu:[{text:"Cell properties",onclick:F("mceTableCellProps"),onPostRender:z},{text:"Merge cells",onclick:F("mceTableMergeCells"),onPostRender:z},{text:"Split cell",onclick:F("mceTableSplitCells"),onPostRender:z}]});u.addMenuItem("row",{text:"Row",context:"table",menu:[{text:"Insert row before",onclick:F("mceTableInsertRowBefore"),onPostRender:z},{text:"Insert row after",onclick:F("mceTableInsertRowAfter"),onPostRender:z},{text:"Delete row",onclick:F("mceTableDeleteRow"),onPostRender:z},{text:"Row properties",onclick:F("mceTableRowProps"),onPostRender:z},{text:"-"},{text:"Cut row",onclick:F("mceTableCutRow"),onPostRender:z},{text:"Copy row",onclick:F("mceTableCopyRow"),onPostRender:z},{text:"Paste row before",onclick:F("mceTablePasteRowBefore"),onPostRender:z},{text:"Paste row after",onclick:F("mceTablePasteRowAfter"),onPostRender:z}]});u.addMenuItem("column",{text:"Column",context:"table",menu:[{text:"Insert column before",onclick:F("mceTableInsertColBefore"),onPostRender:z},{text:"Insert column after",onclick:F("mceTableInsertColAfter"),onPostRender:z},{text:"Delete column",onclick:F("mceTableDeleteCol"),onPostRender:z}]});var I=[];n("inserttable tableprops deletetable | cell row column".split(" "),function(K){if(K=="|"){I.push({text:"-"})}else{I.push(u.menuItems[K])}});u.addButton("table",{type:"menubutton",tooltip:"Table",menu:I});if(!l.isIE){u.on("click",function(K){K=K.target;if(K.nodeName==="TABLE"){u.selection.select(K);u.nodeChanged()}})}C.quirks=new p(u);u.on("Init",function(){s=u.windowManager;C.cellSelection=new r(u)});n({mceTableSplitCells:function(K){K.split()},mceTableMergeCells:function(L){var M,N,K;K=u.dom.getParent(u.selection.getStart(),"th,td");if(K){M=K.rowSpan||1;N=K.colSpan||1}if(!u.dom.select("td.mce-item-selected,th.mce-item-selected").length){E(L,K)}else{L.merge()}},mceTableInsertRowBefore:function(K){K.insertRow(true)},mceTableInsertRowAfter:function(K){K.insertRow()},mceTableInsertColBefore:function(K){K.insertCol(true)},mceTableInsertColAfter:function(K){K.insertCol()},mceTableDeleteCol:function(K){K.deleteCols()},mceTableDeleteRow:function(K){K.deleteRows()},mceTableCutRow:function(K){G=K.cutRows()},mceTableCopyRow:function(K){G=K.copyRows()},mceTablePasteRowBefore:function(K){K.pasteRows(G,true)},mceTablePasteRowAfter:function(K){K.pasteRows(G)},mceTableDelete:function(K){K.deleteTable()}},function(L,K){u.addCommand(K,function(){var M=new q(u);if(M){L(M);u.execCommand("mceRepaint");C.cellSelection.clear()}})});n({mceInsertTable:function(){t()},mceTableRowProps:y,mceTableCellProps:w},function(L,K){u.addCommand(K,function(M,N){L(N)})})}k.add("table",m)});a(["tinymce/tableplugin/TableGrid","tinymce/tableplugin/Quirks","tinymce/tableplugin/CellSelection","tinymce/tableplugin/Plugin"])})(this);tinymce.PluginManager.add("save",function(c){function b(){var e,f;return e=tinymce.DOM.getParent(c.id,"form"),!c.getParam("save_enablewhendirty",!0)||c.isDirty()?(tinymce.triggerSave(),(f=c.getParam("save_onsavecallback"))?(c.execCallback("save_onsavecallback",c)&&(c.startContent=tinymce.trim(c.getContent({format:"raw"})),c.nodeChanged()),void 0):(e?(c.isNotDirty=!0,(!e.onsubmit||e.onsubmit())&&("function"==typeof e.submit?e.submit():c.windowManager.alert("Error: Form submit field collision.")),c.nodeChanged()):c.windowManager.alert("Error: No form element found."),void 0)):void 0}function d(){var e,f=tinymce.trim(c.startContent);return(e=c.getParam("save_oncancelcallback"))?(c.execCallback("save_oncancelcallback",c),void 0):(c.setContent(f),c.undoManager.clear(),c.nodeChanged(),void 0)}function a(){var e=this;c.on("nodeChange",function(){e.disabled(c.getParam("save_enablewhendirty",!0)&&!c.isDirty())})}c.addCommand("mceSave",b),c.addCommand("mceCancel",d),c.addButton("save",{icon:"save",text:"Save",cmd:"mceSave",disabled:!0,onPostRender:a}),c.addButton("cancel",{text:"Cancel",icon:!1,cmd:"mceCancel",disabled:!0,onPostRender:a}),c.addShortcut("ctrl+s","","mceSave")});tinymce.PluginManager.add("hr",function(a){a.addCommand("InsertHorizontalRule",function(){a.execCommand("mceInsertContent",!1,"<hr />")}),a.addButton("hr",{icon:"hr",tooltip:"Horizontal line",cmd:"InsertHorizontalRule"}),a.addMenuItem("hr",{icon:"hr",text:"Horizontal line",cmd:"InsertHorizontalRule",context:"insert"})});tinymce.PluginManager.add("image",function(d){function c(g,j){var f=document.createElement("img");function e(l,k){f.parentNode.removeChild(f);j({width:l,height:k})}f.onload=function(){e(f.clientWidth,f.clientHeight)};f.onerror=function(){e()};f.src=g;var h=f.style;h.visibility="hidden";h.position="fixed";h.bottom=h.left=0;h.width=h.height="auto";document.body.appendChild(f)}function b(e){return function(){var f=d.settings.image_list;if(typeof(f)=="string"){tinymce.util.XHR.send({url:f,success:function(g){e(tinymce.util.JSON.parse(g))}})}else{e(f)}}}function a(h){d.lastSelectionBookmark=d.selection.getBookmark();var p,o,n=d.dom,q=d.selection.getNode();var f,t,r;var m=9999,e=9999;function s(){var w=[{text:"None",value:""}];tinymce.each(h,function(x){w.push({text:x.text||x.title,value:x.value||x.url,menu:x.menu})});return w}function k(B){var x,A,z,w;x=p.find("#width")[0];A=p.find("#height")[0];if(parseInt(x.value())>m){x.value(m)}if(parseInt(A.value())>e){A.value(e)}z=x.value()||0;w=A.value()||0;if(p.find("#constrain")[0].checked()&&f&&t){var y=f/t;if(B.control==x){w=Math.round(z/y);if(w>e){w=e;z=w*y;x.value(z||0)}A.value(w||0)}else{z=Math.round(w*y);if(z>m){z=m;w=Math.round(z/y);A.value(w||0)}x.value(z||0)}}f=z;t=w}function l(){d.selection.moveToBookmark(d.lastSelectionBookmark);function w(z){function y(){z.onload=z.onerror=null;z.click();d.selection.select(z);d.nodeChanged()}z.onload=function(){if(!x.width&&!x.height){n.setAttribs(z,{width:z.clientWidth,height:z.clientHeight})}y()};z.onerror=y}var x=p.toJSON();if(!x.width){x.width=null}if(!x.height){x.height=null}if(!x.style){x.style=null}x={src:x.src,alt:x.alt,width:x.width,height:x.height,style:x.style};d.undoManager.transact(function(){if(!x.src){if(q){n.remove(q);d.nodeChanged()}return}if(!q){x.id="__mcenew";d.selection.setContent(n.createHTML("img",x));q=n.get("__mcenew");n.setAttrib(q,"id",null)}else{n.setAttribs(q,x)}w(q)})}function v(w){if(w){w=w.replace(/px$/,"")}return w}function j(){c(p.find("#src").value(),function(w){if(w.width&&w.height){f=w.width||"";t=w.height||"";p.find("#width").value(f);p.find("#height").value(t)}})}f=n.getAttrib(q,"width");t=n.getAttrib(q,"height");if(q.nodeName=="IMG"&&!q.getAttribute("data-mce-object")){o={src:n.getAttrib(q,"src"),alt:n.getAttrib(q,"alt"),width:f,height:t}}else{q=null}if(h){r={name:"target",type:"listbox",label:"Image list",values:s(),onselect:function(w){var x=p.find("#alt");if(!x.value()||(w.lastControl&&x.value()==w.lastControl.text())){x.value(w.control.text())}p.find("#src").value(w.control.value())}}}var g=[{name:"src",type:"filepicker",filetype:"image",label:"Source",minWidth:270,autofocus:true,onchange:j},r,{name:"alt",type:"textbox",label:"Image description"},{type:"container",label:"Dimensions",layout:"flex",direction:"row",align:"center",spacing:5,items:[{name:"width",type:"textbox",maxLength:4,size:4,onchange:k,onkeyup:k},{type:"label",text:"x"},{name:"height",type:"textbox",maxLength:4,size:4,onchange:k,onkeyup:k},{name:"constrain",type:"checkbox",checked:true,text:"Constrain proportions"}]}];function u(){function y(z){if(z.length>0&&/^[0-9]+$/.test(z)){z+="px"}return z}var x=p.toJSON();var w=n.parseStyle(x.style);n.setAttrib(q,"style","");delete w.margin;w["margin-top"]=w["margin-bottom"]=y(x.vspace);w["margin-left"]=w["margin-right"]=y(x.hspace);w["border-width"]=y(x.border);p.find("#style").value(n.serializeStyle(n.parseStyle(n.serializeStyle(w))))}if(d.settings.image_advtab){if(q){o.hspace=v(q.style.marginLeft||q.style.marginRight);o.vspace=v(q.style.marginTop||q.style.marginBottom);o.border=v(q.style.borderWidth);o.style=d.dom.serializeStyle(d.dom.parseStyle(d.dom.getAttrib(q,"style")))}p=d.windowManager.open({title:"Insert/edit image",data:o,bodyType:"tabpanel",body:[{title:"General",type:"form",items:g},{title:"Advanced",type:"form",pack:"start",items:[{label:"Style",name:"style",type:"textbox"},{type:"form",layout:"grid",packV:"start",columns:2,padding:0,alignH:["left","right"],defaults:{type:"textbox",maxWidth:50,onchange:u},items:[{label:"Vertical space",name:"vspace"},{label:"Horizontal space",name:"hspace"},{label:"Border",name:"border"}]}]}],onSubmit:l})}else{p=d.windowManager.open({title:"Insert/edit image",data:o,body:g,onSubmit:l})}j()}d.addButton("image",{icon:"image",tooltip:"Insert/edit image",onclick:b(a),stateSelector:"img:not([data-mce-object])"});d.addMenuItem("image",{icon:"image",text:"Insert image",onclick:b(a),context:"insert",prependToContext:true})});tinymce.PluginManager.add("link",function(c){function b(d){return function(){var e=c.settings.link_list;if(typeof(e)=="string"){tinymce.util.XHR.send({url:e,success:function(f){d(tinymce.util.JSON.parse(f))}})}else{d(e)}}}function a(t){var k={},n=c.selection,j=c.dom,f,u,q;var l,m,h,d;function g(v){var w=l.find("#text");if(!w.value()||(v.lastControl&&w.value()==v.lastControl.text())){w.value(v.control.text())}l.find("#href").value(v.control.value())}function p(){var v=[{text:"None",value:""}];tinymce.each(t,function(w){v.push({text:w.text||w.title,value:w.value||w.url,menu:w.menu})});return v}function s(v){var w=[{text:"None",value:""}];tinymce.each(c.settings.rel_list,function(x){w.push({text:x.text||x.title,value:x.value,selected:v===x.value})});return w}function r(w){var v=[{text:"None",value:""}];if(!c.settings.target_list){v.push({text:"New window",value:"_blank"})}tinymce.each(c.settings.target_list,function(x){v.push({text:x.text||x.title,value:x.value,selected:w===x.value})});return v}function o(v){var w=[];tinymce.each(c.dom.select("a:not([href])"),function(x){var y=x.name||x.id;if(y){w.push({text:y,value:"#"+y,selected:v.indexOf("#"+y)!=-1})}});if(w.length){w.unshift({text:"None",value:""});return{name:"anchor",type:"listbox",label:"Anchors",values:w,onselect:g}}}function e(){if(!q&&k.text.length===0){this.parent().parent().find("#text")[0].value(this.value());this.parent().parent().find("#external")[0].checked(/^http:\/\//.test(this.value()))}}f=n.getNode();u=j.getParent(f,"a[href]");k.text=q=u?(u.innerText||u.textContent):n.getContent({format:"text"});k.href=u?j.getAttrib(u,"href"):"";k.target=u?j.getAttrib(u,"target"):"";k.rel=u?j.getAttrib(u,"rel"):"";if(f.nodeName=="IMG"){k.text=q=" "}if(t){m={type:"listbox",label:"Link list",values:p(),onselect:g}}if(c.settings.target_list!==false){d={name:"target",type:"listbox",label:"Target",values:r(k.target)}}if(c.settings.rel_list){h={name:"rel",type:"listbox",label:"Rel",values:s(k.rel)}}l=c.windowManager.open({title:"Insert link",data:k,body:[{name:"href",type:"filepicker",filetype:"file",size:40,autofocus:true,label:"Url",onchange:e,onkeyup:e},{name:"external",type:"checkbox",label:"External link",checked:/^http:\/\//.test(k.href),onclick:function(){var v=this.parent().parent().find("#href")[0];v.value(v.value().replace(/^http:\/\//,""));if(this.value()){v.value("http://"+v.value())}}},{name:"text",type:"textbox",size:40,label:"Text to display",onchange:function(){k.text=this.value()}},o(k.href),m,h,d],onSubmit:function(z){var y=z.data,v=y.href;function x(A,B){window.setTimeout(function(){c.windowManager.confirm(A,B)},0)}function w(){if(y.text==""){y.text=tinymce.translate("link")}if(c.selection.isCollapsed()&&c.lastSelectionBookmark){c.selection.moveToBookmark(c.lastSelectionBookmark)}if(y.text!=q){if(u){c.focus();u.innerHTML=y.text;j.setAttribs(u,{href:v,target:y.target?y.target:null,rel:y.rel?y.rel:null});n.select(u)}else{c.insertContent(j.createHTML("a",{href:v,target:y.target?y.target:null,rel:y.rel?y.rel:null},y.text))}}else{c.execCommand("mceInsertLink",false,{href:v,target:y.target,rel:y.rel?y.rel:null})}}if(!v){c.execCommand("unlink");return}if(v.indexOf("@")>0&&v.indexOf("//")==-1&&v.indexOf("mailto:")==-1){x("The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?",function(A){if(A){v="mailto:"+v}w()});return}w()}})}c.addButton("link",{icon:"link",tooltip:"Insert/edit link",shortcut:"Ctrl+K",onclick:b(a),stateSelector:"a[href]"});c.addButton("unlink",{icon:"unlink",tooltip:"Remove link",cmd:"unlink",stateSelector:"a[href]"});c.addShortcut("Ctrl+K","",b(a));this.showDialog=a;c.addMenuItem("link",{icon:"link",text:"Insert link",shortcut:"Ctrl+K",onclick:b(a),stateSelector:"a[href]",context:"insert",prependToContext:true})});tinymce.PluginManager.add("emoticons",function(b,c){function d(){var e;return e='<table role="presentation" class="mce-grid">',tinymce.each(a,function(f){e+="<tr>",tinymce.each(f,function(h){var g=c+"/img/smiley-"+h+".gif";e+='<td><a href="#" data-mce-url="'+g+'" tabindex="-1"><img src="'+g+'" style="width: 18px; height: 18px"></a></td>'}),e+="</tr>"}),e+="</table>"}var a=[["cool","cry","embarassed","foot-in-mouth"],["frown","innocent","kiss","laughing"],["money-mouth","sealed","smile","surprised"],["tongue-out","undecided","wink","yell"]];b.addButton("emoticons",{type:"panelbutton",panel:{autohide:!0,html:d,onclick:function(f){var g=b.dom.getParent(f.target,"a");g&&(b.insertContent('<img src="'+g.getAttribute("data-mce-url")+'" />'),this.hide())}},tooltip:"Emoticons"})});tinymce.PluginManager.add("insertdatetime",function(h){function k(e,l){function a(p,o){if(p=""+p,p.length<o){for(var q=0;q<o-p.length;q++){p="0"+p}}return p}return l=l||new Date,e=e.replace("%D","%m/%d/%Y"),e=e.replace("%r","%I:%M:%S %p"),e=e.replace("%Y",""+l.getFullYear()),e=e.replace("%y",""+l.getYear()),e=e.replace("%m",a(l.getMonth()+1,2)),e=e.replace("%d",a(l.getDate(),2)),e=e.replace("%H",""+a(l.getHours(),2)),e=e.replace("%M",""+a(l.getMinutes(),2)),e=e.replace("%S",""+a(l.getSeconds(),2)),e=e.replace("%I",""+((l.getHours()+11)%12+1)),e=e.replace("%p",""+(l.getHours()<12?"AM":"PM")),e=e.replace("%B",""+h.translate(m[l.getMonth()])),e=e.replace("%b",""+h.translate(c[l.getMonth()])),e=e.replace("%A",""+h.translate(b[l.getDay()])),e=e.replace("%a",""+h.translate(j[l.getDay()])),e=e.replace("%%","%")}function d(p){var l=k(p);if(h.settings.insertdatetime_element){var e;e=/%[HMSIp]/.test(p)?k("%Y-%m-%dT%H:%M"):k("%Y-%m-%d"),l='<time datetime="'+e+'">'+l+"</time>";var o=h.dom.getParent(h.selection.getStart(),"time");if(o){return h.dom.setOuterHTML(o,l),void 0}}h.insertContent(l)}var g,j="Sun Mon Tue Wed Thu Fri Sat Sun".split(" "),b="Sunday Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "),c="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),m="January February March April May June July August September October November December".split(" "),f=[];h.addCommand("mceInsertDate",function(){d(h.getParam("insertdatetime_dateformat",h.translate("%Y-%m-%d")))}),h.addCommand("mceInsertTime",function(){d(h.getParam("insertdatetime_timeformat",h.translate("%H:%M:%S")))}),h.addButton("inserttime",{type:"splitbutton",title:"Insert time",onclick:function(){d(g||"%H:%M:%S")},menu:f}),tinymce.each(h.settings.insertdatetime_formats||["%H:%M:%S","%Y-%m-%d","%I:%M:%S %p","%D"],function(a){f.push({text:k(a),onclick:function(){g=a,d(a)}})}),h.addMenuItem("insertdatetime",{icon:"date",text:"Insert date/time",menu:f,context:"insert"})});tinymce.PluginManager.add("preview",function(b){var a=b.settings;b.addCommand("mcePreview",function(){b.windowManager.open({title:"Preview",width:parseInt(b.getParam("plugin_preview_width","650"),10),height:parseInt(b.getParam("plugin_preview_height","500"),10),html:'<iframe src="javascript:\'\'" frameborder="0"></iframe>',buttons:{text:"Close",onclick:function(){this.parent().parent().close()}},onPostRender:function(){var g,d=this.getEl("body").firstChild.contentWindow.document,c="";tinymce.each(b.contentCSS,function(h){c+='<link type="text/css" rel="stylesheet" href="'+b.documentBaseURI.toAbsolute(h)+'">'});var e=a.body_id||"tinymce";-1!=e.indexOf("=")&&(e=b.getParam("body_id","","hash"),e=e[b.id]||e);var f=a.body_class||"";-1!=f.indexOf("=")&&(f=b.getParam("body_class","","hash"),f=f[b.id]||""),g="<!DOCTYPE html><html><head>"+c+'</head><body id="'+e+'" class="mce-content-body '+f+'">'+b.getContent()+"</body></html>",d.open(),d.write(g),d.close()}})}),b.addButton("preview",{title:"Preview",cmd:"mcePreview"}),b.addMenuItem("preview",{text:"Preview",cmd:"mcePreview",context:"view"})});tinymce.PluginManager.add("media",function(j,p){function h(a){return -1!=a.indexOf(".mp3")?"audio/mpeg":-1!=a.indexOf(".wav")?"audio/wav":-1!=a.indexOf(".mp4")?"video/mp4":-1!=a.indexOf(".webm")?"video/webm":-1!=a.indexOf(".ogg")?"video/ogg":-1!=a.indexOf(".swf")?"application/x-shockwave-flash":""}function d(){function e(u){var o,m,s,v;o=c.find("#width")[0],m=c.find("#height")[0],s=o.value(),v=m.value(),c.find("#constrain")[0].checked()&&r&&n&&s&&v&&(u.control==o?(v=Math.round(s/r*v),m.value(v)):(s=Math.round(v/n*s),o.value(s))),r=s,n=v}var c,r,n,a;a=f(j.selection.getNode()),r=a.width,n=a.height,c=j.windowManager.open({title:"Insert/edit video",data:a,bodyType:"tabpanel",body:[{title:"General",type:"form",onShowTab:function(){this.fromJSON(k(this.next().find("#embed").value()))},items:[{name:"source1",type:"filepicker",filetype:"media",size:40,autofocus:!0,label:"Source"},{name:"source2",type:"filepicker",filetype:"media",size:40,label:"Alternative source"},{name:"poster",type:"filepicker",filetype:"image",size:40,label:"Poster"},{type:"container",label:"Dimensions",layout:"flex",align:"center",spacing:5,items:[{name:"width",type:"textbox",maxLength:3,size:3,onchange:e},{type:"label",text:"x"},{name:"height",type:"textbox",maxLength:3,size:3,onchange:e},{name:"constrain",type:"checkbox",checked:!0,text:"Constrain proportions"}]}]},{title:"Embed",type:"panel",layout:"flex",direction:"column",align:"stretch",padding:10,spacing:10,onShowTab:function(){this.find("#embed").value(b(this.parent().toJSON()))},items:[{type:"label",text:"Paste your embed code below:"},{type:"textbox",flex:1,name:"embed",value:l(),multiline:!0,label:"Source"}]}],onSubmit:function(){j.insertContent(b(this.toJSON()))}})}function l(){var a=j.selection.getNode();return a.getAttribute("data-mce-object")?j.selection.getContent():void 0}function b(e){var c="";return e.source1||(tinymce.extend(e,k(e.embed)),e.source1)?(e.source1=j.convertURL(e.source1,"source"),e.source2=j.convertURL(e.source2,"source"),e.source1mime=h(e.source1),e.source2mime=h(e.source2),e.poster=j.convertURL(e.poster,"poster"),e.flashPlayerUrl=j.convertURL(p+"/moxieplayer.swf","movie"),e.embed?c=q(e.embed,e,!0):(tinymce.each(g,function(r){var o,n,m;if(o=r.regex.exec(e.source1)){for(m=r.url,n=0;o[n];n++){m=m.replace("$"+n,function(){return o[n]})}e.source1=m,e.type=r.type,e.width=r.w,e.height=r.h}}),e.width=e.width||300,e.height=e.height||150,tinymce.each(e,function(m,a){e[a]=j.dom.encode(m)}),"iframe"==e.type?c+='<iframe src="'+e.source1+'" width="'+e.width+'" height="'+e.height+'"></iframe>':"application/x-shockwave-flash"==e.source1mime?(c+='<object data="'+e.source1+'" width="'+e.width+'" height="'+e.height+'" type="application/x-shockwave-flash">',e.poster&&(c+='<img src="'+e.poster+'" width="'+e.width+'" height="'+e.height+'" />'),c+="</object>"):-1!=e.source1mime.indexOf("audio")?j.settings.audio_template_callback?c=j.settings.audio_template_callback(e):c+='<audio controls="controls" src="'+e.source1+'">'+(e.source2?'\n<source src="'+e.source2+'"'+(e.source2mime?' type="'+e.source2mime+'"':"")+" />\n":"")+"</audio>":c=j.settings.video_template_callback?j.settings.video_template_callback(e):'<video width="'+e.width+'" height="'+e.height+'"'+(e.poster?' poster="'+e.poster+'"':"")+' controls="controls">\n<source src="'+e.source1+'"'+(e.source1mime?' type="'+e.source1mime+'"':"")+" />\n"+(e.source2?'<source src="'+e.source2+'"'+(e.source2mime?' type="'+e.source2mime+'"':"")+" />\n":"")+"</video>"),c):""}function k(c){var a={};return new tinymce.html.SaxParser({validate:!1,special:"script,noscript",start:function(n,m){a.source1||"param"!=n||(a.source1=m.map.movie),("iframe"==n||"object"==n||"embed"==n||"video"==n||"audio"==n)&&(a=tinymce.extend(m.map,a)),"source"==n&&(a.source1?a.source2||(a.source2=m.map.src):a.source1=m.map.src),"img"!=n||a.poster||(a.poster=m.map.src)}}).parse(c),a.source1=a.source1||a.src||a.data,a.source2=a.source2||"",a.poster=a.poster||"",a}function f(a){return a.getAttribute("data-mce-object")?k(j.serializer.serialize(a,{selection:!0})):{}}function q(v,s,n){function w(B,z){var y,C,c,A;for(y in z){if(c=""+z[y],B.map[y]){for(C=B.length;C--;){A=B[C],A.name==y&&(c?(B.map[y]=c,A.value=c):(delete B.map[y],B.splice(C,1)))}}else{c&&(B.push({name:y,value:c}),B.map[y]=c)}}}var m,u=new tinymce.html.Writer,x=0;return new tinymce.html.SaxParser({validate:!1,special:"script,noscript",comment:function(a){u.comment(a)},cdata:function(a){u.cdata(a)},text:function(c,a){u.text(c,a)},start:function(c,o,a){switch(c){case"video":case"object":case"embed":case"img":case"iframe":w(o,{width:s.width,height:s.height})}if(n){switch(c){case"video":w(o,{poster:s.poster,src:""}),s.source2&&w(o,{src:""});break;case"iframe":w(o,{src:s.source1});break;case"source":if(x++,2>=x&&(w(o,{src:s["source"+x],type:s["source"+x+"mime"]}),!s["source"+x])){return}break;case"img":if(!s.poster){return}m=!0}}u.start(c,o,a)},end:function(o){if("video"==o&&n){for(var r=1;2>=r;r++){if(s["source"+r]){var c=[];c.map={},r>x&&(w(c,{src:s["source"+r],type:s["source"+r+"mime"]}),u.start("source",c,!0))}}}if(s.poster&&"object"==o&&n&&!m){var a=[];a.map={},w(a,{src:s.poster,width:s.width,height:s.height}),u.start("img",a,!0)}u.end(o)}},new tinymce.html.Schema({})).parse(v),u.getContent()}var g=[{regex:/youtu\.be\/([a-z1-9.-_]+)/,type:"iframe",w:425,h:350,url:"http://www.youtube.com/embed/$1"},{regex:/youtube\.com(.+)v=([^&]+)/,type:"iframe",w:425,h:350,url:"http://www.youtube.com/embed/$2"},{regex:/vimeo\.com\/([0-9]+)/,type:"iframe",w:425,h:350,url:"http://player.vimeo.com/video/$1?title=0&byline=0&portrait=0&color=8dc7dc"},{regex:/maps\.google\.([a-z]{2,3})\/maps\/(.+)msid=(.+)/,type:"iframe",w:425,h:350,url:'http://maps.google.com/maps/ms?msid=$2&output=embed"'}];j.on("ResolveName",function(c){var a;1==c.target.nodeType&&(a=c.target.getAttribute("data-mce-object"))&&(c.name=a)}),j.on("preInit",function(){var c=j.schema.getSpecialElements();tinymce.each("video audio iframe object".split(" "),function(m){c[m]=new RegExp("</"+m+"[^>]*>","gi")}),j.schema.addValidElements("object[id|style|width|height|classid|codebase|*],embed[id|style|width|height|type|src|*],video[*],audio[*]");var a=j.schema.getBoolAttrs();tinymce.each("webkitallowfullscreen mozallowfullscreen allowfullscreen".split(" "),function(m){a[m]={}}),j.parser.addNodeFilter("iframe,video,audio,object,embed",function(B,x){for(var u,A,e,z,v,C,w,y=B.length;y--;){for(A=B[y],e=new tinymce.html.Node("img",1),e.shortEnded=!0,C=A.attributes,u=C.length;u--;){z=C[u].name,v=C[u].value,"width"!==z&&"height"!==z&&"style"!==z&&(("data"==z||"src"==z)&&(v=j.convertURL(v,z)),e.attr("data-mce-p-"+z,v))}w=A.firstChild&&A.firstChild.value,w&&(e.attr("data-mce-html",escape(w)),e.firstChild=null),e.attr({width:A.attr("width")||"300",height:A.attr("height")||("audio"==x?"30":"150"),style:A.attr("style"),src:tinymce.Env.transparentSrc,"data-mce-object":x,"class":"mce-object mce-object-"+x}),A.replace(e)}}),j.serializer.addAttributeFilter("data-mce-object",function(z,C){for(var y,v,B,u,A,w,D=z.length;D--;){for(y=z[D],v=new tinymce.html.Node(y.attr(C),1),"audio"!=y.attr(C)&&v.attr({width:y.attr("width"),height:y.attr("height")}),v.attr({style:y.attr("style")}),u=y.attributes,B=u.length;B--;){var x=u[B].name;0===x.indexOf("data-mce-p-")&&v.attr(x.substr(11),u[B].value)}A=y.attr("data-mce-html"),A&&(w=new tinymce.html.Node("#text",3),w.raw=!0,w.value=unescape(A),v.append(w)),y.replace(v)}})}),j.on("ObjectSelected",function(a){"audio"==a.target.getAttribute("data-mce-object")&&a.preventDefault()}),j.on("objectResized",function(m){var c,a=m.target;a.getAttribute("data-mce-object")&&(c=a.getAttribute("data-mce-html"),c&&(c=unescape(c),a.setAttribute("data-mce-html",escape(q(c,{width:m.width,height:m.height})))))}),j.addButton("media",{tooltip:"Insert/edit video",onclick:d,stateSelector:"img[data-mce-object=video]"}),j.addMenuItem("media",{icon:"media",text:"Insert video",onclick:d,context:"insert",prependToContext:!0})});!function(){function b(C,H,v,F,j){function y(f,d){if(d=d||0,!f[0]){throw"findAndReplaceDOMText cannot handle zero-length matches"}var g=f.index;if(d>0){var c=f[d];if(!c){throw"Invalid capture group"}g+=f[0].indexOf(c),f[0]=c}return[g,g+f[0].length,[f[0]]]}function D(d){var c;if(3===d.nodeType){return d.data}if(z[d.nodeName]&&!G[d.nodeName]){return""}if(c="",(G[d.nodeName]||A[d.nodeName])&&(c+="\n"),d=d.firstChild){do{c+=D(d)}while(d=d.nextSibling)}return c}function q(K,O,m){var N,g,u,L,h=[],p=0,M=K,P=O.shift(),J=0;K:for(;;){if((G[M.nodeName]||A[M.nodeName])&&p++,3===M.nodeType&&(!g&&M.length+p>=P[1]?(g=M,L=P[1]-p):N&&h.push(M),!N&&M.length+p>P[0]&&(N=M,u=P[0]-p),p+=M.length),N&&g){if(M=m({startNode:N,startNodeIndex:u,endNode:g,endNodeIndex:L,innerNodes:h,match:P[2],matchIndex:J}),p-=g.length-L,N=null,g=null,h=[],P=O.shift(),J++,!P){break}}else{if((!z[M.nodeName]||G[M.nodeName])&&M.firstChild){M=M.firstChild;continue}if(M.nextSibling){M=M.nextSibling;continue}}for(;;){if(M.nextSibling){M=M.nextSibling;break}if(M.parentNode===K){break K}M=M.parentNode}}}function x(d){var c;if("function"!=typeof d){var f=d.nodeType?d:B.createElement(d);c=function(l,h){var g=f.cloneNode(!1);return g.setAttribute("data-mce-index",h),l&&g.appendChild(B.createTextNode(l)),g}}else{c=d}return function(R){var L,V,t,O=R.startNode,S=R.endNode,K=R.matchIndex;if(O===S){var N=O;t=N.parentNode,R.startNodeIndex>0&&(L=B.createTextNode(N.data.substring(0,R.startNodeIndex)),t.insertBefore(L,N));var T=c(R.match[0],K);return t.insertBefore(T,N),R.endNodeIndex<N.length&&(V=B.createTextNode(N.data.substring(R.endNodeIndex)),t.insertBefore(V,N)),N.parentNode.removeChild(N),T}L=B.createTextNode(O.data.substring(0,R.startNodeIndex)),V=B.createTextNode(S.data.substring(R.endNodeIndex));for(var X=c(O.data.substring(R.startNodeIndex),K),W=[],P=0,Q=R.innerNodes.length;Q>P;++P){var M=R.innerNodes[P],J=c(M.data,K);M.parentNode.replaceChild(J,M),W.push(J)}var U=c(S.data.substring(0,R.endNodeIndex),K);return t=O.parentNode,t.insertBefore(L,O),t.insertBefore(X,O),t.removeChild(O),t=S.parentNode,t.insertBefore(U,S),t.insertBefore(V,S),t.removeChild(S),U}}var E,I,B,G,z,A,w=[],k=0;if(B=H.ownerDocument,G=j.getBlockElements(),z=j.getWhiteSpaceElements(),A=j.getShortEndedElements(),I=D(H)){if(C.global){for(;E=C.exec(I);){w.push(y(E,F))}}else{E=I.match(C),w.push(y(E,F))}return w.length&&(k=w.length,q(H,w,x(v))),k}}function a(q){function g(){function l(){d.statusbar.find("#next").disabled(!j(m+1).length),d.statusbar.find("#prev").disabled(!j(m-1).length)}function o(){tinymce.ui.MessageBox.alert("Could not find the specified string.",function(){d.find("#find")[0].focus()})}var c={},d=tinymce.ui.Factory.create({type:"window",layout:"flex",pack:"center",align:"center",onClose:function(){q.focus(),h.done()},onSubmit:function(n){var w,v,r,u;return n.preventDefault(),v=d.find("#case").checked(),u=d.find("#words").checked(),r=d.find("#find").value(),r.length?c.text==r&&c.caseState==v&&c.wholeWord==u?0===j(m+1).length?(o(),void 0):(h.next(),l(),void 0):(w=h.find(r,v,u),w||o(),d.statusbar.items().slice(1).disabled(0===w),l(),c={text:r,caseState:v,wholeWord:u},void 0):(h.done(!1),d.statusbar.items().slice(1).disabled(!0),void 0)},buttons:[{text:"Find",onclick:function(){d.submit()}},{text:"Replace",disabled:!0,onclick:function(){h.replace(d.find("#replace").value())||(d.statusbar.items().slice(1).disabled(!0),m=-1,c={})}},{text:"Replace all",disabled:!0,onclick:function(){h.replace(d.find("#replace").value(),!0,!0),d.statusbar.items().slice(1).disabled(!0),c={}}},{type:"spacer",flex:1},{text:"Prev",name:"prev",disabled:!0,onclick:function(){h.prev(),l()}},{text:"Next",name:"next",disabled:!0,onclick:function(){h.next(),l()}}],title:"Find and replace",items:{type:"form",padding:20,labelGap:30,spacing:10,items:[{type:"textbox",name:"find",size:40,label:"Find",value:q.selection.getNode().src},{type:"textbox",name:"replace",size:40,label:"Replace with"},{type:"checkbox",name:"case",text:"Match case",label:" "},{type:"checkbox",name:"words",text:"Whole words",label:" "}]}}).renderTo().reflow()}function p(l){var c,d;return d=q.dom.create("span",{"class":"mce-match-marker","data-mce-bogus":1}),c=q.getBody(),h.done(!1),b(l,c,d,!1,q.schema)}function e(d){var c=d.parentNode;c.insertBefore(d.firstChild,d),d.parentNode.removeChild(d)}function j(o){var s,c=[];if(s=tinymce.toArray(q.getBody().getElementsByTagName("span")),s.length){for(var l=0;l<s.length;l++){var d=s[l].getAttribute("data-mce-index");null!==d&&d.length&&d===o.toString()&&c.push(s[l])}}return c}function k(l){var o=m,c=q.dom;l=l!==!1,l?o++:o--,c.removeClass(j(m),"mce-match-marker-selected");var d=j(o);return d.length?(c.addClass(j(o),"mce-match-marker-selected"),q.selection.scrollIntoView(d[0]),o):-1}function f(c){c.parentNode.removeChild(c)}var h=this,m=-1;h.init=function(c){c.addMenuItem("searchreplace",{text:"Find and replace",shortcut:"Ctrl+F",onclick:g,separator:"before",context:"edit"}),c.addButton("searchreplace",{tooltip:"Find and replace",shortcut:"Ctrl+F",onclick:g}),c.addCommand("SearchReplace",g),c.shortcuts.add("Ctrl+F","",g)},h.find=function(l,c,o){l=l.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),l=o?"\\b"+l+"\\b":l;var d=p(new RegExp(l,c?"g":"gi"));return d&&(m=-1,m=k(!0)),d},h.next=function(){var c=k(!0);-1!==c&&(m=c)},h.prev=function(){var c=k(!1);-1!==c&&(m=c)},h.replace=function(w,l,y){var x,A,v,z,r,t,o=m;for(l=l!==!1,v=q.getBody(),A=tinymce.toArray(v.getElementsByTagName("span")),x=0;x<A.length;x++){var c=A[x].getAttribute("data-mce-index");if(null!==c&&c.length){if(z=r=parseInt(c,10),y||z===m){for(w.length?(A[x].firstChild.nodeValue=w,e(A[x])):f(A[x]);A[++x];){if(z=A[x].getAttribute("data-mce-index"),null!==c&&c.length){if(z!==r){x--;break}f(A[x])}}l&&o--}else{r>m&&A[x].setAttribute("data-mce-index",r-1)}}}return q.undoManager.add(),m=o,l?(t=j(o+1).length>0,h.next()):(t=j(o-1).length>0,h.prev()),!y&&t},h.done=function(t){var w,r,s,v;for(r=tinymce.toArray(q.getBody().getElementsByTagName("span")),w=0;w<r.length;w++){var u=r[w].getAttribute("data-mce-index");null!==u&&u.length&&(u===m.toString()&&(s||(s=r[w].firstChild),v=r[w].firstChild),e(r[w]))}if(s&&v){var c=q.dom.createRng();return c.setStart(s,0),c.setEnd(v,v.data.length),t!==!1&&q.selection.setRng(c),c}}}tinymce.PluginManager.add("searchreplace",a)}();tinymce.PluginManager.add("print",function(a){a.addCommand("mcePrint",function(){a.getWin().print()}),a.addButton("print",{title:"Print",cmd:"mcePrint"}),a.addShortcut("Ctrl+P","","mcePrint"),a.addMenuItem("print",{text:"Print",cmd:"mcePrint",icon:"print",shortcut:"Ctrl+P",context:"file"})});tinymce.PluginManager.add("contextmenu",function(a){var b;a.on("contextmenu",function(f){var g;if(f.preventDefault(),g=a.settings.contextmenu||"link image inserttable | cell row column deletetable",b){b.show()}else{var e=[];tinymce.each(g.split(/[ ,]/),function(j){var c=a.menuItems[j];"|"==j&&(c={text:j}),c&&(c.shortcut="",e.push(c))});for(var h=0;h<e.length;h++){"|"==e[h].text&&(0===h||h==e.length-1)&&e.splice(h,1)}b=new tinymce.ui.Menu({items:e,context:"contextmenu"}),b.renderTo(document.body),a.on("remove",function(){b.remove(),b=null})}var d={x:f.pageX,y:f.pageY};a.inline||(d=tinymce.DOM.getPos(a.getContentAreaContainer()),d.x+=f.clientX,d.y+=f.clientY),b.moveTo(d.x,d.y)})});(function(b,g){var d={};function c(m,n){var l,j=[];for(var k=0;k<m.length;++k){l=d[m[k]]||e(m[k]);if(!l){throw"module definition dependecy not found: "+m[k]}j.push(l)}n.apply(null,j)}function h(l,k,j){if(typeof l!=="string"){throw"invalid module definition, module id must be defined and be a string"}if(k===g){throw"invalid module definition, dependencies must be specified"}if(j===g){throw"invalid module definition, definition function must be specified"}c(k,function(){d[l]=j.apply(null,arguments)})}function f(j){return !!d[j]}function e(m){var k=b;var j=m.split(/[.\/]/);for(var l=0;l<j.length;++l){if(!k[j[l]]){return}k=k[j[l]]}return k}function a(l){for(var k=0;k<l.length;k++){var m=b;var o=l[k];var j=o.split(/[.\/]/);for(var n=0;n<j.length-1;++n){if(m[j[n]]===g){m[j[n]]={}}m=m[j[n]]}m[j[j.length-1]]=d[o]}}h("tinymce/pasteplugin/Clipboard",["tinymce/Env","tinymce/util/Tools","tinymce/util/VK","tinymce/html/DomParser","tinymce/html/Serializer","tinymce/html/Schema"],function(k,l,o,p,j,m){function n(){return !k.gecko&&(("ClipboardEvent" in window)||(k.webkit&&"FocusEvent" in window))}return function(y){var C=this,r;function u(){return new Date().getTime()}function v(D){return(o.metaKeyPressed(D)&&D.keyCode==86)||(D.shiftKey&&D.keyCode==45)}function A(K){var H=new m(),J=new p({},H),I="";var F=H.getShortEndedElements();var E=l.makeMap("script noscript style textarea video audio iframe object"," ");var G=y.schema.getBlockElements();function D(N){var L=N.name,M=N;if(L==="br"){I+="\n";return}if(F[L]){I+=" "}if(E[L]){I+=" ";return}if(N.type==3){I+=N.value}if(!N.shortEnded){if((N=N.firstChild)){do{D(N)}while((N=N.next))}}if(G[L]&&M.next){I+="\n";if(L=="p"){I+="\n"}}}D(J.parse(K.innerHTML));return I}function s(){return u()-r<100||C.pasteFormat=="text"}function t(E,D){l.each(D,function(F){if(F.constructor==RegExp){E=E.replace(F,"")}else{E=E.replace(F[0],F[1])}});return E}function B(F){var E=y.fire("PastePreProcess",{content:F}),G=y.dom;F=E.content;if(!y.settings.paste_data_images){F=F.replace(/<img src=\"data:image[^>]+>/g,"")}if(y.settings.paste_remove_styles||(y.settings.paste_remove_styles_if_webkit!==false&&k.webkit)){F=F.replace(/ style=\"[^\"]+\"/g,"")}if(!E.isDefaultPrevented()){if(y.hasEventListeners("PastePostProcess")&&!E.isDefaultPrevented()){var D=G.add(y.getBody(),"div",{style:"display:none"},F);E=y.fire("PastePostProcess",{node:D});G.remove(D);F=E.node.innerHTML}if(!E.isDefaultPrevented()){y.insertContent(F)}}}function w(E){E=y.dom.encode(E).replace(/\r\n/g,"\n");var D=y.dom.getParent(y.selection.getStart(),y.dom.isBlock);if((D&&/^(PRE|DIV)$/.test(D.nodeName))||!y.settings.forced_root_block){E=t(E,[[/\n/g,"<br>"]])}else{E=t(E,[[/\n\n/g,"</p><p>"],[/^(.*<\/p>)(<p>)$/,"<p>$1"],[/\n/g,"<br />"]])}B(E)}function x(){var D=y.dom.getViewPort().y;var E=y.dom.add(y.getBody(),"div",{contentEditable:false,"data-mce-bogus":"1",style:"position: absolute; top: "+D+"px; left: 0; width: 1px; height: 1px; overflow: hidden"},'<div contentEditable="true" data-mce-bogus="1">X</div>');y.dom.bind(E,"beforedeactivate focusin focusout",function(F){F.stopPropagation()});return E}function z(D){y.dom.unbind(D);y.dom.remove(D)}y.on("keydown",function(D){if(o.metaKeyPressed(D)&&D.shiftKey&&D.keyCode==86){r=u()}});if(n()){y.on("paste",function(E){var F=E.clipboardData;function D(I,H){for(var G=0;G<F.types.length;G++){if(F.types[G]==I){H(F.getData(I));return true}}}if(F){E.preventDefault();if(s()){if(!D("text/plain",w)){D("text/html",B)}}else{if(!D("text/html",B)){D("text/plain",w)}}}})}else{if(k.ie){var q=0;y.on("keydown",function(D){if(v(D)&&!D.isDefaultPrevented()){D.stopImmediatePropagation();var F=x();q=u();y.dom.bind(F,"paste",function(){setTimeout(function(){y.selection.setRng(E);z(F);if(s()){w(A(F.firstChild))}else{B(F.firstChild.innerHTML)}},0)});var E=y.selection.getRng();F.firstChild.focus();F.firstChild.innerText=""}});y.on("init",function(){var D=y.dom;y.dom.bind(y.getBody(),"paste",function(G){if(u()-q>100){var F,I=x();G.preventDefault();D.bind(I,"paste",function(J){J.stopPropagation();F=true});var H=y.selection.getRng();var E=D.doc.body.createTextRange();E.moveToElementText(I.firstChild);E.execCommand("Paste");z(I);if(!F){y.windowManager.alert("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents.");return}y.selection.setRng(H);if(s()){w(A(I.firstChild))}else{B(I.firstChild.innerHTML)}}})})}else{y.on("init",function(){y.dom.bind(y.getBody(),"paste",function(E){var D=y.getDoc();E.preventDefault();if(E.clipboardData||D.dataTransfer){w((E.clipboardData||D.dataTransfer).getData("Text"));return}E.preventDefault();y.windowManager.alert("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents.")})});y.on("keydown",function(D){if(v(D)&&!D.isDefaultPrevented()){D.stopImmediatePropagation();var F=x();var E=y.selection.getRng();if(k.webkit){F.contentEditable=true}y.selection.select(F,true);y.dom.bind(F,"paste",function(G){G.stopPropagation();setTimeout(function(){z(F);y.lastRng=E;y.selection.setRng(E);var H=F.firstChild;if(H.lastChild&&H.lastChild.nodeName=="BR"){H.removeChild(H.lastChild)}if(s()){w(A(H))}else{B(H.innerHTML)}},0)})}})}if(!y.settings.paste_data_images){y.on("drop",function(E){var D=E.dataTransfer;if(D&&D.files&&D.files.length>0){E.preventDefault()}})}}if(y.paste_block_drop){y.on("dragend dragover draggesture dragdrop drop drag",function(D){D.preventDefault();D.stopPropagation()})}this.paste=B;this.pasteText=w;this.innerText=A}});h("tinymce/pasteplugin/WordFilter",["tinymce/util/Tools","tinymce/html/DomParser","tinymce/html/Schema","tinymce/html/Serializer","tinymce/html/Node"],function(l,p,m,j,k){function o(q){return(/class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument/i).test(q)}function n(r){var s=l.each,q=r.settings;r.on("PastePreProcess",function(A){var C=A.content,B,x;B=q.paste_retain_style_properties;if(B){x=l.makeMap(B)}function u(E){s(E,function(F){if(F.constructor==RegExp){C=C.replace(F,"")}else{C=C.replace(F[0],F[1])}})}function z(I){var H,N,E=1;function O(R,Q,S,U){var T=R._listLevel||E;if(T!=E){if(T<E){if(H){H=H.parent.parent}}else{N=H;H=null}}if(!H||H.name!=S){N=N||H;H=new k(S,1);if(U>1){H.attr("start",""+U)}R.wrap(H)}else{H.append(R)}R.name="li";Q.value="";var P=Q.next;if(P&&P.type==3){P.value=P.value.replace(/^\u00a0+/,"")}if(T>E&&N){N.lastChild.append(H)}E=T}var M=I.getAll("p");for(var J=0;J<M.length;J++){I=M[J];if(I.name=="p"&&I.firstChild){var L="";var F=I.firstChild;while(F){L=F.value;if(L){break}F=F.firstChild}if(/^\s*[\u2022\u00b7\u00a7\u00d8\u25CF]\s*$/.test(L)){O(I,F,"ul");continue}if(/^\s*\w+\.$/.test(L)){var K=/([0-9])\./.exec(L);var G=1;if(K){G=parseInt(K[1],10)}O(I,F,"ol",G);continue}H=null}}}function t(F,E){if(F.name==="p"){var G=/mso-list:\w+ \w+([0-9]+)/.exec(E);if(G){F._listLevel=parseInt(G[1],10)}}if(r.getParam("paste_retain_style_properties","none")){var H="";l.each(r.dom.parseStyle(E),function(J,I){switch(I){case"horiz-align":I="text-align";return;case"vert-align":I="vertical-align";return;case"font-color":case"mso-foreground":I="color";return;case"mso-background":case"mso-highlight":I="background";break}if(B=="all"||(x&&x[I])){H+=I+":"+J+";"}});if(H){return H}}return null}if(q.paste_enable_default_filters===false){return}if(o(A.content)){A.wordContent=true;u([/<!--[\s\S]+?-->/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi,"\u00a0"],[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(F,E){return(E.length>0)?E.replace(/./," ").slice(Math.floor(E.length/2)).split("").join("\u00a0"):""}]]);var v=q.paste_word_valid_elements;if(!v){v="@[style],-strong/b,-em/i,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,-table,-tr,-td[colspan|rowspan],-th,-thead,-tfoot,-tbody,-a[!href],sub,sup,strike,br"}var y=new m({valid_elements:v});var D=new p({},y);D.addAttributeFilter("style",function(E){var F=E.length,G;while(F--){G=E[F];G.attr("style",t(G,G.attr("style")));if(G.name=="span"&&!G.attributes.length){G.unwrap()}}});var w=D.parse(C);z(w);A.content=new j({},y).serialize(w)}})}n.isWordContent=o;return n});h("tinymce/pasteplugin/Quirks",["tinymce/Env","tinymce/util/Tools","tinymce/pasteplugin/WordFilter"],function(j,k,l){return function(n){var q;function p(s){n.on("PastePreProcess",function(t){t.content=s(t.content)})}function r(t,s){k.each(s,function(u){if(u.constructor==RegExp){t=t.replace(u,"")}else{t=t.replace(u[0],u[1])}});return t}function o(s){s=r(s,[/^[\s\S]*<!--StartFragment-->|<!--EndFragment-->[\s\S]*$/g,[/<span class="Apple-converted-space">\u00a0<\/span>/g,"\u00a0"],/<br>$/]);return s}function m(s){if(!l.isWordContent(s)){return s}if(!q){var t=[];k.each(n.schema.getBlockElements(),function(v,u){t.push(u)});q=new RegExp("(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*(<\\/?("+t.join("|")+")[^>]*>)(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*","g")}s=r(s,[[q,"$1"]]);s=r(s,[[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]]);return s}if(j.webkit){p(o)}if(j.ie){p(m)}}});h("tinymce/pasteplugin/Plugin",["tinymce/PluginManager","tinymce/pasteplugin/Clipboard","tinymce/pasteplugin/WordFilter","tinymce/pasteplugin/Quirks"],function(j,n,m,k){var l;j.add("paste",function(r){var p=this,s,q=r.settings;function o(){if(s.pasteFormat=="text"){this.active(false);s.pasteFormat="html"}else{s.pasteFormat="text";this.active(true);if(!l){r.windowManager.alert("Paste is now in plain text mode. Contents will now be pasted as plain text until you toggle this option off.");l=true}}}p.clipboard=s=new n(r);p.quirks=new k(r);p.wordFilter=new m(r);p.innerText=s.innerText;if(r.settings.paste_as_text){p.clipboard.pasteFormat="text"}if(q.paste_preprocess){r.on("PastePreProcess",function(t){q.paste_preprocess.call(p,p,t)})}if(q.paste_postprocess){r.on("PastePostProcess",function(t){q.paste_postprocess.call(p,p,t)})}r.addCommand("mceInsertClipboardContent",function(u,t){if(t.content){p.clipboard.paste(t.content)}if(t.text){p.clipboard.pasteText(t.text)}});r.addButton("pastetext",{icon:"pastetext",tooltip:"Paste as text",onclick:o,active:p.clipboard.pasteFormat=="text"});r.addMenuItem("pastetext",{text:"Paste as text",selectable:true,active:s.pasteFormat,onclick:o})})});a(["tinymce/pasteplugin/Clipboard","tinymce/pasteplugin/WordFilter","tinymce/pasteplugin/Quirks","tinymce/pasteplugin/Plugin"])})(this);tinymce.PluginManager.add("directionality",function(b){function a(f){var g,e=b.dom,d=b.selection.getSelectedBlocks();d.length&&(g=e.getAttrib(d[0],"dir"),tinymce.each(d,function(h){e.getParent(h.parentNode,"*[dir='"+f+"']",e.getRoot())||(g!=f?e.setAttrib(h,"dir",f):e.setAttrib(h,"dir",null))}),b.nodeChanged())}function c(f){var d=[];return tinymce.each("h1 h2 h3 h4 h5 h6 div p".split(" "),function(e){d.push(e+"[dir="+f+"]")}),d.join(",")}b.addCommand("mceDirectionLTR",function(){a("ltr")}),b.addCommand("mceDirectionRTL",function(){a("rtl")}),b.addButton("ltr",{title:"Left to right",cmd:"mceDirectionLTR",stateSelector:c("ltr")}),b.addButton("rtl",{title:"Right to left",cmd:"mceDirectionRTL",stateSelector:c("rtl")})});tinymce.PluginManager.add("fullscreen",function(h){function f(){var p,o,q=window,m=document,l=m.body;return l.offsetWidth&&(p=l.offsetWidth,o=l.offsetHeight),q.innerWidth&&q.innerHeight&&(p=q.innerWidth,o=q.innerHeight),{w:p,h:o}}function k(){function q(){b.setStyle(p,"height",f().h-(l.clientHeight-p.clientHeight))}var l,p,e,o=document.body,a=document.documentElement;j=!j,l=h.getContainer().firstChild,p=h.getContentAreaContainer().firstChild,e=p.style,j?(d=e.width,c=e.height,e.width=e.height="100%",b.addClass(o,"mce-fullscreen"),b.addClass(a,"mce-fullscreen"),b.addClass(l,"mce-fullscreen"),b.bind(window,"resize",q),q(),g=q):(e.width=d,e.height=c,b.removeClass(o,"mce-fullscreen"),b.removeClass(a,"mce-fullscreen"),b.removeClass(l,"mce-fullscreen"),b.unbind(window,"resize",g)),h.fire("FullscreenStateChanged",{state:j})}var d,c,g,j=!1,b=tinymce.DOM;if(!h.settings.inline){return h.on("init",function(){h.addShortcut("Ctrl+Alt+F","",k)}),h.on("remove",function(){g&&b.unbind(window,"resize",g)}),h.addCommand("mceFullScreen",k),h.addMenuItem("fullscreen",{text:"Fullscreen",shortcut:"Ctrl+Alt+F",selectable:!0,onClick:k,onPostRender:function(){var a=this;h.on("FullscreenStateChanged",function(l){a.active(l.state)})},context:"view"}),h.addButton("fullscreen",{tooltip:"Fullscreen",shortcut:"Ctrl+Alt+F",onClick:k,onPostRender:function(){var a=this;h.on("FullscreenStateChanged",function(l){a.active(l.state)})}}),{isFullscreen:function(){return j}}}});tinymce.PluginManager.add("noneditable",function(j){function p(){function C(l){var a;if(1===l.nodeType){if(a=l.getAttribute(q),a&&"inherit"!==a){return a}if(a=l.contentEditable,"inherit"!==a){return a}}return null}function r(a){for(var l;a;){if(l=C(a)){return"false"===l?a:null}a=a.parentNode}}function w(a){for(;a;){if(a.id===x){return a}a=a.parentNode}}function e(l){var a;if(l){for(a=new b(l,l),l=a.current();l;l=a.next()){if(3===l.nodeType){return l}}}}function A(D,t){var u,l;return"false"===C(D)&&s.isBlock(D)?(y.select(D),void 0):(l=s.createRng(),"true"===C(D)&&(D.firstChild||D.appendChild(j.getDoc().createTextNode(" ")),D=D.firstChild,t=!0),u=s.create("span",{id:x,"data-mce-bogus":!0},c),t?D.parentNode.insertBefore(u,D):s.insertAfter(u,D),l.setStart(u.firstChild,1),l.collapse(!0),y.setRng(l),u)}function v(D){var o,E,l,u;if(D){o=y.getRng(!0),o.setStartBefore(D),o.setEndBefore(D),E=e(D),E&&E.nodeValue.charAt(0)==c&&(E=E.deleteData(0,1)),s.remove(D,!0),y.setRng(o)}else{for(l=w(y.getStart());(D=s.get(x))&&D!==u;){l!==D&&(E=e(D),E&&E.nodeValue.charAt(0)==c&&(E=E.deleteData(0,1)),s.remove(D,!0)),u=D}}}function z(){function n(I,L){var G,K,F,E,H;if(G=D.startContainer,K=D.startOffset,3==G.nodeType){if(H=G.nodeValue.length,K>0&&H>K||(L?K==H:0===K)){return}}else{if(!(K<G.childNodes.length)){return L?null:I}var J=!L&&K>0?K-1:K;G=G.childNodes[J],G.hasChildNodes()&&(G=G.firstChild)}for(F=new b(G,I);E=F[L?"prev":"next"]();){if(3===E.nodeType&&E.nodeValue.length>0){return}if("true"===C(E)){return E}}return I}var a,u,l,D,t;v(),l=y.isCollapsed(),a=r(y.getStart()),u=r(y.getEnd()),(a||u)&&(D=y.getRng(!0),l?(a=a||u,(t=n(a,!0))?A(t,!0):(t=n(a,!1))?A(t,!1):y.select(a)):(D=y.getRng(!0),a&&D.setStartBefore(a),u&&D.setEndAfter(u),y.setRng(D)))}function B(t){function I(o,a){for(;o=o[a?"previousSibling":"nextSibling"];){if(3!==o.nodeType||o.nodeValue.length>0){return o}}}function M(o,a){y.select(o),y.collapse(a)}function L(S){function O(o){for(var a=Q;a;){if(a===o){return}a=a.parentNode}s.remove(o),z()}function R(){var o,u,a=j.schema.getNonEmptyElements();for(u=new tinymce.dom.TreeWalker(Q,j.getBody());(o=S?u.prev():u.next())&&!a[o.nodeName.toLowerCase()]&&!(3===o.nodeType&&tinymce.trim(o.nodeValue).length>0);){if("false"===C(o)){return O(o),!0}}return r(o)?!0:!1}var N,Q,T,P;if(y.isCollapsed()){if(N=y.getRng(!0),Q=N.startContainer,T=N.startOffset,Q=w(Q)||Q,P=r(Q)){return O(P),!1}if(3==Q.nodeType&&(S?T>0:T<Q.nodeValue.length)){return !0}if(1==Q.nodeType&&(Q=Q.childNodes[T]||Q),R()){return !1}}return !0}var E,n,D,G,K=t.keyCode;if(D=y.getStart(),G=y.getEnd(),E=r(D)||r(G),E&&(112>K||K>124)&&K!=k.DELETE&&K!=k.BACKSPACE){if((tinymce.isMac?t.metaKey:t.ctrlKey)&&(67==K||88==K||86==K)){return}if(t.preventDefault(),K==k.LEFT||K==k.RIGHT){var F=K==k.LEFT;if(j.dom.isBlock(E)){var H=F?E.previousSibling:E.nextSibling,J=new b(H,H),l=F?J.prev():J.next();M(l,!F)}else{M(E,F)}}}else{if(K==k.LEFT||K==k.RIGHT||K==k.BACKSPACE||K==k.DELETE){if(n=w(D)){if(K==k.LEFT||K==k.BACKSPACE){if(E=I(n,!0),E&&"false"===C(E)){if(t.preventDefault(),K!=k.LEFT){return s.remove(E),void 0}M(E,!0)}else{v(n)}}if(K==k.RIGHT||K==k.DELETE){if(E=I(n),E&&"false"===C(E)){if(t.preventDefault(),K!=k.RIGHT){return s.remove(E),void 0}M(E,!1)}else{v(n)}}}if((K==k.BACKSPACE||K==k.DELETE)&&!L(K==k.BACKSPACE)){return t.preventDefault(),!1}}}}var s=j.dom,y=j.selection,x="mce_noneditablecaret",c="";j.on("mousedown",function(l){var a=j.selection.getNode();"false"===C(a)&&a==l.target&&z()}),j.on("mouseup keyup",z),j.on("keydown",B)}function f(c){var l=m.length,a=c.content,e=tinymce.trim(d);if("raw"!=c.format){for(;l--;){a=a.replace(m[l],function(r){var u=arguments,s=u[u.length-2];return s>0&&'"'==a.charAt(s-1)?r:'<span class="'+e+'" data-mce-content="'+j.dom.encode(u[0])+'">'+j.dom.encode("string"==typeof u[1]?u[1]:u[0])+"</span>"})}c.content=a}}var h,d,m,b=tinymce.dom.TreeWalker,g="contenteditable",q="data-mce-"+g,k=tinymce.util.VK;h=" "+tinymce.trim(j.getParam("noneditable_editable_class","mceEditable"))+" ",d=" "+tinymce.trim(j.getParam("noneditable_noneditable_class","mceNonEditable"))+" ",m=j.getParam("noneditable_regexp"),m&&!m.length&&(m=[m]),j.on("PreInit",function(){p(),m&&j.on("BeforeSetContent",f),j.parser.addAttributeFilter("class",function(o){for(var l,r,c=o.length;c--;){r=o[c],l=" "+r.attr("class")+" ",-1!==l.indexOf(h)?r.attr(q,"true"):-1!==l.indexOf(d)&&r.attr(q,"false")}}),j.serializer.addAttributeFilter(q,function(c){for(var a,l=c.length;l--;){a=c[l],m&&a.attr("data-mce-content")?(a.name="#text",a.type=3,a.raw=!0,a.value=a.attr("data-mce-content")):(a.attr(g,null),a.attr(q,null))}}),j.parser.addAttributeFilter(g,function(c){for(var a,l=c.length;l--;){a=c[l],a.attr(q,a.attr(g)),a.attr(g,null)}})})});tinymce.PluginManager.add("visualchars",function(c){function b(p){var g,m,e,f,h,q,k=c.getBody(),j=c.selection;if(a=!a,c.fire("VisualChars",{state:a}),p&&(q=j.getBookmark()),a){for(m=[],tinymce.walk(k,function(l){3==l.nodeType&&l.nodeValue&&-1!=l.nodeValue.indexOf(" ")&&m.push(l)},"childNodes"),e=0;e<m.length;e++){for(f=m[e].nodeValue,f=f.replace(/(\u00a0)/g,'<span data-mce-bogus="1" class="mce-nbsp">$1</span>'),h=c.dom.create("div",null,f);g=h.lastChild;){c.dom.insertAfter(g,m[e])}c.dom.remove(m[e])}}else{for(m=c.dom.select("span.mce-nbsp",k),e=m.length-1;e>=0;e--){c.dom.remove(m[e],1)}}j.moveToBookmark(q)}function d(){var e=this;c.on("VisualChars",function(f){e.active(f.state)})}var a;c.addCommand("mceVisualChars",b),c.addButton("visualchars",{title:"Show invisible characters",cmd:"mceVisualChars",onPostRender:d}),c.addMenuItem("visualchars",{text:"Show invisible characters",cmd:"mceVisualChars",onPostRender:d,selectable:!0,context:"view",prependToContext:!0}),c.on("beforegetcontent",function(f){a&&"raw"!=f.format&&!f.draft&&(a=!0,b(!1))})});tinymce.PluginManager.add("nonbreaking",function(b){var a=b.getParam("nonbreaking_force_tab");if(b.addCommand("mceNonBreaking",function(){b.insertContent(b.plugins.visualchars&&b.plugins.visualchars.state?'<span data-mce-bogus="1" class="mce-nbsp">&nbsp;</span>':"&nbsp;")}),b.addButton("nonbreaking",{title:"Insert nonbreaking space",cmd:"mceNonBreaking"}),b.addMenuItem("nonbreaking",{text:"Nonbreaking space",cmd:"mceNonBreaking",context:"insert"}),a){var c=+a>1?+a:3;b.on("keydown",function(e){if(9==e.keyCode){if(e.shiftKey){return}e.preventDefault();for(var d=0;c>d;d++){b.execCommand("mceNonBreaking")}}})}});tinymce.PluginManager.add("template",function(h){function f(){function l(a){function n(c){if(-1==c.indexOf("<html>")){var s="";tinymce.each(h.contentCSS,function(r){s+='<link type="text/css" rel="stylesheet" href="'+h.documentBaseURI.toAbsolute(r)+'">'}),c="<!DOCTYPE html><html><head>"+s+"</head><body>"+c+"</body></html>"}c=b(c,"template_preview_replace_values");var q=e.find("iframe")[0].getEl().contentWindow.document;q.open(),q.write(c),q.close()}var p=a.control.value();p.url?tinymce.util.XHR.send({url:p.url,success:function(c){o=c,n(o)}}):(o=p.content,n(o)),e.find("#description")[0].text(a.control.value().description)}var e,o,m=[];return h.settings.templates?(tinymce.each(h.settings.templates,function(a){m.push({selected:!m.length,text:a.title,value:{url:a.url,content:a.content,description:a.description}})}),e=h.windowManager.open({title:"Insert template",body:[{type:"container",label:"Templates",items:{type:"listbox",name:"template",values:m,onselect:l}},{type:"label",name:"description",label:"Description",text:" "},{type:"iframe",minWidth:600,minHeight:400,border:1}],onsubmit:function(){g(!1,o)}}),e.find("listbox")[0].fire("select"),void 0):(h.windowManager.alert("No templates defined"),void 0)}function d(p,m){function v(n,l){if(n=""+n,n.length<l){for(var c=0;c<l-n.length;c++){n="0"+n}}return n}var e="Sun Mon Tue Wed Thu Fri Sat Sun".split(" "),q="Sunday Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "),u="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),s="January February March April May June July August September October November December".split(" ");return m=m||new Date,p=p.replace("%D","%m/%d/%Y"),p=p.replace("%r","%I:%M:%S %p"),p=p.replace("%Y",""+m.getFullYear()),p=p.replace("%y",""+m.getYear()),p=p.replace("%m",v(m.getMonth()+1,2)),p=p.replace("%d",v(m.getDate(),2)),p=p.replace("%H",""+v(m.getHours(),2)),p=p.replace("%M",""+v(m.getMinutes(),2)),p=p.replace("%S",""+v(m.getSeconds(),2)),p=p.replace("%I",""+((m.getHours()+11)%12+1)),p=p.replace("%p",""+(m.getHours()<12?"AM":"PM")),p=p.replace("%B",""+h.translate(s[m.getMonth()])),p=p.replace("%b",""+h.translate(u[m.getMonth()])),p=p.replace("%A",""+h.translate(q[m.getDay()])),p=p.replace("%a",""+h.translate(e[m.getDay()])),p=p.replace("%%","%")}function k(e){var c=h.dom,l=h.getParam("template_replace_values");j(c.select("*",e),function(a){j(l,function(n,m){c.hasClass(a,m)&&"function"==typeof l[m]&&l[m](a)})})}function b(e,c){return j(h.getParam(c),function(m,l){"function"!=typeof m&&(e=e.replace(new RegExp("\\{\\$"+l+"\\}","g"),m))}),e}function g(e,n){function u(o,m){return new RegExp("\\b"+m+"\\b","g").test(o.className)}var l,c,a=h.dom,q=h.selection.getContent();n=b(n,"template_replace_values"),l=a.create("div",null,n),c=a.select(".mceTmpl",l),c&&c.length>0&&(l=a.create("div",null),l.appendChild(c[0].cloneNode(!0))),j(a.select("*",l),function(m){u(m,h.getParam("template_cdate_classes","cdate").replace(/\s+/g,"|"))&&(m.innerHTML=d(h.getParam("template_cdate_format",h.getLang("template.cdate_format")))),u(m,h.getParam("template_mdate_classes","mdate").replace(/\s+/g,"|"))&&(m.innerHTML=d(h.getParam("template_mdate_format",h.getLang("template.mdate_format")))),u(m,h.getParam("template_selected_content_classes","selcontent").replace(/\s+/g,"|"))&&(m.innerHTML=q)}),k(l),h.execCommand("mceInsertContent",!1,l.innerHTML),h.addVisual()}var j=tinymce.each;h.addCommand("mceInsertTemplate",g),h.addButton("template",{title:"Insert template",onclick:f}),h.addMenuItem("template",{text:"Insert template",onclick:f,context:"insert"}),h.on("PreProcess",function(c){var a=h.dom;j(a.select("div",c.node),function(e){a.hasClass(e,"mceTmpl")&&(j(a.select("*",e),function(l){a.hasClass(l,h.getParam("template_mdate_classes","mdate").replace(/\s+/g,"|"))&&(l.innerHTML=d(h.getParam("template_mdate_format",h.getLang("template.mdate_format"))))}),k(e))})})});tinymce.PluginManager.add("anchor",function(b){function a(){var c=b.selection.getNode();b.windowManager.open({title:"Anchor",body:{type:"textbox",name:"name",size:40,label:"Name",value:c.name||c.id},onsubmit:function(d){b.execCommand("mceInsertContent",!1,b.dom.createHTML("a",{id:d.data.name}))}})}b.addButton("anchor",{icon:"anchor",tooltip:"Anchor",onclick:a,stateSelector:"a:not([href])"}),b.addMenuItem("anchor",{icon:"anchor",text:"Anchor",context:"insert",onclick:a})});tinymce.PluginManager.add("code",function(b){function a(){b.windowManager.open({title:"Source code",body:{type:"textbox",name:"code",multiline:!0,minWidth:b.getParam("code_dialog_width",600),minHeight:b.getParam("code_dialog_height",Math.min(tinymce.DOM.getViewPort().h-200,500)),value:b.getContent({source_view:!0}),spellcheck:!1,style:"direction: ltr; text-align: left"},onSubmit:function(c){b.undoManager.transact(function(){b.setContent(c.data.code)}),b.nodeChanged()}})}b.addCommand("mceCodeEditor",a),b.addButton("code",{icon:"code",tooltip:"Source code",onclick:a}),b.addMenuItem("code",{icon:"code",text:"Source code",context:"tools",onclick:a})});tinymce.PluginManager.add("charmap",function(b){function a(){function m(l){for(;l;){if("TD"==l.nodeName){return l}l=l.parentNode}}var g,j,d,e;g='<table role="presentation" cellspacing="0" class="mce-charmap"><tbody>';var n=25;for(d=0;10>d;d++){for(g+="<tr>",j=0;n>j;j++){var f=c[d*n+j],h="g"+(d*n+j);g+='<td title="'+f[1]+'"><div id="'+h+'" tabIndex="-1">'+(f?String.fromCharCode(parseInt(f[0],10)):"&nbsp;")+"</div></td>"}g+="</tr>"}g+="</tbody></table>";var k={type:"container",html:g,onclick:function(l){var o=l.target;"DIV"==o.nodeName&&b.execCommand("mceInsertContent",!1,o.firstChild.nodeValue)},onmouseover:function(l){var o=m(l.target);o&&e.find("#preview").text(o.firstChild.firstChild.data)}};e=b.windowManager.open({title:"Special character",spacing:10,padding:10,items:[k,{type:"label",name:"preview",text:" ",style:"font-size: 40px; text-align: center",border:1,minWidth:100,minHeight:80}],buttons:[{text:"Close",onclick:function(){e.close()}}]})}var c=[["160","no-break space"],["38","ampersand"],["34","quotation mark"],["162","cent sign"],["8364","euro sign"],["163","pound sign"],["165","yen sign"],["169","copyright sign"],["174","registered sign"],["8482","trade mark sign"],["8240","per mille sign"],["181","micro sign"],["183","middle dot"],["8226","bullet"],["8230","three dot leader"],["8242","minutes / feet"],["8243","seconds / inches"],["167","section sign"],["182","paragraph sign"],["223","sharp s / ess-zed"],["8249","single left-pointing angle quotation mark"],["8250","single right-pointing angle quotation mark"],["171","left pointing guillemet"],["187","right pointing guillemet"],["8216","left single quotation mark"],["8217","right single quotation mark"],["8220","left double quotation mark"],["8221","right double quotation mark"],["8218","single low-9 quotation mark"],["8222","double low-9 quotation mark"],["60","less-than sign"],["62","greater-than sign"],["8804","less-than or equal to"],["8805","greater-than or equal to"],["8211","en dash"],["8212","em dash"],["175","macron"],["8254","overline"],["164","currency sign"],["166","broken bar"],["168","diaeresis"],["161","inverted exclamation mark"],["191","turned question mark"],["710","circumflex accent"],["732","small tilde"],["176","degree sign"],["8722","minus sign"],["177","plus-minus sign"],["247","division sign"],["8260","fraction slash"],["215","multiplication sign"],["185","superscript one"],["178","superscript two"],["179","superscript three"],["188","fraction one quarter"],["189","fraction one half"],["190","fraction three quarters"],["402","function / florin"],["8747","integral"],["8721","n-ary sumation"],["8734","infinity"],["8730","square root"],["8764","similar to"],["8773","approximately equal to"],["8776","almost equal to"],["8800","not equal to"],["8801","identical to"],["8712","element of"],["8713","not an element of"],["8715","contains as member"],["8719","n-ary product"],["8743","logical and"],["8744","logical or"],["172","not sign"],["8745","intersection"],["8746","union"],["8706","partial differential"],["8704","for all"],["8707","there exists"],["8709","diameter"],["8711","backward difference"],["8727","asterisk operator"],["8733","proportional to"],["8736","angle"],["180","acute accent"],["184","cedilla"],["170","feminine ordinal indicator"],["186","masculine ordinal indicator"],["8224","dagger"],["8225","double dagger"],["192","A - grave"],["193","A - acute"],["194","A - circumflex"],["195","A - tilde"],["196","A - diaeresis"],["197","A - ring above"],["198","ligature AE"],["199","C - cedilla"],["200","E - grave"],["201","E - acute"],["202","E - circumflex"],["203","E - diaeresis"],["204","I - grave"],["205","I - acute"],["206","I - circumflex"],["207","I - diaeresis"],["208","ETH"],["209","N - tilde"],["210","O - grave"],["211","O - acute"],["212","O - circumflex"],["213","O - tilde"],["214","O - diaeresis"],["216","O - slash"],["338","ligature OE"],["352","S - caron"],["217","U - grave"],["218","U - acute"],["219","U - circumflex"],["220","U - diaeresis"],["221","Y - acute"],["376","Y - diaeresis"],["222","THORN"],["224","a - grave"],["225","a - acute"],["226","a - circumflex"],["227","a - tilde"],["228","a - diaeresis"],["229","a - ring above"],["230","ligature ae"],["231","c - cedilla"],["232","e - grave"],["233","e - acute"],["234","e - circumflex"],["235","e - diaeresis"],["236","i - grave"],["237","i - acute"],["238","i - circumflex"],["239","i - diaeresis"],["240","eth"],["241","n - tilde"],["242","o - grave"],["243","o - acute"],["244","o - circumflex"],["245","o - tilde"],["246","o - diaeresis"],["248","o slash"],["339","ligature oe"],["353","s - caron"],["249","u - grave"],["250","u - acute"],["251","u - circumflex"],["252","u - diaeresis"],["253","y - acute"],["254","thorn"],["255","y - diaeresis"],["913","Alpha"],["914","Beta"],["915","Gamma"],["916","Delta"],["917","Epsilon"],["918","Zeta"],["919","Eta"],["920","Theta"],["921","Iota"],["922","Kappa"],["923","Lambda"],["924","Mu"],["925","Nu"],["926","Xi"],["927","Omicron"],["928","Pi"],["929","Rho"],["931","Sigma"],["932","Tau"],["933","Upsilon"],["934","Phi"],["935","Chi"],["936","Psi"],["937","Omega"],["945","alpha"],["946","beta"],["947","gamma"],["948","delta"],["949","epsilon"],["950","zeta"],["951","eta"],["952","theta"],["953","iota"],["954","kappa"],["955","lambda"],["956","mu"],["957","nu"],["958","xi"],["959","omicron"],["960","pi"],["961","rho"],["962","final sigma"],["963","sigma"],["964","tau"],["965","upsilon"],["966","phi"],["967","chi"],["968","psi"],["969","omega"],["8501","alef symbol"],["982","pi symbol"],["8476","real part symbol"],["978","upsilon - hook symbol"],["8472","Weierstrass p"],["8465","imaginary part"],["8592","leftwards arrow"],["8593","upwards arrow"],["8594","rightwards arrow"],["8595","downwards arrow"],["8596","left right arrow"],["8629","carriage return"],["8656","leftwards double arrow"],["8657","upwards double arrow"],["8658","rightwards double arrow"],["8659","downwards double arrow"],["8660","left right double arrow"],["8756","therefore"],["8834","subset of"],["8835","superset of"],["8836","not a subset of"],["8838","subset of or equal to"],["8839","superset of or equal to"],["8853","circled plus"],["8855","circled times"],["8869","perpendicular"],["8901","dot operator"],["8968","left ceiling"],["8969","right ceiling"],["8970","left floor"],["8971","right floor"],["9001","left-pointing angle bracket"],["9002","right-pointing angle bracket"],["9674","lozenge"],["9824","black spade suit"],["9827","black club suit"],["9829","black heart suit"],["9830","black diamond suit"],["8194","en space"],["8195","em space"],["8201","thin space"],["8204","zero width non-joiner"],["8205","zero width joiner"],["8206","left-to-right mark"],["8207","right-to-left mark"],["173","soft hyphen"]];b.addButton("charmap",{icon:"charmap",tooltip:"Special character",onclick:a}),b.addMenuItem("charmap",{icon:"charmap",text:"Special character",onclick:a,context:"insert"})});tinymce.PluginManager.add("textcolor",function(d){function e(){var h,f=[],g;g=d.settings.textcolor_map||["000000","Black","993300","Burnt orange","333300","Dark olive","003300","Dark green","003366","Dark azure","000080","Navy Blue","333399","Indigo","333333","Very dark gray","800000","Maroon","FF6600","Orange","808000","Olive","008000","Green","008080","Teal","0000FF","Blue","666699","Grayish blue","808080","Gray","FF0000","Red","FF9900","Amber","99CC00","Yellow green","339966","Sea green","33CCCC","Turquoise","3366FF","Royal blue","800080","Purple","999999","Medium gray","FF00FF","Magenta","FFCC00","Gold","FFFF00","Yellow","00FF00","Lime","00FFFF","Aqua","00CCFF","Sky blue","993366","Brown","C0C0C0","Silver","FF99CC","Pink","FFCC99","Peach","FFFF99","Light yellow","CCFFCC","Pale green","CCFFFF","Pale cyan","99CCFF","Light sky blue","CC99FF","Plum","FFFFFF","White"];for(h=0;h<g.length;h+=2){f.push({text:g[h+1],color:g[h]})}return f}function a(){var f=this,g,h,k,o,p,m,n,l,j;g=e();k='<table class="mce-grid mce-grid-border mce-colorbutton-grid" role="presentation" cellspacing="0"><tbody>';o=g.length-1;p=d.settings.textcolor_rows||5;m=d.settings.textcolor_cols||8;for(l=0;l<p;l++){k+="<tr>";for(n=0;n<m;n++){j=l*m+n;if(j>o){k+="<td></td>"}else{h=g[j];k+=('<td><div id="'+f._id+"-"+j+'" data-mce-color="'+h.color+'" role="option" tabIndex="-1" style="'+(h?"background-color: #"+h.color:"")+'" title="'+h.text+'"></div></td>')}}k+="</tr>"}k+="</tbody></table>";return k}function c(h){var f=this.parent(),g;if((g=h.target.getAttribute("data-mce-color"))){f.hidePanel();g="#"+g;f.color(g);if(d.selection.isCollapsed()&&d.lastSelectionBookmark){d.selection.moveToBookmark(d.lastSelectionBookmark)}d.execCommand(f.settings.selectcmd,false,g)}}function b(){var f=this;if(d.selection.isCollapsed()&&d.lastSelectionBookmark){d.selection.moveToBookmark(d.lastSelectionBookmark)}if(f._color){d.execCommand(f.settings.selectcmd,false,f._color)}}d.addButton("forecolor",{type:"colorbutton",tooltip:"Text color",selectcmd:"ForeColor",panel:{html:a,onclick:c},onclick:b});d.addButton("backcolor",{type:"colorbutton",tooltip:"Background color",selectcmd:"HiliteColor",panel:{html:a,onclick:c},onclick:b})});